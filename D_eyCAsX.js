import {
  b9 as B,
  an as E,
  ba as ye,
  bb as gt,
  bc as Yr,
  bd as ee,
  be as _,
  bf as Qr,
  bg as qe,
  bh as Te,
  bi as _e,
  bj as Re,
  bk as Kn,
  bl as Ge,
  bm as Ne,
  bn as We,
  bo as be,
  bp as $n,
  bq as M,
  br as ce,
  bs as R,
  bt as S,
  bu as Oe,
  bv as pe,
  b6 as T,
  am as z,
  ap as u,
  bw as Xn,
  bx as ie,
  by as G,
  bz as en,
  a9 as ve,
  bA as wt,
  b4 as N,
  bB as Jn,
  bC as Zn,
  bD as Ni,
  bE as Pi,
  bF as Lt,
  bG as di,
  bH as Ce,
  bI as et,
  bJ as Yn,
  bK as Se,
  bL as ae,
  bM as Ft,
  bN as re,
  bO as pi,
  bP as Ti,
  bQ as Qn,
  bR as Oi,
  bS as fe,
  bT as mt,
  bU as oe,
  a5 as H,
  a4 as ue,
  bV as Bi,
  bW as tn,
  bX as es,
  bY as Hi,
  bZ as rn,
  b_ as nn,
  b0 as Ke,
  b$ as Ai,
  ac as le,
  c0 as sn,
  c1 as an,
  c2 as on,
  c3 as ui,
  c4 as ln,
  c5 as Mt,
  c6 as ts,
  c7 as is,
  c8 as Wt,
  c9 as rs,
  ca as ns,
  cb as ci,
  cc as ss,
  cd as Vi,
  ce as vt,
  cf as _i,
  cg as ji,
  ch as as,
  ci as nt,
  cj as P,
  ck as se,
  cl as Kt,
  cm as ki,
  cn as yt,
  co as ze,
  cp as fi,
  cq as Ui,
  cr as gi,
  cs as Gi,
  ct as Wi,
  cu as os,
  cv as Ki,
  cw as j,
  cx as qt,
  cy as xe,
  cz as ut,
  b5 as Q,
  cA as $i,
  cB as Xi,
  cC as zt,
  cD as Ji,
  cE as me,
  cF as ls,
  cG as hs,
  cH as Tt,
  cI as Yt,
  cJ as ds,
  cK as ps,
  cL as ct,
  cM as us,
  cN as hn,
  cO as cs,
  cP as Zi,
  cQ as fs,
  cR as Qt,
  cS as Ct,
  cT as gs,
  cU as ms,
  cV as je,
  cW as ei,
  cX as Yi,
  cY as ti,
  cZ as ii,
  c_ as Qi,
  c$ as ft,
  d0 as mi,
  d1 as De,
  d2 as U,
  d3 as de,
  d4 as er,
  d5 as tr,
  d6 as ir,
  d7 as dn,
  d8 as q,
  d9 as vs,
  da as ys,
  db as Ss,
  dc as ws,
  dd as bs,
  de as rr,
  df as Pe,
  dg as Cs,
  dh as ri,
  di as Is,
  dj as xs,
  dk as Es,
  dl as Ds,
  dm as nr,
  dn as St,
  dp as sr,
  dq as ar,
  dr as or,
  ds as Nt,
  dt as ni,
  aY as pn,
  aT as te,
  du as Rs,
  dv as lr,
  dw as Fs,
  dx as Ts,
  dy as hr,
  aZ as Ee,
  dz as Os,
  dA as dr,
  dB as st,
  dC as it,
  dD as pr,
  dE as ur,
  dF as un,
  dG as Bs,
  dH as cn,
  dI as Me,
  dJ as fn,
  dK as vi,
  dL as cr,
  dM as gn,
  dN as Li,
  dO as mn,
  dP as As,
  dQ as yi,
  dR as ks,
  dS as Le,
  dT as It,
  dU as Si,
  dV as Ls,
  dW as vn,
  dX as Ms,
  dY as yn,
  dZ as Sn,
  d_ as fr,
  d$ as Ot,
  e0 as wn,
  e1 as gr,
  e2 as qs,
  e3 as Mi,
  e4 as zs,
  e5 as Pt,
  e6 as X,
  e7 as Ns,
  e8 as bn,
  e9 as Cn,
  ea as dt,
  eb as wi,
  ec as Ps,
  ed as Bt,
  ee as At,
  ef as In,
  eg as Y,
  eh as Fe,
  ei as Hs,
  ej as Vs,
  ek as _s,
  el as js,
  em as Us,
  en as xn,
  eo as En,
  ep as Gs,
  eq as bi,
  er as Dn,
  es as Ws,
  et as Ht,
  eu as Rn,
  ev as Ks,
  ew as $s,
  ex as Xs,
  ey as Fn,
  ez as Tn,
  eA as mr,
  eB as Js,
  eC as Zs,
  eD as kt,
  eE as Ys,
  eF as Qs,
  eG as ea,
  eH as Vt,
  eI as Ci,
  eJ as On,
  eK as Ii,
  eL as ta,
  eM as ia,
  eN as ra,
  eO as na,
  eP as vr,
  eQ as sa,
  ai as rt,
  eR as qi,
  eS as _t,
  eT as aa,
  eU as Ue,
  eV as jt,
  eW as oa,
  eX as $t,
  eY as la,
  eZ as bt,
  e_ as yr,
  e$ as Xt,
  f0 as Sr,
  f1 as Jt,
  f2 as ha,
  f3 as pt,
  f4 as da,
  f5 as pa,
  f6 as wr,
  f7 as xi,
  f8 as Bn,
  f9 as Ei,
  fa as Di,
  fb as ua,
  fc as An,
  fd as ca,
  fe as fa,
  ff as ga,
  fg as ma,
  fh as va,
  fi as ya,
  fj as Sa,
  fk as Ri,
  fl as xt,
  fm as wa,
  fn as Ut,
  fo as ba,
  fp as Ca,
  fq as Ia,
  fr as br,
  fs as xa,
  ft as Cr,
  aR as Ir,
  fu as Ea,
  fv as Da,
  fw as Ra,
  fx as Fa,
  fy as si,
  fz as Ta,
  fA as Oa,
  fB as Ba,
  fC as ai,
  fD as xr,
  j as Aa,
  fE as ka,
  fF as Er,
  fG as kn,
  fH as La,
  fI as Ma,
  fJ as Ln,
  fK as Dr,
  fL as Rr,
  fM as qa,
  fN as za,
  fO as Na,
  fP as Je,
  fQ as Pa,
  fR as at,
  fS as Ha,
  fT as Et,
  fU as Fr,
  fV as Va,
  fW as _a,
  fX as ja,
  fY as Tr,
  fZ as Mn,
  f_ as qn,
  f$ as Ua,
  g0 as Ga,
  aQ as Wa,
  g1 as Or,
  g2 as Ka,
  g3 as $a,
  g4 as Br,
  g5 as Xa,
  g6 as Ja,
  g7 as Ar,
  g8 as Za,
  g9 as Ya,
  ga as Qa,
  gb as eo,
  gc as kr,
  gd as to,
  ge as Lr,
  gf as io,
  _ as ro,
  a as no,
  gg as so,
  c as ao,
  o as oo,
  gh as lo,
  i as Mr,
  s as ho,
  E as He,
  aL as po,
  aM as uo,
} from '../assets/app-BjImoLrr.js';
import { d as co } from './DF3-5v4V.js';
import { M as fo } from './BKAIn2gq.js';
import { C as zi } from './D6qTVqbk.js';
var go = (function () {
  function s(e, t, i, r) {
    this.contentRefresh = true;
    this.isModelChanged = true;
    this.aria = new en();
    this.currentTarget = null;
    this.parent = e;
    this.sortSettings = t;
    this.sortedColumns = i;
    this.serviceLocator = r;
    this.focus = r.getService('focus');
    this.addEventListener();
    this.setFullScreenDialog();
  }
  s.prototype.updateModel = function () {
    var e = {
      field: this.columnName,
      direction: this.direction,
    };
    var t;
    var i = this.parent.groupSettings.columns;
    var r = false;
    if (this.isMultiSort) {
      t = this.getSortedColsIndexByField(this.columnName);
      if (t > -1) {
        this.sortSettings.columns.splice(t, 1);
      }
      this.sortSettings.columns.push(e);
      this.sortSettings.columns = this.sortSettings.columns;
    } else if (!this.parent.groupSettings.columns.length) this.sortSettings.columns = [e];
    else {
      for (var n = [], a = 0, o = this.parent.groupSettings.columns.length; a < o; a++) {
        t = this.getSortedColsIndexByField(this.parent.groupSettings.columns[parseInt(a.toString(), 10)], n);
        if (this.columnName === this.parent.groupSettings.columns[parseInt(a.toString(), 10)]) {
          r = true;
          n.push(e);
        } else {
          var l = this.getSortColumnFromField(this.parent.groupSettings.columns[parseInt(a.toString(), 10)]);
          n.push({
            field: l.field,
            direction: l.direction,
            isFromGroup: l.isFromGroup,
          });
        }
      }
      if (!r) {
        n.push(e);
      }
      this.sortSettings.columns = n;
    }
    this.parent.dataBind();
    this.lastSortedCol = this.columnName;
  };
  s.prototype.onActionComplete = function (e) {
    var t = this.isRemove
      ? {
          requestType: 'sorting',
          type: B,
        }
      : {
          columnName: this.columnName,
          direction: this.direction,
          requestType: 'sorting',
          type: B,
        };
    this.isRemove = false;
    this.parent.trigger(B, E(e, t));
  };
  s.prototype.sortColumn = function (e, t, i) {
    var r = this.parent;
    if (this.parent.getColumnByField(e).allowSorting === false || this.parent.isContextMenuOpen()) {
      this.parent.log('action_disabled_column', {
        moduleName: this.getModuleName(),
        columnName: e,
      });
      return;
    }
    if (!this.parent.allowMultiSorting) {
      i = this.parent.allowMultiSorting;
    }
    if (this.isActionPrevent()) {
      this.parent.notify(ye, {
        instance: this,
        handler: this.sortColumn,
        arg1: e,
        arg2: t,
        arg3: i,
      });
      return;
    }
    this.backupSettings();
    this.columnName = e;
    this.direction = t;
    this.isMultiSort = i;
    this.removeSortIcons();
    this.updateSortedCols(e, i);
    this.updateModel();
  };
  s.prototype.setFullScreenDialog = function () {
    if (this.serviceLocator) {
      this.serviceLocator.registerAdaptiveService(this, this.parent.enableAdaptiveUI, gt.isSort);
    }
  };
  s.prototype.backupSettings = function () {
    this.lastSortedCols = Yr(this.sortSettings.columns);
    this.lastCols = this.sortedColumns;
  };
  s.prototype.restoreSettings = function () {
    this.isModelChanged = false;
    this.isMultiSort = true;
    this.parent.setProperties({ sortSettings: { columns: this.lastSortedCols } }, true);
    this.sortedColumns = this.lastCols;
    this.isModelChanged = true;
  };
  s.prototype.updateSortedCols = function (e, t) {
    if (!t)
      if (this.parent.allowGrouping)
        for (var i = 0, r = this.sortedColumns.length; i < r; i++)
          if (this.parent.groupSettings.columns.indexOf(this.sortedColumns[parseInt(i.toString(), 10)]) < 0) {
            this.sortedColumns.splice(i, 1);
            r--;
            i--;
          } else this.sortedColumns.splice(0, this.sortedColumns.length);
    if (this.sortedColumns.indexOf(e) < 0) {
      this.sortedColumns.push(e);
    }
  };
  s.prototype.onPropertyChanged = function (e) {
    if (e.module === this.getModuleName()) {
      if (this.contentRefresh) {
        var t = this.sortSettings.columns.length
          ? {
              columnName: this.columnName,
              direction: this.direction,
              requestType: 'sorting',
              type: _,
              target: this.currentTarget,
              cancel: false,
            }
          : {
              requestType: 'sorting',
              type: _,
              cancel: false,
              target: this.currentTarget,
            };
        this.parent.notify(ee, t);
      }
      this.refreshSortSettings();
      this.removeSortIcons();
      this.addSortIcons();
    }
  };
  s.prototype.refreshSortSettings = function () {
    this.sortedColumns.length = 0;
    for (var e = this.sortSettings.columns, t = 0; t < e.length; t++)
      if (!e[parseInt(t.toString(), 10)].isFromGroup) {
        this.sortedColumns.push(e[parseInt(t.toString(), 10)].field);
      }
  };
  s.prototype.clearSorting = function () {
    var e = Qr(this.sortSettings.columns);
    if (this.isActionPrevent()) {
      this.parent.notify(ye, {
        instance: this,
        handler: this.clearSorting,
      });
      return;
    }
    for (var t = 0, i = e.length; t < i; t++) this.removeSortColumn(e[parseInt(t.toString(), 10)].field);
  };
  s.prototype.isActionPrevent = function () {
    return qe(this.parent);
  };
  s.prototype.removeSortColumn = function (e) {
    var t = this.parent;
    var i = this.sortSettings.columns;
    if (!(i.length === 0 && this.sortedColumns.indexOf(e) < 0)) {
      if (this.isActionPrevent()) {
        this.parent.notify(ye, {
          instance: this,
          handler: this.removeSortColumn,
          arg1: e,
        });
        return;
      }
      this.backupSettings();
      this.removeSortIcons();
      for (
        var r = {
            requestType: 'sorting',
            type: _,
            target: this.currentTarget,
          },
          n = 0,
          a = i.length;
        n < a;
        n++
      )
        if (i[parseInt(n.toString(), 10)].field === e) {
          if (
            this.parent.allowGrouping &&
            this.parent.groupSettings.columns.indexOf(i[parseInt(n.toString(), 10)].field) > -1
          )
            continue;
          this.sortedColumns.splice(this.sortedColumns.indexOf(i[parseInt(n.toString(), 10)].field), 1);
          i.splice(n, 1);
          this.isRemove = true;
          if (this.isModelChanged) {
            this.parent.notify(ee, r);
          }
          break;
        }
      if (!r.cancel) {
        this.addSortIcons();
      }
    }
  };
  s.prototype.getSortedColsIndexByField = function (e, t) {
    for (var i = t || this.sortSettings.columns, r = 0, n = i.length; r < n; r++)
      if (i[parseInt(r.toString(), 10)].field === e) return r;
    return -1;
  };
  s.prototype.getModuleName = function () {
    return 'sort';
  };
  s.prototype.initialEnd = function () {
    this.parent.off(Te, this.initialEnd);
    if (this.parent.getColumns().length && this.sortSettings.columns.length) {
      var e = this.parent;
      this.contentRefresh = false;
      this.isMultiSort = this.sortSettings.columns.length > 1;
      for (var t = 0, i = this.parent.sortSettings.columns.slice(); t < i.length; t++) {
        var r = i[t];
        if (this.sortedColumns.indexOf(i[t].field) > -1) {
          this.sortColumn(i[t].field, i[t].direction, true);
        }
      }
      this.isMultiSort = false;
      this.contentRefresh = true;
    }
  };
  s.prototype.addEventListener = function () {
    if (!this.parent.isDestroyed) {
      this.evtHandlers = [
        {
          event: _e,
          handler: this.setFullScreenDialog,
        },
        {
          event: Re,
          handler: this.renderResponsiveChangeAction,
        },
        {
          event: Te,
          handler: this.initialEnd,
        },
        {
          event: Kn,
          handler: this.onActionComplete,
        },
        {
          event: Ge,
          handler: this.onPropertyChanged,
        },
        {
          event: Ne,
          handler: this.clickHandler,
        },
        {
          event: We,
          handler: this.refreshSortIcons,
        },
        {
          event: be,
          handler: this.keyPressed,
        },
        {
          event: $n,
          handler: this.cancelBeginEvent,
        },
        {
          event: M,
          handler: this.destroy,
        },
      ];
      ce(this.parent, this.evtHandlers, true, this);
      R.add(document.body, 'click', this.excelFilterSortAction, this);
      R.add(document.body, 'touchend', this.excelFilterSortAction, this);
    }
  };
  s.prototype.removeEventListener = function () {
    if (!this.parent.isDestroyed) {
      ce(this.parent, this.evtHandlers, false);
      R.remove(document.body, 'click', this.excelFilterSortAction);
      R.remove(document.body, 'touchend', this.excelFilterSortAction);
    }
  };
  s.prototype.excelFilterSortAction = function (e) {
    var t = S(e.target, 'e-grid-popup');
    var i = this.parent.element.id + '_e-popup';
    if (t && t.id === i && S(e.target, 'e-excelfilter')) {
      this.excelFilterSortActionHandler(e);
    }
  };
  s.prototype.destroy = function () {
    this.isModelChanged = false;
    var e = this.parent.element;
    if (
      !(
        !this.parent.element ||
        (!this.parent.element.querySelector('.' + Oe) && !this.parent.element.querySelector('.' + pe))
      )
    ) {
      if (this.parent.element.querySelector('.e-gridpopup').getElementsByClassName('e-sortdirect').length) {
        this.parent.element.querySelector('.e-gridpopup').style.display = 'none';
      }
      if (!this.parent.refreshing && (this.parent.isDestroyed || !this.parent.allowSorting)) {
        this.clearSorting();
      }
      this.isModelChanged = true;
      this.removeEventListener();
    }
  };
  s.prototype.cancelBeginEvent = function (e) {
    if (e.requestType === 'sorting') {
      this.restoreSettings();
      this.refreshSortIcons();
      this.isMultiSort = true;
    }
  };
  s.prototype.clickHandler = function (e) {
    var t = this.parent;
    this.currentTarget = null;
    this.popUpClickHandler(e);
    var i = T(e.target, '.e-headercell');
    if (
      i &&
      !e.target.classList.contains('e-grptogglebtn') &&
      !i.classList.contains('e-resized') &&
      !e.target.classList.contains('e-rhandler') &&
      !e.target.classList.contains('e-columnmenu') &&
      !e.target.classList.contains('e-filtermenudiv') &&
      !S(e.target, 'e-stackedheadercell') &&
      !(
        this.parent.allowSelection &&
        this.parent.selectionSettings.allowColumnSelection &&
        e.target.classList.contains('e-headercell')
      )
    ) {
      var r = this.parent;
      var n = this.parent.getColumnByUid(i.querySelector('.e-headercelldiv').getAttribute('data-mappinguid'));
      if (n.type !== 'checkbox') {
        this.initiateSort(i, e, n);
        if (z.isDevice) {
          this.showPopUp(e);
        }
      }
    }
    if (i) {
      i.classList.remove('e-resized');
    }
    this.excelFilterSortActionHandler(e);
  };
  s.prototype.excelFilterSortActionHandler = function (e) {
    if (S(e.target, 'e-excel-ascending') || S(e.target, 'e-excel-descending')) {
      var t = T(e.target, '.e-filter-popup').getAttribute('data-uid');
      var i = u(S(e.target, 'e-excel-descending')) ? 'Ascending' : 'Descending';
      this.sortColumn(this.parent.getColumnByUid(t).field, i, false);
    }
  };
  s.prototype.keyPressed = function (e) {
    var t = e.target;
    if (
      !this.parent.isEdit &&
      (e.action === 'enter' || e.action === 'ctrlEnter' || e.action === 'shiftEnter') &&
      T(e.target, '.e-headercell')
    ) {
      var i = this.focus.getFocusedElement();
      if (u(i) || !i.classList.contains('e-headercell') || !i.querySelector('.e-headercelldiv')) return;
      var r = this.parent.getColumnByUid(i.querySelector('.e-headercelldiv').getAttribute('data-mappinguid'));
      this.initiateSort(i, e, r);
    }
  };
  s.prototype.initiateSort = function (e, t, i) {
    var r = this.parent;
    var n = i.field;
    this.currentTarget = t.target;
    var a = e.getElementsByClassName('e-ascending').length ? 'Descending' : 'Ascending';
    this.isMultiSort =
      t.ctrlKey || this.enableSortMultiTouch || (navigator.userAgent.indexOf('Mac OS') !== -1 && t.metaKey);
    t.shiftKey ||
    (this.sortSettings.allowUnsort &&
      e.getElementsByClassName('e-descending').length &&
      !(this.parent.groupSettings.columns.indexOf(i.field) > -1))
      ? this.removeSortColumn(i.field)
      : this.sortColumn(i.field, a, this.isMultiSort);
  };
  s.prototype.showPopUp = function (e) {
    var t = T(e.target, '.e-headercell');
    if (this.parent.allowMultiSorting && (!u(t) || this.parent.isContextMenuOpen())) {
      Xn(
        this.parent.element.querySelector('.e-gridpopup'),
        e,
        'e-sortdirect e-icons e-icon-sortdirect' + (this.sortedColumns.length > 1 ? ' e-spanclicked' : ''),
      );
    }
  };
  s.prototype.popUpClickHandler = function (e) {
    var t = e.target;
    T(e.target, '.e-headercell') || e.target.classList.contains(ie) || T(e.target, '.e-gridpopup')
      ? e.target.classList.contains('e-sortdirect') &&
        (e.target.classList.contains('e-spanclicked')
          ? (e.target.classList.remove('e-spanclicked'),
            (this.enableSortMultiTouch = false),
            (this.parent.element.querySelector('.e-gridpopup').style.display = 'none'))
          : (e.target.classList.add('e-spanclicked'), (this.enableSortMultiTouch = true)))
      : (this.parent.element.querySelector('.e-gridpopup').style.display = 'none');
  };
  s.prototype.addSortIcons = function () {
    for (
      var e = this.parent,
        t,
        i,
        r = this.sortSettings.columns,
        n = this.parent.getColumns().map(function (l) {
          return l.field;
        }),
        a = 0,
        o = r.length;
      a < o;
      a++
    ) {
      t = e.getColumnHeaderByField(r[parseInt(a.toString(), 10)].field);
      if (!(n.indexOf(r[parseInt(a.toString(), 10)].field) === -1 || u(t))) {
        this.aria.setSort(t, r[parseInt(a.toString(), 10)].direction.toLowerCase());
        if (r.length > 1) {
          t.querySelector('.e-headercelldiv').insertBefore(
            this.parent.createElement('span', {
              className: 'e-sortnumber',
              innerHTML: (a + 1).toString(),
            }),
            t.querySelector('.e-headertext'),
          );
        }
        i = t.querySelector('.e-sortfilterdiv');
        r[parseInt(a.toString(), 10)].direction === 'Ascending'
          ? G(i, ['e-ascending', 'e-icon-ascending'], [])
          : G(i, ['e-descending', 'e-icon-descending'], []);
      }
    }
  };
  s.prototype.removeSortIcons = function (e) {
    for (
      var t = this.parent,
        i,
        r = this.sortSettings.columns,
        n = this.parent.getColumns().map(function (l) {
          return l.field;
        }),
        a = e || 0,
        o = u(e) ? r.length : e + 1;
      a < o;
      a++
    ) {
      i = t.getColumnHeaderByField(r[parseInt(a.toString(), 10)].field);
      if (
        !(
          u(i) ||
          (t.allowGrouping &&
            t.groupSettings.columns.indexOf(r[parseInt(a.toString(), 10)].field) > -1 &&
            !i.querySelector('.e-sortfilterdiv'))
        ) &&
        n.indexOf(r[parseInt(a.toString(), 10)].field) !== -1
      ) {
        this.aria.setSort(i, 'none');
        G(
          i.querySelector('.e-sortfilterdiv'),
          [],
          ['e-descending', 'e-icon-descending', 'e-ascending', 'e-icon-ascending'],
        );
        if (i.querySelector('.e-sortnumber')) {
          i.querySelector('.e-headercelldiv').removeChild(i.querySelector('.e-sortnumber'));
        }
      }
    }
  };
  s.prototype.getSortColumnFromField = function (e) {
    for (var t = 0, i = this.sortSettings.columns.length; t < i; t++)
      if (this.sortSettings.columns[parseInt(t.toString(), 10)].field === e)
        return this.sortSettings.columns[parseInt(t.toString(), 10)];
    return false;
  };
  s.prototype.updateAriaAttr = function () {
    for (
      var e = this.parent.getColumns().map(function (a) {
          return a.field;
        }),
        t = 0,
        i = this.sortedColumns;
      t < i.length;
      t++
    ) {
      var r = i[t];
      if (e.indexOf(i[t]) !== -1) {
        var n = this.parent.getColumnHeaderByField(i[t]);
        this.aria.setSort(n, this.getSortColumnFromField(i[t]).direction);
      }
    }
  };
  s.prototype.refreshSortIcons = function () {
    this.removeSortIcons();
    this.isMultiSort = true;
    this.removeSortIcons();
    this.addSortIcons();
    this.isMultiSort = false;
    this.updateAriaAttr();
  };
  s.prototype.renderResponsiveChangeAction = function (e) {
    this.responsiveDialogRenderer.action = e.action;
  };
  s.prototype.showCustomSort = function (e) {
    this.responsiveDialogRenderer.isCustomDialog = e;
    this.responsiveDialogRenderer.showResponsiveDialog();
  };
  return s;
})();
var mo = (function () {
  function s(e) {
    this.pagerModule = e;
  }
  s.prototype.getModuleName = function () {
    return 'pagerdropdown';
  };
  s.prototype.render = function () {
    var e = this.pagerModule;
    this.pagerDropDownDiv = ve('div', { className: 'e-pagesizes' });
    var t = ve('div', { className: 'e-pagerdropdown' });
    var i = ve('div', { className: 'e-pagerconstant' });
    var r = ve('input', {
      attrs: {
        type: 'text',
        tabindex: '-1',
      },
    });
    this.pagerCons = ve('span', {
      className: 'e-constant',
      innerHTML: this.pagerModule.getLocalizedLabel('pagerDropDown'),
    });
    t.appendChild(r);
    i.appendChild(this.pagerCons);
    this.pagerDropDownDiv.appendChild(t);
    this.pagerDropDownDiv.appendChild(i);
    this.pagerModule.element.appendChild(this.pagerDropDownDiv);
    var n = this.pagerModule.pageSizes;
    var a = this.pagerModule.pageSizes.length
      ? this.convertValue(this.pagerModule.pageSizes)
      : [this.pagerModule.getLocalizedLabel('All'), '5', '10', '12', '20'];
    var o = this.pagerModule.pageSize;
    this.dropDownListObject = new wt({
      dataSource: a,
      value: this.pagerModule.pageSize.toString(),
      change: this.onChange.bind(this),
      placeholder: this.pagerModule.getLocalizedLabel('pagerDropDown'),
      cssClass: this.pagerModule.cssClass ? 'e-alldrop ' + this.pagerModule.cssClass : 'e-alldrop',
    });
    this.dropDownListObject.appendTo(r);
    if (this.pagerModule.pageSizes.length) {
      this.dropDownListObject.element.value = this.pagerModule.pageSize.toString();
    }
    e.pageSize = this.pagerModule.pageSize;
    e.dataBind();
    e.trigger('dropDownChanged', { pageSize: this.pagerModule.pageSize });
    this.addEventListener();
  };
  s.prototype.onChange = function (e) {
    this.dropDownListObject.value === this.pagerModule.getLocalizedLabel('All')
      ? ((this.pagerModule.pageSize = this.pagerModule.totalRecordsCount),
        (this.pagerModule.isAllPage = true),
        this.refresh(),
        (e.value = this.pagerModule.pageSize),
        document.getElementsByClassName('e-popup-open e-alldrop').length &&
          (document.getElementsByClassName('e-popup-open e-alldrop')[0].style.display = 'none'))
      : ((this.pagerModule.pageSize = parseInt(this.dropDownListObject.value, 10)),
        (this.pagerModule.isAllPage = false),
        this.pagerCons.innerHTML !== this.pagerModule.getLocalizedLabel('pagerDropDown') && this.refresh());
    this.pagerModule.dataBind();
    if (!this.pagerModule.isCancel) {
      this.pagerModule.trigger('dropDownChanged', {
        pageSize:
          this.pagerModule.isAllPage ||
          (this.pagerModule.isAllPage === void 0 &&
            this.dropDownListObject.value === this.pagerModule.getLocalizedLabel('All'))
            ? this.pagerModule.totalRecordsCount
            : parseInt(this.dropDownListObject.value, 10),
      });
    }
  };
  s.prototype.refresh = function () {
    if (this.pagerCons) {
      this.isPageSizeAll(this.pagerModule.pageSize)
        ? ((this.pagerCons.innerHTML = this.pagerModule.getLocalizedLabel('pagerAllDropDown')),
          this.pagerCons.parentElement.classList.add('e-page-all'))
        : ((this.pagerCons.innerHTML = this.pagerModule.getLocalizedLabel('pagerDropDown')),
          this.pagerCons.parentElement.classList.remove('e-page-all'));
      this.pagerDropDownDiv.classList.remove('e-hide');
    }
  };
  s.prototype.beforeValueChange = function (e) {
    if (typeof e.newProp.value == 'number') {
      var t = e.newProp.value.toString();
      e.newProp.value = t;
    }
  };
  s.prototype.convertValue = function (e) {
    for (var t = e, i = 0; i < t.length; i++)
      t[parseInt(i.toString(), 10)] = parseInt(t[parseInt(i.toString(), 10)], 10)
        ? t[parseInt(i.toString(), 10)].toString()
        : this.pagerModule.getLocalizedLabel(t[parseInt(i.toString(), 10)]) !== ''
          ? this.pagerModule.getLocalizedLabel(t[parseInt(i.toString(), 10)])
          : t[parseInt(i.toString(), 10)];
    return t;
  };
  s.prototype.isPageSizeAll = function (e) {
    var t = typeof e == 'string' && e !== this.pagerModule.getLocalizedLabel('All') ? parseInt(e, 10) : e;
    return t === this.pagerModule.totalRecordsCount || e === this.pagerModule.getLocalizedLabel('All');
  };
  s.prototype.setDropDownValue = function (e, t) {
    if (this.dropDownListObject) {
      var i = this.pagerModule.isAllPage;
      this.pagerModule.isAllPage = this.isPageSizeAll(t);
      if (
        this.pagerModule.isAllPage &&
        typeof this.pagerModule.pageSizes == 'object' &&
        this.pagerModule.pageSizes.indexOf('All') === -1
      ) {
        this.pagerModule.isAllPage = false;
      }
      this.pagerModule.checkAll = !!(this.pagerModule.isAllPage && this.pagerModule.isAllPage);
      this.dropDownListObject['' + e] = this.pagerModule.isAllPage ? this.pagerModule.getLocalizedLabel('All') : t;
    }
  };
  s.prototype.addEventListener = function () {
    this.dropDownListObject.on('beforeValueChange', this.beforeValueChange, this);
  };
  s.prototype.removeEventListener = function () {
    this.dropDownListObject.off('beforeValueChange', this.beforeValueChange);
  };
  s.prototype.destroy = function (e) {
    if (this.dropDownListObject && !this.dropDownListObject.isDestroyed) {
      this.removeEventListener();
      this.dropDownListObject.destroy();
      if (this.pagerDropDownDiv && this.pagerDropDownDiv.parentNode) {
        N(this.pagerDropDownDiv);
      }
    }
  };
  return s;
})();
var vo = (function () {
  function s(e) {
    this.pagerModule = e;
  }
  s.prototype.getModuleName = function () {
    return 'externalMessage';
  };
  s.prototype.render = function () {
    this.element = ve('div', {
      className: 'e-pagerexternalmsg',
      attrs: { 'aria-label': this.pagerModule.getLocalizedLabel('ExternalMsg') },
    });
    this.pagerModule.element.appendChild(this.element);
    this.refresh();
  };
  s.prototype.refresh = function () {
    this.pagerModule.externalMessage && this.pagerModule.externalMessage.toString().length
      ? (this.showMessage(), (this.element.innerHTML = this.pagerModule.externalMessage))
      : this.hideMessage();
  };
  s.prototype.hideMessage = function () {
    if (!u(this.element)) {
      this.element.style.display = 'none';
    }
  };
  s.prototype.showMessage = function () {
    this.element.style.display = '';
  };
  s.prototype.destroy = function () {
    if (this.element && this.element.parentElement) {
      N(this.element);
    }
  };
  return s;
})();
var yo = (function () {
  function s(e, t) {
    this.isInitialRender = true;
    this.isCancel = false;
    Ni.Inject(vo, mo);
    this.parent = e;
    this.pageSettings = t;
    this.addEventListener();
  }
  s.prototype.getModuleName = function () {
    return 'pager';
  };
  s.prototype.render = function () {
    var e = this.parent;
    this.pagerDestroy();
    if (!u(this.parent.pagerTemplate)) {
      this.pageSettings.template = this.parent.pagerTemplate;
      this.parent.pageTemplateChange = true;
    }
    this.element = this.parent.createElement('div', { className: 'e-gridpager' });
    var t = Jn(
      {},
      E({}, Zn(this.pageSettings)),
      {
        click: this.clickHandler.bind(this),
        dropDownChanged: this.onSelect.bind(this),
        enableRtl: this.parent.enableRtl,
        locale: this.parent.locale,
        created: this.addAriaAttr.bind(this),
      },
      ['parentObj', 'propName'],
    );
    t.cssClass = this.parent.cssClass ? this.parent.cssClass : '';
    this.pagerObj = new Ni(t, void 0, this.parent);
    this.pagerObj.root = this.parent.root ? this.parent.root : this.parent;
    this.pagerObj.hasParent = true;
    this.pagerObj.on(Pi, this.renderReactPagerTemplate, this);
    this.pagerObj.allowServerDataBinding = false;
  };
  s.prototype.onSelect = function (e) {
    this.pageSettings.pageSize = e.pageSize;
    if (!this.isInitialLoad) {
      this.pageSettings.currentPage = 1;
    }
  };
  s.prototype.addAriaAttr = function () {
    if (!this.pageSettings.template) {
      if (this.parent.getContentTable()) {
        this.element.setAttribute('aria-controls', this.parent.getContentTable().id);
      }
      for (
        var e = this.parent.createElement('div', { className: 'e-numericcontainer' }),
          t = this.element.querySelector('.e-pagercontainer'),
          i = document.createDocumentFragment(),
          r = this.element.querySelector('.e-numericcontainer'),
          n = r.querySelectorAll('a'),
          a = 0;
        a < n.length;
        a++
      ) {
        var o = this.parent.createElement('div');
        o.appendChild(n[parseInt(a.toString(), 10)]);
        i.appendChild(o);
      }
      e.appendChild(i);
      t.replaceChild(e, r);
    }
  };
  s.prototype.dataReady = function (e) {
    this.updateModel(e);
  };
  s.prototype.refresh = function () {
    this.pagerObj.refresh();
  };
  s.prototype.goToPage = function (e) {
    this.pagerObj.goToPage(e);
  };
  s.prototype.setPageSize = function (e) {
    this.pagerObj.setPageSize(e);
  };
  s.prototype.updateModel = function (e) {
    this.parent.pageSettings.totalRecordsCount = e.count;
    var t = (e.action === 'add' && e.requestType === 'save') || e.requestType === 'batchsave';
    var i = this.parent.filterModule && this.parent.filterModule.isFilterCleared;
    var r =
      (e.searchString === '' && e.requestType === 'searching') ||
      (e.requestType === 'filtering' && (e.action === 'clearFilter' || e.action === 'clear-filter')) ||
      i;
    if (i) {
      this.parent.filterModule.isFilterCleared = false;
    }
    if (this.pagerObj.isAllPage && !t && (!r || (r && this.pagerObj.checkAll))) {
      this.parent.pageSettings.pageSize = this.parent.pageSettings.totalRecordsCount;
    }
    if (t && this.pagerObj.isAllPage && e.count === this.pageSettings.pageSize) {
      this.pagerObj.setProperties({ pageSize: e.count }, true);
    }
    this.parent.dataBind();
  };
  s.prototype.onActionComplete = function (e) {
    this.parent.trigger(
      B,
      E(e, {
        currentPage: this.parent.pageSettings.currentPage,
        requestType: 'paging',
        type: B,
      }),
    );
  };
  s.prototype.onPropertyChanged = function (e) {
    if (e.module === this.getModuleName()) {
      for (var t = e.properties, i = 0, r = Object.keys(t); i < r.length; i++) {
        var n = r[i];
        this.pagerObj['' + r[i]] = t['' + r[i]];
      }
      this.pagerObj.dataBind();
    }
  };
  s.prototype.clickHandler = function (e) {
    var t = this.parent;
    if (this.isForceCancel || (qe(t) && !t.prevPageMoving && !this.isCancel)) {
      this.isForceCancel
        ? (this.isForceCancel = false)
        : (!u(e.newProp) && !u(e.newProp.pageSize)
            ? (t.notify(ye, {
                instance: this,
                handler: this.setPageSize,
                arg1: e.newProp.pageSize,
              }),
              this.pagerObj.setProperties({ pageSize: e.oldProp.pageSize }, true),
              this.parent.setProperties({ pageSettings: { pageSize: e.oldProp.pageSize } }, true),
              this.pagerObj.setProperties(
                {
                  currentPage:
                    t.pageSettings.currentPage === this.pagerObj.currentPage
                      ? this.pagerObj.previousPageNo
                      : t.pageSettings.currentPage,
                },
                true,
              ))
            : e.currentPage &&
              (t.notify(ye, {
                instance: this,
                handler: this.goToPage,
                arg1: e.currentPage,
              }),
              (this.pagerObj.currentPage =
                t.pageSettings.currentPage === this.pagerObj.currentPage
                  ? this.pagerObj.previousPageNo
                  : t.pageSettings.currentPage)),
          (this.isForceCancel = true),
          this.pagerObj.dataBind());
      e.cancel = true;
      return;
    }
    t.pageSettings.pageSize = this.pagerObj.pageSize;
    t.prevPageMoving = false;
    var i = this.pageSettings.currentPage;
    var r = {
      cancel: false,
      requestType: 'paging',
      previousPage: this.pageSettings.currentPage,
      currentPage: e.currentPage,
      pageSize: t.pageSettings.pageSize,
      type: _,
    };
    if (!this.isCancel) {
      this.pageSettings.currentPage = e.currentPage;
      this.parent.notify(ee, r);
      t.pageRequireRefresh = false;
    }
    if (r.cancel) {
      e.cancel = true;
      this.parent.setProperties({ pageSettings: { currentPage: this.pageSettings.currentPage } }, true);
      this.pagerObj.setProperties({ currentPage: this.pageSettings.currentPage }, true);
      this.isCancel = true;
      return;
    }
    this.isCancel = false;
    this.parent.requestTypeAction = 'paging';
  };
  s.prototype.keyPressHandler = function (e) {
    if (e.action in qr) {
      e.preventDefault();
      var t = this.element.querySelector(qr[e.action]);
      if (!t.classList.contains('e-nextprevitemdisabled')) {
        t.click();
      }
    }
  };
  s.prototype.updateExternalMessage = function (e) {
    if (!this.pagerObj.enableExternalMessage) {
      this.pagerObj.enableExternalMessage = true;
      this.pagerObj.dataBind();
    }
    this.pagerObj.externalMessage = e;
    this.pagerObj.dataBind();
  };
  s.prototype.appendToElement = function () {
    this.isInitialLoad = true;
    this.parent.element.appendChild(this.element);
    this.parent.setGridPager(this.element);
    this.pagerObj.isReact = this.parent.isReact;
    this.pagerObj.isVue =
      this.parent.isVue ||
      (this.parent.parentDetails &&
        this.parent.parentDetails.parentInstObj &&
        this.parent.parentDetails.parentInstObj.isVue);
    this.pagerObj.appendTo(this.element);
    this.isInitialLoad = false;
  };
  s.prototype.enableAfterRender = function (e) {
    if (e.module === this.getModuleName() && e.enable) {
      this.render();
      this.appendToElement();
      if (this.isReactTemplate()) {
        this.pagerObj.updateTotalPages();
        this.created();
      }
    }
  };
  s.prototype.addEventListener = function () {
    this.handlers = {
      load: this.render,
      end: this.appendToElement,
      ready: this.dataReady,
      complete: this.onActionComplete,
      updateLayout: this.enableAfterRender,
      inboundChange: this.onPropertyChanged,
      keyPress: this.keyPressHandler,
      created: this.created,
    };
    if (!this.parent.isDestroyed) {
      if (this.parent.isReact || this.parent.isVue) {
        this.parent.addEventListener(Lt, this.handlers.created.bind(this));
      }
      this.evtHandlers = [
        {
          event: di,
          handler: this.handlers.load,
        },
        {
          event: Ce,
          handler: this.handlers.end,
        },
        {
          event: et,
          handler: this.handlers.ready,
        },
        {
          event: Yn,
          handler: this.handlers.complete,
        },
        {
          event: Se,
          handler: this.handlers.updateLayout,
        },
        {
          event: Ge,
          handler: this.handlers.inboundChange,
        },
        {
          event: be,
          handler: this.handlers.keyPress,
        },
        {
          event: M,
          handler: this.destroy,
        },
      ];
      ce(this.parent, this.evtHandlers, true, this);
    }
  };
  s.prototype.created = function () {
    if (this.isInitialRender && this.isReactTemplate()) {
      this.isInitialRender = false;
      this.renderReactPagerTemplate();
    }
  };
  s.prototype.isReactTemplate = function () {
    return (
      (this.parent.isReact || this.parent.isVue) && this.pagerObj.template && typeof this.pagerObj.template != 'string'
    );
  };
  s.prototype.renderReactPagerTemplate = function () {
    if (!this.isInitialRender && this.isReactTemplate()) {
      var e = void 0;
      this.parent.destroyTemplate(['pagerTemplate']);
      this.element.classList.add('e-pagertemplate');
      this.pagerObj.compile(this.pagerObj.template);
      var t = this.parent.pageSettings;
      var i = {
        currentPage: this.parent.pageSettings.currentPage,
        pageSize: this.parent.pageSettings.pageSize,
        pageCount: this.parent.pageSettings.pageCount,
        totalRecordsCount: this.parent.pageSettings.totalRecordsCount,
        totalPages: this.pagerObj.totalPages,
      };
      var r = this.parent.id + '_pagertemplate';
      this.parent.isReact
        ? (this.pagerObj.templateFn(i, this.parent, 'pagerTemplate', r, null, null, this.pagerObj.element),
          this.parent.renderTemplates())
        : ((e = this.pagerObj.templateFn(i, this.parent, 'pagerTemplate')), ae(this.pagerObj.element, e));
    }
  };
  s.prototype.removeEventListener = function () {
    if (!this.parent.isDestroyed) {
      if (this.parent.isReact || this.parent.isVue) {
        this.parent.removeEventListener(Lt, this.handlers.created);
      }
      this.parent.off(Pi, this.renderReactPagerTemplate);
      ce(this.parent, this.evtHandlers, false);
    }
  };
  s.prototype.destroy = function () {
    this.removeEventListener();
    if (this.isReactTemplate()) {
      this.parent.destroyTemplate(['pagerTemplate']);
    }
    this.pagerObj.destroy();
  };
  s.prototype.pagerDestroy = function () {
    if (this.pagerObj && !this.pagerObj.isDestroyed) {
      this.pagerObj.destroy();
      N(this.element);
    }
  };
  return s;
})();
var qr = {
  pageUp: '.e-prev',
  pageDown: '.e-next',
  ctrlAltPageDown: '.e-last',
  ctrlAltPageUp: '.e-first',
  altPageUp: '.e-pp',
  altPageDown: '.e-np',
};
var So = (function () {
  var s = function (e, t) {
    s =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (i, r) {
          i.__proto__ = r;
        }) ||
      function (i, r) {
        for (var n in r)
          if (r.hasOwnProperty(n)) {
            i[n] = r[n];
          }
      };
    return s(e, t);
  };
  return function (e, t) {
    s(e, t);
    function i() {
      this.constructor = e;
    }
    e.prototype = t === null ? Object.create(t) : ((i.prototype = t.prototype), new i());
  };
})();
var wo = (function (s) {
  So(e, s);
  function e() {
    var t = (s !== null && s()) || this;
    t.element = t.parent.createElement('TH', {
      className: 'e-filterbarcell',
      attrs: { role: 'columnheader' },
    });
    return t;
  }
  e.prototype.getGui = function () {
    return this.parent.createElement('div');
  };
  e.prototype.render = function (t, i) {
    var r = this.parent.element.querySelector('.e-filterbar');
    var n = this.element.cloneNode();
    var a = this.getGui();
    var o;
    var l = t.column;
    r.appendChild(n);
    n.setAttribute('data-mappinguid', t.column.uid);
    if (t.column.filterTemplate) {
      var h = {};
      if (i) {
        h[t.column.field] = i[t.column.field];
      }
      var d = 'column';
      h.column = t.column;
      if (t.column.visible) {
        if (this.parent.filterSettings.type === 'FilterBar') {
          n.classList.add('e-fltrtemp');
        }
        var p =
          this.parent.isReact &&
          typeof t.column.filterTemplate != 'string' &&
          !(t.column.filterTemplate.prototype && t.column.filterTemplate.prototype.CSPTemplate);
        var c =
          this.parent.parentDetails &&
          this.parent.parentDetails.parentInstObj &&
          this.parent.parentDetails.parentInstObj.isReact;
        var f = this.parent.element.id + t.column.uid + 'filterTemplate';
        if (p || c) {
          t.column.getFilterTemplate()(h, this.parent, 'filterTemplate', f, null, null, n);
          this.parent.renderTemplates();
        } else {
          var g = t.column.getFilterTemplate()(h, this.parent, 'filterTemplate', f, null, null, null, this.parent.root);
          ae(n, g);
        }
      } else n.classList.add('e-hide');
    } else if (t.column.type !== 'checkbox') {
      if ((u(t.column.allowFiltering) || t.column.allowFiltering) && !u(t.column.filterBarTemplate)) {
        n.classList.add('e-fltrtemp');
        Ft(a, { class: 'e-fltrtempdiv' });
        if (u(t.column.filterBarTemplate.create)) {
          o = this.parent.createElement('input', {
            id: t.column.field + '_filterBarcell',
            className: 'e-filterUi_input e-filtertext e-fltrTemp',
            attrs: {
              type: 'search',
              title: t.column.headerText,
            },
          });
          a.appendChild(o);
        } else {
          var m = {
            column: t.column,
            node: Element,
          };
          var y = t.column.filterBarTemplate.create;
          if (typeof y == 'string') {
            y = re(y, window);
          }
          o = y(m);
          if (typeof o == 'string') {
            var v = this.parent.createElement('div');
            v.innerHTML = o;
            o = v.firstChild;
          }
          Ft(a, {
            class: 'e-filterUi_input e-filtertext e-fltrTemp',
            title: t.column.headerText,
            id: t.column.field + '_filterBarcell',
          });
          a.appendChild(o);
        }
      } else {
        Ft(a, { class: 'e-filterdiv e-fltrinputdiv' });
        o = this.parent.createElement('input', {
          id: t.column.field + '_filterBarcell',
          className: 'e-filtertext',
          attrs: {
            type: 'search',
            title: t.column.headerText + t.attributes.title,
            value: i[t.column.field] ? i[t.column.field] : '',
          },
        });
        a.appendChild(o);
        var m = {
          element: o,
          floatLabelType: 'Never',
          properties: {
            enableRtl: this.parent.enableRtl,
            showClearButton: true,
            cssClass: this.parent.cssClass,
          },
        };
        this.parent.filterModule.inputList.push(m);
        pi.createInput(m, this.parent.createElement);
      }
      if (t.column.allowFiltering === false || t.column.field === '' || u(t.column.field)) {
        o.setAttribute('disabled', 'true');
        o.classList.add('e-disable');
      }
      var b = a.querySelector('.e-clear-icon');
      if (b) {
        b.setAttribute('title', this.parent.localeObj.getConstant('ClearButton'));
      }
      if (!t.column.visible) {
        n.classList.add('e-hide');
      }
      this.appendHtml(n, a);
      if (
        this.parent.filterSettings.showFilterBarOperator &&
        this.parent.filterSettings.type === 'FilterBar' &&
        !this.parent.isPrinting &&
        u(t.column.filterTemplate) &&
        u(t.column.filterBarTemplate)
      ) {
        this.operatorIconRender(a, t.column, t);
      }
      if ((u(t.column.allowFiltering) || t.column.allowFiltering) && !u(t.column.filterBarTemplate)) {
        var w = t.column.filterBarTemplate.write;
        var m = {
          element: o,
          column: t.column,
        };
        if (typeof w == 'string') {
          w = re(w, window);
        }
        w(m);
      }
    } else if (!t.column.visible) {
      n.classList.add('e-hide');
    }
    if (this.parent.isFrozenGrid()) {
      Ti(this.parent, t.column, n);
    }
    return n;
  };
  e.prototype.appendHtml = function (t, i) {
    t.appendChild(i);
    return t;
  };
  e.prototype.operatorIconRender = function (t, i, r) {
    var n = this.parent;
    var a;
    var o = this.parent.createElement('input', {
      className: ' e-filterbaroperator e-icons e-icon-filter',
      id: r.column.uid,
    });
    t.querySelector('span').appendChild(o);
    if (i.filter && i.filter.operator) a = i.filter.operator;
    else if (this.parent.filterSettings.columns.length)
      for (var l = 0, h = this.parent.filterSettings.columns; l < h.length; l++) {
        var d = h[parseInt(l.toString(), 10)];
        if (h[parseInt(l.toString(), 10)].field === i.field) {
          a = h[parseInt(l.toString(), 10)].operator;
          break;
        } else a = 'equal';
      }
    else a = 'equal';
    if (!u(this.parent.filterModule.operators[i.field])) {
      a = this.parent.filterModule.operators[i.field];
    }
    this.dropOptr = new wt({
      fields: {
        text: 'text',
        value: 'value',
      },
      popupHeight: 'auto',
      value: a,
      width: '0px',
      enabled: i.allowFiltering,
      popupWidth: 'auto',
      enableRtl: this.parent.enableRtl,
      change: this.internalEvent.bind(this),
      beforeOpen: function () {
        var c = this.parent.filterModule.customOperators;
        this.dataSource =
          this.parent.filterModule.customOperators[this.parent.getColumnByUid(this.element.id).type + 'Operator'];
        for (var f = 0; f < this.dataSource.length; f++)
          if (
            i.filter &&
            i.filter.operator &&
            u(this.parent.filterModule.operators[i.field]) &&
            this.dataSource[parseInt(f.toString(), 10)].value === i.filter.operator
          ) {
            this.value = i.filter.operator;
          }
      },
      cssClass: this.parent.cssClass ? 'e-popup-flbar ' + this.parent.cssClass : 'e-popup-flbar',
    });
    this.dropOptr.appendTo(o);
    var p = T(this.dropOptr.element, 'span');
    p.classList.add('e-filterbardropdown');
    p.removeAttribute('tabindex');
  };
  e.prototype.internalEvent = function (t) {
    var i = this.parent;
    var r = this.parent.getColumnByUid(t.element.getAttribute('id'));
    t.column = r;
    this.parent.filterModule.operators[r.field] = t.value;
    var n = t.value;
    if (this.parent.filterModule && this.parent.filterModule.filterSettings.showFilterBarOperator) {
      var a = document.getElementById(r.field + '_filterBarcell');
      t.value === 'isempty' || t.value === 'isnotempty' || t.value === 'isnotnull' || t.value === 'isnull'
        ? (a.setAttribute('readOnly', 'true'),
          this.parent.filterModule.filterByColumn(
            r.field,
            t.value,
            null,
            this.parent.filterModule.predicate,
            this.parent.filterModule.filterSettings.enableCaseSensitivity,
            this.parent.filterModule.ignoreAccent,
            r.isForeignColumn(),
          ))
        : a &&
          a.readOnly &&
          (a.removeAttribute('readOnly'), this.parent.filterModule.removeFilteredColsByField(r.field));
    }
    this.parent.notify(Qn, t);
  };
  return e;
})(Oi);
var bo = (function () {
  function s(e, t, i, r) {
    this.ddOpen = this.dropDownOpen.bind(this);
    this.parent = e;
    this.serviceLocator = i;
    this.filterSettings = r;
    this.customFilterOperators = t;
    if (this.parent) {
      this.parent.on(fe, this.destroyDropDownList, this);
      this.parent.on(M, this.destroyDropDownList, this);
    }
  }
  s.prototype.renderOperatorUI = function (e, t, i, r, n) {
    var a = this;
    this.dialogObj = r;
    var o = i.type + 'Operator';
    this.optrData = this.customOptr = u(n)
      ? !u(this.parent.filterSettings.operators) && !u(this.parent.filterSettings.operators['' + o])
        ? this.parent.filterSettings.operators['' + o]
        : this.customFilterOperators['' + o]
      : n;
    var l = this.customOptr;
    var h = this.dropSelectedVal(i, o);
    var d = this.parent.createElement('div', { className: 'e-flm_optrdiv' });
    e.appendChild(d);
    var p = this.parent.createElement('input', { id: i.uid + '-floptr' });
    d.appendChild(p);
    this.dropOptr = new wt({
      dataSource: this.customOptr,
      fields: {
        text: 'text',
        value: 'value',
      },
      cssClass: this.parent.cssClass ? 'e-popup-flmenu ' + this.parent.cssClass : 'e-popup-flmenu',
      enableRtl: this.parent.enableRtl,
      text: h,
      change: function () {
        var c = document.querySelector('.e-flmenu-valuediv').querySelector('input');
        a.dropOptr.value === 'isempty' ||
        a.dropOptr.value === 'isnotempty' ||
        a.dropOptr.value === 'isnotnull' ||
        a.dropOptr.value === 'isnull'
          ? u(c.ej2_instances)
            ? c.setAttribute('disabled', 'true')
            : (c.ej2_instances[0].enabled = false)
          : u(c.getAttribute('disabled')) ||
            (u(c.ej2_instances) ? c.removeAttribute('disabled') : (c.ej2_instances[0].enabled = true));
        mt(a.dropOptr.value, i.uid, i, i.type, r, a.dropOptr.previousValue);
      },
    });
    this.dropOptr.addEventListener(oe, this.ddOpen);
    this.dropOptr.appendTo('#' + i.uid + '-floptr');
  };
  s.prototype.renderResponsiveDropDownList = function (e) {
    e.popup.element.style.width = '100%';
  };
  s.prototype.dropDownOpen = function (e) {
    e.popup.element.style.zIndex = (this.dialogObj.zIndex + 1).toString();
    if (this.parent.enableAdaptiveUI) {
      this.renderResponsiveDropDownList(e);
    }
  };
  s.prototype.dropSelectedVal = function (e, t) {
    for (var i = '', r = this.parent.filterSettings.columns, n = 0, a = r; n < a.length; n++) {
      var o = a[n];
      if (e.field === a[n].field || (e.isForeignColumn() && e.foreignKeyValue === a[n].field)) {
        var l = new H(this.optrData).executeLocal(new ue().where('value', 'equal', a[n].operator));
        i = u(l[0]) ? '' : l[0].text;
      }
    }
    if (i === '')
      if (e.filter.operator)
        for (var h = Object.keys(this.optrData).length, d = 0; d < h; d++)
          if (this.optrData[parseInt(d.toString(), 10)].value === e.filter.operator) {
            i = this.optrData[parseInt(d.toString(), 10)].text;
          } else i = this.optrData[0].text;
    return i;
  };
  s.prototype.getFlOperator = function () {
    return this.dropOptr.value;
  };
  s.prototype.destroyDropDownList = function () {
    if (!this.dropOptr.isDestroyed) {
      this.dropOptr.removeEventListener(oe, this.ddOpen);
      this.dropOptr.destroy();
      this.parent.off(fe, this.destroyDropDownList);
      this.parent.off(M, this.destroyDropDownList);
    }
  };
  return s;
})();
Ke.Inject(zi);
var Co = (function () {
  function s(e, t, i) {
    this.parent = e;
    this.serLocator = t;
    this.filterSettings = i;
    if (this.parent) {
      this.parent.on(fe, this.destroy, this);
      this.parent.on(M, this.destroy, this);
    }
  }
  s.prototype.create = function (e) {
    this.instance = this.parent.createElement('input', {
      className: 'e-flmenu-input',
      id: 'strui-' + e.column.uid,
    });
    e.target.appendChild(this.instance);
    this.multiSelectCheckBoxInstance = this.parent.createElement('input', {
      className: 'multiselect-input',
      id: 'multiselectstrui-' + e.column.uid,
    });
    e.target.appendChild(this.multiSelectCheckBoxInstance);
    this.dialogObj = e.dialogObj;
    this.processDataOperation(e);
    this.createMultiSelectDropDown(e);
    mt(
      e.getOptrInstance.dropOptr.value,
      e.column.uid,
      e.column,
      e.column.type,
      e.dialogObj,
      e.getOptrInstance.dropOptr.previousValue,
    );
  };
  s.prototype.processDataOperation = function (e) {
    var t = this;
    if (e.column.isForeignColumn()) {
      this.parent
        .getDataModule()
        .dataManager.executeQuery(this.parent.getDataModule().generateQuery(true))
        .then(function (i) {
          t.getAutoCompleteOptions(e, i);
          mt(
            e.getOptrInstance.dropOptr.value,
            e.column.uid,
            e.column,
            e.column.type,
            e.dialogObj,
            e.getOptrInstance.dropOptr.previousValue,
          );
        });
      return;
    }
    this.getAutoCompleteOptions(e);
  };
  s.prototype.getAutoCompleteOptions = function (e, t) {
    var i = e.column.isForeignColumn();
    var r;
    if (i) {
      for (var n = Bi.getDistinct(t.result, e.column.field).records || [], a = void 0, o = 0; o < n.length; o++)
        a
          ? (a = a.or(
              e.column.field,
              'contains',
              n[parseInt(o.toString(), 10)][e.column.field],
              this.parent.filterSettings.enableCaseSensitivity,
              this.parent.filterSettings.ignoreAccent,
            ))
          : (a = new tn(
              e.column.field,
              'contains',
              n[parseInt(o.toString(), 10)][e.column.field],
              this.parent.filterSettings.enableCaseSensitivity,
              this.parent.filterSettings.ignoreAccent,
            ));
      r = new ue().where(a);
      r.params = this.parent.query.params;
    }
    var l = i ? e.column.dataSource : this.parent.dataSource;
    var h = { value: i ? e.column.foreignKeyValue : e.column.field };
    var d = new es(
      E(
        {
          dataSource: l instanceof H ? l : new H(l),
          fields: h,
          locale: this.parent.locale,
          enableRtl: this.parent.enableRtl,
          query: i ? r : this.parent.getDataModule().generateQuery(true, true),
          sortOrder: 'Ascending',
          cssClass: this.parent.cssClass ? 'e-popup-flmenu ' + this.parent.cssClass : 'e-popup-flmenu',
          autofill: true,
          placeholder: e.localizeText.getConstant('EnterValue'),
          actionBegin: function () {
            if (
              this.query.queries.length &&
              this.query.queries[0].fn === 'onWhere' &&
              this.query.queries[0].e &&
              this.query.queries[0].e.predicates
            ) {
              for (var g = 0; g < this.query.queries[0].e.predicates.length; g++)
                if (this.properties.fields.value === this.query.queries[0].e.predicates['' + g].field) {
                  this.query.queries[0].e.predicates.splice(g, 1);
                  g = g - 1;
                }
              if (!this.query.queries[0].e.predicates.length) {
                this.query.queries.splice(0, 1);
              }
            }
          },
        },
        e.column.filter.params,
      ),
    );
    this.acFocus = this.focus(d, e);
    this.acComplete = this.actionComplete(d);
    this.acOpen = this.openPopup.bind(this);
    d.addEventListener(Hi, this.acFocus);
    d.addEventListener(oe, this.acOpen);
    d.addEventListener(B, this.acComplete);
    if (l && 'result' in l) {
      var p = this.parent.getQuery ? this.parent.getQuery().clone() : new ue();
      var c = rn({ requestType: 'stringfilterrequest' }, p);
      this.parent.trigger(nn, c.state);
      var f = c.deffered;
      c.deffered.promise.then(function (g) {
        d.dataSource = new H(g);
      });
    }
    this.actObj = d;
    this.actObj.appendTo(this.instance);
    if (i) {
      this.parent.filterModule.filterModule.afterRenderFilterUI();
    }
  };
  s.prototype.write = function (e) {
    var t = this.parent.filterModule.filterModule.getOperatorDropdown();
    var i = this.getAutoCompleteInstance(e.column.uid);
    var r = this.getMultiSelectInstance(e.column.uid);
    t.value === 'in' || t.value === 'notin'
      ? (r.value = Array.isArray(e.filteredValue) ? e.filteredValue : [])
      : e.filteredValue !== '' && !u(e.filteredValue) && !Array.isArray(e.filteredValue) && (i.value = e.filteredValue);
  };
  s.prototype.read = function (e, t, i, r) {
    if (i === 'in' || i === 'notin') {
      var n = this.getMultiSelectInstance(t.uid).value;
      r.filterByColumn(
        t.field,
        i,
        this.getMultiSelectInstance(t.uid).value,
        'and',
        this.parent.filterSettings.enableCaseSensitivity,
      );
    } else {
      var a = this.getAutoCompleteInstance(t.uid);
      var n = a.value;
      if (z.isDevice) {
        a.hidePopup();
        a.focusOut();
      }
      if (u(n) || n === '') {
        n = null;
      }
      r.filterByColumn(t.field, i, n, 'and', this.parent.filterSettings.enableCaseSensitivity);
    }
  };
  s.prototype.getAutoCompleteInstance = function (e) {
    return document.querySelector('#strui-' + e).ej2_instances[0];
  };
  s.prototype.getMultiSelectInstance = function (e) {
    return document.querySelector('#multiselectstrui-' + e).ej2_instances[0];
  };
  s.prototype.createMultiSelectDropDown = function (e) {
    var t = e.column.isForeignColumn();
    var i = t ? e.column.dataSource : this.parent.dataSource;
    var r = t ? e.column.foreignKeyValue : e.column.field;
    this.multiSelectObj = new Ke(
      E(
        {
          dataSource: i instanceof H ? i : new H(i),
          fields: {
            text: r,
            value: r,
          },
          mode: 'CheckBox',
          showDropDownIcon: true,
          popupHeight: '300px',
          showSelectAll: true,
          query: new ue().select(r),
          cssClass: this.parent.cssClass ? 'e-multiselect-flmenu ' + this.parent.cssClass : 'e-multiselect-flmenu',
          locale: this.parent.locale,
          enableRtl: this.parent.enableRtl,
        },
        e.column.filter.params,
      ),
    );
    this.dialogObj = e.dialogObj;
    this.dropdownOpen = this.openPopup.bind(this);
    this.dropdownComplete = this.actionCompleteMultiCheckBox(r);
    this.multiSelectObj.addEventListener(oe, this.dropdownOpen);
    this.multiSelectObj.addEventListener(B, this.dropdownComplete);
    this.multiSelectObj.appendTo(this.multiSelectCheckBoxInstance);
  };
  s.prototype.openPopup = function (e) {
    Ai(e, this.dialogObj);
  };
  s.prototype.focus = function (e, t) {
    return function () {
      e.filterType = t.getOptrInstance.getFlOperator();
    };
  };
  s.prototype.actionComplete = function (e) {
    return function (t) {
      t.result = t.result.filter(function (i, r, n) {
        return (
          n
            .map(function (a) {
              return re(e.fields.value, a);
            })
            .indexOf(re(e.fields.value, i)) === r
        );
      });
    };
  };
  s.prototype.actionCompleteMultiCheckBox = function (e) {
    return function (t) {
      t.result = le.distinct(t.result, e, true);
    };
  };
  s.prototype.destroy = function () {
    this.parent.off(fe, this.destroy);
    this.parent.off(M, this.destroy);
    if (this.actObj && !this.actObj.isDestroyed) {
      this.actObj.removeEventListener(Hi, this.acFocus);
      this.actObj.removeEventListener(oe, this.acOpen);
      this.actObj.removeEventListener(B, this.acComplete);
      this.actObj.destroy();
    }
    if (this.multiSelectObj && !this.multiSelectObj.isDestroyed) {
      this.multiSelectObj.removeEventListener(oe, this.dropdownOpen);
      this.multiSelectObj.removeEventListener(B, this.dropdownComplete);
      this.multiSelectObj.destroy();
    }
  };
  return s;
})();
Ke.Inject(zi);
var Io = (function () {
  function s(e, t, i) {
    this.filterSettings = i;
    this.parent = e;
    this.serviceLocator = t;
    if (this.parent) {
      this.parent.on(fe, this.destroy, this);
      this.parent.on(M, this.destroy, this);
    }
  }
  s.prototype.keyEventHandler = function (e) {
    if (e.keyCode === 13 || e.keyCode === 9) {
      var t = document.createEvent('HTMLEvents');
      t.initEvent('change', false, true);
      this.dispatchEvent(t);
    }
  };
  s.prototype.create = function (e) {
    this.numericInstance = this.parent.createElement('input', {
      className: 'e-flmenu-input',
      id: 'numberui-' + e.column.uid,
    });
    this.multiSelectCheckBoxInstance = this.parent.createElement('input', {
      className: 'multiselect-input',
      id: 'multiselectnumberui-' + e.column.uid,
    });
    e.target.appendChild(this.numericInstance);
    e.target.appendChild(this.multiSelectCheckBoxInstance);
    this.createNumericTextBox(e);
    this.createMultiSelectDropDown(e);
    mt(
      e.getOptrInstance.dropOptr.value,
      e.column.uid,
      e.column,
      e.column.type,
      e.dialogObj,
      e.getOptrInstance.dropOptr.previousValue,
    );
  };
  s.prototype.write = function (e) {
    var t = this.parent.filterModule.filterModule.getOperatorDropdown();
    var i = this.getNumericInstance(e.column.uid);
    var r = this.getMultiSelectInstance(e.column.uid);
    t.value === 'in' || t.value === 'notin'
      ? (r.value = Array.isArray(e.filteredValue) ? e.filteredValue : [])
      : (i.element.addEventListener('keydown', this.keyEventHandler),
        Array.isArray(e.filteredValue) || (i.value = e.filteredValue));
  };
  s.prototype.read = function (e, t, i, r) {
    if (i === 'in' || i === 'notin') {
      var n = this.getMultiSelectInstance(t.uid).value;
      r.filterByColumn(t.field, i, this.getMultiSelectInstance(t.uid).value, 'and', true);
    } else {
      var n = this.getNumericInstance(t.uid).value;
      r.filterByColumn(t.field, i, this.getNumericInstance(t.uid).value, 'and', true);
    }
  };
  s.prototype.createNumericTextBox = function (e) {
    this.numericTxtObj = new sn(
      E(
        {
          format: typeof e.column.format == 'string' || an(e.column.format) ? e.column.format : e.column.format.format,
          locale: this.parent.locale,
          cssClass: this.parent.cssClass ? 'e-popup-flmenu ' + this.parent.cssClass : 'e-popup-flmenu',
          placeholder: e.localizeText.getConstant('EnterValue'),
          enableRtl: this.parent.enableRtl,
        },
        e.column.filter.params,
      ),
    );
    this.numericTxtObj.appendTo(this.numericInstance);
  };
  s.prototype.createMultiSelectDropDown = function (e) {
    var t = e.column.isForeignColumn();
    var i = t ? e.column.dataSource : this.parent.dataSource;
    var r = t ? e.column.foreignKeyValue : e.column.field;
    this.multiSelectObj = new Ke(
      E(
        {
          dataSource: i instanceof H ? i : new H(i),
          fields: {
            text: r,
            value: r,
          },
          mode: 'CheckBox',
          showDropDownIcon: true,
          popupHeight: '300px',
          showSelectAll: true,
          query: new ue().select(r),
          cssClass: this.parent.cssClass ? 'e-multiselect-flmenu ' + this.parent.cssClass : 'e-multiselect-flmenu',
          locale: this.parent.locale,
          enableRtl: this.parent.enableRtl,
        },
        e.column.filter.params,
      ),
    );
    this.dialogObj = e.dialogObj;
    this.dropdownOpen = this.openPopup.bind(this);
    this.dropdownComplete = this.actionComplete(r);
    this.multiSelectObj.addEventListener(oe, this.dropdownOpen);
    this.multiSelectObj.addEventListener(B, this.dropdownComplete);
    this.multiSelectObj.appendTo(this.multiSelectCheckBoxInstance);
  };
  s.prototype.getNumericInstance = function (e) {
    return document.querySelector('#numberui-' + e).ej2_instances[0];
  };
  s.prototype.getMultiSelectInstance = function (e) {
    return document.querySelector('#multiselectnumberui-' + e).ej2_instances[0];
  };
  s.prototype.openPopup = function (e) {
    Ai(e, this.dialogObj);
  };
  s.prototype.actionComplete = function (e) {
    return function (t) {
      t.result = le.distinct(t.result, e, true);
    };
  };
  s.prototype.destroy = function () {
    this.parent.off(fe, this.destroy);
    this.parent.off(M, this.destroy);
    if (this.numericTxtObj && !this.numericTxtObj.isDestroyed) {
      this.numericTxtObj.destroy();
    }
    if (this.multiSelectObj && !this.multiSelectObj.isDestroyed) {
      this.multiSelectObj.removeEventListener(oe, this.dropdownOpen);
      this.multiSelectObj.removeEventListener(B, this.dropdownComplete);
      this.multiSelectObj.destroy();
    }
  };
  return s;
})();
Ke.Inject(zi);
var xo = (function () {
  function s(e, t, i) {
    this.parent = e;
    this.serviceLocator = t;
    this.filterSettings = i;
    if (this.parent) {
      this.parent.on(fe, this.destroy, this);
      this.parent.on(M, this.destroy, this);
    }
  }
  s.prototype.create = function (e) {
    this.elem = this.parent.createElement('input', {
      className: 'e-flmenu-input',
      id: 'bool-ui-' + e.column.uid,
    });
    e.target.appendChild(this.elem);
    this.multiSelectElement = this.parent.createElement('input', {
      className: 'multiselect-input',
      id: 'multiselectbool-ui-' + e.column.uid,
    });
    e.target.appendChild(this.multiSelectElement);
    this.createDropDownList(e);
    this.createMultiSelectDropDown(e);
    mt(
      e.getOptrInstance.dropOptr.value,
      e.column.uid,
      e.column,
      e.column.type,
      e.dialogObj,
      e.getOptrInstance.dropOptr.previousValue,
    );
  };
  s.prototype.write = function (e) {
    var t = this.parent.filterModule.filterModule.getOperatorDropdown();
    var i = this.getBooleanInstance(e.column.uid);
    var r = this.getMultiSelectInstance(e.column.uid);
    t.value === 'in' || t.value === 'notin'
      ? (r.value = Array.isArray(e.filteredValue) ? e.filteredValue : [])
      : !u(e.filteredValue) && !Array.isArray(e.filteredValue) && (i.value = e.filteredValue);
  };
  s.prototype.read = function (e, t, i, r) {
    if (i === 'in' || i === 'notin') {
      var n = this.getMultiSelectInstance(t.uid).value;
      r.filterByColumn(t.field, i, this.getMultiSelectInstance(t.uid).value, 'and', true);
    } else {
      var a = this.getBooleanInstance(t.uid);
      var n = a.value;
      r.filterByColumn(t.field, i, a.value, 'and', false);
    }
  };
  s.prototype.createDropDownList = function (e) {
    var t = this;
    var i = e.column.isForeignColumn();
    var r = i ? e.column.dataSource : this.parent.dataSource;
    var n = i ? e.column.foreignKeyValue : e.column.field;
    this.dialogObj = e.dialogObj;
    this.dropInstance = new wt(
      E(
        {
          dataSource: r instanceof H ? r : new H(r),
          query: new ue().select(n),
          fields: {
            text: n,
            value: n,
          },
          placeholder: e.localizeText.getConstant('SelectValue'),
          cssClass: this.parent.cssClass ? 'e-popup-flmenu ' + this.parent.cssClass : 'e-popup-flmenu',
          locale: this.parent.locale,
          enableRtl: this.parent.enableRtl,
        },
        e.column.filter.params,
      ),
    );
    this.dropdownOpen = this.openPopup.bind(this);
    this.dropdownComplete = this.actionComplete(n);
    this.dropInstance.addEventListener(oe, this.dropdownOpen);
    this.dropInstance.addEventListener(B, this.dropdownComplete);
    if (r && 'result' in r) {
      var a = this.parent.getQuery ? this.parent.getQuery().clone() : new ue();
      var o = rn({ requestType: 'booleanfilterrequest' }, a);
      this.parent.trigger(nn, o.state);
      var l = o.deffered;
      o.deffered.promise.then(function (h) {
        t.dropInstance.dataSource = new H(h);
        t.dropInstance.dataBind();
        for (var d = t.parent.filterSettings.columns, p = 0, c = d; p < c.length; p++) {
          var f = c[p];
          if (e.column.uid === c[p].uid) {
            t.dropInstance.value = c[p].value;
          }
        }
      });
    }
    this.dropInstance.appendTo(this.elem);
  };
  s.prototype.createMultiSelectDropDown = function (e) {
    var t = e.column.isForeignColumn();
    var i = t ? e.column.dataSource : this.parent.dataSource;
    var r = t ? e.column.foreignKeyValue : e.column.field;
    this.multiSelectCheckBoxInstance = new Ke(
      E(
        {
          dataSource: i instanceof H ? i : new H(i),
          fields: {
            text: r,
            value: r,
          },
          mode: 'CheckBox',
          showDropDownIcon: true,
          popupHeight: '300px',
          showSelectAll: true,
          query: new ue().select(r),
          cssClass: this.parent.cssClass ? 'e-multiselect-flmenu ' + this.parent.cssClass : 'e-multiselect-flmenu',
          locale: this.parent.locale,
          enableRtl: this.parent.enableRtl,
        },
        e.column.filter.params,
      ),
    );
    this.dialogObj = e.dialogObj;
    this.multiSelectDropdownOpen = this.openPopup.bind(this);
    this.multiSelectDropdownComplete = this.actionComplete(r);
    this.multiSelectCheckBoxInstance.addEventListener(oe, this.multiSelectDropdownOpen);
    this.multiSelectCheckBoxInstance.addEventListener(B, this.multiSelectDropdownComplete);
    this.multiSelectCheckBoxInstance.appendTo(this.multiSelectElement);
  };
  s.prototype.getBooleanInstance = function (e) {
    return document.querySelector('#bool-ui-' + e).ej2_instances[0];
  };
  s.prototype.getMultiSelectInstance = function (e) {
    return document.querySelector('#multiselectbool-ui-' + e).ej2_instances[0];
  };
  s.prototype.openPopup = function (e) {
    Ai(e, this.dialogObj);
  };
  s.prototype.actionComplete = function (e) {
    return function (t) {
      t.result = le.distinct(t.result, e, true);
    };
  };
  s.prototype.destroy = function () {
    this.parent.off(fe, this.destroy);
    this.parent.off(M, this.destroy);
    if (this.dropInstance && !this.dropInstance.isDestroyed) {
      this.dropInstance.removeEventListener(oe, this.dropdownOpen);
      this.dropInstance.removeEventListener(B, this.dropdownComplete);
      this.dropInstance.destroy();
    }
    if (this.multiSelectCheckBoxInstance && !this.multiSelectCheckBoxInstance.isDestroyed) {
      this.multiSelectCheckBoxInstance.removeEventListener(oe, this.multiSelectDropdownOpen);
      this.multiSelectCheckBoxInstance.removeEventListener(B, this.multiSelectDropdownComplete);
      this.multiSelectCheckBoxInstance.destroy();
    }
  };
  return s;
})();
var oi = (function () {
  function s(e, t, i) {
    this.dpOpen = this.openPopup.bind(this);
    this.parent = e;
    this.locator = t;
    this.fltrSettings = i;
    if (this.parent) {
      this.parent.on(fe, this.destroy, this);
      this.parent.on(M, this.destroy, this);
    }
  }
  s.prototype.create = function (e) {
    var t = on(e.column.format, e.column.type);
    this.dialogObj = e.dialogObj;
    this.inputElem = this.parent.createElement('input', {
      className: 'e-flmenu-input',
      id: 'dateui-' + e.column.uid,
    });
    e.target.appendChild(this.inputElem);
    e.column.type === 'date' || e.column.type === 'dateonly'
      ? (this.datePickerObj = new ui(
          E(
            {
              format: t,
              cssClass: this.parent.cssClass ? 'e-popup-flmenu ' + this.parent.cssClass : 'e-popup-flmenu',
              placeholder: e.localizeText.getConstant('ChooseDate'),
              width: '100%',
              locale: this.parent.locale,
              enableRtl: this.parent.enableRtl,
            },
            e.column.filter.params,
          ),
        ))
      : e.column.type === 'datetime' &&
        (this.datePickerObj = new ln(
          E(
            {
              format: t,
              cssClass: this.parent.cssClass ? 'e-popup-flmenu ' + this.parent.cssClass : 'e-popup-flmenu',
              placeholder: e.localizeText.getConstant('ChooseDate'),
              width: '100%',
              locale: this.parent.locale,
              enableRtl: this.parent.enableRtl,
            },
            e.column.filter.params,
          ),
        ));
    this.datePickerObj.addEventListener(oe, this.dpOpen);
    this.datePickerObj.appendTo(this.inputElem);
  };
  s.prototype.write = function (e) {
    var t = document.querySelector('#dateui-' + e.column.uid).ej2_instances[0];
    t.value = u(e.filteredValue) ? null : new Date(e.filteredValue);
  };
  s.prototype.read = function (e, t, i, r) {
    var n = document.querySelector('#dateui-' + t.uid).ej2_instances[0];
    var a = document.querySelector('#dateui-' + t.uid).ej2_instances[0].value;
    a = u(a) ? null : a;
    r.filterByColumn(t.field, i, a, 'and', true);
  };
  s.prototype.openPopup = function (e) {
    e.popup.element.style.zIndex = (this.dialogObj.zIndex + 1).toString();
  };
  s.prototype.destroy = function () {
    this.parent.off(fe, this.destroy);
    this.parent.off(M, this.destroy);
    if (!(u(this.datePickerObj) || this.datePickerObj.isDestroyed)) {
      this.datePickerObj.removeEventListener(oe, this.dpOpen);
      this.datePickerObj.destroy();
    }
  };
  return s;
})();
var Eo = (function () {
  function s(e, t, i, r, n) {
    this.isDialogOpen = false;
    this.maxHeight = '350px';
    this.isMenuCheck = false;
    this.colTypes = {
      string: Co,
      number: Io,
      date: oi,
      dateonly: oi,
      boolean: xo,
      datetime: oi,
    };
    this.parent = e;
    this.filterSettings = t;
    this.serviceLocator = i;
    this.customFilterOperators = r;
    this.filterObj = n;
    this.flMuiObj = new bo(this.parent, this.customFilterOperators, this.serviceLocator);
    this.l10n = this.serviceLocator.getService('localization');
    this.menuFilterBase = new Bi(e);
  }
  s.prototype.clearCustomFilter = function (e) {
    this.clearBtnClick(e);
  };
  s.prototype.applyCustomFilter = function (e) {
    this.filterBtnClick(e.col);
  };
  s.prototype.openDialog = function (e) {
    this.options = e;
    this.col = this.parent.getColumnByField(e.field);
    if (u(this.col.filter) || u(this.col.filter.type) || this.col.filter.type === 'Menu') {
      this.renderDlgContent(e.target, this.col);
    }
  };
  s.prototype.closeDialog = function (e) {
    var t = this;
    if (this.dlgObj) {
      var i = document.getElementById(this.dlgObj.element.id);
      if (this.dlgObj && !this.dlgObj.isDestroyed && i) {
        var r = {
          cancel: false,
          column: this.col,
          target: e,
          element: i,
        };
        if (r.cancel) {
          this.parent.isColumnMenuFilterClosing = false;
          return;
        }
        this.parent.notify(fe, r);
        this.isDialogOpen = false;
        if (this.isMenuCheck) {
          this.menuFilterBase.unWireEvents();
          this.parent.off(Mt, this.actionComplete);
          this.isMenuCheck = false;
        }
        var n = this.col;
        if (!u(this.col.filter) && !u(this.col.filter.ui) && !u(this.col.filter.ui.destroy)) {
          var a = this.col.filter.ui.destroy;
          if (typeof a == 'string') {
            a = re(a, window);
          }
          a();
        }
        (this.parent.isReact || this.parent.isVue) &&
        this.col.filterTemplate &&
        this.col.filterTemplate instanceof Function
          ? this.parent.clearTemplate(['filterTemplate'], void 0, function () {
              t.dlgObj.destroy();
            })
          : (this.dlgObj.destroy(), N(i));
        if (!this.parent.showColumnChooser) {
          var o = document.getElementById(this.parent.element.id + '_e-popup');
          if (!u(o)) {
            N(o);
            o = null;
          }
        }
        if (!u(this.dlgObj.storeActiveElement)) {
          this.dlgObj.storeActiveElement.focus();
        }
      }
      this.parent.notify(ts, {});
    }
  };
  s.prototype.renderDlgContent = function (e, t) {
    var i = {
      requestType: is,
      columnName: t.field,
      columnType: t.type,
    };
    var r = 'filterModel';
    i.filterModel = this;
    this.parent.trigger(_, i);
    var n = this.parent.createElement('div', {
      className: 'e-flmenu-maindiv',
      id: t.uid + '-flmenu',
    });
    this.dlgDiv = this.parent.createElement('div', {
      className: 'e-flmenu',
      id: t.uid + '-flmdlg',
    });
    this.dlgDiv.setAttribute('aria-label', this.l10n.getConstant('FilterMenuDialogARIA'));
    if (this.parent.enableAdaptiveUI) {
      var a = document.querySelector('.e-resfilter > .e-dlg-content > .e-mainfilterdiv');
      a.appendChild(this.dlgDiv);
    } else this.parent.element.appendChild(this.dlgDiv);
    this.dlgObj = new Wt({
      showCloseIcon: false,
      closeOnEscape: false,
      locale: this.parent.locale,
      visible: false,
      enableRtl: this.parent.enableRtl,
      created: this.dialogCreated.bind(this, e, t),
      position: this.parent.element.classList.contains('e-device')
        ? {
            X: 'center',
            Y: 'center',
          }
        : {
            X: '',
            Y: '',
          },
      target: this.parent.element.classList.contains('e-device') ? document.body : this.parent.element,
      buttons: [
        {
          click: this.filterBtnClick.bind(this, t),
          buttonModel: {
            content: this.l10n.getConstant('FilterButton'),
            isPrimary: true,
            cssClass: this.parent.cssClass ? 'e-flmenu-okbtn ' + this.parent.cssClass : 'e-flmenu-okbtn',
          },
        },
        {
          click: this.clearBtnClick.bind(this, t),
          buttonModel: {
            content: this.l10n.getConstant('ClearButton'),
            cssClass: this.parent.cssClass ? 'e-flmenu-cancelbtn ' + this.parent.cssClass : 'e-flmenu-cancelbtn',
          },
        },
      ],
      content: n,
      width: !u(S(e, 'e-bigger')) || this.parent.element.classList.contains('e-device') ? 260 : 250,
      animationSettings: { effect: 'None' },
      cssClass: this.parent.cssClass ? 'e-filter-popup ' + this.parent.cssClass : 'e-filter-popup',
    });
    var o = 'isStringTemplate';
    this.dlgObj.isStringTemplate = true;
    this.renderResponsiveDialog();
    this.dlgObj.appendTo(this.dlgDiv);
  };
  s.prototype.renderResponsiveDialog = function () {
    var e = this.parent;
    if (this.parent.enableAdaptiveUI) {
      this.dlgObj.position = {
        X: '',
        Y: '',
      };
      this.dlgObj.target = document.querySelector('.e-resfilter > .e-dlg-content > .e-mainfilterdiv');
      this.dlgObj.width = '100%';
      this.dlgObj.isModal = false;
      this.dlgObj.buttons = [{}];
    }
  };
  s.prototype.dialogCreated = function (e, t) {
    !z.isDevice && e
      ? rs(e, this.dlgObj, this.parent)
      : this.options.isResponsiveFilter ||
        (this.dlgObj.position = {
          X: 'center',
          Y: 'center',
        });
    this.currentDialogCreatedColumn = t;
    this.renderFilterUI(e, t);
    if (!(t.isForeignColumn() && !(!u(t.filter) && !u(t.filter.ui) && !u(t.filter.ui.create)))) {
      this.afterRenderFilterUI();
    }
    var i = this.parent.isReact && typeof t.filterTemplate != 'string';
    var r =
      this.parent.parentDetails &&
      this.parent.parentDetails.parentInstObj &&
      this.parent.parentDetails.parentInstObj.isReact;
    !u(t.filterTemplate) && !(i || r)
      ? (this.dlgDiv.querySelector('.e-flmenu-valuediv').firstElementChild.focus(),
        this.dlgDiv.querySelector('.e-flmenu-valuediv').firstElementChild.classList.add('e-input-focus'))
      : u(this.dlgDiv.querySelector('.e-flmenu-input')) ||
        (this.dlgDiv.querySelector('.e-flmenu-input').focus(),
        this.dlgDiv.querySelector('.e-flmenu-input').parentElement.classList.add('e-input-focus'));
  };
  s.prototype.afterRenderFilterUI = function () {
    var e = this.currentDialogCreatedColumn;
    if (this.currentDialogCreatedColumn.showColumnMenu) {
      this.parent.notify(ns, {});
    }
    this.parent.enableAdaptiveUI
      ? ((this.dlgObj.element.style.left = '0px'), (this.dlgObj.element.style.maxHeight = 'none'))
      : (this.dlgObj.element.style.maxHeight = this.maxHeight);
    this.dlgObj.show();
    if (
      this.parent.getContent().firstElementChild.offsetHeight < this.dlgObj.element.offsetHeight &&
      !S(this.parent.element, 'e-gantt-dialog')
    ) {
      ci(this.parent, this.dlgObj);
    }
    var t = this.dlgObj.element.querySelector('.e-flm_optrdiv').querySelector('input');
    var i = this.dlgObj.element.querySelector('.e-flmenu-valuediv').querySelector('input');
    t.value === 'Empty' || t.value === 'Not Empty' || t.value === 'Null' || t.value === 'Not Null'
      ? u(i.ej2_instances)
        ? i.setAttribute('disabled', 'true')
        : (i.ej2_instances[0].enabled = false)
      : u(i && i.getAttribute('disabled')) ||
        (u(i.ej2_instances) ? i.removeAttribute('disabled') : (i.ej2_instances[0].enabled = true));
    if (!this.currentDialogCreatedColumn.filterTemplate) {
      this.writeMethod(
        this.currentDialogCreatedColumn,
        this.dlgObj.element.querySelector('#' + this.currentDialogCreatedColumn.uid + '-flmenu'),
      );
    }
    var r = {
      requestType: ss,
      columnName: this.currentDialogCreatedColumn.field,
      columnType: this.currentDialogCreatedColumn.type,
    };
    var n = 'filterModel';
    r.filterModel = this;
    this.isDialogOpen = true;
    if (!this.isMenuCheck) {
      this.parent.trigger(B, r);
    }
  };
  s.prototype.renderFilterUI = function (e, t) {
    var i = this.dlgObj.element.querySelector('.e-flmenu-maindiv');
    this.parent.log('column_type_missing', { column: t });
    this.renderOperatorUI(i, e, t);
    this.renderFlValueUI(i, e, t);
  };
  s.prototype.renderOperatorUI = function (e, t, i) {
    this.flMuiObj.renderOperatorUI(e, t, i, this.dlgObj, this.filterObj.menuOperator);
  };
  s.prototype.renderFlValueUI = function (e, t, i) {
    var r = this.parent.createElement('div', { className: 'e-flmenu-valuediv' });
    var n = this.filterObj;
    e.appendChild(r);
    var a = new this.colTypes[i.type](this.parent, this.serviceLocator, this.parent.filterSettings);
    if (i.filterTemplate) {
      var o = {};
      var l = 'value';
      o[i.field] = o.value = this.filterObj.values[i.field];
      if (i.foreignKeyValue) {
        o[i.foreignKeyValue] = this.filterObj.values[i.field];
        o[i.field] = void 0;
      }
      var h = 'column';
      o.column = i;
      var d =
        this.parent.isReact &&
        typeof i.filterTemplate != 'string' &&
        !(i.filterTemplate.prototype && i.filterTemplate.prototype.CSPTemplate);
      var p =
        this.parent.parentDetails &&
        this.parent.parentDetails.parentInstObj &&
        this.parent.parentDetails.parentInstObj.isReact;
      var c = this.parent.element.id + i.uid + 'filterTemplate';
      if (d || p) {
        i.getFilterTemplate()(o, this.parent, 'filterTemplate', c, null, null, r);
        this.parent.renderTemplates();
      } else {
        var f = i.getFilterTemplate()(o, this.parent, 'filterTemplate', c, null, null, null, this.parent.root);
        ae(r, f);
      }
      if (this.isMenuCheck) {
        this.menuFilterBase.cBox = this.dlgObj.element.querySelector('.e-checkboxlist.e-fields');
        this.menuFilterBase.wireEvents();
        this.parent.on(Mt, this.actionComplete, this);
        this.menuFilterBase.getAllData();
      }
    } else if (!u(i.filter) && !u(i.filter.ui) && !u(i.filter.ui.create)) {
      var g = i.filter.ui.create;
      if (typeof g == 'string') {
        g = re(g, window);
      }
      g({
        column: i,
        target: r,
        getOptrInstance: this.flMuiObj,
        dialogObj: this.dlgObj,
      });
    } else
      a.create({
        column: i,
        target: r,
        getOptrInstance: this.flMuiObj,
        localizeText: this.l10n,
        dialogObj: this.dlgObj,
      });
  };
  s.prototype.writeMethod = function (e, t) {
    for (
      var i,
        r = t.querySelector('.e-flmenu-valinput'),
        n = new this.colTypes[e.type](this.parent, this.serviceLocator, this.parent.filterSettings),
        a = this.filterSettings.columns,
        o = 0,
        l = a;
      o < l.length;
      o++
    ) {
      var h = l[o];
      if (e.uid === l[o].uid) {
        i = l[o].value;
      }
    }
    if (!u(e.filter) && !u(e.filter.ui) && !u(e.filter.ui.write)) {
      var d = e.filter.ui.write;
      if (typeof d == 'string') {
        d = re(d, window);
      }
      d({
        column: e,
        target: r,
        parent: this.parent,
        filteredValue: i,
      });
    } else
      n.write({
        column: e,
        target: r,
        parent: this.parent,
        filteredValue: i,
      });
  };
  s.prototype.filterBtnClick = function (e) {
    var t = this.dlgObj.element.querySelector('.e-flmenu-valuediv input');
    var i = this.flMuiObj.getFlOperator();
    var r = new this.colTypes[e.type](this.parent, this.serviceLocator, this.parent.filterSettings);
    if (e.filterTemplate) {
      var n = this.dlgDiv.querySelector('.e-flmenu-valuediv');
      var a = void 0;
      if (n.children[0].value) a = n.children[0].value;
      else if (!u(n.children[0].ej2_instances))
        a = (this.parent.isAngular ? n.children[0] : n.querySelector('input')).ej2_instances[0].value;
      else {
        var o = n.querySelector('.e-control');
        if (!u(o)) {
          a = e.type === 'boolean' ? o.checked : u(o.ej2_instances) ? o.value : o.ej2_instances[0].value;
        }
      }
      this.filterObj.filterByColumn(e.field, i, a);
    } else if (!u(e.filter) && !u(e.filter.ui) && !u(e.filter.ui.read)) {
      var l = e.filter.ui.read;
      if (typeof l == 'string') {
        l = re(l, window);
      }
      l({
        element: t,
        column: e,
        operator: i,
        fltrObj: this.filterObj,
      });
    } else r.read(t, e, i, this.filterObj);
    this.closeDialog();
    if (this.parent.showColumnMenu) {
      this.parent.notify(Vi, {});
    }
  };
  s.prototype.closeResponsiveDialog = function () {
    this.closeDialog();
  };
  s.prototype.clearBtnClick = function (e) {
    this.filterObj.removeFilteredColsByField(e.field);
    this.closeDialog();
    if (this.parent.showColumnMenu) {
      this.parent.notify(Vi, {});
    }
  };
  s.prototype.destroy = function () {
    this.closeDialog();
  };
  s.prototype.getFilterUIInfo = function () {
    return {
      field: this.col.field,
      operator: this.flMuiObj.getFlOperator(),
    };
  };
  s.prototype.getOperatorDropdown = function () {
    return this.flMuiObj.dropOptr;
  };
  s.prototype.renderCheckBoxMenu = function () {
    this.isMenuCheck = true;
    this.menuFilterBase.updateModel(this.options);
    this.menuFilterBase.getAndSetChkElem(this.options);
    this.dlgObj.buttons = [
      {
        click: this.menuFilterBase.btnClick.bind(this.menuFilterBase),
        buttonModel: {
          content: this.menuFilterBase.getLocalizedLabel('FilterButton'),
          cssClass: 'e-primary',
          isPrimary: true,
        },
      },
      {
        click: this.menuFilterBase.btnClick.bind(this.menuFilterBase),
        buttonModel: {
          cssClass: 'e-flat',
          content: this.menuFilterBase.getLocalizedLabel('ClearButton'),
        },
      },
    ];
    this.menuFilterBase.dialogObj = this.dlgObj;
    this.menuFilterBase.dlg = this.dlgObj.element;
    this.menuFilterBase.dlg.classList.add('e-menucheckbox');
    this.menuFilterBase.dlg.classList.remove('e-checkboxfilter');
    this.maxHeight = '800px';
    return this.menuFilterBase.sBox.innerHTML;
  };
  s.prototype.actionComplete = function (e) {
    if (this.isMenuCheck) {
      this.parent.trigger(B, e);
    }
  };
  return s;
})();
var zn = (function () {
  function s(e, t, i) {
    this.parent = e;
    this.isresetFocus = true;
    this.checkBoxBase = new Bi(e);
    this.addEventListener();
  }
  s.prototype.destroy = function () {
    this.removeEventListener();
    this.checkBoxBase.closeDialog();
  };
  s.prototype.openDialog = function (e) {
    this.checkBoxBase.openDialog(e);
    this.parent.log('column_type_missing', { column: e.column });
  };
  s.prototype.closeDialog = function () {
    this.destroy();
    if (this.isresetFocus) {
      this.parent.notify(vt, {});
    }
  };
  s.prototype.closeResponsiveDialog = function () {
    this.checkBoxBase.closeDialog();
  };
  s.prototype.getModuleName = function () {
    return 'checkboxFilter';
  };
  s.prototype.actionBegin = function (e) {
    this.parent.trigger(_, e);
  };
  s.prototype.actionComplete = function (e) {
    this.parent.trigger(B, e);
  };
  s.prototype.actionPrevent = function (e) {
    if (qe(this.parent)) {
      this.parent.notify(ye, e);
      e.cancel = true;
    }
  };
  s.prototype.clearCustomFilter = function (e) {
    this.checkBoxBase.clearFilter(e);
  };
  s.prototype.applyCustomFilter = function () {
    this.checkBoxBase.fltrBtnHandler();
    this.checkBoxBase.closeDialog();
  };
  s.prototype.addEventListener = function () {
    if (!this.parent.isDestroyed) {
      this.parent.on(_i, this.actionBegin, this);
      this.parent.on(Mt, this.actionComplete, this);
      this.parent.on(ji, this.actionPrevent, this);
    }
  };
  s.prototype.removeEventListener = function () {
    if (!this.parent.isDestroyed) {
      this.parent.off(_i, this.actionBegin);
      this.parent.off(Mt, this.actionComplete);
      this.parent.off(ji, this.actionPrevent);
    }
  };
  return s;
})();
var Do = (function () {
  var s = function (e, t) {
    s =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (i, r) {
          i.__proto__ = r;
        }) ||
      function (i, r) {
        for (var n in r)
          if (r.hasOwnProperty(n)) {
            i[n] = r[n];
          }
      };
    return s(e, t);
  };
  return function (e, t) {
    s(e, t);
    function i() {
      this.constructor = e;
    }
    e.prototype = t === null ? Object.create(t) : ((i.prototype = t.prototype), new i());
  };
})();
var Ro = (function (s) {
  Do(e, s);
  function e(t, i, r, n) {
    var a = s(t, i, r) || this;
    a.parent = t;
    a.isresetFocus = true;
    a.excelFilterBase = new as(t, n);
    return a;
  }
  e.prototype.destroy = function () {
    this.excelFilterBase.closeDialog();
  };
  e.prototype.openDialog = function (t) {
    this.excelFilterBase.openDialog(t);
  };
  e.prototype.closeDialog = function () {
    this.excelFilterBase.closeDialog();
    if (this.isresetFocus) {
      this.parent.notify(vt, {});
    }
  };
  e.prototype.clearCustomFilter = function (t) {
    this.excelFilterBase.clearFilter(t);
  };
  e.prototype.closeResponsiveDialog = function (t) {
    t ? this.excelFilterBase.removeDialog() : this.closeDialog();
  };
  e.prototype.applyCustomFilter = function (t) {
    t.isCustomFilter
      ? this.excelFilterBase.filterBtnClick(t.col.field)
      : (this.excelFilterBase.fltrBtnHandler(), this.excelFilterBase.closeDialog());
  };
  e.prototype.filterByColumn = function (t, i, r, n, a, o, l, h) {
    this.excelFilterBase.filterByColumn(t, i, r, n, a, o, l, h);
  };
  e.prototype.getFilterUIInfo = function () {
    return this.excelFilterBase.getFilterUIInfo();
  };
  e.prototype.getModuleName = function () {
    return 'excelFilter';
  };
  return e;
})(zn);
var Fo = (function () {
  function s(e, t, i) {
    this.predicate = 'and';
    this.contentRefresh = true;
    this.filterByMethod = true;
    this.refresh = true;
    this.values = {};
    this.operators = {};
    this.cellText = {};
    this.nextFlMenuOpen = '';
    this.type = {
      Menu: Eo,
      CheckBox: zn,
      Excel: Ro,
    };
    this.filterOperators = {
      contains: 'contains',
      endsWith: 'endswith',
      equal: 'equal',
      greaterThan: 'greaterthan',
      greaterThanOrEqual: 'greaterthanorequal',
      lessThan: 'lessthan',
      lessThanOrEqual: 'lessthanorequal',
      notEqual: 'notequal',
      startsWith: 'startswith',
      wildCard: 'wildcard',
      isNull: 'isnull',
      notNull: 'notnull',
      like: 'like',
    };
    this.fltrDlgDetails = {
      field: '',
      isOpen: false,
    };
    this.skipNumberInput = ['=', ' ', '!'];
    this.skipStringInput = ['>', '<', '='];
    this.actualPredicate = {};
    this.inputList = [];
    this.isFilterCleared = false;
    this.parent = e;
    this.filterSettings = t;
    this.serviceLocator = i;
    this.addEventListener();
    this.setFullScreenDialog();
  }
  s.prototype.render = function (e) {
    if (!le.getObject('args.isFrozen', e)) {
      var t = this.parent;
      this.l10n = this.serviceLocator.getService('localization');
      this.getLocalizedCustomOperators();
      if (this.parent.filterSettings.type === 'FilterBar' && this.parent.columns.length) {
        var i = this.parent.element.querySelector('.e-filterbar');
        if (i) {
          N(i);
        }
        var r = new nt(this.serviceLocator, P.Filter, this.parent);
        var n = this.serviceLocator.getService('cellRendererFactory');
        n.addCellRenderer(P.Filter, new wo(this.parent, this.serviceLocator));
        this.valueFormatter = this.serviceLocator.getService('valueFormatter');
        r.element = this.parent.createElement('tr', {
          className: 'e-filterbar',
          attrs: { role: 'row' },
        });
        var a = this.generateRow();
        a.data = this.values;
        this.parent.getHeaderContent().querySelector('thead:not(.e-masked-thead)').appendChild(r.element);
        var o = this.parent.element.querySelector('.e-rowdragheader');
        this.element = r.render(a, this.parent.getColumns(), null, null, r.element);
        if (
          this.element.querySelectorAll('.e-leftfreeze').length &&
          (this.element.querySelectorAll('.e-indentcell').length ||
            this.element.querySelectorAll('.e-grouptopleftcell').length)
        )
          for (var l = this.element.querySelectorAll('.e-indentcell, .e-grouptopleftcell'), h = 0; h < l.length; h++) {
            l[parseInt(h.toString(), 10)].classList.add('e-leftfreeze');
            se(l[parseInt(h.toString(), 10)], h * 30, this.parent.enableRtl, 'Left');
          }
        Kt(this.element);
        var d = this.element.querySelector('.e-detailheadercell');
        if (d) {
          d.className = 'e-filterbarcell e-mastercell';
        }
        if (o) {
          o.classList.contains('e-leftfreeze')
            ? (o.className = 'e-dragheadercell e-mastercell e-leftfreeze')
            : (o.className = 'e-filterbarcell e-mastercell');
        }
        var p = [].slice.call(this.element.getElementsByClassName('e-grouptopleftcell'));
        if (p.length) {
          p[p.length - 1].classList.add('e-lastgrouptopleftcell');
        }
        this.wireEvents();
        this.parent.notify(ki, { case: 'filter' });
      }
    }
  };
  s.prototype.showCustomFilter = function (e) {
    this.responsiveDialogRenderer.isCustomDialog = e;
    this.responsiveDialogRenderer.showResponsiveDialog(this.column);
  };
  s.prototype.renderResponsiveChangeAction = function (e) {
    this.responsiveDialogRenderer.action = e.action;
  };
  s.prototype.setFilterModel = function (e) {
    var t = e.filter.type || this.parent.filterSettings.type;
    this.filterModule = new this.type['' + t](
      this.parent,
      this.parent.filterSettings,
      this.serviceLocator,
      this.customOperators,
      this,
    );
  };
  s.prototype.destroy = function () {
    var e = this.parent.element;
    if (
      !(
        !this.parent.element ||
        (!this.parent.element.querySelector('.' + Oe) && !this.parent.element.querySelector('.' + pe))
      )
    ) {
      if (this.filterModule) {
        this.filterModule.destroy();
      }
      if (!this.parent.refreshing && (this.parent.isDestroyed || !this.parent.allowFiltering)) {
        this.filterSettings.columns = [];
      }
      this.updateFilterMsg();
      this.removeEventListener();
      this.unWireEvents();
      if (this.filterSettings.type === 'FilterBar' && !this.parent.isDestroyed) {
        if (this.filterSettings.showFilterBarOperator)
          for (
            var t = [].slice.call(this.element.getElementsByClassName('e-filterbaroperator')), i = 0;
            i < t.length;
            i++
          )
            if (t[parseInt(i.toString(), 10)].ej2_instances[0]) {
              t[parseInt(i.toString(), 10)].ej2_instances[0].destroy();
            }
        this.parent.getColumns().map(function (n) {
          if (n.filterBarTemplate && !u(n.filterBarTemplate.destroy)) {
            var a = n.filterBarTemplate.destroy;
            if (typeof a == 'string') {
              a = re(a, window);
            }
            a();
          }
        });
      }
      if (this.element) {
        if (this.element.parentElement) {
          for (var i = 0; i < this.inputList.length; i++) {
            pi.destroy(
              this.inputList[parseInt(i.toString(), 10)],
              this.inputList[parseInt(i.toString(), 10)].element.nextElementSibling,
            );
            N(this.inputList[parseInt(i.toString(), 10)].element);
          }
          this.inputList = [];
          N(this.element);
          this.element = null;
        }
        var r = this.parent.getHeaderContent().querySelector('.e-filterbar');
        if (r) {
          N(r);
        }
      }
    }
  };
  s.prototype.setFullScreenDialog = function () {
    if (this.serviceLocator) {
      this.serviceLocator.registerAdaptiveService(this, this.parent.enableAdaptiveUI, gt.isFilter);
    }
  };
  s.prototype.generateRow = function () {
    var e = {};
    var t = new yt(e);
    t.cells = this.generateCells();
    return t;
  };
  s.prototype.generateCells = function () {
    var e = [];
    if (this.parent.allowGrouping)
      for (var t = 0, i = this.parent.groupSettings.columns.length; t < i; t++)
        e.push(this.generateCell({}, P.HeaderIndent));
    if (this.parent.detailTemplate || this.parent.childGrid) {
      e.push(this.generateCell({}, P.DetailHeader));
    }
    if (this.parent.isRowDragable() && this.parent.getFrozenMode() !== 'Right') {
      e.push(this.generateCell({}, P.RowDragHIcon));
    }
    for (var r = 0, n = this.parent.getColumns(); r < n.length; r++) {
      var a = n[r];
      e.push(this.generateCell(n[r]));
    }
    if (this.parent.isRowDragable() && this.parent.getFrozenMode() === 'Right') {
      e.push(this.generateCell({}, P.RowDragHIcon));
    }
    return e;
  };
  s.prototype.generateCell = function (e, t) {
    var i = {
      visible: e.visible,
      isDataCell: false,
      rowId: '',
      column: e,
      cellType: t || P.Filter,
      attributes: { title: this.l10n.getConstant('FilterbarTitle') },
    };
    return new ze(i);
  };
  s.prototype.updateModel = function () {
    var e =
      this.column.isForeignColumn() || this.parent.enableColumnVirtualization
        ? this.parent.getColumnByUid(this.column.uid, true)
        : this.parent.getColumnByField(this.fieldName);
    this.filterObjIndex = this.getFilteredColsIndexByField(e);
    this.prevFilterObject = this.filterSettings.columns[this.filterObjIndex];
    for (
      var t = Array.isArray(this.value) && this.value.length ? this.value : [this.value],
        i =
          this.parent.dataSource.adaptor && this.parent.dataSource.adaptor.getModuleName
            ? this.parent.dataSource.adaptor.getModuleName()
            : void 0,
        r = 0,
        n = t.length;
      r < n;
      r++
    ) {
      var a = e.isForeignColumn() ? e.foreignKeyValue : this.fieldName;
      var o = this.operator === 'notequal';
      this.operator === 'in' || this.operator === 'notin'
        ? (this.parent.getDataModule().isRemote() &&
            (e.type === 'date' || e.type === 'dateonly' || e.type === 'datetime') &&
            (t = le.parse.arrayReplacer(t)),
          (this.currentFilterObject = {
            field: a,
            uid: e.uid,
            isForeignKey: e.isForeignColumn(),
            operator: this.operator,
            value: t,
            predicate: this.predicate,
            matchCase: this.matchCase,
            ignoreAccent: this.ignoreAccent,
            actualFilterValue: {},
            actualOperator: {},
          }),
          (n = 0))
        : (this.currentFilterObject = {
            field: a,
            uid: e.uid,
            isForeignKey: e.isForeignColumn(),
            operator: this.operator,
            value: t[parseInt(r.toString(), 10)],
            predicate: this.predicate,
            matchCase: this.matchCase,
            ignoreAccent: this.ignoreAccent,
            actualFilterValue: {},
            actualOperator: {},
          });
      var l = this.getFilteredColsIndexByField(e);
      l > -1 &&
      (!Array.isArray(this.value) ||
        (Array.isArray(this.value) && (this.operator === 'in' || this.operator === 'notin')))
        ? (this.filterSettings.columns[parseInt(l.toString(), 10)] = this.currentFilterObject)
        : this.filterSettings.columns.push(this.currentFilterObject);
      if (
        !this.column.isForeignColumn() &&
        this.prevFilterObject &&
        (u(this.prevFilterObject.value) || this.prevFilterObject.value === '') &&
        (this.prevFilterObject.operator === 'equal' || this.prevFilterObject.operator === 'notequal') &&
        i !== 'ODataAdaptor' &&
        i !== 'ODataV4Adaptor'
      ) {
        this.handleExistingFilterCleanup(a);
      }
      if (
        !this.column.isForeignColumn() &&
        u(this.value) &&
        (this.operator === 'equal' || this.operator === 'notequal') &&
        i !== 'ODataAdaptor' &&
        i !== 'ODataV4Adaptor'
      ) {
        this.handleExistingFilterCleanup(a);
        if (e.type === 'string') {
          this.filterSettings.columns.push({
            field: a,
            ignoreAccent: this.ignoreAccent,
            matchCase: this.matchCase,
            operator: this.operator,
            predicate: o ? 'and' : 'or',
            value: '',
          });
        }
        this.filterSettings.columns.push({
          field: a,
          ignoreAccent: this.ignoreAccent,
          matchCase: this.matchCase,
          operator: this.operator,
          predicate: o ? 'and' : 'or',
          value: void 0,
        });
        this.filterSettings.columns.push({
          field: a,
          ignoreAccent: this.ignoreAccent,
          matchCase: this.matchCase,
          operator: this.operator,
          predicate: o ? 'and' : 'or',
          value: null,
        });
      }
    }
    this.filterSettings.columns = this.filterSettings.columns;
    this.parent.dataBind();
  };
  s.prototype.handleExistingFilterCleanup = function (e) {
    for (var t = 0; t < this.filterSettings.columns.length; t++)
      if (
        this.filterSettings.columns['' + t].field === e &&
        (this.filterSettings.columns['' + t].operator === 'equal' ||
          this.filterSettings.columns['' + t].operator === 'notequal') &&
        u(this.filterSettings.columns['' + t].value)
      ) {
        this.filterSettings.columns.splice(t, 1);
        t = t - 1;
      }
  };
  s.prototype.getFilteredColsIndexByField = function (e) {
    for (var t = this.filterSettings.columns, i = 0, r = t.length; i < r; i++)
      if (
        t[parseInt(i.toString(), 10)].uid === e.uid ||
        (e.isForeignColumn() && this.parent.getColumnByUid(e.uid).field === e.foreignKeyValue)
      )
        return i;
    return -1;
  };
  s.prototype.onActionComplete = function (e) {
    var t = this.isRemove
      ? {
          requestType: 'filtering',
          type: B,
        }
      : {
          currentFilterObject: this.currentFilterObject,
          currentFilteringColumn: u(this.column) ? void 0 : this.column.field,
          columns: this.filterSettings.columns,
          requestType: 'filtering',
          type: B,
        };
    this.parent.trigger(B, E(e, t));
    this.isRemove = false;
  };
  s.prototype.wireEvents = function () {
    R.add(this.parent.getHeaderContent(), 'keyup', this.keyUpHandlerImmediate, this);
  };
  s.prototype.unWireEvents = function () {
    R.remove(this.parent.getHeaderContent(), 'keyup', this.keyUpHandlerImmediate);
  };
  s.prototype.enableAfterRender = function (e) {
    if (e.module === this.getModuleName() && e.enable) {
      this.parent.getHeaderTable().classList.add('e-sortfilter');
      this.render();
    }
  };
  s.prototype.refreshFilterValue = function () {
    if (!u(this.parent.modelObserver.boundedEvents)) {
      this.parent.removeEventListener(fi, this.refreshFilterValueFn);
    }
    if (
      (this.filterSettings.type === 'FilterBar' || this.filterSettings.type === 'Excel') &&
      this.filterSettings.columns.length &&
      !this.parent.getCurrentViewRecords().length
    ) {
      this.initialEnd();
    }
  };
  s.prototype.initialEnd = function () {
    this.parent.off(Te, this.initialEnd);
    if (this.parent.getColumns().length && this.filterSettings.columns.length) {
      var e = this.parent;
      this.contentRefresh = false;
      this.initialLoad = true;
      for (var t = 0, i = this.parent.filterSettings.columns; t < i.length; t++) {
        var r = i[t];
        this.filterByColumn(
          i[t].field,
          i[t].operator,
          i[t].value,
          i[t].predicate,
          i[t].matchCase,
          i[t].ignoreAccent,
          i[t].actualFilterValue,
          i[t].actualOperator,
          i[t].isForeignKey,
        );
      }
      this.initialLoad = false;
      this.updateFilterMsg();
      this.contentRefresh = true;
    }
  };
  s.prototype.addEventListener = function () {
    if (!this.parent.isDestroyed) {
      this.parent.on(_e, this.setFullScreenDialog, this);
      this.parent.on(Se, this.enableAfterRender, this);
      this.parent.on(Ui, this.onActionComplete, this);
      this.parent.on(Ge, this.onPropertyChanged, this);
      this.parent.on(be, this.keyUpHandler, this);
      this.parent.on(gi, this.columnPositionChanged, this);
      this.parent.on(We, this.render, this);
      this.parent.on(Te, this.initialEnd, this);
      this.parent.on(fe, this.filterMenuClose, this);
      this.parent.on(Re, this.renderResponsiveChangeAction, this);
      this.docClickHandler = this.clickHandler.bind(this);
      R.add(document, 'click', this.docClickHandler, this);
      R.add(this.parent.element, 'mousedown', this.refreshClearIcon, this);
      this.parent.on(Gi, this.columnMenuFilter, this);
      this.parent.on(Ne, this.filterIconClickHandler, this);
      this.parent.on('persist-data-changed', this.initialEnd, this);
      this.parent.on(Wi, this.clickHandler, this);
      this.parent.on(M, this.destroy, this);
      this.refreshFilterValueFn = this.refreshFilterValue.bind(this);
      this.parent.addEventListener(fi, this.refreshFilterValueFn);
    }
  };
  s.prototype.removeEventListener = function () {
    R.remove(document, 'click', this.docClickHandler);
    R.remove(this.parent.element, 'mousedown', this.refreshClearIcon);
    if (!this.parent.isDestroyed) {
      this.parent.off(_e, this.setFullScreenDialog);
      this.parent.off(Se, this.enableAfterRender);
      this.parent.off(Ui, this.onActionComplete);
      this.parent.off(Ge, this.onPropertyChanged);
      this.parent.off(be, this.keyUpHandler);
      this.parent.off(gi, this.columnPositionChanged);
      this.parent.off(We, this.render);
      this.parent.off(Gi, this.columnMenuFilter);
      this.parent.off(fe, this.filterMenuClose);
      this.parent.off(Re, this.renderResponsiveChangeAction);
      this.parent.off(Ne, this.filterIconClickHandler);
      this.parent.off(Wi, this.clickHandler);
      this.parent.off(M, this.destroy);
    }
  };
  s.prototype.refreshClearIcon = function (e) {
    if (
      this.parent.allowFiltering &&
      this.parent.filterSettings.type === 'FilterBar' &&
      e.target.closest('th') &&
      e.target.closest('th').classList.contains('e-filterbarcell') &&
      e.target.classList.contains('e-clear-icon')
    ) {
      var t = e.target.previousElementSibling;
      pi.setValue(null, e.target.previousElementSibling, 'Never', true);
      if (this.filterSettings.mode === 'Immediate') {
        this.removeFilteredColsByField(e.target.previousElementSibling.id.slice(0, -14));
      }
    }
  };
  s.prototype.filterMenuClose = function () {
    this.fltrDlgDetails.isOpen = false;
  };
  s.prototype.filterByColumn = function (e, t, i, r, n, a, o, l, h) {
    var d = this;
    var p = this.parent;
    var c;
    if (typeof i == 'string') {
      i = this.parent.sanitize(i);
    }
    this.column = this.parent.grabColumnByFieldFromAllCols(e, h);
    if (
      this.filterSettings.type === 'FilterBar' &&
      this.filterSettings.showFilterBarOperator &&
      u(this.column.filterBarTemplate) &&
      u(this.column.filterTemplate)
    ) {
      t = this.getOperatorName(e);
    }
    if (t === 'like' && i && i.indexOf('%') === -1) {
      i = '%' + i + '%';
    }
    if (false) {
      if (this.filterSettings.type === 'FilterBar') {
        c = this.parent.getHeaderContent().querySelector("[id='" + this.column.field + "_filterBarcell']");
      }
      if (!u(this.column.allowFiltering) && !this.column.allowFiltering) {
        this.parent.log('action_disabled_column', {
          moduleName: this.getModuleName(),
          columnName: this.column.headerText,
        });
        return;
      }
      if (qe(this.parent)) {
        this.parent.notify(ye, {
          instance: this,
          handler: this.filterByColumn,
          arg1: e,
          arg2: t,
          arg3: i,
          arg4: r,
          arg5: n,
          arg6: a,
          arg7: o,
          arg8: l,
        });
        return;
      }
      this.predicate = r || (Array.isArray(i) ? 'or' : 'and');
      this.value = i;
      this.matchCase = n || false;
      this.ignoreAccent = this.ignoreAccent = u(a) ? this.parent.filterSettings.ignoreAccent : a;
      this.fieldName = e;
      this.operator = t;
      i = u(i) ? i : i.toString();
      if (i === '') {
        i = null;
      }
      if (this.column.type === 'number' || this.column.type === 'date') {
        this.matchCase = true;
      }
      if (c && this.filterSettings.type === 'FilterBar') {
        if ((i && i.length < 1) || (!this.filterByMethod && this.checkForSkipInput(this.column, i))) {
          this.filterStatusMsg = i && i.length < 1 ? '' : this.l10n.getConstant('InvalidFilterMessage');
          this.updateFilterMsg();
          return;
        }
        if (c.value !== i) {
          c.value = i;
        }
      }
      u(this.column.format)
        ? (this.values[this.column.field] = i)
        : (this.applyColumnFormat(i),
          this.initialLoad && this.filterSettings.type === 'FilterBar' && (c.value = this.values[this.column.field]));
      var f = {
        field: this.fieldName,
        predicate: r,
        matchCase: n,
        ignoreAccent: a,
        operator: this.operator,
        value: this.value,
        type: this.column.type,
      };
      var g = this.parent.filterSettings.columns.filter(function (m) {
        return m.field === d.fieldName;
      });
      g.length > 1 && !u(this.actualPredicate[this.fieldName])
        ? this.actualPredicate[this.fieldName].push(f)
        : (this.actualPredicate[this.fieldName] = [f]);
      if (!this.checkAlreadyColFiltered(this.column.field)) {
        this.updateModel();
      }
    }
  };
  s.prototype.applyColumnFormat = function (e) {
    var t = this;
    var i =
      this.column.type === 'date' || this.column.type === 'datetime' || this.column.type === 'dateonly'
        ? new Date(e)
        : parseFloat(e);
    (this.column.type === 'date' || this.column.type === 'datetime' || this.column.type === 'dateonly') &&
    e &&
    Array.isArray(this.value) &&
    e.split(',').length > 1
      ? (this.values[this.column.field] = e.split(',').map(function (r) {
          if (r === '') {
            r = null;
          }
          return t.setFormatForFlColumn(new Date(r), t.column);
        }))
      : (this.values[this.column.field] = this.setFormatForFlColumn(i, this.column));
  };
  s.prototype.skipUid = function (e) {
    for (var t = true, i = Object.keys(e), r = 0; r < i.length; r++) {
      var n = Object.keys(e[i[parseInt(r.toString(), 10)]]);
      if (n.length === 1 && n[0] === 'uid') {
        t = false;
      }
    }
    return t;
  };
  s.prototype.onPropertyChanged = function (e) {
    if (e.module === this.getModuleName())
      for (var t = 0, i = Object.keys(e.properties); t < i.length; t++) {
        var r = i[t];
        switch (i[t]) {
          case 'columns':
            {
              var n = 'columns';
              var a = {
                currentFilterObject: this.currentFilterObject,
                currentFilteringColumn: this.column ? this.column.field : void 0,
                action: 'filter',
                columns: this.filterSettings.columns,
                requestType: 'filtering',
                type: _,
                cancel: false,
              };
            }
            if (this.contentRefresh && this.skipUid(e.properties.columns)) {
              this.parent.notify(ee, a);
              if (a.cancel) {
                if (this.filterSettings.type === 'CheckBox' || this.filterSettings.type === 'Excel') {
                  this.filterSettings.columns =
                    this.actualData.length <= 1 ? this.checkboxPrevFilterObject : this.checkboxFilterObject;
                  this.actualPredicate[this.column.field] = this.filterSettings.columns;
                  var o = this.parent.getColumnByField(this.column.field);
                  var l = this.parent.showColumnMenu && o.showColumnMenu ? '.e-columnmenu' : '.e-icon-filter';
                  var h = this.parent.getColumnHeaderByField(this.column.field).querySelector(l);
                  this.checkboxPrevFilterObject.length === 0
                    ? h.classList.remove('e-filtered')
                    : h.classList.add('e-filtered');
                } else
                  u(this.prevFilterObject)
                    ? this.filterSettings.columns.splice(this.filterSettings.columns.length - 1, 1)
                    : (this.filterSettings.columns[this.filterObjIndex] = this.prevFilterObject);
                return;
              }
              this.updateFilterIcon();
              this.refreshFilterSettings();
              this.updateFilterMsg();
              this.updateFilter();
            }
            break;
          case 'showFilterBarStatus':
            e.properties['' + i[t]]
              ? this.updateFilterMsg()
              : this.parent.allowPaging && this.parent.updateExternalMessage('');
            break;
          case 'showFilterBarOperator':
          case 'type':
            {
              this.parent.refreshHeader();
              this.refreshFilterSettings();
              if (this.parent.height === '100%') {
                this.parent.scrollModule.refresh();
              }
            }
            break;
        }
      }
  };
  s.prototype.refreshFilterSettings = function () {
    if (this.filterSettings.type === 'FilterBar') {
      for (var e = 0; e < this.filterSettings.columns.length; e++) {
        this.column = this.parent.grabColumnByUidFromAllCols(
          this.filterSettings.columns[parseInt(e.toString(), 10)].uid,
        );
        var t = this.filterSettings.columns[parseInt(e.toString(), 10)].value;
        t = !u(t) && t.toString();
        if (!u(this.column.format)) this.applyColumnFormat(t);
        else {
          var i = this.filterSettings.columns[parseInt(e.toString(), 10)].field;
          this.values['' + this.filterSettings.columns[parseInt(e.toString(), 10)].field] =
            this.filterSettings.columns[parseInt(e.toString(), 10)].value;
        }
        var r = this.getFilterBarElement(this.column.field);
        if (r) {
          this.cellText[this.filterSettings.columns[parseInt(e.toString(), 10)].field] !== '' &&
          !u(this.cellText[this.filterSettings.columns[parseInt(e.toString(), 10)].field])
            ? (r.value = this.cellText[this.column.field])
            : (r.value = this.filterSettings.columns[parseInt(e.toString(), 10)].value);
        }
        var n = {
          isnull: 'IsNull',
          isnotnull: 'NotNull',
          isnotempty: 'IsNotEmpty',
          isempty: 'IsEmpty',
        };
        var a = ['isnull', 'isnotnull', 'isempty', 'isnotempty'];
        if (
          r &&
          this.filterSettings.showFilterBarOperator &&
          a.indexOf(this.filterSettings.columns[parseInt(e.toString(), 10)].operator) > -1
        ) {
          r.value = this.l10n.getConstant(n[this.filterSettings.columns[parseInt(e.toString(), 10)].operator]);
        }
      }
      if (this.filterSettings.columns.length === 0)
        for (var o = this.parent.getColumns(), e = 0; e < o.length; e++) {
          var r = this.getFilterBarElement(o[parseInt(e.toString(), 10)].field);
          if (r && r.value !== '') {
            r.value = '';
            delete this.values[o[parseInt(e.toString(), 10)].field];
          }
        }
    }
  };
  s.prototype.updateFilterIcon = function () {
    if (this.filterSettings.columns.length === 0 && this.parent.element.querySelector('.e-filtered'))
      for (
        var e = [].slice.call(this.parent.element.getElementsByClassName('e-filtered')), t = 0, i = e.length;
        t < i;
        t++
      )
        e[parseInt(t.toString(), 10)].classList.remove('e-filtered');
  };
  s.prototype.getFilterBarElement = function (e) {
    var t = "[id='" + e + "_filterBarcell']";
    var i;
    if (t && !u(this.element)) {
      i = this.element.querySelector(t);
    }
    return i;
  };
  s.prototype.refreshFilter = function () {
    this.refreshFilterSettings();
    this.updateFilterMsg();
  };
  s.prototype.clearFiltering = function (e) {
    var t = this;
    var i = Qr(this.filterSettings.columns);
    this.isFilterCleared = true;
    if (!u(e)) {
      this.refresh = false;
      e.forEach(function (h) {
        t.removeFilteredColsByField(h, false);
      });
      this.parent.setProperties({ filterSettings: { columns: this.filterSettings.columns } }, true);
      this.parent.renderModule.refresh();
      this.refresh = true;
      return;
    }
    if (qe(this.parent)) {
      this.parent.notify(ye, {
        instance: this,
        handler: this.clearFiltering,
      });
      return;
    }
    for (var r = 0; r < i.length; r++)
      i[parseInt(r.toString(), 10)].uid =
        i[parseInt(r.toString(), 10)].uid || this.parent.getColumnByField(i[parseInt(r.toString(), 10)].field).uid;
    var n = i.map(function (h) {
      return h.uid;
    });
    var a = n.filter(function (h, d) {
      return n.indexOf(h) === d;
    });
    this.refresh = false;
    for (var r = 0, o = a.length; r < o; r++)
      this.removeFilteredColsByField(this.parent.getColumnByUid(a[parseInt(r.toString(), 10)]).field, false);
    this.refresh = true;
    if (a.length) {
      this.parent.renderModule.refresh();
    }
    if (this.parent.filterSettings.columns.length === 0 && this.parent.element.querySelector('.e-filtered'))
      for (
        var l = [].slice.call(this.parent.element.getElementsByClassName('e-filtered')), r = 0, o = l.length;
        r < o;
        r++
      )
        l[0].classList.remove('e-filtered');
    this.isRemove = true;
    this.filterStatusMsg = '';
    this.updateFilterMsg();
  };
  s.prototype.checkAlreadyColFiltered = function (e) {
    for (var t = this.filterSettings.columns, i = 0, r = t; i < r.length; i++) {
      var n = r[i];
      if (
        r[i].field === e &&
        this.parent.filterSettings.type === 'Menu' &&
        (r[i].type === 'date' || r[i].type === 'datetime')
      )
        return (
          this.checkDateColumnValue(r[i].value, this.value) &&
          r[i].operator === this.operator &&
          r[i].predicate === this.predicate
        );
      if (
        r[i].field === e &&
        r[i].value === this.value &&
        r[i].operator === this.operator &&
        r[i].predicate === this.predicate
      )
        return true;
    }
    return false;
  };
  s.prototype.checkDateColumnValue = function (e, t) {
    return u(e) && u(t) ? true : e instanceof Date && t instanceof Date ? e.getTime() === t.getTime() : false;
  };
  s.prototype.columnMenuFilter = function (e) {
    this.column = e.col;
    var t = T(e.target, '#' + e.id);
    e.isClose && !t ? this.filterModule.closeDialog() : t && this.filterDialogOpen(this.column, e.target);
  };
  s.prototype.filterDialogOpen = function (e, t, i, r) {
    if (this.filterModule) {
      this.filterModule.isresetFocus = false;
      this.filterModule.closeDialog();
    }
    this.setFilterModel(e);
    this.filterModule.openDialog(this.createOptions(e, t, i, r));
  };
  s.prototype.createOptions = function (e, t, i, r) {
    var n = this.parent;
    var a =
      e.filter.dataSource || (this.parent.dataSource && 'result' in this.parent.dataSource)
        ? this.parent.dataSource
        : this.parent.getDataModule().dataManager;
    var o = e.filter.type || this.parent.filterSettings.type;
    var l = {
      type: e.type,
      field: e.field,
      displayName: e.headerText,
      dataSource: a,
      format: e.format,
      height: 800,
      columns: this.parent.getColumns(),
      filteredColumns: this.parent.filterSettings.columns,
      target: t,
      dataManager: this.parent.getDataModule().dataManager,
      formatFn: e.getFormatter(),
      ignoreAccent: this.parent.filterSettings.ignoreAccent,
      parserFn: e.getParser(),
      query: this.parent.query,
      template: e.getFilterItemTemplate(),
      hideSearchbox: u(e.filter.hideSearchbox) ? false : e.filter.hideSearchbox,
      handler: this.filterHandler.bind(this),
      localizedStrings: this.parent.getLocaleConstants(),
      position: {
        X: i,
        Y: r,
      },
      column: e,
      foreignKeyValue: e.foreignKeyValue,
      actualPredicate: this.actualPredicate,
      localeObj: this.parent.localeObj,
      isRemote: this.parent.getDataModule().isRemote(),
      allowCaseSensitive: this.filterSettings.enableCaseSensitivity,
      isResponsiveFilter: this.parent.enableAdaptiveUI,
      operator: this.actualPredicate[e.field] && o === 'Menu' ? this.actualPredicate[e.field][0].operator : 'equal',
      parentTotalDataCount:
        this.parent.getDataModule().isRemote() && this.parent.allowPaging
          ? this.parent.pagerModule.pagerObj.totalRecordsCount
          : this.parent.getDataModule().isRemote()
            ? this.parent.totalDataRecordsCount
            : this.parent.getFilteredRecords().length,
      parentCurrentViewDataCount: this.parent.currentViewData.length,
      parentFilteredLocalRecords: this.parent.getDataModule().isRemote() ? [] : this.parent.getFilteredRecords(),
    };
    return l;
  };
  s.prototype.removeFilteredColsByField = function (e, t) {
    var i;
    var r = this.filterSettings.columns;
    if (qe(this.parent)) {
      var n = {
        instance: this,
        handler: this.removeFilteredColsByField,
        arg1: e,
        arg2: t,
      };
      this.parent.notify(ye, n);
      return;
    }
    var a = r.map(function (g) {
      return g.uid;
    });
    var o = a.filter(function (g, m) {
      return a.indexOf(g) === m;
    });
    if (!u(this.column)) {
      var l = this.column.isForeignColumn()
        ? this.parent.getColumnByUid(this.column.uid)
        : this.parent.getColumnByField(e);
      this.filterObjIndex = this.getFilteredColsIndexByField(l);
      this.prevFilterObject = this.filterSettings.columns[this.filterObjIndex];
    }
    for (
      var h = function (g, m) {
          r[parseInt(g.toString(), 10)].uid =
            r[parseInt(g.toString(), 10)].uid || d.parent.getColumnByField(r[parseInt(g.toString(), 10)].field).uid;
          var y = r.length;
          var v = d.parent.grabColumnByUidFromAllCols(o[parseInt(g.toString(), 10)]);
          if (v.field === e || (v.field === v.foreignKeyValue && v.isForeignColumn())) {
            var b = d.filterSettings.columns.filter(function (x) {
              return x.uid === v.uid;
            })[0];
            if (d.filterSettings.type === 'FilterBar' && !t) {
              var w = "[id='" + v.field + "_filterBarcell']";
              i = d.parent.getHeaderContent().querySelector(w);
              if (i) {
                i.value = '';
                delete d.values['' + e];
              }
            }
            for (; y--; )
              if (r[parseInt(y.toString(), 10)].uid === v.uid) {
                r.splice(y, 1);
              }
            var C = d.parent.getColumnHeaderByField(v.field);
            if (d.filterSettings.type !== 'FilterBar' || d.parent.showColumnMenu) {
              var I = d.parent.showColumnMenu && v.showColumnMenu ? '.e-columnmenu' : '.e-icon-filter';
              C.querySelector(I).classList.remove('e-filtered');
            }
            d.isRemove = true;
            if (d.actualPredicate['' + e]) {
              delete d.actualPredicate['' + e];
            }
            if (d.values['' + e]) {
              delete d.values['' + e];
            }
            if (d.refresh) {
              d.parent.notify(ee, {
                requestType: 'filtering',
                type: _,
                currentFilterObject: d.filterSettings.columns.filter(function (x) {
                  return x.uid === v.uid;
                })[0],
                currentFilterColumn: v,
                action: 'clearFilter',
              });
            }
            return 'break';
          }
        },
        d = this,
        p = 0,
        c = o.length;
      p < c;
      p++
    ) {
      var f = h(p);
      if (f === 'break') break;
    }
    this.updateFilterMsg();
  };
  s.prototype.getModuleName = function () {
    return 'filter';
  };
  s.prototype.keyUpHandlerImmediate = function (e) {
    if (e.keyCode !== 13) {
      this.keyUpHandler(e);
    }
  };
  s.prototype.keyUpHandler = function (e) {
    var t = this.parent;
    var i = e.target;
    if (e.target && os(e.target, '.e-filterbar input')) {
      var r = T(e.target, 'th.e-filterbarcell');
      this.column = this.parent.getColumnByUid(r.getAttribute('data-mappinguid'));
      if (!this.column) return;
      if (e.action === 'altDownArrow' && this.parent.filterSettings.showFilterBarOperator) {
        var n = T(e.target, 'span').querySelector('.e-filterbaroperator');
        n.ej2_instances[0].showPopup();
        n.focus();
      }
      if (
        (this.filterSettings.mode === 'Immediate' ||
          (e.keyCode === 13 && !e.target.classList.contains('e-filterbaroperator'))) &&
        e.keyCode !== 9 &&
        !this.column.filterTemplate
      ) {
        this.value = e.target.value.trim();
        this.processFilter(e);
      }
    }
    if (
      e.action === 'altDownArrow' &&
      this.filterSettings.type !== 'FilterBar' &&
      !S(e.target, 'e-toolbar') &&
      u(this.parent.element.querySelector('.e-filter-popup')) &&
      !this.parent.enableAdaptiveUI
    ) {
      var a = this.parent.focusModule.currentInfo.element;
      if (
        this.parent.focusModule.currentInfo.element &&
        this.parent.focusModule.currentInfo.element.classList.contains('e-headercell') &&
        !this.parent.focusModule.currentInfo.element.classList.contains('e-stackedheadercell')
      ) {
        var o = this.parent.getColumnByUid(
          this.parent.focusModule.currentInfo.element.firstElementChild.getAttribute('data-mappinguid'),
        );
        this.openMenuByField(o.field);
        this.parent.focusModule.clearIndicator();
      }
    }
    if (e.action === 'escape' && this.filterSettings.type === 'Menu' && this.filterModule) {
      if (this.parent.showColumnMenu && this.filterModule.isDialogOpen) {
        this.parent.isColumnMenuFilterClosing = true;
      }
      this.filterModule.closeDialog();
      this.parent.notify(vt, {});
      if (!this.parent.showColumnMenu) {
        this.parent.notify(vt, {});
      }
    }
  };
  s.prototype.updateCrossIcon = function (e) {
    if (e.value.length) {
      e.nextElementSibling.classList.remove('e-hide');
    }
  };
  s.prototype.updateFilterMsg = function () {
    if (this.filterSettings.type === 'FilterBar') {
      var e = this.parent;
      var t = void 0;
      var i = this.filterSettings.columns;
      var r = void 0;
      if (!this.filterSettings.showFilterBarStatus) return;
      if (
        this.filterSettings.columns.length > 0 &&
        this.filterStatusMsg !== this.l10n.getConstant('InvalidFilterMessage')
      ) {
        this.filterStatusMsg = '';
        for (var n = 0; n < this.filterSettings.columns.length; n++) {
          r =
            this.parent.grabColumnByUidFromAllCols(this.filterSettings.columns[parseInt(n.toString(), 10)].uid) ||
            this.parent.grabColumnByFieldFromAllCols(
              this.filterSettings.columns[parseInt(n.toString(), 10)].field,
              this.filterSettings.columns[parseInt(n.toString(), 10)].isForeignKey,
            );
          if (n) {
            this.filterStatusMsg += ' && ';
          }
          if (u(r.format)) this.filterStatusMsg += r.headerText + ': ' + this.values[r.field];
          else {
            var a =
              r.type === 'date' || r.type === 'datetime' || r.type === 'dateonly'
                ? this.valueFormatter.fromView(
                    this.values[r.field],
                    r.getParser(),
                    r.type === 'dateonly' ? 'date' : r.type,
                  )
                : this.values[r.field];
            if (r.type === 'date' || r.type === 'datetime' || r.type === 'dateonly')
              t = this.setFormatForFlColumn(a, r);
            else {
              var o = this.serviceLocator.getService('valueFormatter');
              t = o.toView(a, r.getParser()).toString();
            }
            this.filterStatusMsg += r.headerText + ': ' + t;
          }
        }
      }
      if (this.parent.allowPaging) {
        this.parent.updateExternalMessage(this.filterStatusMsg);
        if (this.parent.height === '100%') {
          this.parent.scrollModule.refresh();
        }
      }
      this.filterStatusMsg = '';
    }
  };
  s.prototype.setFormatForFlColumn = function (e, t) {
    var i = this.serviceLocator.getService('valueFormatter');
    var r = i.toView(e, t.getFormatter());
    return u(r) ? r : r.toString();
  };
  s.prototype.checkForSkipInput = function (e, t) {
    var i;
    if (e.type === 'number')
      if (le.operatorSymbols['' + t] || this.skipNumberInput.indexOf(t) > -1) {
        i = true;
      } else if (e.type === 'string')
        for (var r = 0, n = t; r < n.length; r++) {
          var a = n[r];
          if (this.skipStringInput.indexOf(n[r]) > -1) {
            i = true;
          }
        }
    return i;
  };
  s.prototype.processFilter = function (e) {
    this.stopTimer();
    this.startTimer(e);
  };
  s.prototype.startTimer = function (e) {
    var t = this;
    this.timer = window.setInterval(
      function () {
        t.onTimerTick();
      },
      e.keyCode === 13 ? 0 : this.filterSettings.immediateModeDelay,
    );
  };
  s.prototype.stopTimer = function () {
    window.clearInterval(this.timer);
  };
  s.prototype.onTimerTick = function () {
    var e = "[id='" + this.column.field + "_filterBarcell']";
    var t = this.element.querySelector(e);
    if (!t) {
      t = this.parent.getHeaderContent().querySelector(e);
    }
    var i;
    this.cellText[this.column.field] = t.value;
    this.stopTimer();
    if (u(this.column.filterBarTemplate)) i = JSON.parse(JSON.stringify(t.value));
    else {
      var r = this.column.filterBarTemplate.read;
      if (typeof r == 'string') {
        r = re(r, window);
      }
      if (!u(r)) {
        this.value = r(t);
      }
    }
    if (u(this.value) || this.value === '') {
      this.removeFilteredColsByField(this.column.field);
      return;
    }
    this.validateFilterValue(this.value);
    this.filterByMethod = false;
    this.filterByColumn(
      this.column.field,
      this.operator,
      this.value,
      this.predicate,
      this.filterSettings.enableCaseSensitivity,
      this.ignoreAccent,
      this.column.isForeignColumn(),
    );
    this.filterByMethod = true;
    t.value = i;
    this.updateFilterMsg();
  };
  s.prototype.validateFilterValue = function (e) {
    var t;
    var i;
    switch (((this.matchCase = this.filterSettings.enableCaseSensitivity), this.column.type)) {
      case 'number':
        {
          this.column.filter.operator
            ? (this.operator = this.column.filter.operator)
            : (this.operator = this.filterOperators.equal);
          t = ['>', '<', '=', '!'];
        }
        for (var r = 0; r < e.length; r++)
          if (t.indexOf(e[parseInt(r.toString(), 10)]) > -1) {
            i = r;
            break;
          }
        {
          this.getOperator(e.substring(i));
          if (i !== 0) {
            this.value = e.substring(0, i);
          }
          if (this.value !== '' && e.length >= 1) {
            this.value = this.valueFormatter.fromView(this.value, this.column.getParser(), this.column.type);
          }
          if (isNaN(this.value)) {
            this.filterStatusMsg = this.l10n.getConstant('InvalidFilterMessage');
          }
        }
        break;
      case 'date':
      case 'datetime':
        {
          this.operator = this.filterOperators.equal;
          if (this.value !== '' && !(this.value instanceof Date)) {
            this.getOperator(e);
            this.value = this.valueFormatter.fromView(this.value, this.column.getParser(), this.column.type);
            if (u(this.value)) {
              this.filterStatusMsg = this.l10n.getConstant('InvalidFilterMessage');
            }
          }
        }
        break;
      case 'string':
        {
          this.matchCase = false;
          this.column.filter.operator
            ? (this.operator = this.column.filter.operator)
            : e.indexOf('*') !== -1 || e.indexOf('?') !== -1 || e.indexOf('%3f') !== -1
              ? (this.operator = this.filterOperators.wildCard)
              : e.indexOf('%') !== -1
                ? (this.operator = this.filterOperators.like)
                : (this.operator = this.filterOperators.startsWith);
        }
        break;
      case 'boolean':
        {
          e.toLowerCase() === 'true' || e === '1'
            ? (this.value = true)
            : e.toLowerCase() === 'false' || e === '0'
              ? (this.value = false)
              : e.length && (this.filterStatusMsg = this.l10n.getConstant('InvalidFilterMessage'));
          this.operator = this.filterOperators.equal;
        }
        break;
      default:
        this.column.filter.operator
          ? (this.operator = this.column.filter.operator)
          : (this.operator = this.filterOperators.equal);
    }
  };
  s.prototype.getOperator = function (e) {
    var t = e.charAt(0);
    var i = e.slice(0, 2);
    var r = E(
      {
        '=': this.filterOperators.equal,
        '!': this.filterOperators.notEqual,
      },
      le.operatorSymbols,
    );
    if (r.hasOwnProperty(t) || r.hasOwnProperty(i)) {
      this.operator = r['' + t];
      this.value = e.substring(1);
      if (!this.operator) {
        this.operator = r['' + i];
        this.value = e.substring(2);
      }
    }
    if (
      (this.operator === this.filterOperators.lessThan || this.operator === this.filterOperators.greaterThan) &&
      this.value.charAt(0) === '='
    ) {
      this.operator = this.operator + 'orequal';
      this.value = this.value.substring(1);
    }
  };
  s.prototype.columnPositionChanged = function () {
    this.parent.filterSettings.type;
  };
  s.prototype.getLocalizedCustomOperators = function () {
    var e = [
      {
        value: 'equal',
        text: this.l10n.getConstant('Equal'),
      },
      {
        value: 'greaterthan',
        text: this.l10n.getConstant('GreaterThan'),
      },
      {
        value: 'greaterthanorequal',
        text: this.l10n.getConstant('GreaterThanOrEqual'),
      },
      {
        value: 'lessthan',
        text: this.l10n.getConstant('LessThan'),
      },
      {
        value: 'lessthanorequal',
        text: this.l10n.getConstant('LessThanOrEqual'),
      },
      {
        value: 'notequal',
        text: this.l10n.getConstant('NotEqual'),
      },
      {
        value: 'isnull',
        text: this.l10n.getConstant('IsNull'),
      },
      {
        value: 'isnotnull',
        text: this.l10n.getConstant('NotNull'),
      },
    ];
    this.customOperators = {
      stringOperator: [
        {
          value: 'startswith',
          text: this.l10n.getConstant('StartsWith'),
        },
        {
          value: 'endswith',
          text: this.l10n.getConstant('EndsWith'),
        },
        {
          value: 'contains',
          text: this.l10n.getConstant('Contains'),
        },
        {
          value: 'equal',
          text: this.l10n.getConstant('Equal'),
        },
        {
          value: 'isempty',
          text: this.l10n.getConstant('IsEmpty'),
        },
        {
          value: 'doesnotstartwith',
          text: this.l10n.getConstant('NotStartsWith'),
        },
        {
          value: 'doesnotendwith',
          text: this.l10n.getConstant('NotEndsWith'),
        },
        {
          value: 'doesnotcontain',
          text: this.l10n.getConstant('NotContains'),
        },
        {
          value: 'notequal',
          text: this.l10n.getConstant('NotEqual'),
        },
        {
          value: 'isnotempty',
          text: this.l10n.getConstant('IsNotEmpty'),
        },
        {
          value: 'like',
          text: this.l10n.getConstant('Like'),
        },
      ],
      numberOperator: e,
      dateOperator: [
        {
          value: 'equal',
          text: this.l10n.getConstant('Equal'),
        },
        {
          value: 'greaterthan',
          text: this.l10n.getConstant('GreaterThan'),
        },
        {
          value: 'greaterthanorequal',
          text: this.l10n.getConstant('GreaterThanOrEqual'),
        },
        {
          value: 'lessthan',
          text: this.l10n.getConstant('LessThan'),
        },
        {
          value: 'lessthanorequal',
          text: this.l10n.getConstant('LessThanOrEqual'),
        },
        {
          value: 'notequal',
          text: this.l10n.getConstant('NotEqual'),
        },
        {
          value: 'isnull',
          text: this.l10n.getConstant('IsNull'),
        },
        {
          value: 'isnotnull',
          text: this.l10n.getConstant('NotNull'),
        },
      ],
      datetimeOperator: [
        {
          value: 'equal',
          text: this.l10n.getConstant('Equal'),
        },
        {
          value: 'greaterthan',
          text: this.l10n.getConstant('GreaterThan'),
        },
        {
          value: 'greaterthanorequal',
          text: this.l10n.getConstant('GreaterThanOrEqual'),
        },
        {
          value: 'lessthan',
          text: this.l10n.getConstant('LessThan'),
        },
        {
          value: 'lessthanorequal',
          text: this.l10n.getConstant('LessThanOrEqual'),
        },
        {
          value: 'notequal',
          text: this.l10n.getConstant('NotEqual'),
        },
        {
          value: 'isnull',
          text: this.l10n.getConstant('IsNull'),
        },
        {
          value: 'isnotnull',
          text: this.l10n.getConstant('NotNull'),
        },
      ],
      dateonlyOperator: [
        {
          value: 'equal',
          text: this.l10n.getConstant('Equal'),
        },
        {
          value: 'greaterthan',
          text: this.l10n.getConstant('GreaterThan'),
        },
        {
          value: 'greaterthanorequal',
          text: this.l10n.getConstant('GreaterThanOrEqual'),
        },
        {
          value: 'lessthan',
          text: this.l10n.getConstant('LessThan'),
        },
        {
          value: 'lessthanorequal',
          text: this.l10n.getConstant('LessThanOrEqual'),
        },
        {
          value: 'notequal',
          text: this.l10n.getConstant('NotEqual'),
        },
        {
          value: 'isnull',
          text: this.l10n.getConstant('IsNull'),
        },
        {
          value: 'isnotnull',
          text: this.l10n.getConstant('NotNull'),
        },
      ],
      booleanOperator: [
        {
          value: 'equal',
          text: this.l10n.getConstant('Equal'),
        },
        {
          value: 'notequal',
          text: this.l10n.getConstant('NotEqual'),
        },
      ],
    };
    if (this.filterSettings.type === 'Menu') {
      this.customOperators.stringOperator.push(
        {
          value: 'in',
          text: this.l10n.getConstant('In'),
        },
        {
          value: 'notin',
          text: this.l10n.getConstant('NotIn'),
        },
      );
      this.customOperators.booleanOperator.push(
        {
          value: 'in',
          text: this.l10n.getConstant('In'),
        },
        {
          value: 'notin',
          text: this.l10n.getConstant('NotIn'),
        },
      );
      this.customOperators.numberOperator.push(
        {
          value: 'in',
          text: this.l10n.getConstant('In'),
        },
        {
          value: 'notin',
          text: this.l10n.getConstant('NotIn'),
        },
      );
    }
  };
  s.prototype.openMenuByField = function (e) {
    var t = this.parent;
    if (this.parent.enableAdaptiveUI) {
      this.showCustomFilter(false);
      return;
    }
    var i = this.parent.getColumnByField(e);
    var r = this.parent.getColumnHeaderByField(e);
    var n = r.querySelector('.e-filtermenudiv');
    if (n) {
      var a = this.parent.element.getBoundingClientRect();
      var o = n.getBoundingClientRect();
      this.filterDialogOpen(i, n, o.right - a.left, o.bottom - a.top);
    }
  };
  s.prototype.filterIconClickHandler = function (e) {
    var t = e.target;
    if (
      e.target.classList.contains('e-filtermenudiv') &&
      (this.parent.filterSettings.type === 'Menu' ||
        this.parent.filterSettings.type === 'CheckBox' ||
        this.parent.filterSettings.type === 'Excel')
    ) {
      var i = this.parent;
      var r = this.parent.getColumnByUid(S(e.target, 'e-headercell').firstElementChild.getAttribute('data-mappinguid'));
      this.column = r;
      if (this.fltrDlgDetails.field === r.field && this.fltrDlgDetails.isOpen) return;
      if (this.filterModule) {
        this.filterModule.closeDialog();
      }
      this.fltrDlgDetails = {
        field: r.field,
        isOpen: true,
      };
      this.openMenuByField(r.field);
    }
  };
  s.prototype.clickHandler = function (e) {
    if (this.filterSettings.type === 'FilterBar' && this.filterSettings.showFilterBarOperator) {
      if (S(e.target, 'e-filterbarcell') && e.target.classList.contains('e-input-group-icon')) {
        var t = T(e.target, 'div').querySelector('.e-filterbaroperator');
        t ? t.focus() : e.target.focus();
      }
      if (e.target.classList.contains('e-list-item')) {
        var i = document.querySelector('.e-popup-open').getAttribute('id').replace('_popup', '');
        if (i.indexOf('grid-column') !== -1) {
          T(document.getElementById(i), 'div').querySelector('.e-filtertext').focus();
        }
      }
    }
    if (
      this.filterSettings.mode === 'Immediate' ||
      this.parent.filterSettings.type === 'Menu' ||
      this.parent.filterSettings.type === 'CheckBox' ||
      this.parent.filterSettings.type === 'Excel'
    ) {
      var r = e.target;
      var n = e.target.classList.contains('e-day');
      var a = S(this.parent.element, 'e-dialog');
      var o = false;
      var l = S(e.target, 'e-popup');
      var h = document.getElementById(this.parent.element.id + '_e-popup');
      var d = this.parent.element.classList.contains('e-device')
        ? document.querySelector('.e-filter-popup')
        : h && h.querySelector('.e-filter-popup')
          ? h.querySelector('.e-filter-popup')
          : this.parent.element.querySelector('.e-filter-popup');
      if (a && l) {
        o = a.id === l.id;
      }
      if (this.filterModule && d && (S(e.target, 'e-excel-ascending') || S(e.target, 'e-excel-descending'))) {
        this.filterModule.closeDialog(e.target);
      }
      if (S(e.target, 'e-filter-popup') || e.target.classList.contains('e-filtermenudiv')) return;
      if (
        this.filterModule &&
        !S(e.target, 'e-date-overflow') &&
        !S(e.target, 'e-popup-wrapper') &&
        !T(e.target, '.e-filter-item.e-menu-item') &&
        !n &&
        !(S(e.target, 'e-search-wrapper') && !d) &&
        ((o && !S(e.target, 'e-filter-popup') && !S(e.target, 'e-popup-flmenu')) || (!l && d))
      ) {
        this.filterModule.isresetFocus =
          S(e.target, 'e-grid') &&
          S(e.target, 'e-grid').id === this.parent.element.id &&
          !(S(e.target, 'e-search-wrapper') && d);
        this.filterModule.closeDialog(e.target);
      }
    }
  };
  s.prototype.filterHandler = function (e) {
    this.actualPredicate[e.field] = e.actualPredicate;
    this.actualData = Object.keys(this.actualPredicate);
    var t = new H(this.filterSettings.columns);
    var i = new ue().where('field', this.filterOperators.equal, e.field);
    this.checkboxFilterObject = t.dataSource.json;
    this.checkboxPrevFilterObject = t.executeLocal(i);
    for (var r = 0; r < this.checkboxPrevFilterObject.length; r++) {
      for (var n = -1, a = 0; a < this.filterSettings.columns.length; a++)
        if (
          this.checkboxPrevFilterObject[parseInt(r.toString(), 10)].field ===
          this.filterSettings.columns[parseInt(a.toString(), 10)].field
        ) {
          n = a;
          break;
        }
      if (n !== -1) {
        this.filterSettings.columns.splice(n, 1);
      }
    }
    if (this.values[e.field]) {
      delete this.values[e.field];
    }
    var o = this.parent.getColumnByField(e.field);
    var l = this.parent.showColumnMenu && o.showColumnMenu ? '.e-columnmenu' : '.e-icon-filter';
    var h = this.parent.getColumnHeaderByField(e.field).querySelector(l);
    e.action === 'filtering'
      ? ((this.filterSettings.columns = this.filterSettings.columns.concat(e.filterCollection)),
        this.filterSettings.columns.length && h && h.classList.add('e-filtered'))
      : (h && h.classList.remove('e-filtered'), (e.requestType = 'filtering'), this.parent.renderModule.refresh(e));
    this.parent.dataBind();
  };
  s.prototype.updateFilter = function () {
    var e = this.filterSettings.columns;
    this.actualPredicate = {};
    for (var t = 0; t < this.filterSettings.columns.length; t++) {
      this.column =
        this.parent.getColumnByField(this.filterSettings.columns[parseInt(t.toString(), 10)].field) ||
        Ki(this.filterSettings.columns[parseInt(t.toString(), 10)].field, this.parent.getForeignKeyColumns());
      var i = this.filterSettings.columns[parseInt(t.toString(), 10)].field;
      if (!this.parent.getColumnByField(this.filterSettings.columns[parseInt(t.toString(), 10)].field)) {
        i = Ki(this.filterSettings.columns[parseInt(t.toString(), 10)].field, this.parent.getForeignKeyColumns()).field;
      }
      this.refreshFilterIcon(
        i,
        this.filterSettings.columns[parseInt(t.toString(), 10)].operator,
        this.filterSettings.columns[parseInt(t.toString(), 10)].value,
        this.filterSettings.columns[parseInt(t.toString(), 10)].type,
        this.filterSettings.columns[parseInt(t.toString(), 10)].predicate,
        this.filterSettings.columns[parseInt(t.toString(), 10)].matchCase,
        this.filterSettings.columns[parseInt(t.toString(), 10)].ignoreAccent,
        this.filterSettings.columns[parseInt(t.toString(), 10)].uid,
      );
    }
  };
  s.prototype.refreshFilterIcon = function (e, t, i, r, n, a, o, l) {
    var h = {
      field: e,
      predicate: n,
      matchCase: a,
      ignoreAccent: o,
      operator: t,
      value: i,
      type: r,
    };
    this.actualPredicate['' + e] ? this.actualPredicate['' + e].push(h) : (this.actualPredicate['' + e] = [h]);
    var d = l ? this.parent.grabColumnByUidFromAllCols(l).field : e;
    this.addFilteredClass(d);
  };
  s.prototype.addFilteredClass = function (e) {
    var t;
    var i = this.parent.getColumnByField(e);
    this.parent.showColumnMenu && i.showColumnMenu
      ? (t = this.parent.getColumnHeaderByField(e).querySelector('.e-columnmenu'))
      : i && (t = this.parent.getColumnHeaderByField(e).querySelector('.e-icon-filter'));
    if (t) {
      t.classList.add('e-filtered');
    }
  };
  s.prototype.getFilterUIInfo = function () {
    return this.filterModule ? this.filterModule.getFilterUIInfo() : {};
  };
  s.prototype.getOperatorName = function (e) {
    return document.getElementById(this.parent.getColumnByField(e).uid).ej2_instances[0].value;
  };
  s.prototype.renderCheckboxOnFilterMenu = function () {
    return this.filterModule.renderCheckBoxMenu();
  };
  return s;
})();
var ge = {
  root: 'e-rhandler',
  suppress: 'e-rsuppress',
  icon: 'e-ricon',
  helper: 'e-rhelper',
  header: 'th.e-headercell',
  cursor: 'e-rcursor',
};
var To = (function () {
  function s(e) {
    this.tapped = false;
    this.isDblClk = true;
    this.resizeProcess = false;
    this.isCancelAutoFit = false;
    this.parent = e;
    if (!this.parent.isDestroyed) {
      this.widthService = new cs(e);
      this.addEventListener();
    }
  }
  s.prototype.autoFitColumns = function (e, t, i) {
    var r = this;
    var n =
      e == null || e.length <= 0
        ? this.parent.getColumns().map(function (a) {
            a.autoFit = true;
            return a.field;
          })
        : typeof e == 'string'
          ? [e]
          : e;
    this.parent.isAutoFitColumns = true;
    !u(e) && typeof e == 'object' && e.length !== 0
      ? e.forEach(function (a) {
          if (r.parent.getColumnByField(a)) {
            r.parent.getColumnByField(a).autoFit = true;
          }
        })
      : typeof e == 'string' && e.trim() !== '' && (this.parent.getColumnByField(e).autoFit = true);
    if (this.parent.enableAdaptiveUI) {
      this.parent.element.classList.add('e-grid-autofit');
    }
    this.findColumn(n, t, i);
  };
  s.prototype.autoFit = function () {
    var e = this.parent.getColumns();
    var t = 0;
    var i = e
      .filter(function (n) {
        if (!u(n.maxWidth)) {
          t++;
        }
        return n.autoFit === true;
      })
      .map(function (n) {
        return n.field || n.headerText;
      });
    if (i.length > 0 && !this.parent.preventAutoFit) {
      this.autoFitColumns(i);
    }
    var r = this.parent.getContentTable();
    this.parent.allowResizing &&
    t &&
    (this.parent.resizeSettings.mode === 'Auto' ||
      (this.parent.resizeSettings.mode === 'Normal' && !this.parent.autoFit && i.length === 0))
      ? this.widthService.setWidthToTable(r.style.width.indexOf('px') === -1)
      : this.parent.autoFit && this.parent.resizeSettings.mode === 'Auto' && this.widthService.setWidthToTable();
    if (r.style.width.indexOf('px') !== -1 && r.getBoundingClientRect().width < r.parentElement.clientWidth) {
      j([this.parent.getHeaderTable(), r], ['e-tableborder']);
    }
  };
  s.prototype.getCellElementsByColumnIndex = function (e) {
    return this.parent.frozenRows
      ? [].slice
          .call(
            this.parent
              .getHeaderTable()
              .querySelectorAll('td.e-rowcell:nth-child(' + (e + 1) + '):not(.e-groupcaption):not(.e-detailcell)'),
          )
          .concat(
            [].slice.call(
              this.parent
                .getContentTable()
                .querySelectorAll('td.e-rowcell:nth-child(' + (e + 1) + '):not(.e-groupcaption):not(.e-detailcell)'),
            ),
          )
      : [].slice.call(
          this.parent
            .getContentTable()
            .querySelectorAll('td.e-rowcell:nth-child(' + (e + 1) + '):not(.e-groupcaption):not(.e-detailcell)'),
        );
  };
  s.prototype.resizeColumn = function (e, t, i, r, n) {
    var a = this.parent;
    var o = 0;
    var l = this.parent.getHeaderTable();
    var h = this.parent.getContentTable();
    var d;
    var p = 'e-gridheader';
    var c = pe;
    var f = qt;
    var g = 0;
    var m = i || this.parent.getUidByColumnField(e);
    var y = this.parent.getNormalizedColumnIndex(m);
    var v = l.querySelector('[data-mappinguid="' + m + '"]').parentElement.cloneNode(true);
    var b = this.getCellElementsByColumnIndex(y);
    var w;
    var C = this.parent.getColumnIndexByField(e);
    if (!u(this.parent.getFooterContent())) {
      d = this.parent.getFooterContentTable();
    }
    if (d) {
      w = d.querySelectorAll('td:nth-child(' + (y + 1) + '):not(.e-groupcaption)');
    }
    var I = [].slice.call(l.querySelector('tr').getElementsByClassName('e-grouptopleftcell'));
    if (I.length > 0) for (var x = 0; x < I.length; x++) g += I[parseInt(x.toString(), 10)].offsetWidth;
    var O = h.querySelector('.e-detailrowcollapse') || h.querySelector('.e-detailrowexpand');
    if ((this.parent.detailTemplate || this.parent.childGrid) && O) {
      g += O.offsetWidth;
    }
    var A = [v];
    var k = [];
    var F = [];
    if (d)
      for (var x = 0; x < w.length; x++) F[parseInt(x.toString(), 10)] = w[parseInt(x.toString(), 10)].cloneNode(true);
    for (var x = 0; x < b.length; x++) k[parseInt(x.toString(), 10)] = b[parseInt(x.toString(), 10)].cloneNode(true);
    var D = this.createTable(l, A, 'e-gridheader');
    var L = null;
    var K = null;
    if (this.parent.getCurrentViewRecords().length) {
      K = this.createTable(h, k, pe, r, n);
    }
    if (F.length) {
      L = this.createTable(d, F, qt);
    }
    var V = this.parent.getColumns()[parseInt(C.toString(), 10)];
    var W = (V.width = xe(Math.max(D, K, L)));
    var J = V.maxWidth && parseFloat(V.maxWidth.toString());
    if (parseInt(W, 10) > J) {
      V.width = J;
    }
    this.widthService.setColumnWidth(this.parent.getColumns()[parseInt(C.toString(), 10)]);
    var we = this.parent.getColumns().some(function (Xe) {
      return (
        (Xe.visible || this.parent.groupSettings.columns.length) &&
        (Xe.width === null || Xe.width === void 0 || Xe.width.length <= 0)
      );
    });
    if (we === false)
      for (var he = this.parent.getColumns(), x = 0; x < he.length; x++)
        if (he[parseInt(x.toString(), 10)].visible) {
          o = o + parseFloat(he[parseInt(x.toString(), 10)].width);
        }
    var Be = o + g;
    if (o > 0) {
      if (this.parent.detailTemplate || this.parent.childGrid) {
        this.widthService.setColumnWidth(new ut({ width: '30px' }));
      }
      if (this.parent.resizeSettings.mode === 'Auto') {
        Be = '100%';
      }
      l.style.width = xe(Be);
      h.style.width = xe(Be);
      if (!u(d)) {
        d.style.width = xe(Be);
      }
    }
    if (this.parent.isFrozenGrid() && this.parent.enableColumnVirtualization) {
      this.widthService.refreshFrozenScrollbar();
    }
    var $e = l.offsetWidth;
    var Ae = h.parentElement.scrollWidth;
    h.parentElement.scrollWidth > l.offsetWidth
      ? (u(h.querySelector('.e-emptyrow'))
          ? j([l, h], ['e-tableborder'])
          : (j([l], ['e-tableborder']), Q([h], ['e-tableborder'])),
        Q([this.parent.element], ['e-left-shadow', 'e-right-shadow']))
      : (Q([l, h], ['e-tableborder']),
        this.parent.getVisibleFrozenRightCount() && j([this.parent.element], 'e-right-shadow'));
    if (!u(d)) {
      d.classList.add('e-tableborder');
    }
  };
  s.prototype.destroy = function () {
    var e = this.parent.element;
    if (
      !(
        !this.parent.element ||
        (!this.parent.element.querySelector('.' + Oe) && !this.parent.element.querySelector('.' + pe))
      )
    ) {
      this.widthService = null;
      this.unwireEvents();
      this.removeEventListener();
    }
  };
  s.prototype.getModuleName = function () {
    return 'resize';
  };
  s.prototype.findColumn = function (e, t, i) {
    for (var r = 0; r < e.length; r++) {
      var n = e[parseInt(r.toString(), 10)];
      var a = this.parent.getColumnIndexByField(e[parseInt(r.toString(), 10)]);
      var o = this.parent.getColumns()[parseInt(a.toString(), 10)];
      if (
        a > -1 &&
        !u(this.parent.getColumns()[parseInt(a.toString(), 10)]) &&
        this.parent.getColumns()[parseInt(a.toString(), 10)].visible === true
      ) {
        this.resizeColumn(e[parseInt(r.toString(), 10)], a, null, t, i);
      }
    }
    if (this.parent.allowTextWrap) {
      this.parent.notify(ki, {
        case: 'refreshHeight',
        isModeChg: true,
      });
    }
    if (this.parent.isFrozenGrid()) {
      this.refreshResizefrzCols(true, true);
    }
  };
  s.prototype.createTable = function (e, t, i, r, n) {
    if (r === void 0) {
      r = 1;
    }
    if (n === void 0) {
      n = t.length;
    }
    if (r > n) {
      r ^= n;
      n ^= r;
      r ^= n;
    }
    var a = this.parent.createElement('div');
    var o = this.parent.enableAdaptiveUI ? ' e-bigger' : '';
    a.className = this.parent.element.className + o;
    a.style.cssText = 'display: inline-block;visibility:hidden;position:absolute';
    var l = this.parent.createElement('div');
    l.className = i;
    var h = this.parent.createElement('table', { attrs: { role: 'grid' } });
    h.className = e.className;
    h.classList.add('e-resizetable');
    h.style.cssText = 'table-layout: auto;width: auto';
    for (var d = this.parent.createElement('tr'), p = r <= 0 ? 1 : r; p <= (n > t.length ? t.length : n); p++) {
      var c = d.cloneNode();
      c.className = e.querySelector('tr').className;
      c.appendChild(t[parseInt((p - 1).toString(), 10)]);
      h.appendChild(c);
    }
    l.appendChild(h);
    a.appendChild(l);
    document.body.appendChild(a);
    var f = h.getBoundingClientRect().width;
    document.body.removeChild(a);
    return Math.ceil(h.getBoundingClientRect().width);
  };
  s.prototype.addEventListener = function () {
    if (!this.parent.isDestroyed) {
      this.parent.on(We, this.refreshHeight, this);
      this.parent.on($i, this.refreshResizePosition, this);
      this.parent.on(Ce, this.wireEvents, this);
      this.parent.on(Te, this.autoFit, this);
      this.parent.on(Xi, this.refreshHeight, this);
      this.parent.on(M, this.destroy, this);
    }
  };
  s.prototype.removeEventListener = function () {
    if (!this.parent.isDestroyed) {
      this.parent.off(We, this.refreshHeight);
      this.parent.off($i, this.refreshResizePosition);
      this.parent.off(Ce, this.wireEvents);
      this.parent.off(Xi, this.refreshHeight);
      this.parent.off(M, this.destroy);
    }
  };
  s.prototype.render = function () {
    this.unwireEvents();
    this.wireEvents();
    this.setHandlerHeight();
  };
  s.prototype.refreshHeight = function () {
    if (this.parent.getHeaderTable()) {
      for (var e = this.getResizeHandlers(), t = 0; t < e.length; t++)
        if (e[parseInt(t.toString(), 10)].parentElement.offsetHeight > 0) {
          e[parseInt(t.toString(), 10)].style.height = '100%';
        }
      this.setHandlerHeight();
    }
  };
  s.prototype.wireEvents = function () {
    R.add(this.parent.getHeaderContent(), z.touchStartEvent, this.touchResizeStart, this);
    R.add(this.parent.getHeaderContent(), zt, this.callAutoFit, this);
  };
  s.prototype.unwireEvents = function () {
    R.remove(this.parent.getHeaderContent(), z.touchStartEvent, this.touchResizeStart);
    R.remove(this.parent.getHeaderContent(), zt, this.callAutoFit);
  };
  s.prototype.getResizeHandlers = function () {
    return [].slice.call(this.parent.getHeaderTable().getElementsByClassName('e-rhandler'));
  };
  s.prototype.setHandlerHeight = function () {
    for (
      var e = [].slice.call(this.parent.getHeaderTable().getElementsByClassName('e-rsuppress')), t = 0;
      t < e.length;
      t++
    )
      e[parseInt(t.toString(), 10)].style.height = '100%';
  };
  s.prototype.callAutoFit = function (e) {
    if (z.isDevice && typeof e.preventDefault == 'function' && this.isDblClk) {
      e.preventDefault();
    }
    if (e.target.classList.contains('e-rhandler') && !this.isCancelAutoFit) {
      var t = this.getTargetColumn(e);
      if (t.columns) return;
      this.resizeColumn(t.field, this.parent.getNormalizedColumnIndex(t.uid), t.uid);
      if (this.parent.isFrozenGrid()) {
        this.refreshResizefrzCols(true, true);
      }
      if (this.isDblClk && e.type === 'mousedown') {
        var i = {
          e,
          column: t,
        };
        this.parent.trigger(Ji, i);
      }
      var r = T(e.target, 'th.e-headercell');
      r.classList.add('e-resized');
    }
  };
  s.prototype.touchResizeStart = function (e) {
    if (me.timer) {
      clearTimeout(me.timer);
      me.timer = null;
      this.callAutoFit(e);
    } else {
      me.timer = setTimeout(function () {
        me.timer = null;
      }, 300);
      return this.resizeStart(e);
    }
  };
  s.prototype.resizeStart = function (e) {
    var t = this;
    var i = this.parent.getContentTable().style.width;
    var r = false;
    if (
      this.parent.getContentTable().style.width.indexOf('%') !== -1 &&
      parseFloat(this.parent.getContentTable().style.width) > 100
    ) {
      r = true;
    }
    if (e.target.classList.contains('e-rhandler')) {
      this.isCancelAutoFit = false;
      var n = {
        e,
        column: this.getTargetColumn(e),
      };
      this.parent.trigger(ls, n, function (d) {
        if (d.cancel || t.parent.isEdit) {
          t.cancelResizeAction();
          t.isCancelAutoFit = true;
          return;
        }
      });
      if (!this.isCancelAutoFit) {
        if (!this.helper) {
          if (this.getScrollBarWidth() === 0 || r) {
            this.resizeProcess = true;
            for (var a = 0, o = this.refreshColumnWidth(); a < o.length; a++) {
              var l = o[a];
              this.widthService.setColumnWidth(o[a]);
            }
            if (this.parent.allowGrouping)
              for (var h = 0; h < this.parent.groupSettings.columns.length; h++)
                this.widthService.setColumnWidth(new ut({ width: '30px' }), h);
            if (this.parent.isRowDragable()) {
              this.widthService.setColumnWidth(new ut({ width: '30px' }));
            }
            this.widthService.setWidthToTable();
            this.resizeProcess = false;
          }
          this.refreshStackedColumnWidth();
          this.element = e.target;
          this.parentElementWidth = this.parent.element.getBoundingClientRect().width;
          this.appendHelper();
          this.column = this.getTargetColumn(e);
          this.pageX = this.getPointX(e);
          this.column.getFreezeTableName() === hs
            ? this.parent.enableRtl
              ? (this.minMove =
                  (this.column.minWidth ? parseFloat(this.column.minWidth.toString()) : 0) -
                  parseFloat(u(this.column.width) ? '' : this.column.width.toString()))
              : (this.minMove =
                  parseFloat(u(this.column.width) ? '' : this.column.width.toString()) -
                  (this.column.minWidth ? parseFloat(this.column.minWidth.toString()) : 0))
            : this.parent.enableRtl
              ? (this.minMove =
                  parseFloat(this.column.width.toString()) -
                  (this.column.minWidth ? parseFloat(this.column.minWidth.toString()) : 0))
              : (this.minMove =
                  (this.column.minWidth ? parseFloat(this.column.minWidth.toString()) : 0) -
                  parseFloat(u(this.column.width) ? '' : this.column.width.toString()));
          this.minMove += this.pageX;
        }
        R.add(document, z.touchEndEvent, this.resizeEnd, this);
        R.add(this.parent.element, z.touchMoveEvent, this.resizing, this);
        z.isDevice && !this.helper.classList.contains('e-ricon')
          ? (this.helper.classList.add('e-ricon'),
            R.add(document, z.touchStartEvent, this.removeHelper, this),
            R.add(this.helper, z.touchStartEvent, this.resizeStart, this))
          : this.updateCursor('add');
      }
    }
  };
  s.prototype.cancelResizeAction = function (e) {
    if (e) {
      R.remove(this.parent.element, z.touchMoveEvent, this.resizing);
      R.remove(document, z.touchEndEvent, this.resizeEnd);
      this.updateCursor('remove');
    }
    if (z.isDevice && !u(this.helper)) {
      R.remove(document, z.touchStartEvent, this.removeHelper);
      R.remove(this.helper, z.touchStartEvent, this.resizeStart);
    }
    if (!u(this.helper)) {
      Tt(this.helper);
    }
    this.refresh();
  };
  s.prototype.getWidth = function (e, t, i) {
    return t && e < t ? t : i && e > i ? i : e;
  };
  s.prototype.updateResizeEleHeight = function () {
    for (
      var e = [].slice.call(this.parent.getHeaderContent().getElementsByClassName('e-rhandler')), t = 0;
      t < e.length;
      t++
    )
      e[parseInt(t.toString(), 10)].style.height = this.element.parentElement.offsetHeight + 'px';
  };
  s.prototype.getColData = function (e, t) {
    return {
      width:
        parseFloat(
          u(this.widthService.getWidth(e)) || this.widthService.getWidth(e) === 'auto'
            ? '0'
            : this.widthService.getWidth(e).toString(),
        ) + t,
      minWidth: e.minWidth ? parseFloat(e.minWidth.toString()) : null,
      maxWidth: e.maxWidth ? parseFloat(e.maxWidth.toString()) : null,
    };
  };
  s.prototype.refreshResizeFixedCols = function (e) {
    for (
      var t = this.parent.getColumns(),
        i = this.parent.enableColumnVirtualization ? this.parent.translateX : 0,
        r = [].slice
          .call(this.parent.getHeaderContent().querySelector('tbody').querySelectorAll('.e-fixedfreeze'))
          .concat([].slice.call(this.parent.getContent().querySelectorAll('.e-fixedfreeze'))),
        n = 0;
      n < r.length;
      n++
    ) {
      var a = r[parseInt(n.toString(), 10)];
      var o = void 0;
      if (r[parseInt(n.toString(), 10)].classList.contains('e-summarycell')) {
        var l = r[parseInt(n.toString(), 10)].getAttribute('data-mappinguid');
        o = this.parent.getColumnByUid(l);
      } else {
        var h = parseInt(r[parseInt(n.toString(), 10)].getAttribute('aria-colindex'), 10) - 1;
        o = t[parseInt(h.toString(), 10)];
      }
      var d = 0;
      if (e === 'Left') {
        this.parent.getVisibleFrozenLeftCount()
          ? (d = this.parent.getIndentCount() * 30)
          : this.parent.getFrozenMode() === 'Right' && (d = this.parent.groupSettings.columns.length * 30);
        for (var p = 0; p < t.length; p++)
          if (o.index > t[parseInt(p.toString(), 10)].index) {
            if (o.uid === t[parseInt(p.toString(), 10)].uid) break;
            if (
              (t[parseInt(p.toString(), 10)].freeze === 'Left' ||
                t[parseInt(p.toString(), 10)].isFrozen ||
                t[parseInt(p.toString(), 10)].freeze === 'Fixed') &&
              t[parseInt(p.toString(), 10)].visible
            ) {
              d += parseFloat(t[parseInt(p.toString(), 10)].width.toString());
            }
          }
        se(r[parseInt(n.toString(), 10)], (d === 0 ? d : d - 1) - i, this.parent.enableRtl, 'Left');
      }
      if (e === 'Right') {
        d = this.parent.getFrozenMode() === 'Right' && this.parent.isRowDragable() ? 30 : 0;
        for (var p = t.length - 1; p >= 0 && o.uid !== t[parseInt(p.toString(), 10)].uid; p--)
          if (
            (t[parseInt(p.toString(), 10)].freeze === 'Right' || t[parseInt(p.toString(), 10)].freeze === 'Fixed') &&
            t[parseInt(p.toString(), 10)].visible
          ) {
            d += parseFloat(t[parseInt(p.toString(), 10)].width.toString());
          }
        var c = 0;
        if (r[parseInt(n.toString(), 10)].colSpan > 1) {
          c = this.calculateColspanWidth(t, r[parseInt(n.toString(), 10)], o.index);
        }
        se(r[parseInt(n.toString(), 10)], d - c + i, this.parent.enableRtl, 'Right');
      }
    }
  };
  s.prototype.calculateColspanWidth = function (e, t, i) {
    for (var r = 0, n = i + 1; n < i + t.colSpan; n++)
      r += parseInt(e[parseInt(n.toString(), 10)].width.toString(), 10);
    return r;
  };
  s.prototype.refreshResizePosition = function () {
    this.refreshResizefrzCols(true);
  };
  s.prototype.refreshResizefrzCols = function (e, t) {
    var i = this;
    var r = this.parent.enableColumnVirtualization ? this.parent.translateX : 0;
    if (
      e ||
      this.column.freeze === 'Left' ||
      this.column.isFrozen ||
      (this.column.columns && Yt(this.column) === 'Left')
    ) {
      var n = this.parent.getIndentCount() * 30;
      var a = this.parent.getColumns().filter(function (g) {
        return g.freeze === 'Left' || g.isFrozen;
      });
      if (!e || t) {
        this.frzHdrRefresh('Left');
      }
      for (var o = 0; o < a.length; o++) {
        if (e || a[parseInt(o.toString(), 10)].index > this.column.index) {
          var l = [];
          this.parent.frozenRows
            ? (l = [].slice
                .call(this.parent.getHeaderContent().querySelectorAll('td[aria-colindex="' + (o + 1) + '"]'))
                .concat(
                  [].slice.call(this.parent.getContent().querySelectorAll('td[aria-colindex="' + (o + 1) + '"]')),
                ))
            : (l = [].slice.call(this.parent.getContent().querySelectorAll('td[aria-colindex="' + (o + 1) + '"]')));
          l.filter(function (g) {
            se(g, n - r, i.parent.enableRtl, 'Left');
          });
          if (this.parent.enableColumnVirtualization) {
            a[parseInt(o.toString(), 10)].valueX = n;
          }
        }
        if (a[parseInt(o.toString(), 10)].visible) {
          n += parseFloat(a[parseInt(o.toString(), 10)].width.toString());
        }
      }
      this.refreshResizeFixedCols('Left');
    }
    if (e || this.column.freeze === 'Right' || (this.column.columns && Yt(this.column) === 'Right')) {
      var h = this.parent.getFrozenMode() === 'Right' && this.parent.isRowDragable() ? 30 : 0;
      var d = this.parent.getColumns();
      if (!e || t) {
        this.frzHdrRefresh('Right');
      }
      for (
        var p = d.filter(function (g) {
            return g.freeze === 'Right';
          }),
          c = function (g) {
            var m = [];
            f.parent.frozenRows
              ? (m = [].slice
                  .call(f.parent.getHeaderContent().querySelectorAll('td[aria-colindex="' + (g + 1) + '"]'))
                  .concat([].slice.call(f.parent.getContent().querySelectorAll('td[aria-colindex="' + (g + 1) + '"]'))))
              : (m = [].slice.call(f.parent.getContent().querySelectorAll('td[aria-colindex="' + (g + 1) + '"]')));
            m.filter(function (y) {
              var v = 0;
              if (y.colSpan > 1) {
                v = i.calculateColspanWidth(d, y, d[parseInt(g.toString(), 10)].index);
              }
              se(y, h - v + r, i.parent.enableRtl, 'Right');
            });
            if (f.parent.enableColumnVirtualization) {
              d[parseInt(g.toString(), 10)].valueX = h;
            }
            if (d[parseInt(g.toString(), 10)].visible) {
              h = h + parseFloat(d[parseInt(g.toString(), 10)].width.toString());
            }
          },
          f = this,
          o = d.length - 1;
        o >= d.length - p.length;
        o--
      )
        c(o);
      this.refreshResizeFixedCols('Right');
    }
    if (this.column && (this.column.freeze === 'Fixed' || (this.column.columns && Yt(this.column) === 'Fixed'))) {
      this.refreshResizeFixedCols('Left');
      this.refreshResizeFixedCols('Right');
      this.frzHdrRefresh('Left');
      this.frzHdrRefresh('Right');
    }
    if (
      this.parent.groupSettings.columns.length &&
      this.parent.aggregates.length &&
      this.parent.getContent().querySelector('.e-groupcaptionrow')
    ) {
      this.refreshGroupCaptionRow();
    }
  };
  s.prototype.refreshGroupCaptionRow = function () {
    for (
      var e = [].slice.call(this.parent.getContent().querySelectorAll('.e-groupcaptionrow')), t = 0;
      t < e.length;
      t++
    ) {
      var i = e[parseInt(t.toString(), 10)];
      if (e[parseInt(t.toString(), 10)].querySelector('.e-summarycell')) {
        ds(e[parseInt(t.toString(), 10)], this.parent);
      }
    }
  };
  s.prototype.frzHdrRefresh = function (e) {
    var t = this;
    var i = this.parent.enableColumnVirtualization ? this.parent.translateX : 0;
    if (e === 'Left')
      for (
        var r = [].slice.call(this.parent.getHeaderContent().querySelector('thead').querySelectorAll('tr')), n = 0;
        n < r.length;
        n++
      )
        for (
          var a = [].slice.call(r[parseInt(n.toString(), 10)].querySelectorAll('.e-leftfreeze,.e-fixedfreeze')),
            o = function (c) {
              var f = a[parseInt(c.toString(), 10)];
              if (
                a[parseInt(c.toString(), 10)].classList.contains('e-rowdragheader') ||
                a[parseInt(c.toString(), 10)].classList.contains('e-dragheadercell') ||
                a[parseInt(c.toString(), 10)].classList.contains('e-grouptopleftcell')
              )
                return 'continue';
              var g = l.getParticularCol(a[parseInt(c.toString(), 10)]);
              var m = l.parent.getColumns();
              var y = 0;
              var v = [];
              if (l.parent.aggregates.length && l.parent.getFooterContent()) {
                if (l.parent.getContent().querySelectorAll('.e-summaryrow').length) {
                  var b = [].slice.call(l.parent.getContent().querySelectorAll('.e-summaryrow'));
                  b.filter(function (I) {
                    v.push(I.querySelector('[data-mappinguid="' + g.uid + '"]'));
                  });
                }
                v = v.concat(
                  [].slice.call(l.parent.getFooterContent().querySelectorAll('[data-mappinguid="' + g.uid + '"]')),
                );
              }
              if (a[parseInt(c.toString(), 10)].classList.contains('e-fixedfreeze')) {
                l.parent.getVisibleFrozenLeftCount()
                  ? (y = l.parent.getIndentCount() * 30)
                  : l.parent.getFrozenMode() === 'Right' && (y = l.parent.groupSettings.columns.length * 30);
                for (var w = 0; w < m.length; w++)
                  if (g.index > m[parseInt(w.toString(), 10)].index) {
                    if (g.uid === m[parseInt(w.toString(), 10)].uid) break;
                    if (
                      (m[parseInt(w.toString(), 10)].freeze === 'Left' ||
                        m[parseInt(w.toString(), 10)].isFrozen ||
                        m[parseInt(w.toString(), 10)].freeze === 'Fixed') &&
                      m[parseInt(w.toString(), 10)].visible
                    ) {
                      y += parseInt(m[parseInt(w.toString(), 10)].width.toString(), 10);
                    }
                  }
                if (v && v.length) {
                  v.filter(function (I) {
                    se(I, y - i, t.parent.enableRtl, 'Left');
                  });
                }
                se(a[parseInt(c.toString(), 10)], (y === 0 ? y : y - 1) - i, l.parent.enableRtl, 'Left');
              } else {
                y = l.parent.getIndentCount() * 30;
                if (g.index === 0) {
                  if (v && v.length) {
                    v.filter(function (I) {
                      se(I, y - i, t.parent.enableRtl, 'Left');
                    });
                  }
                  se(a[parseInt(c.toString(), 10)], y - i, l.parent.enableRtl, 'Left');
                  if (l.parent.enableColumnVirtualization) {
                    g.valueX = y;
                  }
                } else {
                  for (
                    var C = 0;
                    C < m.length &&
                    !(g.index < m[parseInt(C.toString(), 10)].index || g.uid === m[parseInt(C.toString(), 10)].uid);
                    C++
                  )
                    if (m[parseInt(C.toString(), 10)].visible) {
                      y += parseInt(m[parseInt(C.toString(), 10)].width.toString(), 10);
                    }
                  if (v && v.length) {
                    v.filter(function (I) {
                      se(I, y - i, t.parent.enableRtl, 'Left');
                    });
                  }
                  se(a[parseInt(c.toString(), 10)], y - i, l.parent.enableRtl, 'Left');
                  if (l.parent.enableColumnVirtualization) {
                    g.valueX = y;
                  }
                }
                Ti(l.parent, g, a[parseInt(c.toString(), 10)]);
              }
            },
            l = this,
            h = 0;
          h < a.length;
          h++
        )
          o(h);
    if (e === 'Right')
      for (
        var r = [].slice.call(this.parent.getHeaderContent().querySelector('thead').querySelectorAll('tr')), n = 0;
        n < r.length;
        n++
      )
        for (
          var a = [].slice.call(r[parseInt(n.toString(), 10)].querySelectorAll('.e-rightfreeze, .e-fixedfreeze')),
            d = function (m) {
              var y = a[parseInt(m.toString(), 10)];
              var v = p.getParticularCol(a[parseInt(m.toString(), 10)]);
              var b = p.parent.getColumns();
              var w = 0;
              var C = [];
              if (p.parent.aggregates.length && p.parent.getFooterContent()) {
                if (p.parent.getContent().querySelectorAll('.e-summaryrow').length) {
                  var I = [].slice.call(p.parent.getContent().querySelectorAll('.e-summaryrow'));
                  I.filter(function (A) {
                    C.push(A.querySelector('[data-mappinguid="' + v.uid + '"]'));
                  });
                }
                C = C.concat(
                  [].slice.call(p.parent.getFooterContent().querySelectorAll('[data-mappinguid="' + v.uid + '"]')),
                );
              }
              if (a[parseInt(m.toString(), 10)].classList.contains('e-fixedfreeze')) {
                w = p.parent.getFrozenMode() === 'Right' && p.parent.isRowDragable() ? 30 : 0;
                for (var x = b.length - 1; x >= 0; x--)
                  if (v.index < b[parseInt(x.toString(), 10)].index) {
                    if (
                      (v.columns && Zi(v, b[parseInt(x.toString(), 10)].uid)) ||
                      v.index > b[parseInt(x.toString(), 10)].index
                    )
                      break;
                    if (
                      (b[parseInt(x.toString(), 10)].freeze === 'Right' ||
                        b[parseInt(x.toString(), 10)].freeze === 'Fixed') &&
                      b[parseInt(x.toString(), 10)].visible
                    ) {
                      w += parseFloat(b[parseInt(x.toString(), 10)].width.toString());
                    }
                  }
                if (C.length) {
                  C.filter(function (A) {
                    se(A, w + i, t.parent.enableRtl, 'Right');
                  });
                }
                se(a[parseInt(m.toString(), 10)], w + i, p.parent.enableRtl, 'Right');
              } else {
                w = p.parent.getFrozenMode() === 'Right' && p.parent.isRowDragable() ? 30 : 0;
                for (
                  var O = b.length - 1;
                  O >= 0 &&
                  !(
                    (v.columns && Zi(v, b[parseInt(O.toString(), 10)].uid)) ||
                    v.index > b[parseInt(O.toString(), 10)].index ||
                    v.uid === b[parseInt(O.toString(), 10)].uid
                  );
                  O--
                )
                  if (b[parseInt(O.toString(), 10)].visible) {
                    w += parseInt(b[parseInt(O.toString(), 10)].width.toString(), 10);
                  }
                if (C.length) {
                  C.filter(function (A) {
                    se(A, w + i, t.parent.enableRtl, 'Right');
                  });
                }
                se(a[parseInt(m.toString(), 10)], w + i, p.parent.enableRtl, 'Right');
                if (p.parent.enableColumnVirtualization) {
                  v.valueX = w;
                }
              }
            },
            p = this,
            h = a.length - 1;
          h >= 0;
          h--
        )
          d(h);
  };
  s.prototype.getParticularCol = function (e) {
    var t = e.classList.contains('e-filterbarcell')
      ? e.getAttribute('data-mappinguid')
      : e.querySelector('[data-mappinguid]').getAttribute('data-mappinguid');
    return this.parent.getColumnByUid(t);
  };
  s.prototype.resizing = function (e) {
    var t = this;
    if (z.isDevice && typeof e.preventDefault == 'function') {
      e.preventDefault();
    }
    if (!u(this.column)) {
      var i = 0;
      if (u(this.column)) {
        i = S(this.element, 'th').offsetWidth;
      }
      if (this.parent.allowTextWrap) {
        this.updateResizeEleHeight();
        this.setHelperHeight();
      }
      var r = this.getPointX(e);
      var n = this.parent.enableRtl ? -(r - this.pageX) : r - this.pageX;
      var a = parseFloat(this.column.width.toString());
      var o = this.getColData(this.column, n);
      if (!o.width) {
        o.width = T(this.element, 'th').offsetWidth;
      }
      var l = this.getWidth(o.width, o.minWidth, o.maxWidth);
      this.parent.log('resize_min_max', {
        column: this.column,
        width: l,
      });
      if ((!this.parent.enableRtl && this.minMove >= r) || (this.parent.enableRtl && this.minMove <= r)) {
        l = this.column.minWidth ? parseFloat(this.column.minWidth.toString()) : 10;
        this.pageX = r = this.minMove;
      }
      if (
        l !==
        parseFloat(u(this.column.width) || this.column.width === 'auto' ? i.toString() : this.column.width.toString())
      ) {
        this.pageX = r;
        this.column.width = xe(l);
        var h = {
          e,
          column: this.column,
        };
        this.parent.trigger(ps, h);
        if (h.cancel) {
          this.cancelResizeAction(true);
          return;
        }
        var d = [this.column];
        var p = [this.column];
        if (this.column.columns) {
          d = this.getSubColumns(this.column, []);
          d = this.calulateColumnsWidth(d, false, n);
          p = this.calulateColumnsWidth(d, true, n);
        }
        var c = 0;
        var f = this.parent.getColumns().filter(function (w) {
          if (w.visible) {
            c += parseInt(w.width.toString(), 10);
          }
          return w.visible && (w.maxWidth || w.minWidth);
        });
        if (this.parent.resizeSettings.mode === 'Auto' && f.length && c < this.parentElementWidth) {
          var g = this.parent.getColumns().filter(function (w) {
            return w.visible && w.uid !== t.column.uid;
          });
          var m = this.distributeColWidth(g, n, 0);
          if (Math.round(m.usedWidth) !== Math.abs(n)) {
            p[0].width = a + m.usedWidth * Math.sign(n);
          }
          p = p.concat(m.columns);
        }
        this.resizeProcess = true;
        for (var y = 0, v = p; y < v.length; y++) {
          var b = v[y];
          this.widthService.setColumnWidth(v[y], null, 'resize');
        }
        this.resizeProcess = false;
        this.updateHelper();
      }
      if (this.parent.isFrozenGrid()) {
        this.refreshResizefrzCols();
      }
      this.isDblClk = false;
    }
  };
  s.prototype.distributeColWidth = function (e, t, i) {
    for (var r = t / e.length, n = Math.abs(r), a = [], o = [], l = 0, h = 0, d = e; h < d.length; h++) {
      var p = d[h];
      var c = parseFloat(p.width.toString()) - r;
      if (p.minWidth && c < parseInt(p.minWidth.toString(), 10)) {
        var f = parseFloat((parseInt(p.minWidth.toString(), 10) - c).toFixed(3));
        l += f;
        i += n - f;
        p.width = p.minWidth;
        a.push(p);
      } else if (p.maxWidth && c > parseInt(p.maxWidth.toString(), 10)) {
        var f = parseFloat((c - parseInt(p.maxWidth.toString(), 10)).toFixed(3));
        l += f;
        i += n - f;
        p.width = p.maxWidth;
        a.push(p);
      } else {
        i += n;
        p.width = c;
        o.push(p);
      }
    }
    var g =
      l && o.length
        ? this.distributeColWidth(o, l * Math.sign(t), i)
        : {
            columns: o,
            usedWidth: i,
          };
    return {
      columns: a.concat(g.columns),
      usedWidth: g.usedWidth,
    };
  };
  s.prototype.calulateColumnsWidth = function (e, t, i) {
    for (var r = [], n = 0, a = e; n < a.length; n++) {
      for (var o = a[n], l = 0, h = 0; h < e.length; h++)
        l += parseFloat(e[parseInt(h.toString(), 10)].width.toString());
      var d = this.getColData(o, (parseFloat(o.width) * i) / l);
      var p = this.getWidth(d.width, d.minWidth, d.maxWidth);
      if (p !== parseFloat(o.width.toString())) {
        if (t) {
          o.width = xe(p < 1 ? 1 : p);
        }
        r.push(o);
      }
    }
    return r;
  };
  s.prototype.getSubColumns = function (e, t) {
    for (var i = 0, r = e.columns; i < r.length; i++) {
      var n = r[i];
      if (r[i].visible !== false && r[i].allowResizing) {
        r[i].columns ? this.getSubColumns(r[i], t) : t.push(r[i]);
      }
    }
    return t;
  };
  s.prototype.resizeEnd = function (e) {
    if (!(!this.helper || this.parent.isDestroyed)) {
      var t = this.parent;
      if (this.parent.isFrozenGrid()) {
        this.refreshResizePosition();
      }
      R.remove(this.parent.element, z.touchMoveEvent, this.resizing);
      R.remove(document, z.touchEndEvent, this.resizeEnd);
      if (z.isDevice) {
        R.remove(document, z.touchStartEvent, this.removeHelper);
        R.remove(this.helper, z.touchStartEvent, this.resizeStart);
      }
      this.updateCursor('remove');
      Tt(this.helper);
      var i = {
        e,
        column: this.column,
      };
      var r = this.parent.getContent().querySelector('.' + ct);
      var n = r;
      if (r.scrollHeight > r.clientHeight) {
        this.parent.scrollModule.setPadding();
        r.style.overflowY = 'scroll';
      }
      if (!me.timer || !this.isDblClk) {
        this.parent.trigger(Ji, i);
        T(this.element, '.e-headercell').classList.add('e-resized');
      }
      this.isFrozenColResized = false;
      if (this.parent.allowTextWrap) {
        this.updateResizeEleHeight();
        this.parent.notify(us, { case: 'textwrap' });
      }
      var a = this.parent.getHeaderTable();
      var o = this.parent.getContentTable();
      var l;
      if (!u(this.parent.getFooterContent())) {
        l = this.parent.getFooterContentTable();
      }
      var h = a.offsetWidth;
      var d = this.parent.getContent().scrollWidth;
      this.parent.getContent().scrollWidth > a.offsetWidth
        ? (u(o.querySelector('.e-emptyrow'))
            ? j([a, o], ['e-tableborder'])
            : (j([a], ['e-tableborder']), Q([o], ['e-tableborder'])),
          Q([this.parent.element], ['e-left-shadow', 'e-right-shadow']))
        : (Q([a, o], ['e-tableborder']),
          this.parent.getVisibleFrozenRightCount() && j([this.parent.element], 'e-right-shadow'));
      if (!u(l)) {
        l.classList.add('e-tableborder');
      }
      this.refresh();
      this.doubleTapEvent(e);
      this.isDblClk = true;
    }
  };
  s.prototype.getPointX = function (e) {
    return e.touches && e.touches.length ? e.touches[0].pageX : e.pageX;
  };
  s.prototype.refreshColumnWidth = function () {
    for (
      var e = this.parent.getColumns(),
        t = 0,
        i = [].slice.apply(this.parent.getHeaderContent().querySelectorAll('th.e-headercell'));
      t < i.length;
      t++
    )
      for (var r = i[t], n = 0, a = e; n < a.length; n++) {
        var o = a[n];
        if (
          r.querySelector('[data-mappinguid]') &&
          r.querySelector('[data-mappinguid]').getAttribute('data-mappinguid') === o.uid &&
          o.visible
        ) {
          o.width = r.getBoundingClientRect().width;
          break;
        }
      }
    return e;
  };
  s.prototype.refreshStackedColumnWidth = function () {
    for (var e = 0, t = this.parent.getStackedColumns(this.parent.columns); e < t.length; e++) {
      var i = t[e];
      i.width = this.getStackedWidth(i, 0);
    }
  };
  s.prototype.getStackedWidth = function (e, t) {
    for (var i = 0, r = e.columns; i < r.length; i++) {
      var n = r[i];
      if (r[i].visible !== false) {
        r[i].columns ? (t = this.getStackedWidth(r[i], t)) : (t += parseFloat(r[i].width.toString()));
      }
    }
    return t;
  };
  s.prototype.getTargetColumn = function (e) {
    var t = T(e.target, 'th.e-headercell');
    t = t.querySelector('.e-headercelldiv') || t.querySelector('.e-stackedheadercelldiv');
    var i = t.getAttribute('data-mappinguid');
    return this.parent.getColumnByUid(i);
  };
  s.prototype.updateCursor = function (e) {
    var t = [].slice.call(this.parent.getHeaderContent().querySelectorAll('th'));
    t.push(this.parent.element);
    for (var i = 0, r = t; i < r.length; i++) {
      var n = r[i];
      r[i].classList['' + e]('e-rcursor');
    }
  };
  s.prototype.refresh = function () {
    this.column = null;
    this.pageX = null;
    this.element = null;
    this.helper = null;
  };
  s.prototype.appendHelper = function () {
    this.helper = this.parent.createElement('div', { className: 'e-rhelper' });
    this.parent.element.appendChild(this.helper);
    this.setHelperHeight();
  };
  s.prototype.setHelperHeight = function () {
    for (
      var e = this.parent.getContent().offsetHeight - this.getScrollBarWidth(),
        t = T(this.element, 'th.e-headercell'),
        i = [].slice.call(this.parent.getHeaderContent().querySelectorAll('tr')),
        r = i.indexOf(t.parentElement);
      r < i.length && r > -1;
      r++
    )
      e += i[parseInt(r.toString(), 10)].offsetHeight;
    var n = this.calcPos(t);
    n.left += this.parent.enableRtl ? -1 : t.offsetWidth - 2;
    this.helper.style.cssText = 'height: ' + e + 'px; top: ' + n.top + 'px; left:' + Math.floor(n.left) + 'px;';
    if (this.parent.enableVirtualization) {
      this.helper.classList.add('e-virtual-rhandler');
    }
  };
  s.prototype.getScrollBarWidth = function (e) {
    var t = this.parent.getContent().firstChild;
    return (this.parent.getContent().firstChild.scrollHeight > this.parent.getContent().firstChild.clientHeight && e) ||
      this.parent.getContent().firstChild.scrollWidth > this.parent.getContent().firstChild.clientWidth
      ? hn()
      : 0;
  };
  s.prototype.removeHelper = function (e) {
    var t = e.target.classList;
    if (!(e.target.classList.contains('e-rhandler') || e.target.classList.contains('e-ricon')) && this.helper) {
      R.remove(document, z.touchStartEvent, this.removeHelper);
      R.remove(this.helper, z.touchStartEvent, this.resizeStart);
      Tt(this.helper);
      this.refresh();
    }
  };
  s.prototype.updateHelper = function () {
    var e = T(this.element, 'th.e-headercell');
    var t;
    t = Math.floor(this.calcPos(e).left + (this.parent.enableRtl ? -1 : e.offsetWidth - 2));
    var i = 2;
    if (t > this.parentElementWidth) {
      t = this.parentElementWidth - 2;
    }
    this.helper.style.left = t + 'px';
  };
  s.prototype.calcPos = function (e) {
    for (
      var t = {
          top: 0,
          left: 0,
        },
        i = e.getBoundingClientRect(),
        r = e.ownerDocument,
        n = S(e, 'e-grid') || r.documentElement;
      n && (n === r.body || n === r.documentElement) && n.style.position === 'static';

    )
      n = n.parentNode;
    if (n && n !== e && n.nodeType === 1) {
      t = n.getBoundingClientRect();
    }
    return {
      top: i.top - t.top,
      left: i.left - t.left,
    };
  };
  s.prototype.doubleTapEvent = function (e) {
    var t = this;
    if (this.getUserAgent() && this.isDblClk) {
      this.tapped
        ? (clearTimeout(this.tapped), this.callAutoFit(e), (this.tapped = null))
        : (this.tapped = setTimeout(function () {
            t.tapped = null;
          }, 300));
    }
  };
  s.prototype.getUserAgent = function () {
    var e = z.userAgent.toLowerCase();
    return /iphone|ipod|ipad/.test(e);
  };
  s.prototype.timeoutHandler = function () {
    this.tapped = null;
  };
  return s;
})();
var Oo = (function () {
  function s(e) {
    this.idx = 0;
    this.parent = e;
    if (!this.parent.isDestroyed) {
      this.parent.on(ei, this.headerDrop, this);
      this.parent.on(Se, this.enableAfterRender, this);
      this.parent.on(Yi, this.onActionComplete, this);
      this.parent.on(ti, this.drag, this);
      this.parent.on(ii, this.dragStart, this);
      this.parent.on(Qi, this.dragStop, this);
      this.parent.on(ei, this.headerDrop, this);
      this.parent.on(We, this.createReorderElement, this);
      this.parent.on(be, this.keyPressHandler, this);
      this.parent.on(M, this.destroy, this);
    }
  }
  s.prototype.chkDropPosition = function (e, t) {
    var i = this.parent.getColumnByUid(t.firstElementChild.getAttribute('data-mappinguid'));
    var r = i ? !i.lockColumn : true;
    return (
      (e.parentElement.isEqualNode(t.parentElement) ||
        this.parent.enableColumnVirtualization ||
        (this.parent.isFrozenGrid() &&
          Array.prototype.indexOf.call(T(e, 'thead').children, e.parentElement) ===
            Array.prototype.indexOf.call(T(t, 'thead').children, t.parentElement))) &&
      this.targetParentContainerIndex(e, t) > -1 &&
      r
    );
  };
  s.prototype.chkDropAllCols = function (e, t) {
    for (var i, r = this.getHeaderCells(), n; !i && r.length > 0; ) {
      n = r.pop();
      i = e !== n && this.targetParentContainerIndex(e, t) > -1;
    }
    return i;
  };
  s.prototype.findColParent = function (e, t, i) {
    i = i;
    for (var r = 0, n = t.length; r < n; r++) {
      if (e === t[parseInt(r.toString(), 10)]) return true;
      if (t[parseInt(r.toString(), 10)].columns) {
        var a = i.length;
        i.push(t[parseInt(r.toString(), 10)]);
        if (!this.findColParent(e, t[parseInt(r.toString(), 10)].columns, i)) i.splice(i.length, i.length - i.length);
        else return true;
      }
    }
    return false;
  };
  s.prototype.getColumnsModel = function (e, t) {
    for (var i = [], r = [], n = 0, a = e.length; n < a; n++)
      if (!u(e[parseInt(n.toString(), 10)])) {
        if (e[parseInt(n.toString(), 10)].visible || t) {
          i.push(e[parseInt(n.toString(), 10)]);
        }
        if (e[parseInt(n.toString(), 10)].columns) {
          r = r.concat(e[parseInt(n.toString(), 10)].columns);
        }
      }
    if (r.length) {
      i = i.concat(this.getColumnsModel(r));
    }
    return i;
  };
  s.prototype.headerDrop = function (e) {
    var t = this.parent;
    var i = this.element.querySelector('.e-headercelldiv') || this.element.querySelector('.e-stackedheadercelldiv');
    var r = i.getAttribute('data-mappinguid');
    var n = this.parent.getColumnByUid(r);
    if (!T(e.target, 'th') || (!u(n) && (!n.allowReordering || n.lockColumn))) {
      this.parent.log('action_disabled_column', {
        moduleName: this.getModuleName(),
        column: n,
      });
      return;
    }
    var a = T(e.target, '.e-headercell');
    var o = a.querySelector('.e-headercelldiv') || a.querySelector('.e-stackedheadercelldiv');
    var l = o.getAttribute('data-mappinguid');
    if (!u(l)) {
      var h = this.parent.getColumnByUid(l);
      if (u(h) || !h.allowReordering || h.lockColumn) {
        this.parent.log('action_disabled_column', {
          moduleName: this.getModuleName(),
          column: n,
          destColumn: h,
        });
        return;
      }
    }
    if (a && !(!this.chkDropPosition(this.element, a) || !this.chkDropAllCols(this.element, a)))
      if (this.parent.enableColumnVirtualization) {
        var d = this.parent.columns;
        var p = this.element.querySelector('.e-headercelldiv').getAttribute('data-mappinguid');
        var c = this.parent.columns.filter(function (C) {
          return C.uid === p;
        });
        var f = null;
        var g = c[0];
        var m = a.querySelector('.e-headercelldiv').getAttribute('data-mappinguid');
        this.parent.columns.some(function (C, I) {
          return C.uid === m ? ((f = I), C.uid === m) : false;
        });
        if (!u(f)) {
          this.moveColumns(f, c[0]);
        }
      } else {
        var y = this.targetParentContainerIndex(this.element, a);
        var v = this.element.firstElementChild.getAttribute('data-mappinguid');
        this.destElement = a;
        this.parent.notify(fs, { ele: a });
        if (v) this.moveColumns(y, this.parent.getColumnByUid(v));
        else {
          var b = this.getHeaderCells();
          var w = Qt(this.element, b);
          var d = this.getColumnsModel(this.parent.columns);
          this.moveColumns(y, d[parseInt(w.toString(), 10)]);
        }
      }
  };
  s.prototype.isActionPrevent = function (e) {
    return qe(e);
  };
  s.prototype.moveColumns = function (e, t, i, r) {
    var n = this.parent;
    if (this.isActionPrevent(n)) {
      n.notify(ye, {
        instance: this,
        handler: this.moveColumns,
        arg1: e,
        arg2: t,
      });
      return;
    }
    var a = this.getColParent(t, this.parent.columns);
    var o = a ? a.columns : this.parent.columns;
    var l = Ct(t, o);
    if ((a || this.parent.lockcolPositionCount) && !i && !this.parent.enableColumnVirtualization) {
      for (var h = 0; h < o.length; h++)
        if (o[parseInt(h.toString(), 10)].field === t.field) {
          l = h;
          break;
        }
      var d = this.parent.getColumnByUid(this.destElement.firstElementChild.getAttribute('data-mappinguid'));
      if (d) {
        for (var h = 0; h < o.length; h++)
          if (o[parseInt(h.toString(), 10)].field === d.field) {
            e = h;
            break;
          }
      } else
        for (var h = 0; h < o.length; h++)
          if (o[parseInt(h.toString(), 10)].headerText === this.destElement.innerText.trim()) {
            e = h;
          }
    }
    if (!(!n.allowReordering || l === e || l === -1 || e === -1)) {
      o.splice(e, 0, o.splice(l, 1)[0]);
      var p = {
        column: t,
        destIndex: e,
        columns: o,
        parent: a,
        cancel: false,
      };
      n.notify(gs, p);
      if (!p.cancel) {
        if (this.parent.isFrozenGrid())
          if (this.parent.frozenColumns)
            for (var h = 0; h < o.length; h++)
              if (o[parseInt(h.toString(), 10)].freeze === 'Left') {
                o[parseInt(h.toString(), 10)].freeze = void 0;
              } else if (!(a && a.columns)) {
                this.parent.getFrozenLeftCount() > e
                  ? (t.freeze = 'Left')
                  : o.length - this.parent.getFrozenRightColumnsCount() <= e
                    ? (t.freeze = 'Right')
                    : (t.freeze = t.freeze === 'Fixed' ? 'Fixed' : void 0);
              }
        if (r !== false) {
          var c = {
            type: _,
            requestType: 'reorder',
            fromIndex: e,
            toIndex: l,
            toColumnUid: t.uid,
            cancel: false,
          };
          n.notify(ee, c);
          if (c.cancel) {
            o.splice(l, 0, o.splice(e, 1)[0]);
            return;
          }
        }
        n.getColumns(true);
        n.preventAutoFit = true;
        n.notify(gi, {
          fromIndex: e,
          toIndex: l,
        });
        if (this.parent.isFrozenGrid()) {
          var f = this.parent.columns;
          this.idx = 0;
          this.refreshColumnIndex(this.parent.columns);
          this.parent.notify(ms, {});
        }
      }
    }
  };
  s.prototype.refreshColumnIndex = function (e) {
    for (var t = 0; t < e.length; t++) {
      e[parseInt(t.toString(), 10)].index = this.idx;
      this.idx++;
      if (e[parseInt(t.toString(), 10)].columns && e[parseInt(t.toString(), 10)].columns.length) {
        this.refreshColumnIndex(e[parseInt(t.toString(), 10)].columns);
      }
    }
  };
  s.prototype.targetParentContainerIndex = function (e, t) {
    var i = this.parent.columns;
    var r = this.getHeaderCells();
    var n = this.parent.getStackedColumns(i);
    var a = [];
    if (n.length) {
      a = this.getAllStackedheaderParentColumns(r);
    }
    var o = n.length && a.length ? this.getColumnsModel(a) : this.getColumnsModel(i, true);
    var l = this.getColParent(o[Qt(e, r)], i);
    i = l ? l.columns : i;
    return Ct(o[Qt(t, r)], i);
  };
  s.prototype.getAllStackedheaderParentColumns = function (e) {
    for (var t = [], i = 0; i < e.length; i++)
      e[parseInt(i.toString(), 10)].classList.contains('e-hide')
        ? (e.splice(i, 1), i--)
        : e[parseInt(i.toString(), 10)].closest('thead').firstChild === e[parseInt(i.toString(), 10)].parentElement &&
          t.push(
            this.parent.getColumnByUid(e[parseInt(i.toString(), 10)].firstElementChild.getAttribute('data-mappinguid')),
          );
    return t;
  };
  s.prototype.getHeaderCells = function () {
    return [].slice.call(this.parent.element.getElementsByClassName('e-headercell'));
  };
  s.prototype.getColParent = function (e, t) {
    var i = [];
    this.findColParent(e, t, i);
    return i[i.length - 1];
  };
  s.prototype.reorderSingleColumn = function (e, t) {
    var i = this.parent.enableColumnVirtualization
      ? this.parent.columns.filter(function (h) {
          return h.field === e;
        })[0]
      : this.parent.getColumnByField(e);
    var r = this.parent.enableColumnVirtualization
      ? this.parent.columns.filter(function (h) {
          return h.field === t;
        })[0]
      : this.parent.getColumnByField(t);
    if ((!u(i) && (!i.allowReordering || i.lockColumn)) || (!u(r) && (!r.allowReordering || r.lockColumn))) {
      this.parent.log('action_disabled_column', {
        moduleName: this.getModuleName(),
        column: i,
        destColumn: r,
      });
      return;
    }
    var n = r;
    var a = this.getColParent(r, this.parent.columns);
    var o = a ? a.columns : this.parent.columns;
    var l = Ct(r, o);
    if (l > -1) {
      this.moveColumns(l, i, true);
    }
  };
  s.prototype.reorderMultipleColumns = function (e, t) {
    var i = this.parent.getColumnIndexByField(t);
    var r = this.parent.getColumnByField(t);
    if (!(i < 0 || (!u(r) && (!r.allowReordering || r.lockColumn)))) {
      for (var n = 0; n < e.length; n++) {
        var a = this.parent.getColumnByField(e[parseInt(n.toString(), 10)]);
        if (!u(a) && (!a.allowReordering || a.lockColumn)) return;
      }
      for (var n = 0; n < e.length; n++) {
        var a = this.parent.getColumnByIndex(i);
        var o = this.getColParent(a, this.parent.columns);
        var l = o ? o.columns : this.parent.columns;
        var h = Ct(a, l);
        if (h > -1) {
          this.moveColumns(h, this.parent.getColumnByField(e[parseInt(n.toString(), 10)]), true, true);
        }
        if (this.parent.getColumnIndexByField(e[n + 1]) >= h) {
          i++;
        }
      }
    }
  };
  s.prototype.moveTargetColumn = function (e, t) {
    if (t > -1) {
      this.moveColumns(t, e, true);
    }
  };
  s.prototype.reorderSingleColumnByTarget = function (e, t) {
    this.moveTargetColumn(this.parent.getColumnByField(e), t);
  };
  s.prototype.reorderMultipleColumnByTarget = function (e, t) {
    for (var i = 0; i < e.length; i++) this.reorderSingleColumnByTarget(e[parseInt(i.toString(), 10)], t);
  };
  s.prototype.reorderColumns = function (e, t) {
    typeof e == 'string'
      ? (this.reorderSingleColumn(e, t), (this.fromCol = e))
      : (this.reorderMultipleColumns(e, t), (this.fromCol = e[0]));
  };
  s.prototype.reorderColumnByModel = function (e, t) {
    if (!u(e) && !u(t) && e instanceof ut && t instanceof ut) {
      if (!e.allowReordering || e.lockColumn || !t.allowReordering || t.lockColumn) {
        this.parent.log('action_disabled_column', {
          moduleName: this.getModuleName(),
          column: e,
          destColumn: t,
        });
        return;
      }
      var i = this.targetParentContainerIndex(
        this.parent.getColumnHeaderByUid(e.uid),
        this.parent.getColumnHeaderByUid(t.uid),
      );
      this.moveTargetColumn(e, i);
    }
  };
  s.prototype.reorderColumnByIndex = function (e, t) {
    this.moveTargetColumn(this.parent.getColumnByIndex(e), t);
  };
  s.prototype.reorderColumnByTargetIndex = function (e, t) {
    typeof e == 'string' ? this.reorderSingleColumnByTarget(e, t) : this.reorderMultipleColumnByTarget(e, t);
  };
  s.prototype.enableAfterRender = function (e) {
    if (e.module === this.getModuleName() && e.enable) {
      this.createReorderElement();
    }
  };
  s.prototype.createReorderElement = function (e) {
    if (e && e.args && e.args.isXaxis) {
      this.setDisplay('none');
    }
    var t = this.parent.element.querySelector('.' + je);
    var i = this.parent.createElement('div', { className: 'e-icons e-icon-reorderuparrow e-reorderuparrow' });
    i.style.display = 'none';
    this.upArrow = i;
    t.appendChild(this.upArrow);
    var r = this.parent.createElement('div', { className: 'e-icons e-icon-reorderdownarrow e-reorderdownarrow' });
    r.style.display = 'none';
    this.downArrow = r;
    t.appendChild(this.downArrow);
  };
  s.prototype.onActionComplete = function (e) {
    this.parent.preventAutoFit = false;
    this.parent.trigger(B, E(e, { type: B }));
    var t = this.fromCol && this.parent.getColumnHeaderByField(this.fromCol);
    if (t) {
      this.parent.focusModule.onClick({ target: t }, true);
    }
  };
  s.prototype.destroy = function () {
    var e = this.parent.element;
    if (
      !(
        this.parent.isDestroyed ||
        !this.parent.element ||
        (!this.parent.element.querySelector('.' + Oe) && !this.parent.element.querySelector('.' + pe))
      )
    ) {
      if (this.upArrow.parentNode) {
        N(this.upArrow);
      }
      if (this.downArrow.parentNode) {
        N(this.downArrow);
      }
      this.parent.off(ei, this.headerDrop);
      this.parent.off(Se, this.enableAfterRender);
      this.parent.off(Yi, this.onActionComplete);
      this.parent.off(ti, this.drag);
      this.parent.off(ii, this.dragStart);
      this.parent.off(Qi, this.dragStop);
      this.parent.off(We, this.createReorderElement);
      this.parent.off(be, this.keyPressHandler);
      this.parent.off(M, this.destroy);
    }
  };
  s.prototype.keyPressHandler = function (e) {
    var t = this.parent;
    var i = /(Mac)/i.test(navigator.platform);
    switch (
      (i &&
        e.metaKey &&
        (e.action === 'leftArrow'
          ? (e.action = 'ctrlLeftArrow')
          : e.action === 'rightArrow' && (e.action = 'ctrlRightArrow')),
      e.action)
    ) {
      case 'ctrlLeftArrow':
      case 'ctrlRightArrow':
        var r = this.parent.focusModule.currentInfo.element;
        if (
          this.parent.focusModule.currentInfo.element &&
          this.parent.focusModule.currentInfo.element.classList.contains('e-headercell')
        ) {
          var n = this.parent.getColumnByUid(
            this.parent.focusModule.currentInfo.element.firstElementChild.getAttribute('data-mappinguid'),
          );
          var a = this.parent.getVisibleColumns();
          var o = a.indexOf(n);
          var l = e.action === 'ctrlLeftArrow' ? a[o - 1] : a[o + 1];
          if (l && l.field && n.field) {
            this.reorderColumns(n.field, l.field);
          }
        }
        break;
    }
  };
  s.prototype.drag = function (e) {
    var t = this.parent;
    var i = e.target;
    var r = T(i, '.e-headercell:not(.e-stackedHeaderCell)');
    var n = this.parent.element.querySelector('.e-cloneproperties');
    var a = this.parent.getContent().firstElementChild;
    var o = this.x > ft(e.event).x + this.parent.getContent().firstElementChild.scrollLeft;
    Q([].slice.call(this.parent.getHeaderTable().getElementsByClassName('e-reorderindicate')), ['e-reorderindicate']);
    this.setDisplay('none');
    this.stopTimer();
    G(n, ['e-defaultcur'], ['e-notallowedcur']);
    this.updateScrollPostion(e.event);
    if (r && !r.isEqualNode(this.element)) {
      i = r;
      var l = i.querySelector('.e-headercelldiv, .e-stackedheadercelldiv').getAttribute('data-mappinguid');
      !(!this.chkDropPosition(this.element, i) || !this.chkDropAllCols(this.element, i)) &&
      this.parent.getColumnByUid(l).allowReordering &&
      e.column.allowReordering
        ? (this.updateArrowPosition(i, o), G(i, ['e-allowDrop', 'e-reorderindicate'], []))
        : (this.parent.allowGrouping && S(e.target, 'e-groupdroparea')) || G(n, ['e-notallowedcur'], ['e-defaultcur']);
    } else
      r &&
      r.isEqualNode(this.element) &&
      !((this.parent.allowGrouping && e.column.allowGrouping) || e.column.allowReordering)
        ? G(n, ['e-notallowedcur'], ['e-defaultcur'])
        : !r &&
          !(this.parent.allowGrouping && S(e.target, 'e-groupdroparea')) &&
          G(n, ['e-notallowedcur'], ['e-defaultcur']);
    if (!(!e.column.allowReordering || e.column.lockColumn)) {
      this.parent.trigger(ti, {
        target: i,
        draggableType: 'headercell',
        column: e.column,
      });
    }
  };
  s.prototype.updateScrollPostion = function (e) {
    var t = this;
    var i = ft(e).x;
    var r = this.parent.element.getBoundingClientRect();
    var n = r.right;
    var a = r.left;
    var o = this.parent.getContent().firstElementChild;
    ft(e).x > r.left && ft(e).x < r.left + 35
      ? (this.timer = window.setInterval(function () {
          t.setScrollLeft(this.parent.getContent().firstElementChild, true);
        }, 50))
      : ft(e).x < r.right &&
        ft(e).x > r.right - 35 &&
        (this.timer = window.setInterval(function () {
          t.setScrollLeft(this.parent.getContent().firstElementChild, false);
        }, 50));
  };
  s.prototype.setScrollLeft = function (e, t) {
    var i = e.scrollLeft;
    e.scrollLeft = e.scrollLeft + (t ? -5 : 5);
    if (e.scrollLeft !== e.scrollLeft) {
      this.setDisplay('none');
    }
  };
  s.prototype.stopTimer = function () {
    window.clearInterval(this.timer);
  };
  s.prototype.updateArrowPosition = function (e, t) {
    var i = e.getBoundingClientRect();
    var r = this.parent.element.getBoundingClientRect();
    if (!((t && i.left < r.left) || (!t && i.right > r.right))) {
      var n = this.parent.getHeaderContent().classList.contains('e-sticky');
      this.upArrow.style.top = n ? i.top + i.height + 'px' : i.top + i.height - r.top + 'px';
      this.downArrow.style.top = n ? i.top - 7 + 'px' : i.top - r.top - 7 + 'px';
      this.upArrow.style.left = this.downArrow.style.left = n
        ? (t ? i.left : i.right) - 4 + 'px'
        : (t ? i.left : i.right) - r.left - 4 + 'px';
      this.setDisplay('');
    }
  };
  s.prototype.dragStart = function (e) {
    var t = this.parent;
    var i = e.target;
    this.element = e.target.classList.contains('e-headercell') ? e.target : S(e.target, 'e-headercell');
    if (!(!e.column.allowReordering || e.column.lockColumn)) {
      var r = this.parent.getContent().firstElementChild;
      this.x = ft(e.event).x + this.parent.getContent().firstElementChild.scrollLeft;
      this.parent.trigger(ii, {
        target: e.target,
        draggableType: 'headercell',
        column: e.column,
      });
    }
  };
  s.prototype.dragStop = function (e) {
    var t = this.parent;
    this.setDisplay('none');
    this.stopTimer();
    if (!e.cancel) {
      this.parent.trigger(mi, {
        target: e.target,
        draggableType: 'headercell',
        column: e.column,
      });
    }
    Q([].slice.call(this.parent.getHeaderTable().getElementsByClassName('e-reorderindicate')), ['e-reorderindicate']);
  };
  s.prototype.setDisplay = function (e) {
    this.upArrow.style.display = e;
    this.downArrow.style.display = e;
  };
  s.prototype.getModuleName = function () {
    return 'reorder';
  };
  return s;
})();
var Bo = (function () {
  function s(e) {
    var t = this;
    this.selectedRows = [];
    this.isOverflowBorder = true;
    this.selectedRowColls = [];
    this.isRefresh = true;
    this.isReplaceDragEle = true;
    this.istargetGrid = false;
    this.helper = function (i) {
      var r = t.parent;
      var n = t.draggable.currentStateTarget;
      if (!u(n) && t.parent.rowDropSettings.targetID && !u(n.classList) && !n.classList.contains('e-rowcell')) {
        n = S(n, 'e-rowcell');
      }
      var a = t.parent.createElement('div', { className: 'e-cloneproperties e-draganddrop e-grid e-dragclone' });
      a.style.height = 'auto';
      var o = t.parent.createElement('table', { attrs: { role: 'grid' } });
      var l = t.parent.createElement(U, { attrs: { role: 'rowgroup' } });
      if (
        document.getElementsByClassName('e-griddragarea').length ||
        (t.parent.rowDropSettings.targetID &&
          ((!u(n) && !n.classList.contains('e-selectionbackground') && t.parent.selectionSettings.type !== 'Single') ||
            !S(n, 'e-rowcell'))) ||
        (!t.parent.rowDropSettings.targetID && !S(n, 'e-rowdragdrop'))
      )
        return false;
      if (
        t.parent.rowDropSettings.targetID &&
        t.parent.selectionSettings.mode === 'Row' &&
        t.parent.selectionSettings.type === 'Single'
      ) {
        t.parent.selectRow(parseInt(t.draggable.currentStateTarget.parentElement.getAttribute(q), 10) - 1);
      }
      t.startedRow = T(n, 'tr').cloneNode(true);
      if (t.parent.isFrozenGrid())
        for (var h = [].slice.call(t.startedRow.querySelectorAll('.e-rowcell')), d = 0; d < h.length; d++) {
          Q(
            [h[parseInt(d.toString(), 10)]],
            [
              'e-leftfreeze',
              'e-freezeleftborder',
              'e-fixedfreeze',
              'e-freezerightborder',
              'e-rightfreeze',
              'e-unfreeze',
            ],
          );
          h[parseInt(d.toString(), 10)].removeAttribute('style');
        }
      t.processArgs(n);
      var p = {
        selectedRow: t.rows,
        dragelement: n,
        cloneElement: a,
        cancel: false,
        data: t.rowData,
      };
      var c = t.parent.getSelectedRows();
      t.parent.trigger(Cs, p);
      var f = 'cancel';
      if (p.cancel) return false;
      ri(t.startedRow, '.e-indentcell');
      ri(t.startedRow, '.e-detailrowcollapse');
      ri(t.startedRow, '.e-detailrowexpand');
      if (!(t.parent.enableInfiniteScrolling && t.parent.infiniteScrollSettings.enableCache)) {
        t.removeCell(t.startedRow, Is);
      }
      var g = t.startedRow.querySelectorAll('.e-active');
      g.forEach(function (v) {
        return v.classList.remove('e-active');
      });
      l.appendChild(t.startedRow);
      if (t.parent.getSelectedRowIndexes().length > 1 && t.startedRow.hasAttribute('aria-selected')) {
        var m = t.parent.createElement('span', {
          className: 'e-dropitemscount',
          innerHTML: '' + c.length,
        });
        a.appendChild(m);
      }
      var y = T(n, 'tr').querySelector('.e-icon-rowdragicon');
      if (y) {
        y.classList.add('e-dragstartrow');
      }
      o.appendChild(l);
      a.appendChild(o);
      t.parent.element.appendChild(a);
      return a;
    };
    this.dragStart = function (i) {
      var r = t.parent;
      if (
        (t.parent.enableVirtualization || t.parent.infiniteScrollSettings.enableCache) &&
        t.parent.allowGrouping &&
        t.parent.groupSettings.columns.length &&
        !u(i.target.closest('tr'))
      )
        for (
          var n = i.dragElement.querySelectorAll('tr'),
            a = i.target.closest('tr').querySelectorAll('.e-indentcell'),
            o = 0;
          o < n.length;
          o++
        )
          for (var l = 0; l < a.length; l++) {
            var h = a[parseInt(l.toString(), 10)].cloneNode(true);
            n[parseInt(o.toString(), 10)].insertBefore(h, n[parseInt(o.toString(), 10)].firstElementChild);
          }
      if (t.parent.element.classList.contains('e-childgrid')) {
        var d = t.getParentGrid(t.parent.element);
        d.appendChild(i.dragElement);
        t.parent.element.appendChild(t.parent.createElement('div', { className: 'e-drag-ref' }));
      }
      document.body.classList.add('e-prevent-select');
      if (!document.getElementsByClassName('e-griddragarea').length) {
        var p = i.target;
        var c = t.parent.element.querySelector('.e-dropitemscount');
        if (t.parent.getSelectedRecords().length > 1 && c) {
          c.style.left = t.parent.element.querySelector('.e-cloneproperties table').offsetWidth - 5 + 'px';
        }
        t.processArgs(i.target);
        t.parent.trigger(xs, {
          rows: t.rows,
          target: i.target,
          draggableType: 'rows',
          fromIndex: parseInt(t.rows[0].getAttribute(q), 10) - 1,
          data: t.rowData[0] && Object.keys(t.rowData[0]).length > 0 ? t.rowData : t.currentViewData(),
        });
        t.dragStartData = t.rowData;
        var f = document.getElementById(t.parent.rowDropSettings.targetID);
        if (
          t.parent.rowDropSettings.targetID &&
          f &&
          f.ej2_instances &&
          f.ej2_instances[0].getModuleName() === 'grid'
        ) {
          f.ej2_instances[0].getContent().classList.add('e-allowRowDrop');
        }
      }
    };
    this.drag = function (i) {
      var r = t.parent;
      t.isDropGrid = t.parent;
      t.istargetGrid = false;
      if (t.parent.rowDropSettings.targetID) {
        var n = document.getElementById(t.parent.rowDropSettings.targetID);
        t.isDropGrid = n.ej2_instances[0];
        if (S(i.target, 'e-grid')) {
          t.istargetGrid = t.parent.rowDropSettings.targetID === S(i.target, 'e-grid').id;
        }
      }
      var a = t.parent.element.querySelector('.e-cloneproperties');
      if (t.parent.element.classList.contains('e-childgrid')) {
        var o = t.getParentGrid(t.parent.element);
        a = o.querySelector('.e-cloneproperties');
      }
      var l = t.getElementFromPosition(a, i.event);
      G(a, ['e-defaultcur'], ['e-notallowedcur', 'e-movecur', 'e-grabcur']);
      t.isOverflowBorder = true;
      t.hoverState = t.parent.enableHover;
      var h = S(l, 'e-grid') ? T(i.target, 'tr') : null;
      if (i.target) {
        t.processArgs(l);
        if (t.parent.enableVirtualization && u(t.rows[0])) {
          G(a, ['e-notallowedcur'], ['e-movecur']);
        }
        var d = {
          rows: t.rows,
          target: l,
          draggableType: 'rows',
          data: t.rowData,
          originalEvent: i,
          cancel: false,
        };
        t.parent.trigger(Es, d);
        t.stopTimer();
        if (!d.cancel) {
          t.parent.element.classList.add('e-rowdrag');
          h && (S(l, 'e-grid').id === a.parentElement.id || S(l, 'e-grid').id)
            ? t.isDropGrid.element.querySelector('.e-emptyrow')
              ? (t.dragTarget = 0)
              : (t.dragTarget = parseInt(h.getAttribute('aria-rowindex'), 10) - 1)
            : (t.dragTarget = parseInt(t.startedRow.getAttribute('aria-rowindex'), 10) - 1);
          if (t.parent.rowDropSettings.targetID) {
            var p = document.querySelector('.e-drag-ref');
            !S(l, 'e-grid') ||
            (p && S(p.parentElement, 'e-grid').id === S(l, 'e-grid').id) ||
            S(a.parentElement, 'e-grid').id === S(l, 'e-grid').id
              ? G(a, ['e-notallowedcur'], ['e-defaultcur'])
              : G(a, ['e-grabcur'], ['e-notallowedcur']);
          } else {
            var c = S(l, 'e-grid');
            c && c.id === a.parentElement.id && S(l, 'e-row') && !S(l, 'e-addedrow')
              ? G(a, ['e-movecur'], ['e-defaultcur'])
              : G(a, ['e-notallowedcur'], ['e-movecur']);
          }
          if (S(t.isDropGrid.element, 'e-grid')) {
            if (
              (!t.isDropGrid.groupSettings.columns.length || t.isDropGrid.groupSettings.columns.length) &&
              !t.isDropGrid.element.querySelector('.e-emptyrow')
            ) {
              if (S(l, 'e-grid') && S(l, 'e-grid').id === t.isDropGrid.element.id) {
                t.updateScrollPostion(i.event);
              }
              if (
                ((t.isOverflowBorder || t.parent.frozenRows > t.dragTarget) &&
                  (parseInt(t.startedRow.getAttribute(q), 10) - 1 !== t.dragTarget || t.istargetGrid)) ||
                (t.istargetGrid &&
                  h &&
                  t.isDropGrid
                    .getRowByIndex(t.isDropGrid.getCurrentViewRecords().length - 1)
                    .getAttribute('data-uid') === h.getAttribute('data-uid'))
              )
                t.moveDragRows(i, t.startedRow, h);
              else {
                var f = void 0;
                if (t.parent.enableVirtualization)
                  f =
                    h &&
                    parseInt(h.getAttribute(q), 10) - 1 ===
                      t.parent.renderModule.data.dataManager.dataSource.json.length - 1;
                else {
                  var g =
                    t.parent.enableInfiniteScrolling &&
                    t.parent.infiniteScrollSettings.enableCache &&
                    !t.parent.groupSettings.enableLazyLoading
                      ? t.parent.pageSettings.currentPage * t.parent.pageSettings.pageSize - 1
                      : t.parent.getCurrentViewRecords().length - 1;
                  var m = t.parent.getRowByIndex(g);
                  f =
                    h &&
                    m &&
                    m.getAttribute('data-uid') === h.getAttribute('data-uid') &&
                    m.getAttribute('data-uid') !== t.startedRow.getAttribute('data-uid');
                  if (t.isNewRowAdded() && t.parent.editSettings.newRowPosition === 'Bottom') {
                    f = false;
                  }
                }
                if (f && !t.parent.rowDropSettings.targetID) {
                  var y = t.parent.createElement('div', { className: 'e-lastrow-dragborder' });
                  var v = t.parent.getContent();
                  y.style.width = t.parent.element.offsetWidth - t.getScrollWidth() + 'px';
                  if (t.parent.enableVirtualization) {
                    y.style.zIndex = '1';
                  }
                  if (
                    !v.getElementsByClassName('e-lastrow-dragborder').length &&
                    (!(t.parent.allowGrouping && t.parent.groupSettings.columns.length) || u(h.nextSibling))
                  ) {
                    v.classList.add('e-grid-relative');
                    v.appendChild(y);
                    y.style.bottom = t.getScrollWidth() + 'px';
                  }
                }
                t.removeBorder(h);
              }
            }
            if (l && l.classList.contains(ct) && !t.isDropGrid.element.querySelector('.e-emptyrow') && t.istargetGrid) {
              t.removeBorder(h);
              var g = t.isDropGrid.getCurrentViewRecords().length - 1;
              var b = '.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse';
              var w = '.e-rowcell:not(.e-hide),.e-rowdragdrop:not(.e-hide),.e-detailrowcollapse:not(.e-hide)';
              var C = [];
              t.parent.allowGrouping && t.parent.groupSettings.columns && t.parent.groupSettings.columns.length
                ? (C = [].slice.call(
                    t.isDropGrid
                      .getRowByIndex(g)
                      .querySelectorAll(
                        '.e-rowcell:not(.e-hide),.e-rowdragdrop:not(.e-hide),.e-detailrowcollapse:not(.e-hide)',
                      ),
                  ))
                : (C = [].slice.call(
                    t.isDropGrid.getRowByIndex(g).querySelectorAll('.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse'),
                  ));
              if (C.length > 0) {
                t.parent.allowGrouping && t.parent.groupSettings.columns && t.parent.groupSettings.columns.length
                  ? t.groupRowDDIndicator(C, true)
                  : De(C, true, 'e-dragborder');
              }
            }
          }
        }
      }
    };
    this.dragStop = function (i) {
      if (t.parent.isCheckBoxSelection && t.parent.enableInfiniteScrolling) {
        window.getSelection().removeAllRanges();
      }
      document.body.classList.remove('e-prevent-select');
      qe(t.parent)
        ? t.parent.notify(ye, {
            instance: t,
            handler: t.processDragStop,
            arg1: i,
          })
        : t.processDragStop(i);
    };
    this.processDragStop = function (i) {
      var r = t.parent;
      if (!t.parent.isDestroyed) {
        var n = t.getElementFromPosition(i.helper, i.event);
        var a = n && !n.classList.contains('e-dlg-overlay') ? n : i.target;
        t.parent.element.classList.remove('e-rowdrag');
        var o = document.getElementById(t.parent.rowDropSettings.targetID);
        if (
          t.parent.rowDropSettings.targetID &&
          o &&
          o.ej2_instances &&
          o.ej2_instances[0].getModuleName() === 'grid'
        ) {
          o.ej2_instances[0].getContent().classList.remove('e-allowRowDrop');
        }
        if (S(t.isDropGrid.element, 'e-grid')) {
          t.stopTimer();
          t.isDropGrid.enableHover = t.hoverState;
          t.isDropGrid.getContent().classList.remove('e-grid-relative');
          t.removeBorder(n);
          var l = t.isDropGrid.element.querySelector('.e-dragstartrow');
          if (l) {
            l.classList.remove('e-dragstartrow');
          }
        }
        t.processArgs(a);
        if (!(t.parent.enableVirtualization && u(t.rows[0]))) {
          var h = {
            target: a,
            draggableType: 'rows',
            cancel: false,
            fromIndex: parseInt(t.rows[0].getAttribute(q), 10) - 1,
            dropIndex: t.dragTarget,
            rows: t.rows,
            data: Object.keys(t.dragStartData[0]).length > 0 ? t.dragStartData : t.currentViewData(),
          };
          t.parent.trigger(Ds, h, function () {
            if (!(S(a, de) || S(a, 'e-emptyrow') || S(a, pe)) || h.cancel) {
              t.dragTarget = null;
              N(i.helper);
              return;
            }
            t.isRefresh = false;
            var d = t.parent.getSelectedRowIndexes();
            if (t.parent.isRowDragable()) {
              !t.parent.rowDropSettings.targetID &&
              t.startedRow.querySelector('td.e-selectionbackground') &&
              d.length > 1 &&
              d.length !== t.parent.getCurrentViewRecords().length
                ? t.reorderRows(d, h.dropIndex)
                : t.reorderRows([parseInt(t.startedRow.getAttribute(q), 10) - 1], t.dragTarget);
              t.dragTarget = null;
              if (!t.parent.rowDropSettings.targetID) {
                if (
                  i.helper.classList.contains('e-cloneproperties') &&
                  document.querySelector('.' + i.helper.classList[0])
                ) {
                  N(i.helper);
                }
                t.parent.enableVirtualization &&
                !t.parent.sortSettings.columns.length &&
                !t.parent.filterSettings.columns.length &&
                (!t.parent.allowGrouping || !t.parent.groupSettings.columns.length)
                  ? (t.parent.refresh(), (t.parent.contentModule.vgenerator.startIndex = null))
                  : t.rowOrder(h);
              }
              if (t.parent.getContentTable().scrollHeight < t.parent.getContent().clientHeight) {
                t.parent.scrollModule.setLastRowCell();
              }
            }
            t.isRefresh = true;
          });
        }
      }
    };
    this.removeCell = function (i, r) {
      return [].slice.call(i.querySelectorAll('td')).filter(function (n) {
        if (n.classList.contains(r)) {
          i.deleteCell(n.cellIndex);
        }
      });
    };
    this.parent = e;
    if (!this.parent.isDestroyed) {
      this.parent.on(Ce, this.initializeDrag, this);
      this.parent.on(mi, this.columnDrop, this);
      this.parent.on(rr, this.onActionComplete, this);
      this.onDataBoundFn = this.onDataBound.bind(this);
      this.parent.addEventListener(Pe, this.onDataBoundFn);
      this.parent.on(Se, this.enableAfterRender, this);
      this.parent.on(M, this.destroy, this);
    }
  }
  s.prototype.getParentGrid = function (e) {
    for (var t = e, i = false; !i; ) {
      if (t.ej2_instances[0].parentDetails) {
        t = document.getElementById(t.ej2_instances[0].parentDetails.parentID);
      }
      if (!t.classList.contains('e-childgrid')) {
        i = true;
      }
    }
    return t;
  };
  s.prototype.isNewRowAdded = function () {
    return (
      this.parent.editSettings &&
      this.parent.editSettings.showAddNewRow &&
      !(this.parent.enableInfiniteScrolling || this.parent.enableVirtualization)
    );
  };
  s.prototype.groupRowDDIndicator = function (e, t) {
    De([e[0]], t, 'e-dragleft');
    De(e, t, 'e-dragtop', 'e-dragbottom');
    De([e[e.length - 1]], t, 'e-dragright');
  };
  s.prototype.refreshRow = function (e, t, i) {
    for (
      var r = this.parent,
        n = r.getContentTable().querySelector(U),
        a = r.getHeaderTable().querySelector(U),
        o = 0,
        l = e.rows.length;
      o < l;
      o++
    ) {
      var h = e.rows[parseInt(o.toString(), 10)];
      if (
        ((r.enableVirtualization && r.allowGrouping && r.groupSettings.columns.length) ||
          (r.enableInfiniteScrolling && r.infiniteScrollSettings.enableCache)) &&
        e.rows.length === 1
      ) {
        var d = r.getRowElementByUID(e.rows[parseInt(o.toString(), 10)].getAttribute('data-uid'));
        if (!u(d)) {
          N(d);
        }
      }
      var p = e.rows[parseInt(o.toString(), 10)].querySelector('.e-dragstartrow');
      if (p) {
        p.classList.remove('e-dragstartrow');
      }
      t.insertBefore(e.rows[parseInt(o.toString(), 10)], i);
      if (r.allowGrouping && r.groupSettings.columns.length) {
        var c = e.rows[parseInt(o.toString(), 10)].getAttribute('data-uid');
        var f = e.target.parentElement.getAttribute('data-uid');
        var g = r.getRowObjectFromUID(c);
        var m = r.getRowObjectFromUID(f);
        if (g.parentUid !== m.parentUid) {
          r.groupModule.groupReorderHandler(g, m);
        }
      }
    }
    var y = [].slice.call(
      r.editSettings.showAddNewRow ? t.querySelectorAll('.e-row:not(.e-addedrow)') : t.getElementsByClassName(de),
    );
    r.allowGrouping && r.groupSettings.columns.length
      ? r.groupSettings.enableLazyLoading ||
        (r.enableInfiniteScrolling && r.infiniteScrollSettings.enableCache && y.length > r.pageSettings.pageSize * 3)
        ? r.refresh()
        : (er(this.parent, e, y),
          r.enableVirtualization || (r.enableInfiniteScrolling && r.infiniteScrollSettings.enableCache)
            ? tr(r)
            : ir(
                this.parent,
                r.getRowsObject().filter(function (v) {
                  return v.isDataRow;
                }),
                y,
              ),
          this.parent.notify(dn, { rows: r.enableVirtualization ? this.parent.vRows : this.parent.getRowsObject() }))
      : r.enableInfiniteScrolling && r.infiniteScrollSettings.enableCache && !r.groupSettings.columns.length
        ? y.length > r.pageSettings.pageSize * 3
          ? r.refresh()
          : (er(this.parent, e, y), tr(r))
        : this.refreshData(y);
    if (this.parent.frozenRows)
      for (var o = 0, l = y.length; o < l; o++)
        o < this.parent.frozenRows
          ? a.appendChild(y[parseInt(o.toString(), 10)])
          : n.appendChild(y[parseInt(o.toString(), 10)]);
  };
  s.prototype.updateFrozenRowreOrder = function (e) {
    var t = this.parent;
    var i = this.parent.getContentTable().querySelector(U);
    var r = this.parent.getHeaderTable().querySelector(U);
    var n = [].slice.call(r.getElementsByClassName(de)).concat([].slice.call(i.getElementsByClassName(de)));
    var a = this.parent.createElement(U, { attrs: { role: 'rowgroup' } });
    !this.parent.selectionSettings.persistSelection &&
    Object.keys(this.parent.selectionModule.selectedRowState).length === 0
      ? this.parent.clearSelection()
      : this.parent.clearRowSelection();
    for (var o = this.refreshRowTarget(e), l = 0, h = n.length; l < h; l++)
      a.appendChild(n[parseInt(l.toString(), 10)]);
    this.refreshRow(e, a, o);
  };
  s.prototype.refreshRowTarget = function (e) {
    var t = this.parent;
    var i = parseInt(e.target.parentElement.getAttribute(q), 10) - 1;
    if (this.parent.enableVirtualization && this.parent.allowGrouping && this.parent.groupSettings.columns.length) {
      i = this.parent.getDataRows().indexOf(e.target.parentElement);
    }
    if (
      (e.fromIndex < e.dropIndex || e.fromIndex === e.dropIndex) &&
      (!this.parent.allowGrouping || !this.parent.groupSettings.columns.length)
    ) {
      i = i + 1;
    }
    var r = this.parent.getRowByIndex(i);
    if (
      i === this.parent.getRows().length &&
      this.isNewRowAdded() &&
      this.parent.editSettings.newRowPosition === 'Bottom'
    ) {
      r = this.parent.element.querySelector('.e-row.e-addedrow');
    }
    var n =
      this.parent.allowGrouping &&
      this.parent.groupSettings.columns.length &&
      i !== -1 &&
      e.fromIndex < e.dropIndex &&
      r
        ? r.nextSibling
        : r;
    return n;
  };
  s.prototype.updateFrozenColumnreOrder = function (e) {
    var t = this.parent;
    var i = this.parent.getContentTable().querySelector(U);
    !this.parent.selectionSettings.persistSelection &&
    Object.keys(this.parent.selectionModule.selectedRowState).length === 0
      ? this.parent.clearSelection()
      : this.parent.clearRowSelection();
    var r = this.refreshRowTarget(e);
    this.refreshRow(e, i, r);
  };
  s.prototype.refreshData = function (e) {
    for (
      var t = {}, i = {}, r = this.parent.getRowsObject(), n = this.parent.getCurrentViewRecords(), a = 0, o = e.length;
      a < o;
      a++
    ) {
      var l = parseInt(e[parseInt(a.toString(), 10)].getAttribute(q), 10) - 1;
      t[parseInt(a.toString(), 10)] = r[parseInt(l.toString(), 10)];
      i[parseInt(a.toString(), 10)] = n[parseInt(l.toString(), 10)];
    }
    for (var h = this.parent.getRows(), a = 0, o = e.length; a < o; a++) {
      h[parseInt(a.toString(), 10)] = e[parseInt(a.toString(), 10)];
      r[parseInt(a.toString(), 10)] = t[parseInt(a.toString(), 10)];
      n[parseInt(a.toString(), 10)] = i[parseInt(a.toString(), 10)];
    }
    ir(this.parent, r, e);
  };
  s.prototype.rowOrder = function (e) {
    if (!(e.dropIndex === e.fromIndex || isNaN(e.dropIndex) || S(e.target, 'e-groupcaption'))) {
      if (this.parent.isDetail()) {
        this.parent.detailCollapseAll();
        var t = [].slice.call(this.parent.getContentTable().querySelector(U).children);
        var i = this.parent.getRowsObject();
        t.filter(function (o) {
          if (o.classList.contains('e-detailrow')) {
            o.remove();
          }
        });
        for (var r = 0, n = i.length; r < n && i[parseInt(r.toString(), 10)]; r++)
          if (i[parseInt(r.toString(), 10)].isDetailRow) {
            this.parent.getRowsObject().splice(r, 1);
            r--;
          }
      }
      if (
        e.target.classList.contains('e-rowcelldrag') ||
        e.target.classList.contains('e-dtdiagonalright') ||
        e.target.classList.contains('e-dtdiagonaldown')
      ) {
        e.target = e.target.parentElement;
      }
      if (!e.target.classList.contains('e-rowcell') && S(e.target, 'e-rowcell')) {
        e.target = S(e.target, 'e-rowcell');
      }
      this.parent.frozenRows ? this.updateFrozenRowreOrder(e) : this.updateFrozenColumnreOrder(e);
      if (
        (!this.parent.allowGrouping || !this.parent.groupSettings.columns.length) &&
        this.selectedRowColls.length > 0
      ) {
        this.parent.selectRows(this.selectedRowColls);
        var a = [];
        if (this.parent.filterSettings.columns.length || this.parent.sortSettings.columns.length) {
          for (var r = 0, n = e.rows.length; r < n; r++)
            a.push(parseInt(e.rows[parseInt(r.toString(), 10)].getAttribute(q), 10) - 1);
          this.selectedRowColls = a;
        }
        this.selectedRowColls = [];
      } else this.selectedRowColls = [];
    }
  };
  s.prototype.currentViewData = function () {
    for (
      var e = this.parent.getSelectedRowIndexes(),
        t = [],
        i = parseInt(this.startedRow.getAttribute(q), 10) - 1,
        r = 0,
        n = e.length;
      r < n;
      r++
    ) {
      var a = 'currentViewData';
      t[parseInt(r.toString(), 10)] = this.parent.currentViewData[e[parseInt(r.toString(), 10)]];
    }
    if (!this.parent.rowDropSettings.targetID && e.length === 0) {
      t[0] = this.parent.currentViewData[parseInt(i.toString(), 10)];
    }
    return t;
  };
  s.prototype.reorderRows = function (e, t) {
    for (
      var i = this.parent.getSelectedRowIndexes(),
        r = [],
        n = [],
        a = this.parent.getDataModule().isRemote()
          ? this.parent.getCurrentViewRecords()
          : this.parent.renderModule.data.dataManager.dataSource.json,
        o = this.parent.allowPaging
          ? this.parent.pageSettings.currentPage * this.parent.pageSettings.pageSize - this.parent.pageSettings.pageSize
          : 0,
        l = t + o,
        h = e[0] + o,
        d = 0,
        p = e.length;
      d < p;
      d++
    )
      n[parseInt(d.toString(), 10)] = a[e[parseInt(d.toString(), 10)] + o];
    for (var d = 0, p = i.length; d < p; d++) r[parseInt(d.toString(), 10)] = a[i[parseInt(d.toString(), 10)] + o];
    for (var d = 0, p = n.length; d < p; d++) {
      if (d !== 0) {
        for (var c = 0, f = a.length; c < f; c++)
          if (JSON.stringify(a[parseInt(c.toString(), 10)]) === JSON.stringify(n[parseInt(d.toString(), 10)])) {
            h = c;
            break;
          }
        for (var c = 0, f = a.length; c < f; c++)
          if (JSON.stringify(a[parseInt(c.toString(), 10)]) === JSON.stringify(n[d - 1])) {
            if (h > c) {
              l = c + 1;
            }
            break;
          }
      }
      this.reorderRow(h - o, l - o);
    }
    if (this.isRefresh) {
      this.parent.notify(ee, {
        type: _,
        requestType: 'rowdraganddrop',
      });
    }
    for (var d = 0, p = r.length; d < p; d++)
      for (var c = 0, f = a.length; c < f; c++)
        if (JSON.stringify(a[parseInt(c.toString(), 10)]) === JSON.stringify(r[parseInt(d.toString(), 10)])) {
          i[parseInt(d.toString(), 10)] = c - o;
          break;
        }
    this.selectedRowColls = i;
  };
  s.prototype.stopTimer = function () {
    window.clearInterval(this.timer);
  };
  s.prototype.onActionComplete = function (e) {
    this.parent.trigger(
      B,
      E(e, {
        type: B,
        requestType: 'rowdraganddrop',
      }),
    );
  };
  s.prototype.initializeDrag = function () {
    var e = this.parent;
    this.draggable = new vs(this.parent.element, {
      dragTarget: '.e-rowcelldrag, .e-rowdragdrop, .e-rowcell',
      distance: 5,
      helper: this.helper,
      dragStart: this.dragStart,
      drag: this.drag,
      dragStop: this.dragStop,
      isReplaceDragEle: this.isReplaceDragEle,
      isPreventSelect: false,
      isPreventScroll: true,
    });
  };
  s.prototype.updateScrollPostion = function (e) {
    var t = this;
    var i = ft(e).y;
    var r = this.isDropGrid.getContent().getBoundingClientRect();
    var n = this.isDropGrid.getRowHeight() - 15;
    var a = this.isDropGrid.getContent().firstElementChild;
    var o = this.parent.enableVirtualization ? 20 : 0;
    if (r.top >= ft(e).y) {
      var l = -this.isDropGrid.getRowHeight();
      this.isOverflowBorder = false;
      this.timer = window.setInterval(function () {
        t.setScrollDown(this.isDropGrid.getContent().firstElementChild, l);
      }, 200);
    } else if (r.top + this.isDropGrid.getContent().clientHeight - n - 33 - o <= ft(e).y) {
      var h = this.isDropGrid.getRowHeight();
      this.isOverflowBorder = false;
      this.timer = window.setInterval(function () {
        t.setScrollDown(this.isDropGrid.getContent().firstElementChild, h);
      }, 200);
    }
  };
  s.prototype.setScrollDown = function (e, t) {
    e.scrollTop = e.scrollTop + t;
  };
  s.prototype.moveDragRows = function (e, t, i) {
    var r = this.parent.element.querySelector('.e-cloneproperties');
    if (this.parent.element.classList.contains('e-childgrid')) {
      var n = this.getParentGrid(this.parent.element);
      r = n.querySelector('.e-cloneproperties');
    }
    var a = T(e.target, 'tr');
    if (
      S(a, 'e-grid') &&
      ((!this.parent.rowDropSettings.targetID && S(r.parentElement, 'e-grid').id === S(a, 'e-grid').id) ||
        this.istargetGrid)
    ) {
      var o = a;
      if (!a) {
        o = t;
      }
      this.setBorder(o, e.event, t, i);
    }
  };
  s.prototype.setBorder = function (e, t, i, r) {
    var n = this.parent.element;
    if (this.istargetGrid) {
      n = this.isDropGrid.element;
    }
    var a = this.parent.element.querySelector('.e-cloneproperties');
    this.parent.allowGrouping && this.parent.groupSettings.columns.length
      ? this.removeBorder(e)
      : (this.removeFirstRowBorder(e), this.removeLastRowBorder(e));
    if (
      S(e, 'e-grid') &&
      e.classList.contains(de) &&
      ((!this.parent.rowDropSettings.targetID && S(a.parentElement, 'e-grid').id === S(e, 'e-grid').id) ||
        this.istargetGrid)
    ) {
      this.parent.allowGrouping && this.parent.groupSettings.columns && this.parent.groupSettings.columns.length
        ? Q(n.querySelectorAll('.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse'), [
            'e-dragtop',
            'e-dragright',
            'e-dragbottom',
            'e-dragleft',
          ])
        : Q(n.querySelectorAll('.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse'), ['e-dragborder']);
      var o = [];
      var l = parseInt(r.getAttribute(q), 10) - 1;
      if (r && l === 0 && !(this.isNewRowAdded() && this.parent.editSettings.newRowPosition === 'Top'))
        if (this.parent.allowGrouping && this.parent.groupSettings.columns.length) {
          e = r;
          o = [].slice.call(
            e.querySelectorAll('.e-groupcaption,.e-summarycell,.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse'),
          );
        } else {
          var h = this.parent.createElement('div', { className: 'e-firstrow-dragborder' });
          var d = this.isDropGrid.getHeaderContent();
          d.classList.add('e-grid-relative');
          h.style.width = n.offsetWidth - this.getScrollWidth() + 'px';
          if (!d.getElementsByClassName('e-firstrow-dragborder').length) {
            this.parent.frozenRows
              ? (this.parent.isFrozenGrid() &&
                  (h.style.width = this.parent.getContent().firstElementChild.scrollWidth + 'px'),
                d.querySelector('thead').appendChild(h),
                (h.style.position = 'relative'))
              : d.appendChild(h);
          }
        }
      else
        this.parent.rowDropSettings.targetID && r
          ? ((e = this.isDropGrid.getRowByIndex(l - 1)),
            (o = [].slice.call(e.querySelectorAll('.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse'))))
          : r && parseInt(i.getAttribute(q), 10) - 1 > l
            ? (this.parent.enableVirtualization &&
                this.parent.allowGrouping &&
                this.parent.groupSettings.columns.length &&
                (l = this.parent.getDataRows().indexOf(r)),
              this.parent.allowGrouping && this.parent.groupSettings.columns.length
                ? ((e = r),
                  (o = [].slice.call(
                    e.querySelectorAll(`.e-groupcaption,.e-summarycell,.e-rowcell:not(.e-hide),.e-rowdragdrop:not(.e-hide),
                        .e-detailrowcollapse:not(.e-hide)`),
                  )))
                : (l === 0 && this.isNewRowAdded() && this.parent.editSettings.newRowPosition === 'Top'
                    ? (e = this.parent.element.querySelector('.e-row.e-addedrow tr'))
                    : (e = this.parent.getRowByIndex(l - 1)),
                  (o = [].slice.call(
                    e.querySelectorAll('.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse,.e-dragindentcell'),
                  ))))
            : (o = [].slice.call(e.querySelectorAll('.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse')));
      if (o.length > 0) {
        this.parent.allowGrouping && this.parent.groupSettings.columns && this.parent.groupSettings.columns.length
          ? this.groupRowDDIndicator(o, true)
          : De(o, true, 'e-dragborder');
      }
    }
  };
  s.prototype.getScrollWidth = function () {
    var e = this.parent.getContent().firstElementChild;
    return this.parent.getContent().firstElementChild.scrollWidth >
      this.parent.getContent().firstElementChild.offsetWidth
      ? ys.getScrollBarWidth()
      : 0;
  };
  s.prototype.removeFirstRowBorder = function (e) {
    if (
      this.isDropGrid.element.getElementsByClassName('e-firstrow-dragborder').length > 0 &&
      e &&
      (e.rowIndex !== 0 || e.classList.contains('e-columnheader'))
    )
      N(this.isDropGrid.element.getElementsByClassName('e-firstrow-dragborder')[0]);
    else {
      var t = this.parent.element.querySelector('.e-row.e-addedrow tr');
      if (t && t.querySelector('.e-dragborder')) {
        var i = [].slice.call(t.querySelectorAll('.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse,.e-dragindentcell'));
        De(i, false, 'e-dragborder');
      }
    }
  };
  s.prototype.removeLastRowBorder = function (e) {
    var t;
    if (this.parent.enableVirtualization)
      t =
        e &&
        parseInt(e.getAttribute(q), 10) - 1 !== this.parent.renderModule.data.dataManager.dataSource.json.length - 1;
    else {
      var i =
        this.parent.enableInfiniteScrolling &&
        this.parent.infiniteScrollSettings.enableCache &&
        !this.parent.groupSettings.enableLazyLoading
          ? this.parent.pageSettings.currentPage * this.parent.pageSettings.pageSize - 1
          : this.parent.getCurrentViewRecords().length - 1;
      var r = this.parent.getRowByIndex(i);
      t = e && r && r.getAttribute('data-uid') !== e.getAttribute('data-uid');
    }
    if (this.parent.element.getElementsByClassName('e-lastrow-dragborder').length > 0 && e && t) {
      N(this.parent.element.getElementsByClassName('e-lastrow-dragborder')[0]);
    }
  };
  s.prototype.removeBorder = function (e) {
    this.removeFirstRowBorder(e);
    if (!this.parent.rowDropSettings.targetID) {
      this.removeLastRowBorder(e);
    }
    this.parent.allowGrouping && this.parent.groupSettings.columns.length
      ? (e = [].slice.call(this.isDropGrid.getContentTable().querySelectorAll('tr')).filter(function (i) {
          return i.querySelector('td.e-dragtop.e-dragbottom');
        })[0])
      : (e = this.isDropGrid.getRows().filter(function (i) {
          return i.querySelector('td.e-dragborder');
        })[0]);
    if (e) {
      var t =
        this.parent.allowGrouping && this.parent.groupSettings.columns.length
          ? [].slice.call(e.querySelectorAll('.e-dragtop.e-dragbottom'))
          : [].slice.call(e.getElementsByClassName('e-dragborder'));
      this.parent.allowGrouping && this.parent.groupSettings.columns && this.parent.groupSettings.columns.length
        ? this.groupRowDDIndicator(t, false)
        : De(t, false, 'e-dragborder');
    }
  };
  s.prototype.getElementFromPosition = function (e, t) {
    var i = ft(t);
    e.style.display = 'none';
    var r = document.elementFromPoint(i.x, i.y);
    e.style.display = '';
    return r;
  };
  s.prototype.onDataBound = function () {
    if (this.selectedRowColls.length > 0 && (this.parent.enableVirtualization || this.parent.allowRowDragAndDrop)) {
      this.parent.selectRows(this.selectedRowColls);
      this.selectedRowColls = [];
    }
  };
  s.prototype.getTargetIdx = function (e) {
    return e ? parseInt(e.getAttribute(q), 10) - 1 : 0;
  };
  s.prototype.singleRowDrop = function (e) {
    var t = T(e.target, 'tr');
    var i = e.droppedElement.parentElement.ej2_instances[0];
    var r = t ? t.rowIndex : e.droppedElement.parentElement.ej2_instances[0].currentViewData.length - 1;
    this.reorderRow(this.startedRowIndex, r);
  };
  s.prototype.columnDrop = function (e) {
    var t = this.parent;
    if (
      e.droppedElement.getAttribute('action') !== 'grouping' &&
      (S(e.target, de) || S(e.target, 'e-emptyrow') || S(e.target, pe))
    ) {
      var i = T(e.target, 'tr');
      var r = void 0;
      var n = document.querySelector('.e-drag-ref');
      if (
        (e.droppedElement.querySelector('tr').getAttribute('single-dragrow') !== 'true' &&
          (e.droppedElement.parentElement.id === this.parent.element.id ||
            (n && n.parentElement.id === this.parent.element.id))) ||
        (e.droppedElement.querySelector('tr').getAttribute('single-dragrow') === 'true' &&
          e.droppedElement.parentElement.id !== this.parent.element.id)
      )
        return;
      if (e.droppedElement.parentElement.id !== this.parent.element.id)
        n ? ((r = n.parentElement.ej2_instances[0]), N(n)) : (r = e.droppedElement.parentElement.ej2_instances[0]);
      else if (
        this.isSingleRowDragDrop ||
        e.droppedElement.querySelector('tr').getAttribute('single-dragrow') === 'true'
      ) {
        this.singleRowDrop(e);
        return;
      }
      if (r.element.id !== this.parent.element.id && r.rowDropSettings.targetID !== this.parent.element.id) return;
      var a = r.getSelectedRecords();
      var o = this.getTargetIdx(i);
      if (e.target && e.target.classList.contains('e-content') && this.parent.getCurrentViewRecords().length) {
        var l = this.parent.getContentTable().querySelector('tr:last-child');
        if (l) {
          o = parseInt(l.getAttribute(q), 10);
        }
      }
      if (isNaN(o)) {
        o = 0;
      }
      if (this.parent.allowPaging) {
        o =
          o +
          this.parent.pageSettings.currentPage * this.parent.pageSettings.pageSize -
          this.parent.pageSettings.pageSize;
      }
      this.parent.notify(Ss, {
        toIndex: o,
        records: a,
      });
      this.parent.notify(ee, {
        type: _,
        requestType: 'rowdraganddrop',
      });
      var h = r.getSelectedRowIndexes();
      var d = r.allowPaging ? r.pageSettings.currentPage * r.pageSettings.pageSize - r.pageSettings.pageSize : 0;
      this.selectedRows = [];
      for (var p = 0, c = a.length; p < c; p++) this.selectedRows.push(d + h[parseInt(p.toString(), 10)]);
      r.notify(ws, {
        indexes: this.selectedRows,
        records: a,
      });
      if (r.dataSource instanceof H && r.dataSource.dataSource.offline) {
        r.notify(ee, {
          type: _,
          requestType: 'rowdraganddrop',
        });
      }
    }
  };
  s.prototype.reorderRow = function (e, t) {
    var i = this.parent;
    if (!this.parent.groupSettings.columns.length) {
      var r = this.parent.allowPaging
        ? this.parent.pageSettings.currentPage * this.parent.pageSettings.pageSize - this.parent.pageSettings.pageSize
        : 0;
      t = t + r;
      this.selectedRows = this.parent.getSelectedRowIndexes();
      this.parent.notify(bs, {
        fromIndex: e + r,
        toIndex: t,
      });
    }
  };
  s.prototype.enableAfterRender = function (e) {
    if (e.module === this.getModuleName() && e.enable) {
      this.initializeDrag();
    }
  };
  s.prototype.destroy = function () {
    var e = this.parent.element;
    if (
      !(
        this.parent.isDestroyed ||
        !this.parent.element ||
        (!this.parent.element.querySelector('.' + Oe) && !this.parent.element.querySelector('.' + pe))
      )
    ) {
      this.draggable.destroy();
      this.parent.off(Ce, this.initializeDrag);
      this.parent.off(mi, this.columnDrop);
      this.parent.off(rr, this.onActionComplete);
      this.parent.removeEventListener(Pe, this.onDataBoundFn);
      this.parent.off(Se, this.enableAfterRender);
      this.parent.off(M, this.destroy);
    }
  };
  s.prototype.getModuleName = function () {
    return 'rowDragAndDrop';
  };
  s.prototype.processArgs = function (e) {
    var t = this.parent;
    var i = parseInt(this.startedRow.getAttribute(q), 10) - 1;
    (this.parent.getSelectedRecords().length > 0 &&
      this.startedRow.cells[0].classList.contains('e-selectionbackground') === false) ||
    this.parent.getSelectedRecords().length === 0
      ? (this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache
          ? (this.rows = [this.startedRow])
          : (this.rows = [this.parent.getRowByIndex(i)]),
        (this.rowData = [this.parent.getRowInfo(this.startedRow.querySelector('.' + ie)).rowData]),
        (this.parent.enableVirtualization ||
          (this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache)) &&
          this.parent.allowGrouping &&
          this.parent.groupSettings.columns.length &&
          this.parent.getSelectedRows().length &&
          ((this.rows = this.parent.getSelectedRows()),
          (this.rowData = Array.from(this.rows, function (r) {
            return this.parent.getRowObjectFromUID(r.getAttribute('data-uid')).data;
          }))))
      : ((this.rows = this.parent.getSelectedRows()),
        (this.rowData = Array.from(this.rows, function (r) {
          return this.parent.getRowObjectFromUID(r.getAttribute('data-uid')).data;
        })));
  };
  return s;
})();
var Ao = (function () {
  function s(e, t) {
    this.aria = new en();
    this.childRefs = [];
    this.parent = e;
    this.serviceLocator = t;
    this.focus = t.getService('focus');
    this.addEventListener();
  }
  s.prototype.addEventListener = function () {
    if (!this.parent.isDestroyed) {
      R.add(this.parent.element, 'auxclick', this.auxilaryclickHandler, this);
      this.parent.on(Ne, this.clickHandler, this);
      this.parent.on(M, this.destroy, this);
      this.parent.on(be, this.keyPressHandler, this);
      this.parent.on(nr, this.expand, this);
      this.parent.on(St, this.refreshColSpan, this);
      this.parent.on(M, this.destroyChildGrids, this);
      this.parent.on(sr, this.destroyChildGrids, this);
      this.parent.on(M, this.detachDetailTemplate, this);
      this.parent.on(ar, this.detachDetailTemplate, this);
    }
  };
  s.prototype.clickHandler = function (e) {
    if (
      (e.target.classList.contains('e-icon-grightarrow') || e.target.classList.contains('e-icon-gdownarrow')) &&
      !this.parent.allowGrouping
    ) {
      e.preventDefault();
    }
    this.toogleExpandcollapse(T(e.target, 'td'));
  };
  s.prototype.auxilaryclickHandler = function (e) {
    if (
      (e.target.classList.contains('e-icon-grightarrow') || e.target.classList.contains('e-icon-gdownarrow')) &&
      !this.parent.allowGrouping &&
      e.button === 1
    ) {
      e.preventDefault();
    }
  };
  s.prototype.toogleExpandcollapse = function (e) {
    this.l10n = this.serviceLocator.getService('localization');
    var t = this.parent;
    var i = this.parent.getContentTable();
    var r = this.parent.getCurrentViewRecords().length - 1;
    var n = 'parentDetails';
    var a;
    var o = e && e.classList.contains('e-detailrowcollapse');
    if (
      !(
        !(e && (e.classList.contains('e-detailrowcollapse') || e.classList.contains('e-detailrowexpand'))) ||
        (e && e.classList.contains('e-masked-cell'))
      )
    ) {
      var l = e.parentElement;
      var h = e.parentElement.getAttribute('data-uid');
      var d = this.parent.getRowObjectFromUID(h);
      if (!u(d)) {
        var p = false;
        var c = this.parent.getContentTable().querySelector(U).children[e.parentElement.rowIndex + 1];
        if (e.classList.contains('e-detailrowcollapse')) {
          var f = d.data;
          if (this.isDetailRow(this.parent.getContentTable().querySelector(U).children[e.parentElement.rowIndex + 1])) {
            this.parent.getContentTable().querySelector(U).children[e.parentElement.rowIndex + 1].style.display = '';
            this.parent.notify(or, {
              data: d.data,
              childGrid: this.parent.childGrid,
              detailElement: e,
              isExpanded: o,
            });
            p = true;
          } else if (this.parent.getDetailTemplate() || this.parent.childGrid) {
            var g = Nt('grid-row');
            var m = this.parent.createElement('tr', {
              className: 'e-detailrow',
              attrs: {
                'data-uid': g,
                role: 'row',
              },
            });
            var y = this.parent.createElement('th', {
              className: 'e-detailcell',
              attrs: {
                scope: 'col',
                role: 'columnheader',
              },
            });
            var v = this.parent.getVisibleColumns().length;
            if (this.parent.allowRowDragAndDrop) {
              v++;
            }
            y.setAttribute('colspan', v.toString());
            var b = new yt({
              isDataRow: true,
              isExpand: true,
              uid: g,
              isDetailRow: true,
              cells: [
                new ze({ cellType: P.Indent }),
                new ze({
                  isDataCell: true,
                  visible: true,
                }),
              ],
            });
            b.parentUid = d.uid;
            for (var w = 0, C = this.parent.groupSettings.columns.length; w < C; w++) {
              m.appendChild(this.parent.createElement('td', { className: 'e-indentcell' }));
              b.cells.unshift(new ze({ cellType: P.Indent }));
            }
            m.appendChild(
              this.parent.createElement('th', {
                className: 'e-detailindentcell',
                attrs: { scope: 'col' },
              }),
            );
            m.appendChild(y);
            e.parentElement.parentNode.insertBefore(m, e.parentElement.nextSibling);
            var I = void 0;
            var x = void 0;
            if (this.parent.detailTemplate) {
              I =
                this.parent.isReact &&
                typeof this.parent.detailTemplate != 'string' &&
                !(this.parent.detailTemplate.prototype && this.parent.detailTemplate.prototype.CSPTemplate);
              x =
                this.parent.parentDetails &&
                this.parent.parentDetails.parentInstObj &&
                this.parent.parentDetails.parentInstObj.isReact;
              var O = this.parent.printGridParent && this.parent.printGridParent.isReact;
              var A = this.parent.element.id + 'detailTemplate';
              I || x || O
                ? (this.parent.getDetailTemplate()(d.data, this.parent, 'detailTemplate', A, null, null, y),
                  this.parent.renderTemplates(function () {
                    this.parent.trigger(ni, {
                      detailElement: y,
                      data: d.data,
                      childGrid: a,
                    });
                  }))
                : ae(
                    y,
                    this.parent.getDetailTemplate()(
                      d.data,
                      this.parent,
                      'detailTemplate',
                      A,
                      void 0,
                      void 0,
                      void 0,
                      this.parent.root,
                    ),
                  );
            } else {
              a = new pn(this.getGridModel(this.parent, d, this.parent.printMode));
              a.height = this.parent.enableInfiniteScrolling && a.height === 'auto' ? 300 : a.height;
              a.root = this.parent.root ? this.parent.root : this.parent;
              this.childRefs.push(a);
              if (a.query) {
                a.query = a.query.clone();
              }
              a.parentDetails = {
                parentID: this.parent.element.id,
                parentPrimaryKeys: this.parent.getPrimaryKeyFieldNames(),
                parentKeyField: this.parent.childGrid.queryString,
                parentKeyFieldValue:
                  this.parent.childGrid.queryString && Rs(this.parent.childGrid.queryString)
                    ? te(this.parent.childGrid.queryString, d.data)
                    : d.data[this.parent.childGrid.queryString],
                parentRowData: d.data,
              };
              this.parent.isReact || this.parent.isVue
                ? (a.parentDetails.parentInstObj = this.parent)
                : this.parent.parentDetails &&
                  this.parent.parentDetails.parentInstObj &&
                  (this.parent.parentDetails.parentInstObj.isReact || this.parent.parentDetails.parentInstObj.isVue) &&
                  (a.parentDetails.parentInstObj = this.parent.parentDetails.parentInstObj);
              if (this.parent.printGridParent && this.parent.printGridParent.isReact) {
                a.printGridParent = this.parent.printGridParent;
              }
              a.isLegacyTemplate = this.parent.isReact || this.parent.isLegacyTemplate;
              if (this.parent.isPrinting) {
                a.isPrinting = true;
                a.on(Te, this.promiseResolve(a), this);
                a.on(lr, this.promiseResolve(a), this);
              }
              d.childGrid = a;
              var k = a.getInjectedModules();
              var F = this.parent.getInjectedModules();
              if (!k || k.length !== F.length) {
                a.setInjectedModules(F);
              }
              var D = this.parent.createElement('div', {
                id: 'child' + Fs(e.parentElement, 'e-grid').length + '_grid' + e.parentElement.rowIndex + Nt(''),
                className: 'e-childgrid',
              });
              y.appendChild(D);
              a.appendTo(D);
            }
            m.appendChild(y);
            e.parentElement.nextSibling
              ? e.parentElement.parentNode.insertBefore(m, e.parentElement.nextSibling)
              : e.parentElement.parentNode.appendChild(m);
            var L = this.parent.getRows();
            var K = this.parent.getRowsObject();
            L.splice(L.indexOf(e.parentElement) + 1, 0, m);
            if (this.parent.enableInfiniteScrolling && this.parent.infiniteScrollSettings.enableCache)
              for (var V = this.parent.contentModule.infiniteCache, W = Object.keys(V), w = 0; w < W.length; w++) {
                var J = V[parseInt(W[parseInt(w.toString(), 10)], 10)].indexOf(d);
                if (J !== -1) {
                  V[parseInt(W[parseInt(w.toString(), 10)], 10)].splice(J + 1, 0, b);
                  break;
                }
              }
            else K.splice(K.indexOf(d) + 1, 0, b);
            if (!I || !x) {
              this.parent.trigger(ni, {
                detailElement: y,
                data: d.data,
                childGrid: a,
              });
            }
            this.parent.notify(ni, { rows: K });
          }
          G(e, ['e-detailrowexpand'], ['e-detailrowcollapse']);
          G(
            e.firstElementChild,
            ['e-dtdiagonaldown', 'e-icon-gdownarrow'],
            ['e-dtdiagonalright', 'e-icon-grightarrow'],
          );
          d.isExpand = true;
          if (e.classList.contains('e-lastrowcell') && this.parent.getContent().clientHeight > i.scrollHeight) {
            Q(e.parentElement.querySelectorAll('td'), 'e-lastrowcell');
            var we = i.querySelector(U).getElementsByClassName('e-detailrow').length - 1;
            j(i.querySelector(U).getElementsByClassName('e-detailrow')[parseInt(we.toString(), 10)].childNodes, [
              'e-lastrowcell',
            ]);
            this.lastrowcell = true;
          }
          this.aria.setExpand(e, true);
          e.firstElementChild.setAttribute('title', this.l10n.getConstant('Expanded'));
        } else {
          if (this.isDetailRow(this.parent.getContentTable().querySelector(U).children[e.parentElement.rowIndex + 1])) {
            this.parent.getContentTable().querySelector(U).children[e.parentElement.rowIndex + 1].style.display =
              'none';
            this.parent.notify(or, {
              data: d.data,
              childGrid: this.parent.childGrid,
              detailElement: e,
              isExpanded: o,
            });
          }
          G(e, ['e-detailrowcollapse'], ['e-detailrowexpand']);
          G(
            e.firstElementChild,
            ['e-dtdiagonalright', 'e-icon-grightarrow'],
            ['e-dtdiagonaldown', 'e-icon-gdownarrow'],
          );
          if (parseInt(e.parentElement.getAttribute(q), 10) - 1 === r && this.lastrowcell) {
            j(e.parentElement.querySelectorAll('td'), 'e-lastrowcell');
            this.lastrowcell = false;
          }
          d.isExpand = false;
          p = true;
          this.aria.setExpand(e, false);
          e.firstElementChild.setAttribute('title', this.l10n.getConstant('Collapsed'));
        }
        if (!u(this.parent.detailTemplate) || (this.parent.childGrid && p)) {
          this.parent.updateVisibleExpandCollapseRows();
          this.parent.notify(dn, { rows: this.parent.getRowsObject() });
        }
        if (this.parent.allowTextWrap && this.parent.height === 'auto') {
          this.parent.getContentTable().scrollHeight > this.parent.getContent().clientHeight
            ? this.parent.scrollModule.setPadding()
            : this.parent.scrollModule.removePadding();
        }
      }
    }
  };
  s.prototype.getGridModel = function (e, t, i) {
    var r;
    e.isPrinting && t.isExpand && e.expandedRows && e.expandedRows[t.index] && e.expandedRows[t.index].gridModel
      ? ((e.expandedRows[t.index].gridModel.hierarchyPrintMode = e.childGrid.hierarchyPrintMode),
        (r = E({}, e.expandedRows[t.index].gridModel, e.childGrid, true)))
      : (e.isPrinting && e.childGrid.allowPaging && (e.childGrid.allowPaging = i === 'CurrentPage'),
        (r = E({}, {}, e.childGrid, true)));
    return r;
  };
  s.prototype.promiseResolve = function (e) {
    var t = this;
    return function () {
      e.off(Te, t.promiseResolve);
      e.off(lr, t.promiseResolve);
      e.notify(Ts, {});
    };
  };
  s.prototype.isDetailRow = function (e) {
    return e && e.classList.contains('e-detailrow');
  };
  s.prototype.destroy = function () {
    var e = this.parent.element;
    if (
      !(
        this.parent.isDestroyed ||
        !this.parent.element ||
        (!this.parent.element.querySelector('.' + Oe) && !this.parent.element.querySelector('.' + pe))
      )
    ) {
      R.remove(this.parent.element, 'auxclick', this.auxilaryclickHandler);
      this.parent.off(Ne, this.clickHandler);
      this.parent.off(M, this.destroy);
      this.parent.off(be, this.keyPressHandler);
      this.parent.off(nr, this.expand);
      this.parent.off(St, this.refreshColSpan);
      this.parent.off(M, this.destroyChildGrids);
      this.parent.off(sr, this.destroyChildGrids);
      this.parent.off(M, this.detachDetailTemplate);
      this.parent.off(ar, this.detachDetailTemplate);
    }
  };
  s.prototype.getTDfromIndex = function (e, t) {
    var i = u(e) ? void 0 : this.parent.getDataRows()[parseInt(e.toString(), 10)];
    return i && i.querySelector(t) ? i.querySelector(t) : null;
  };
  s.prototype.expand = function (e) {
    if (!isNaN(e)) {
      e = this.getTDfromIndex(e, '.e-detailrowcollapse');
    }
    if (e && e.classList.contains('e-detailrowcollapse')) {
      this.toogleExpandcollapse(e);
    }
  };
  s.prototype.collapse = function (e) {
    if (!isNaN(e)) {
      e = this.getTDfromIndex(e, '.e-detailrowexpand');
    }
    if (e && e.classList.contains('e-detailrowexpand')) {
      this.toogleExpandcollapse(e);
    }
  };
  s.prototype.expandAll = function () {
    this.expandCollapse(true);
    this.parent.trigger(B, {
      requestType: 'expandAllComplete',
      type: B,
      moduleObj: this,
    });
  };
  s.prototype.collapseAll = function () {
    this.expandCollapse(false);
    this.parent.trigger(B, {
      requestType: 'collapseAllComplete',
      type: B,
      moduleObj: this,
    });
  };
  s.prototype.expandCollapse = function (e) {
    for (var t, i = this.parent.getDataRows(), r = 0, n = i.length; r < n; r++) {
      t = i[parseInt(r.toString(), 10)].querySelector('.e-detailrowcollapse, .e-detailrowexpand');
      e ? this.expand(t) : this.collapse(t);
    }
  };
  s.prototype.keyPressHandler = function (e) {
    var t = this.parent;
    var i = /(Mac)/i.test(navigator.platform);
    switch (
      (i &&
        e.metaKey &&
        (e.action === 'downArrow'
          ? (e.action = 'ctrlDownArrow')
          : e.action === 'upArrow' && (e.action = 'ctrlUpArrow')),
      e.action)
    ) {
      case 'ctrlDownArrow':
        this.expandAll();
        break;
      case 'ctrlUpArrow':
        this.collapseAll();
        break;
      case 'altUpArrow':
      case 'altDownArrow':
        var r = this.parent.allowSelection ? this.parent.getSelectedRowIndexes() : [];
        if (r.length) {
          var n = this.parent.getDataRows()[r[r.length - 1]];
          var a = this.parent.getDataRows()[r[r.length - 1]].querySelector('.e-detailrowcollapse, .e-detailrowexpand');
          e.action === 'altDownArrow' ? this.expand(a) : this.collapse(a);
        }
        break;
      case 'enter':
        if (this.parent.isEdit) return;
        var o = this.focus.getFocusedElement();
        {
          if (o && (o.classList.contains('e-icon-grightarrow') || o.classList.contains('e-icon-gdownarrow'))) {
            o = o.parentElement;
          }
          if (o && !o.classList.contains('e-detailrowcollapse') && !o.classList.contains('e-detailrowexpand')) break;
        }
        this.toogleExpandcollapse(o);
        break;
    }
  };
  s.prototype.refreshColSpan = function () {
    for (
      var e = this.parent.contentModule.getTable().querySelectorAll('tr.e-detailrow'),
        t = this.parent.getVisibleColumns().length,
        i = 0;
      i < e.length;
      i++
    )
      e[parseInt(i.toString(), 10)].querySelector('.e-detailcell').setAttribute('colspan', t + '');
  };
  s.prototype.destroyChildGrids = function (e) {
    var t = this.parent;
    if (
      this.parent.enableInfiniteScrolling &&
      (this.parent.childGrid || this.parent.detailTemplate) &&
      e.requestType === 'infiniteScroll' &&
      this.parent.infiniteScrollSettings.enableCache
    ) {
      var i =
        e.direction === 'down'
          ? e.currentPage - this.parent.infiniteScrollSettings.initialBlocks
          : e.currentPage + this.parent.infiniteScrollSettings.initialBlocks;
      var r = this.parent.contentModule.infiniteCache[parseInt(i.toString(), 10)];
      var n = r.filter(function (c) {
        return c.isDetailRow && c.parentUid;
      });
      if (this.parent.childGrid)
        for (
          var a = function (c) {
              var f = this.parent
                .getContentTable()
                .querySelector('[data-uid="' + n[parseInt(c.toString(), 10)].uid + '"]');
              var g = f.querySelector('.e-childgrid');
              var m = o.childRefs.findIndex(function (v) {
                return v.element.id === g.id;
              });
              if (!o.childRefs[parseInt(m.toString(), 10)].isDestroyed) {
                o.childRefs[parseInt(m.toString(), 10)].destroy();
                o.childRefs.splice(m, 1);
              }
              var y = r.indexOf(n[parseInt(c.toString(), 10)]);
              r.splice(y, 1);
              r[y - 1].childGrid = null;
              r[y - 1].isExpand = false;
              f.remove();
            },
            o = this,
            l = 0;
          l < n.length;
          l++
        )
          a(l);
      if (this.parent.detailTemplate && n.length) {
        for (
          var h = [],
            d = function (c) {
              h.push({
                detailRow: this.parent
                  .getContentTable()
                  .querySelector('[data-uid="' + n[parseInt(c.toString(), 10)].uid + '"]'),
                detailRowObject: n[parseInt(c.toString(), 10)],
                parentRowObject: r.find(function (f) {
                  return n[parseInt(c.toString(), 10)].parentUid === f.uid;
                }),
              });
            },
            l = 0;
          l < n.length;
          l++
        )
          d(l);
        this.parent.trigger(hr, h, function () {
          for (var c = 0; c < n.length; c++) {
            var f = this.parent
              .getContentTable()
              .querySelector('[data-uid="' + n[parseInt(c.toString(), 10)].uid + '"]');
            var g = r.indexOf(n[parseInt(c.toString(), 10)]);
            r.splice(g, 1);
            r[g - 1].isExpand = false;
            f.remove();
          }
        });
      }
      return;
    }
    for (var p = this.parent.getRowsObject(), l = 0; l < p.length; l++) p[parseInt(l.toString(), 10)].childGrid = null;
    for (var l = 0; l < this.childRefs.length; l++)
      if (!this.childRefs[parseInt(l.toString(), 10)].isDestroyed) {
        this.childRefs[parseInt(l.toString(), 10)].destroy();
      }
    this.childRefs = [];
  };
  s.prototype.detachDetailTemplate = function () {
    var e = this.parent;
    if (this.parent.detailTemplate) {
      var t = this.parent.getRowsObject();
      var i = t.filter(function (n) {
        return n.isDetailRow && n.parentUid;
      });
      if (i.length) {
        var r = [];
        i.map(function (n) {
          r.push({
            detailRow: this.parent.getContentTable().querySelector('[data-uid="' + n.uid + '"]'),
            detailRowObject: n,
            parentRowObject: t.find(function (a) {
              return n.parentUid === a.uid;
            }),
          });
        });
        this.parent.trigger(hr, r, function () {
          i.map(function (n) {
            this.parent
              .getContentTable()
              .querySelector('[data-uid="' + n.uid + '"]')
              .remove();
          });
        });
      }
    }
  };
  s.prototype.getModuleName = function () {
    return 'detailRow';
  };
  return s;
})();
var ko = (function () {
  function s(e, t) {
    this.predefinedItems = {};
    this.isSearched = false;
    this.items = [
      'Add',
      'Edit',
      'Update',
      'Delete',
      'Cancel',
      'Print',
      'Search',
      'ColumnChooser',
      'PdfExport',
      'ExcelExport',
      'CsvExport',
      'WordExport',
    ];
    this.isRightToolbarMenu = false;
    this.parent = e;
    this.gridID = e.element.id;
    this.serviceLocator = t;
    this.addEventListener();
  }
  s.prototype.render = function () {
    this.l10n = this.serviceLocator.getService('localization');
    for (
      var e = [
          'Add',
          'Edit',
          'Update',
          'Delete',
          'Cancel',
          'Print',
          'PdfExport',
          'ExcelExport',
          'WordExport',
          'CsvExport',
        ],
        t = this.parent.enableAdaptiveUI,
        i = ['Edit', 'Delete', 'Update', 'Cancel'],
        r = 0,
        n = e;
      r < n.length;
      r++
    ) {
      var a = n[r];
      var o = n[r].toLowerCase();
      var l = o[0].toUpperCase() + o.slice(1);
      this.predefinedItems['' + n[r]] = {
        id: this.gridID + '_' + o,
        prefixIcon: 'e-' + o,
        text: this.l10n.getConstant(l),
        tooltipText: this.l10n.getConstant(l),
      };
      if (t) {
        this.predefinedItems['' + n[r]].text = '';
        this.predefinedItems['' + n[r]].visible = i.indexOf(n[r]) === -1;
      }
    }
    this.predefinedItems.Search = {
      id: this.gridID + '_search',
      tooltipText: this.l10n.getConstant('Search'),
      align: 'Right',
      cssClass: 'e-search-wrapper',
      type: 'Input',
    };
    this.isRightToolbarMenu = false;
    if (
      this.parent.enableAdaptiveUI &&
      this.isResponsiveToolbarMenuItems(true) &&
      (this.parent.rowRenderingMode === 'Horizontal' ||
        (this.parent.rowRenderingMode === 'Vertical' && !this.parent.allowFiltering && !this.parent.allowSorting))
    ) {
      this.isRightToolbarMenu = true;
    }
    t && this.isResponsiveToolbarMenuItems(false)
      ? (this.predefinedItems.responsiveToolbarItems = {
          id: this.gridID + '_responsivetoolbaritems',
          cssClass: 'e-responsive-toolbar-items e-menu-toolbar',
          suffixIcon: 'e-responsivetoolbaritems-btn',
          align: this.isRightToolbarMenu ? 'Left' : 'Right',
        })
      : (this.predefinedItems.ColumnChooser = {
          id: this.gridID + '_columnchooser',
          cssClass: 'e-cc e-ccdiv e-cc-toolbar',
          suffixIcon: 'e-columnchooser-btn',
          text: t ? '' : this.l10n.getConstant('Columnchooser'),
          tooltipText: this.l10n.getConstant('Columnchooser'),
          align: 'Right',
        });
    if (this.parent.rowRenderingMode === 'Vertical') {
      if (this.parent.allowFiltering && this.parent.filterSettings.type !== 'FilterBar') {
        this.predefinedItems.responsiveFilter = {
          id: this.gridID + '_responsivefilter',
          cssClass: 'e-gridresponsiveicons e-icons',
          suffixIcon: 'e-resfilter-icon',
          tooltipText: this.l10n.getConstant('FilterIcon'),
        };
      }
      if (this.parent.allowSorting) {
        this.predefinedItems.responsiveSort = {
          id: this.gridID + '_responsivesort',
          cssClass: 'e-gridresponsiveicons e-icons',
          suffixIcon: 'e-ressort-icon',
          tooltipText: this.l10n.getConstant('SortIcon'),
        };
      }
    }
    if (
      this.parent.enableAdaptiveUI &&
      this.parent.toolbar &&
      this.parent.toolbar.some(function (h) {
        return (typeof h == 'object' && h.text === 'Search') || h === 'Search';
      })
    ) {
      this.predefinedItems.responsiveBack = {
        id: this.gridID + '_responsiveback',
        cssClass: 'e-gridresponsiveicons e-icons',
        suffixIcon: 'e-resback-icon',
        visible: false,
      };
    }
    this.createToolbar();
    if (this.parent.enableAdaptiveUI) {
      if (u(this.responsiveToolbarMenu)) {
        this.renderResponsiveToolbarpopup();
      }
      if (this.toolbar.element) {
        this.toolbar.refreshOverflow();
      }
    }
  };
  s.prototype.isResponsiveToolbarMenuItems = function (e) {
    for (
      var t = e
          ? ['Add', 'Edit', 'Delete', 'Search']
          : ['Print', 'ColumnChooser', 'PdfExport', 'ExcelExport', 'CsvExport'],
        i = this.parent.toolbar || [],
        r = 0;
      r < t.length;
      r++
    )
      if (i.indexOf(t[parseInt(r.toString(), 10)]) >= 0) return !e;
    return !!e;
  };
  s.prototype.getToolbar = function () {
    return this.toolbar.element;
  };
  s.prototype.destroy = function () {
    if (this.toolbar && !this.toolbar.isDestroyed) {
      if (this.responsiveToolbarMenu) {
        this.responsiveToolbarMenu.destroy();
      }
      this.toolbar.off('render-react-toolbar-template', this.addReactToolbarPortals);
      this.unWireEvent();
      this.removeEventListener();
      this.toolbar.created = null;
      this.toolbar.clicked = null;
      this.toolbar.element
        ? this.toolbar.destroy()
        : (this.parent.destroyTemplate(['toolbarTemplate']), this.parent.isReact && this.parent.renderTemplates());
      if (this.parent.isAngular) {
        var e = 'viewContainerRef';
        var t = 'registeredTemplate';
        this.toolbar.viewContainerRef = null;
        this.toolbar.registeredTemplate = null;
      }
      if (this.element.parentNode) {
        N(this.element);
        this.toolbar = null;
      }
    }
  };
  s.prototype.bindSearchEvents = function () {
    this.searchElement = Ee('#' + this.gridID + '_searchbar', this.element);
    this.wireEvent();
    this.refreshToolbarItems();
    if (this.parent.searchSettings) {
      this.updateSearchBox();
    }
  };
  s.prototype.toolbarCreated = function (e) {
    if (this.element.querySelector('.e-search-wrapper')) {
      if (!this.parent.enableAdaptiveUI || e) {
        var t = this.parent.cssClass ? 'e-input-group e-search ' + this.parent.cssClass : 'e-input-group e-search';
        this.element.querySelector('.e-search-wrapper').innerHTML =
          '<div class="' +
          t +
          '" role="search">                    <input id="' +
          this.gridID +
          '_searchbar" class="e-input e-search" name="input" type="search"                     placeholder= "' +
          this.l10n.getConstant('Search') +
          '"/>                    <span id="' +
          this.gridID +
          '_clearbutton" class="e-input-group-icon e-icons e-sicon"                     tabindex="-1" aria-label= "clear" role= "button" ></span>                    <span id="' +
          this.gridID +
          '_searchbutton" class="e-input-group-icon e-search-icon e-icons"                     tabindex="-1" title="' +
          this.l10n.getConstant('Search') +
          '" role= "search"></span>                     </div>';
      } else
        this.element.querySelector('.e-search-wrapper').innerHTML =
          '<span id="' +
          this.gridID +
          '_clearbutton" class="e-input-group-icon e-icons e-sicon"                     tabindex="-1" role= "button" aria-label= "clear" ></span>                    <span id="' +
          this.gridID +
          '_searchbutton" class="e-input-group-icon e-search-icon e-icons"                     tabindex="-1" role= "button" title="' +
          this.l10n.getConstant('Search') +
          '"></span>                     </div>';
      this.element.querySelector('#' + this.gridID + '_clearbutton').style.cursor = 'default';
    }
    if (this.element.querySelector('.e-responsive-toolbar-items')) {
      this.element.querySelector('.e-responsive-toolbar-items').innerHTML =
        '<button id="' +
        this.gridID +
        '_responsivetoolbaritems" class="e-tbar-btn e-control e-btn e-lib e-icon-btn"                     type="button" data-ripple="true" tabindex="-1" data-tabindex="-1" aria-label="responsivetoolbaritems"                      aria-disabled="false" ><span class="e-btn-icon e-responsivetoolbaritems-btn e-icons"></span>';
      this.element.querySelector('#' + this.gridID + '_responsivetoolbaritems').style.width = 'auto';
    }
    this.bindSearchEvents();
  };
  s.prototype.createToolbar = function () {
    var e = this.getItems();
    this.toolbar = new Os({
      items: e,
      clicked: this.toolbarClickHandler.bind(this),
      enablePersistence: this.parent.enablePersistence,
      enableRtl: this.parent.enableRtl,
      created: this.toolbarCreated.bind(this),
      cssClass: this.parent.cssClass ? this.parent.cssClass : '',
    });
    this.toolbar.isReact = this.parent.isReact;
    this.toolbar.on('render-react-toolbar-template', this.addReactToolbarPortals, this);
    var t = 'isStringTemplate';
    this.toolbar.isStringTemplate = true;
    var i = 'viewContainerRef';
    var r = 'registeredTemplate';
    if (this.parent.viewContainerRef) {
      this.toolbar.registeredTemplate = {};
      this.toolbar.viewContainerRef = this.parent.viewContainerRef;
    }
    this.element = this.parent.createElement('div', { id: this.gridID + '_toolbarItems' });
    if (this.parent.enableAdaptiveUI) {
      this.element.classList.add('e-res-toolbar');
    }
    if (this.parent.toolbarTemplate) {
      var n =
        this.parent.isVue ||
        (this.parent.parentDetails &&
          this.parent.parentDetails.parentInstObj &&
          this.parent.parentDetails.parentInstObj.isVue);
      if (
        typeof this.parent.toolbarTemplate == 'string' &&
        !(n && !document.querySelectorAll(this.parent.toolbarTemplate).length) &&
        document.querySelector(this.parent.toolbarTemplate) &&
        document.querySelector(this.parent.toolbarTemplate).tagName.toLowerCase() !== 'script'
      ) {
        this.toolbar.appendTo(this.parent.toolbarTemplate);
        this.element = this.toolbar.element;
      } else {
        var a =
          this.parent.isReact &&
          typeof this.parent.toolbarTemplate != 'string' &&
          !(this.parent.toolbarTemplate.prototype && this.parent.toolbarTemplate.prototype.CSPTemplate);
        var o =
          this.parent.parentDetails &&
          this.parent.parentDetails.parentInstObj &&
          this.parent.parentDetails.parentInstObj.isReact;
        var l = this.parent.element.id + 'toolbarTemplate';
        a || o
          ? (dr(this.parent.toolbarTemplate)({}, this.parent, 'toolbarTemplate', l, null, null, this.element),
            this.parent.renderTemplates())
          : ae(
              this.element,
              dr(this.parent.toolbarTemplate)(
                {},
                this.parent,
                'toolbarTemplate',
                null,
                null,
                null,
                null,
                this.parent.root,
              ),
            );
      }
      this.element.classList.add('e-temp-toolbar');
    } else this.toolbar.appendTo(this.element);
    this.parent.element.insertBefore(this.element, this.parent.getHeaderContent());
    var h = this.element.querySelector('.e-toolbar-left');
    var d = this.element.querySelector('.e-toolbar-center');
    var p = this.element.querySelector('.e-toolbar-right');
    var c = this.element.querySelector('.e-toolbar-items');
    var f = this.element;
    var g = h ? h.clientWidth : 0;
    var m = d ? d.clientWidth : 0;
    var y = p ? p.clientWidth : 0;
    var v = c ? c.clientWidth : 0;
    var b = this.element ? this.element.clientWidth : 0;
    if (g > b || m > b || y > b || v > b) {
      this.toolbar.refreshOverflow();
    }
  };
  s.prototype.addReactToolbarPortals = function (e) {
    if (this.parent.isReact && e) {
      this.parent.portals = this.parent.portals.concat(e);
      this.parent.renderTemplates();
    }
  };
  s.prototype.renderResponsiveSearch = function (e) {
    if (e) {
      this.toolbarCreated(true);
      this.refreshResponsiveToolbarItems(st.isSearch);
      this.searchElement = Ee('#' + this.gridID + '_searchbar', this.element);
      var t = S(this.searchElement, 'e-toolbar-right');
      if (t) {
        t.classList.add('e-responsive-right');
      }
      if (this.parent.searchSettings) {
        this.updateSearchBox();
      }
    } else this.refreshResponsiveToolbarItems(st.isInitial);
    if (this.toolbar.element && this.toolbar.element.querySelector('.e-hscroll')) {
      this.toolbar.refreshOverflow();
    }
    if (e) {
      this.searchBoxObj.searchFocus({ target: this.searchElement });
      this.searchElement.focus();
    }
  };
  s.prototype.refreshResponsiveToolbarItems = function (e) {
    if (e === st.isInitial) {
      for (
        var t = this.parent.element.id,
          i = [t + '_edit', t + '_delete'],
          r = this.parent.getSelectedRowIndexes(),
          n = [t + '_responsiveback', t + '_update', t + '_cancel'],
          a = 0,
          o = this.toolbar.items;
        a < o.length;
        a++
      ) {
        var l = o[a];
        var h =
          o[a].template && o[a].template.length
            ? S(this.toolbar.element.querySelector('#' + o[a].id), 'e-template').children[0]
            : this.toolbar.element.querySelector('#' + o[a].id);
        if (h) {
          i.indexOf(o[a].id) > -1
            ? r.length
              ? h.parentElement.classList.remove('e-hidden')
              : h.parentElement.classList.add('e-hidden')
            : n.indexOf(o[a].id) === -1 || (n.indexOf(o[a].id) > 0 && this.parent.isEdit)
              ? h.parentElement.classList.remove('e-hidden')
              : h.parentElement.classList.add('e-hidden');
        }
      }
      if (this.searchElement) {
        var d = S(this.searchElement, 'e-toolbar-right');
        if (d) {
          d.classList.remove('e-responsive-right');
        }
        this.toolbarCreated(false);
        this.unWireEvent();
        this.searchElement = void 0;
      }
    }
    if (e === st.isSearch)
      for (
        var i = [this.parent.element.id + '_responsiveback', this.parent.element.id + '_search'],
          p = 0,
          c = this.toolbar.items;
        p < c.length;
        p++
      ) {
        var l = c[p];
        var h = this.toolbar.element.querySelector('#' + c[p].id);
        if (h) {
          i.indexOf(c[p].id) > -1
            ? h.parentElement.classList.remove('e-hidden')
            : h.parentElement.classList.add('e-hidden');
        }
      }
  };
  s.prototype.refreshToolbarItems = function (e) {
    var t = this.parent;
    var i = [];
    var r = [];
    var n = this.parent.editSettings;
    var a =
      (this.parent.currentViewData && this.parent.currentViewData.length) ||
      (this.parent.editSettings.mode === 'Batch' &&
        !u(this.parent.editModule) &&
        this.parent.editModule.getBatchChanges()[it].length);
    var o = this.parent.editSettings.showAddNewRow && !this.parent.element.querySelector('.e-editedrow');
    this.parent.editSettings.allowAdding ? i.push(this.gridID + '_add') : r.push(this.gridID + '_add');
    this.parent.editSettings.allowEditing && a ? i.push(this.gridID + '_edit') : r.push(this.gridID + '_edit');
    this.parent.editSettings.allowDeleting && a ? i.push(this.gridID + '_delete') : r.push(this.gridID + '_delete');
    this.parent.allowPdfExport && a ? i.push(this.gridID + '_pdfexport') : r.push(this.gridID + '_pdfexport');
    this.parent.allowExcelExport && a
      ? (i.push(this.gridID + '_excelexport'), i.push(this.gridID + '_csvexport'))
      : (r.push(this.gridID + '_excelexport'), r.push(this.gridID + '_csvexport'));
    this.parent.showColumnChooser ? i.push(this.gridID + '_columnchooser') : r.push(this.gridID + '_columnchooser');
    this.parent.editSettings.mode === 'Batch'
      ? this.parent.element.getElementsByClassName('e-updatedtd').length &&
        (this.parent.editSettings.allowAdding || this.parent.editSettings.allowEditing)
        ? (i.push(this.gridID + '_update'), i.push(this.gridID + '_cancel'))
        : (r.push(this.gridID + '_update'), r.push(this.gridID + '_cancel'))
      : (this.parent.isEdit || this.parent.editSettings.showAddNewRow) &&
          (this.parent.editSettings.allowAdding || this.parent.editSettings.allowEditing)
        ? ((i = o
            ? [this.gridID + '_update', this.gridID + '_cancel', this.gridID + '_edit', this.gridID + '_delete']
            : [this.gridID + '_update', this.gridID + '_cancel']),
          (r = o ? [this.gridID + '_add'] : [this.gridID + '_add', this.gridID + '_edit', this.gridID + '_delete']))
        : (r.push(this.gridID + '_update'), r.push(this.gridID + '_cancel'));
    this.enableItems(i, true);
    this.enableItems(r, false);
  };
  s.prototype.getItems = function () {
    var e = [];
    var t = this.parent.toolbar || [];
    if (typeof this.parent.toolbar == 'string') return [];
    if (this.parent.rowRenderingMode === 'Vertical') {
      if (this.parent.allowFiltering && this.parent.filterSettings.type !== 'FilterBar') {
        e.push(this.getItemObject('responsiveFilter'));
      }
      if (this.parent.allowSorting) {
        e.push(this.getItemObject('responsiveSort'));
      }
    }
    for (var i = 0, r = t; i < r.length; i++) {
      var n = r[i];
      if (
        !(
          this.parent.enableAdaptiveUI &&
          ['Print', 'ColumnChooser', 'PdfExport', 'ExcelExport', 'CsvExport'].indexOf(r[i]) !== -1
        )
      )
        switch (
          (this.parent.enableAdaptiveUI &&
            ((typeof r[i] == 'object' && r[i].text === 'Search') || r[i] === 'Search') &&
            e.push(this.getItemObject('responsiveBack')),
          typeof r[i])
        ) {
          case 'number':
            e.push(this.getItemObject(this.items[r[i]]));
            break;
          case 'string':
            e.push(this.getItemObject(r[i]));
            break;
          default:
            e.push(this.getItem(r[i]));
        }
    }
    if (this.parent.enableAdaptiveUI && this.isResponsiveToolbarMenuItems(false)) {
      e.push(this.getItemObject('responsiveToolbarItems'));
    }
    return e;
  };
  s.prototype.getItem = function (e) {
    var t = this.predefinedItems[e.text];
    return this.predefinedItems[e.text] ? E(this.predefinedItems[e.text], this.predefinedItems[e.text], e) : e;
  };
  s.prototype.getItemObject = function (e) {
    return (
      this.predefinedItems['' + e] || {
        text: e,
        id: this.gridID + '_' + e,
      }
    );
  };
  s.prototype.enableItems = function (e, t) {
    for (var i = 0, r = e; i < r.length; i++) {
      var n = r[i];
      var a = Ee('#' + r[i], this.element);
      if (a) {
        this.toolbar.enableItems(a.closest('.e-toolbar-item'), t);
      }
    }
  };
  s.prototype.toolbarClickHandler = function (e) {
    var t = this;
    var i = this.parent;
    var r = this.gridID;
    var n = e.originalEvent;
    if (this.parent.enableAdaptiveUI && e.item.id === this.gridID + '_responsivetoolbaritems')
      this.openResponsiveToolbarMenuPopup(e.originalEvent, e.item.id);
    else {
      E(e, { cancel: false });
      var a = e;
      this.parent.trigger(pr, e, function (o) {
        o.originalEvent = o.originalEvent ? o.originalEvent : e.originalEvent;
        if (!o.cancel)
          switch (!u(o.item) && o.item.id) {
            case this.gridID + '_print':
              this.parent.print();
              break;
            case this.gridID + '_edit':
              this.parent.startEdit();
              break;
            case this.gridID + '_update':
              this.parent.endEdit();
              break;
            case this.gridID + '_cancel':
              this.parent.closeEdit();
              break;
            case this.gridID + '_add':
              this.parent.addRecord();
              break;
            case this.gridID + '_delete':
              this.parent.deleteRecord();
              break;
            case this.gridID + '_search':
              o.originalEvent.target.id === this.gridID + '_searchbutton' && t.searchElement
                ? t.search()
                : this.parent.enableAdaptiveUI &&
                    !t.searchElement &&
                    (o.originalEvent.target.classList.contains('e-search-wrapper') ||
                      o.originalEvent.target.id === this.gridID + '_searchbutton')
                  ? t.renderResponsiveSearch(true)
                  : o.originalEvent.target.classList.contains('e-clear-icon') &&
                    o.originalEvent.target.id === this.gridID + '_clearbutton' &&
                    t.searchElement &&
                    ((t.searchElement.value = ''),
                    t.searchElement &&
                      ((t.sIcon = t.searchElement.parentElement.querySelector('.e-sicon')),
                      t.sIcon.classList.remove('e-clear-icon'),
                      t.sIcon.removeAttribute('title'),
                      (t.sIcon.style.cursor = 'default')),
                    (t.isSearched || t.parent.searchSettings.key.length) &&
                      (t.parent.search(t.searchElement.value), (t.isSearched = false)));
              break;
            case this.gridID + '_columnchooser':
              if (t.parent.enableAdaptiveUI) this.parent.showResponsiveCustomColumnChooser();
              else {
                var l = t.parent.element.querySelector('.e-ccdiv');
                var h = l.getBoundingClientRect().top;
                var d = l.getBoundingClientRect().left;
                var p = o.originalEvent.target;
                h = l.getBoundingClientRect().top + l.offsetTop;
                this.parent.createColumnchooser(l.getBoundingClientRect().left, h, o.originalEvent.target);
              }
              break;
            case this.gridID + '_responsivefilter':
              {
                this.parent.notify(Re, { action: 3 });
                this.parent.showResponsiveCustomFilter();
              }
              break;
            case this.gridID + '_responsivesort':
              {
                this.parent.notify(Re, { action: 2 });
                this.parent.showResponsiveCustomSort();
              }
              break;
            case this.gridID + '_responsiveback':
              {
                t.renderResponsiveSearch(false);
                t.toolbar.refreshOverflow();
              }
              break;
          }
      });
    }
  };
  s.prototype.openResponsiveToolbarMenuPopup = function (e, t) {
    var i = {
      top: 0,
      left: 0,
    };
    this.toolbarMenuElement.style.cssText = 'display:block;visibility:hidden';
    var r = this.toolbarMenuElement.getBoundingClientRect();
    var n = this.parent.element.getBoundingClientRect();
    this.toolbarMenuElement.style.cssText = 'display:none;visibility:visible';
    var a;
    u(e) ? (a = this.parent.element.querySelector('#' + t)) : (a = e.target);
    this.parent.enableRtl
      ? ((i = ur(a, 'left', 'bottom')), this.isRightToolbarMenu && (i.left -= r.width))
      : ((i = ur(a, 'right', 'bottom')),
        this.isRightToolbarMenu || (i.left -= r.width),
        i.left + r.width + 1 >= n.right && (i.left -= 35));
    this.responsiveToolbarMenu.open(i.top, i.left);
    if (e && e.preventDefault) {
      e.preventDefault();
    }
    un(this.parent.element, this.responsiveToolbarMenu.element.parentElement);
  };
  s.prototype.getMenuItems = function () {
    for (var e = [], t = this.parent.toolbar || [], i = 0, r = t; i < r.length; i++) {
      var n = r[i];
      if (
        typeof r[i] == 'string' &&
        (r[i] === 'ColumnChooser' ||
          r[i] === 'PdfExport' ||
          r[i] === 'ExcelExport' ||
          r[i] === 'CsvExport' ||
          r[i] === 'Print')
      ) {
        e.push({
          text: this.getLocaleText(r[i]),
          id: this.gridID + '_' + r[i].toLowerCase(),
          iconCss: 'e-btn-icon e-' + r[i].toLowerCase() + ' e-icons',
        });
      }
    }
    return e;
  };
  s.prototype.getLocaleText = function (e) {
    var t;
    e === 'ColumnChooser'
      ? (t = this.l10n.getConstant('Columnchooser'))
      : e === 'PdfExport'
        ? (t = this.l10n.getConstant('Pdfexport'))
        : e === 'ExcelExport'
          ? (t = this.l10n.getConstant('Excelexport'))
          : e === 'CsvExport'
            ? (t = this.l10n.getConstant('Csvexport'))
            : e === 'Print' && (t = this.l10n.getConstant('Print'));
    return t;
  };
  s.prototype.renderResponsiveToolbarpopup = function () {
    this.l10n = this.serviceLocator.getService('localization');
    this.toolbarMenuElement = this.parent.createElement('ul', {
      id: this.gridID + '__toolbaritemsmenu',
      className: 'e-responsivetoolbar-menu',
    });
    this.element.setAttribute('aria-label', this.l10n.getConstant('ToolbarMenuDialogARIA'));
    this.parent.element.appendChild(this.toolbarMenuElement);
    this.responsiveToolbarMenu = new Bs({
      cssClass: this.parent.cssClass
        ? 'e-grid-toolbarmenu e-bigger ' + this.parent.cssClass
        : 'e-grid-toolbarmenu e-bigger',
      enableRtl: this.parent.enableRtl,
      enablePersistence: this.parent.enablePersistence,
      locale: this.parent.locale,
      beforeOpen: this.beforeOpenResponsiveToolbarMenuItem.bind(this),
      items: this.getMenuItems(),
      select: this.ResponsiveToolbarMenuItemClick.bind(this),
    });
    this.responsiveToolbarMenu.appendTo(this.toolbarMenuElement);
  };
  s.prototype.ResponsiveToolbarMenuItemClick = function (e) {
    var t = this;
    var i = this.parent;
    var r = e.element;
    e.item.id = e.element.id;
    var n = {
      cancel: false,
      name: 'clicked',
      item: e.item,
      originalEvent: e.event,
    };
    this.parent.trigger(pr, n, function (a) {
      if (!a.cancel)
        switch (!u(a.item) && a.item.id) {
          case t.gridID + '_columnchooser':
            {
              this.parent.notify(Re, { action: 5 });
              this.parent.showResponsiveCustomColumnChooser();
            }
            break;
          case t.gridID + '_print':
            this.parent.print();
            break;
        }
    });
  };
  s.prototype.beforeOpenResponsiveToolbarMenuItem = function () {
    var e = this;
    var t = this.parent.toolbar || [];
    var i = [
      {
        key: 'PdfExport',
        enabled: this.parent.allowPdfExport,
      },
      {
        key: 'ExcelExport',
        enabled: this.parent.allowExcelExport,
      },
      {
        key: 'CsvExport',
        enabled: this.parent.allowExcelExport,
      },
      {
        key: 'ColumnChooser',
        enabled: this.parent.showColumnChooser,
      },
    ];
    var r = [];
    var n = [];
    i.forEach(function (a) {
      if (t.indexOf(a.key) !== -1) {
        var o = e.getLocaleText(a.key);
        a.enabled ? r.push(o) : n.push(o);
      }
    });
    this.responsiveToolbarMenu.enableItems(r, true);
    this.responsiveToolbarMenu.enableItems(n, false);
  };
  s.prototype.modelChanged = function (e) {
    if (e.module === 'edit') {
      this.refreshToolbarItems();
    }
  };
  s.prototype.onPropertyChanged = function (e) {
    if (!(e.module !== this.getModuleName() || !this.parent.toolbar)) {
      if (this.element) {
        N(this.element);
      }
      this.render();
    }
  };
  s.prototype.keyUpHandler = function (e) {
    if (e.keyCode === 13) {
      this.parent.searchModule.refreshSearch = false;
      this.search();
    }
    if (this.searchElement) {
      this.sIcon = this.searchElement.parentElement.querySelector('.e-sicon');
      this.searchElement.value.length && !u(this.sIcon)
        ? (this.sIcon.classList.add('e-clear-icon'),
          this.sIcon.setAttribute('title', this.l10n.getConstant('Clear')),
          (this.sIcon.style.cursor = 'pointer'))
        : (this.sIcon.classList.remove('e-clear-icon'),
          this.sIcon.removeAttribute('title'),
          (this.sIcon.style.cursor = 'default'));
    }
  };
  s.prototype.search = function () {
    this.isSearched = true;
    this.parent.search(this.searchElement.value);
  };
  s.prototype.updateSearchBox = function () {
    if (this.searchElement) {
      this.searchElement.value = this.parent.searchSettings.key;
    }
  };
  s.prototype.wireEvent = function () {
    if (this.searchElement) {
      this.searchBoxObj = new cn(this.searchElement, this.serviceLocator);
      R.add(this.searchElement, 'keyup', this.keyUpHandler, this);
      this.searchBoxObj.wireEvent();
    }
    R.add(this.element, 'focusin', this.onFocusIn, this);
    R.add(this.element, 'focusout', this.onFocusOut, this);
  };
  s.prototype.unWireEvent = function () {
    if (this.searchElement) {
      R.remove(this.searchElement, 'keyup', this.keyUpHandler);
      this.searchBoxObj.unWireEvent();
    }
    R.remove(this.element, 'focusin', this.onFocusIn);
    R.remove(this.element, 'focusout', this.onFocusOut);
  };
  s.prototype.onFocusIn = function (e) {
    var t = this.parent.focusModule.currentInfo;
    if (this.parent.focusModule.currentInfo && this.parent.focusModule.currentInfo.element) {
      Q(
        [this.parent.focusModule.currentInfo.element, this.parent.focusModule.currentInfo.elementToFocus],
        ['e-focused', 'e-focus'],
      );
      this.parent.focusModule.currentInfo.element.tabIndex = -1;
    }
    e.target.tabIndex = 0;
  };
  s.prototype.onFocusOut = function (e) {
    e.target.tabIndex = -1;
    if (
      e.target &&
      e.target.id === this.parent.element.id + '_searchbar' &&
      !(
        e.relatedTarget &&
        (e.relatedTarget.id === this.parent.element.id + '_clearbutton' ||
          e.relatedTarget.id === this.parent.element.id + '_searchbutton')
      )
    ) {
      this.parent.searchModule.refreshSearch = false;
      this.search();
    }
  };
  s.prototype.setFocusToolbarItem = function (e) {
    var t = e.querySelector('.e-btn,.e-input,.e-toolbar-item-focus');
    if (!t && this.parent.enableAdaptiveUI && !this.searchElement && e.classList.contains('e-search-wrapper')) {
      t = e.querySelector('#' + this.gridID + '_searchbutton');
    }
    t.focus();
  };
  s.prototype.getFocusableToolbarItems = function () {
    for (
      var e = [].slice.call(this.element.querySelectorAll('.e-toolbar-item:not(.e-overlay):not(.e-hidden)')),
        t = [],
        i = 0;
      i < e.length;
      i++
    )
      if (!u(e[parseInt(i.toString(), 10)].querySelector('.e-btn,.e-input,.e-toolbar-item-focus'))) {
        t.push(e[parseInt(i.toString(), 10)]);
      }
    return t;
  };
  s.prototype.keyPressedHandler = function (e) {
    if (e.target && S(e.target, 'e-toolbar-item')) {
      var t = S(e.target, 'e-toolbar-item');
      var i = this.getFocusableToolbarItems();
      if (e.action === 'tab' || e.action === 'shiftTab') {
        if ((e.action === 'tab' && t === i[i.length - 1]) || (e.action === 'shiftTab' && t === i[0])) return;
        for (var r = 0; r < i.length; r++)
          if (t === i[parseInt(r.toString(), 10)]) {
            e.preventDefault();
            var n = e.action === 'tab' ? r + 1 : r - 1;
            this.setFocusToolbarItem(i[parseInt(n.toString(), 10)]);
            return;
          }
      }
      if (
        e.action === 'enter' &&
        this.parent.enableAdaptiveUI &&
        !this.searchElement &&
        e.target.id === this.gridID + '_searchbutton'
      ) {
        this.renderResponsiveSearch(true);
      }
    }
  };
  s.prototype.reRenderToolbar = function () {
    if (this.element) {
      N(this.element);
    }
    this.render();
  };
  s.prototype.addEventListener = function () {
    if (!this.parent.isDestroyed) {
      this.evtHandlers = [
        {
          event: _e,
          handler: this.reRenderToolbar,
        },
        {
          event: Ce,
          handler: this.render,
        },
        {
          event: Se,
          handler: this.onPropertyChanged,
        },
        {
          event: Ge,
          handler: this.updateSearchBox.bind(this),
        },
        {
          event: ee,
          handler: this.refreshToolbarItems,
        },
        {
          event: Me,
          handler: this.refreshToolbarItems,
        },
        {
          event: Ge,
          handler: this.modelChanged,
        },
        {
          event: Pe,
          handler: this.refreshToolbarItems,
        },
        {
          event: Ne,
          handler: this.removeResponsiveSearch,
        },
        {
          event: fn,
          handler: this.reRenderToolbar,
        },
        {
          event: M,
          handler: this.destroy,
        },
        {
          event: be,
          handler: this.keyPressedHandler,
        },
      ];
      ce(this.parent, this.evtHandlers, true, this);
      this.rowSelectedFunction = this.rowSelected.bind(this);
      this.rowDeSelectedFunction = this.rowSelected.bind(this);
      this.parent.addEventListener(vi, this.rowSelectedFunction);
      this.parent.addEventListener(cr, this.rowDeSelectedFunction);
    }
  };
  s.prototype.removeEventListener = function () {
    if (!this.parent.isDestroyed) {
      ce(this.parent, this.evtHandlers, false);
      this.parent.removeEventListener(vi, this.rowSelectedFunction);
      this.parent.removeEventListener(cr, this.rowDeSelectedFunction);
    }
  };
  s.prototype.removeResponsiveSearch = function (e) {
    var t = e.target;
    var i = e.target.classList.contains('e-search-icon') || e.target.classList.contains('e-search-wrapper');
    if (this.parent.enableAdaptiveUI && !i && this.searchElement && !S(e.target, 'e-res-toolbar')) {
      this.renderResponsiveSearch(false);
    }
  };
  s.prototype.rowSelected = function () {
    if (this.parent.enableAdaptiveUI && this.toolbar.element) {
      this.refreshResponsiveToolbarItems(st.isInitial);
      this.toolbar.refreshOverflow();
    }
  };
  s.prototype.getModuleName = function () {
    return 'toolbar';
  };
  return s;
})();
var Lo = (function () {
  var s = function (e, t) {
    s =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (i, r) {
          i.__proto__ = r;
        }) ||
      function (i, r) {
        for (var n in r)
          if (r.hasOwnProperty(n)) {
            i[n] = r[n];
          }
      };
    return s(e, t);
  };
  return function (e, t) {
    s(e, t);
    function i() {
      this.constructor = e;
    }
    e.prototype = t === null ? Object.create(t) : ((i.prototype = t.prototype), new i());
  };
})();
var Mo = (function (s) {
  Lo(e, s);
  function e(t, i) {
    var r = s(t, i) || this;
    r.aggregates = {};
    r.parent = t;
    r.locator = i;
    r.modelGenerator = new gn(r.parent);
    r.addEventListener();
    return r;
  }
  e.prototype.renderPanel = function () {
    var t = this.parent.createElement('div', { className: qt });
    var i = this.parent.createElement('div', { className: 'e-summarycontent' });
    t.appendChild(i);
    this.setPanel(t);
    this.parent.allowPaging && this.parent.getPager() != null
      ? this.parent.element.insertBefore(t, this.parent.getPager())
      : this.parent.element.appendChild(t);
  };
  e.prototype.renderTable = function () {
    var t = this.createContentTable('_footer_table');
    var i = t.querySelector('.' + Li);
    var r = this.parent.createElement('tfoot');
    i.appendChild(r);
    this.setTable(i);
  };
  e.prototype.renderSummaryContent = function (t, i, r, n) {
    var a =
      this.parent.dataSource instanceof Array
        ? !this.parent.getDataModule().isRemote() && this.parent.parentDetails
          ? this.getData()
          : this.parent.dataSource
        : this.parent.currentViewData;
    var o = this.modelGenerator.getData();
    var l = u(r) ? this.modelGenerator.getColumns() : this.modelGenerator.getColumns(r);
    var h = u(r)
      ? this.modelGenerator.generateRows(a, t || this.aggregates)
      : this.modelGenerator.generateRows(a, t || this.aggregates, r, n);
    var d = document.createDocumentFragment();
    var p = new nt(this.locator, null, this.parent);
    p.element = this.parent.createElement('TR', {
      className: 'e-summaryrow',
      attrs: { role: 'row' },
    });
    for (var c = 0, f = o.length; c < f; c++) {
      var g = h[parseInt(c.toString(), 10)];
      if (h[parseInt(c.toString(), 10)]) {
        var m = p.render(h[parseInt(c.toString(), 10)], l);
        if (m.querySelectorAll('.e-leftfreeze').length && m.querySelectorAll('.e-indentcell').length)
          for (var y = m.querySelectorAll('.e-indentcell'), v = 0; v < y.length; v++) {
            y[parseInt(v.toString(), 10)].classList.add('e-leftfreeze');
            se(y[parseInt(v.toString(), 10)], v * 30, this.parent.enableRtl, 'Left');
          }
        if (this.parent.isFrozenGrid() && m.querySelectorAll('.e-summarycell').length) {
          Q([].slice.call(m.querySelectorAll('.e-summarycell')), ['e-freezeleftborder', 'e-freezerightborder']);
        }
        d.appendChild(m);
      }
    }
    var b =
      this.parent.parentDetails &&
      this.parent.parentDetails.parentInstObj &&
      this.parent.parentDetails.parentInstObj.isReact;
    (this.parent.isReact || b) && o.length && this.parent.isInitialLoad
      ? this.parent.renderTemplates(function () {
          i.tFoot.innerHTML = '';
          i.tFoot.appendChild(d);
        })
      : i.tFoot.appendChild(d);
    this.aggregates = u(t) ? this.aggregates : t;
  };
  e.prototype.refresh = function (t) {
    var i =
      this.parent.parentDetails &&
      this.parent.parentDetails.parentInstObj &&
      this.parent.parentDetails.parentInstObj.isReact;
    if (!(this.parent.isReact || i) || !this.parent.isInitialLoad) {
      this.getTable().tFoot.innerHTML = '';
    }
    this.renderSummaryContent(t, this.getTable(), void 0, void 0);
    if (u(t) && this.parent.isAutoFitColumns) {
      this.parent.autoFitColumns();
    }
    this.onScroll();
  };
  e.prototype.refreshCol = function () {
    var t = this.parent.enableColumnVirtualization
      ? this.parent.headerModule.getColGroup()
      : this.parent.element
          .querySelector('.' + Oe)
          .querySelector(mn)
          .cloneNode(true);
    this.getTable().replaceChild(t, this.getColGroup());
    this.setColGroup(t);
  };
  e.prototype.onWidthChange = function (t) {
    this.getColFromIndex(t.index).style.width = xe(t.width);
    if (this.parent.allowResizing && t.module === 'resize') {
      this.updateFooterTableWidth(this.getTable());
    }
  };
  e.prototype.onScroll = function (t) {
    if (t === void 0) {
      t = { left: this.parent.getContent().firstChild.scrollLeft };
    }
    this.getTable().parentElement.scrollLeft = t.left;
  };
  e.prototype.getColFromIndex = function (t) {
    return this.getColGroup().children[parseInt(t.toString(), 10)];
  };
  e.prototype.columnVisibilityChanged = function () {
    this.refresh();
  };
  e.prototype.addEventListener = function () {
    this.evtHandlers = [
      {
        event: As,
        handler: this.refreshCol,
      },
      {
        event: yi,
        handler: this.onWidthChange,
      },
      {
        event: ks,
        handler: this.onScroll,
      },
      {
        event: St,
        handler: this.columnVisibilityChanged,
      },
      {
        event: Le,
        handler: this.refreshFooterRenderer,
      },
    ];
    ce(this.parent, this.evtHandlers, true, this);
  };
  e.prototype.removeEventListener = function () {
    ce(this.parent, this.evtHandlers, false);
  };
  e.prototype.updateFooterTableWidth = function (t) {
    var i = this.parent.getHeaderTable();
    if (i && t) {
      t.style.width = i.style.width;
    }
  };
  e.prototype.refreshFooterRenderer = function (t) {
    var i = this.onAggregates(t);
    this.refresh(i);
  };
  e.prototype.getIndexByKey = function (t, i) {
    for (var r = this.parent.getPrimaryKeyFieldNames()[0], n = 0; n < i.length; n++)
      if (i[parseInt(n.toString(), 10)]['' + r] === t['' + r]) return n;
    return -1;
  };
  e.prototype.getData = function () {
    return this.parent.getDataModule().dataManager.executeLocal(this.parent.getDataModule().generateQuery(true));
  };
  e.prototype.onAggregates = function (t) {
    t = t instanceof Array ? t : [];
    var i = this.parent.getPrimaryKeyFieldNames()[0];
    var r = [];
    var n = false;
    var a = {};
    var o = 'dataSource';
    var l = false;
    if (
      !(this.parent.renderModule.data.isRemote() || (!u(this.parent.dataSource) && this.parent.dataSource.result)) &&
      ((this.parent.allowFiltering && this.parent.filterSettings.columns.length) ||
        this.parent.searchSettings.key.length)
    ) {
      l = true;
    }
    var h;
    !u(this.parent.dataSource) && this.parent.dataSource.result
      ? (h = this.parent.getCurrentViewRecords())
      : (h =
          this.parent.dataSource instanceof Array
            ? l
              ? this.parent.getFilteredRecords()
              : this.parent.dataSource
            : this.parent.dataSource.dataSource.json.length
              ? l
                ? this.parent.getFilteredRecords()
                : this.parent.dataSource.dataSource.json
              : this.parent.getCurrentViewRecords());
    if (this.parent.parentDetails && !this.parent.getDataModule().isRemote()) {
      h = this.getData();
    }
    if (this.parent.editModule) {
      a = this.parent.editModule.getBatchChanges();
    }
    if (Object.keys(a).length) {
      for (var d = 0; d < h.length; d++) {
        n = false;
        if (a[It].length && this.getIndexByKey(h[parseInt(d.toString(), 10)], a[It]) > -1) {
          n = true;
          r.push(a[It][this.getIndexByKey(h[parseInt(d.toString(), 10)], a[It])]);
        }
        a[Si].length && this.getIndexByKey(h[parseInt(d.toString(), 10)], a[Si]) > -1
          ? (n = true)
          : n || r.push(h[parseInt(d.toString(), 10)]);
      }
      if (a[it].length) for (var d = 0; d < a[it].length; d++) r.push(a[it][parseInt(d.toString(), 10)]);
    } else if (t.length) {
      var p = Yr(h);
      r = p.map(function (O) {
        var A = le.getObject(this.parent.getPrimaryKeyFieldNames()[0], O);
        var k;
        var F = t.some(function (D) {
          k = D;
          return A === le.getObject(this.parent.getPrimaryKeyFieldNames()[0], D);
        });
        return F ? k : O;
      });
    } else r = h;
    var c = t;
    if (t.type && t.type === 'cancel') {
      r = h;
    }
    for (var f = {}, g, m = this.parent.aggregates, d = 0; d < m.length; d++)
      for (var y = 0; y < m[parseInt(d.toString(), 10)].columns.length; y++) {
        var p = [];
        var v = m[parseInt(d.toString(), 10)].columns[parseInt(y.toString(), 10)].type.toString();
        p = r;
        for (
          var b = v.split(',').map(function (k) {
              return k.trim();
            }),
            w = 0,
            C = b;
          w < C.length;
          w++
        ) {
          var I = C[w];
          g = Ls(C[w], p, m[parseInt(d.toString(), 10)].columns[parseInt(y.toString(), 10)], this.parent);
          f[m[parseInt(d.toString(), 10)].columns[parseInt(y.toString(), 10)].field + ' - ' + C[w].toLowerCase()] = g;
        }
      }
    var x = {
      result: r,
      count: r.length,
      aggregates: f,
    };
    return x;
  };
  return e;
})(vn);
var qo = (function () {
  var s = function (e, t) {
    s =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (i, r) {
          i.__proto__ = r;
        }) ||
      function (i, r) {
        for (var n in r)
          if (r.hasOwnProperty(n)) {
            i[n] = r[n];
          }
      };
    return s(e, t);
  };
  return function (e, t) {
    s(e, t);
    function i() {
      this.constructor = e;
    }
    e.prototype = t === null ? Object.create(t) : ((i.prototype = t.prototype), new i());
  };
})();
var zo = (function (s) {
  qo(e, s);
  function e() {
    var t = (s !== null && s()) || this;
    t.element = t.parent.createElement('TD', {
      className: 'e-summarycell',
      attrs: {
        tabindex: '-1',
        role: 'gridcell',
      },
    });
    return t;
  }
  e.prototype.getValue = function (t, i, r) {
    var n = u(r.type) ? r.columnName : r.field + ' - ' + (typeof r.type == 'string' ? r.type.toLowerCase() : '');
    return i[r.columnName] ? i[r.columnName]['' + n] : '';
  };
  e.prototype.evaluate = function (t, i, r, n) {
    var a = i.column;
    this.parent.on(Ms, this.refreshWithAggregate(t, i), this);
    if (i.column.footerTemplate || i.column.groupFooterTemplate || i.column.groupCaptionTemplate)
      if (this.parent.rowRenderingMode === 'Vertical') {
        t.classList.add('e-lastsummarycell');
      } else {
        if (this.parent.rowRenderingMode === 'Vertical') {
          t.style.display = 'none';
        }
        return true;
      }
    var o = i.column.getTemplate(i.cellType);
    var l = '';
    var h = this.parent.getColumnByField(r[i.column.columnName].field);
    if (!u(h) && ((r[i.column.columnName].headerText = h.headerText), h.isForeignColumn())) {
      var d = h.columnData.filter(function (b) {
        return b[h.foreignKeyField] === r[i.column.columnName].key;
      })[0];
      if (
        h.columnData.filter(function (b) {
          return b[h.foreignKeyField] === r[i.column.columnName].key;
        })[0]
      ) {
        r[i.column.columnName].foreignKey = h.columnData.filter(function (b) {
          return b[h.foreignKeyField] === r[i.column.columnName].key;
        })[0][h.foreignKeyValue];
      }
    }
    var p = i.column.footerTemplate
      ? typeof i.column.footerTemplate != 'string' &&
        !(i.column.footerTemplate.prototype && i.column.footerTemplate.prototype.CSPTemplate)
      : i.column.groupFooterTemplate
        ? typeof i.column.groupFooterTemplate != 'string' &&
          !(i.column.groupFooterTemplate.prototype && i.column.groupFooterTemplate.prototype.CSPTemplate)
        : i.column.groupCaptionTemplate
          ? typeof i.column.groupCaptionTemplate != 'string' &&
            !(i.column.groupCaptionTemplate.prototype && i.column.groupCaptionTemplate.prototype.CSPTemplate)
          : false;
    var c = this.parent.isReact && p;
    var f =
      this.parent.parentDetails &&
      this.parent.parentDetails.parentInstObj &&
      this.parent.parentDetails.parentInstObj.isReact &&
      p;
    var g = this.parent.printGridParent && this.parent.printGridParent.isReact;
    if (c || f || g) {
      var m = r[i.column.columnName];
      if (o.property === 'groupCaptionTemplate' || o.property === 'groupFooterTemplate') {
        var y = 'groupKey';
        var v = 'key';
        m.groupKey = m.key;
      }
      o.fn(m, this.parent, o.property, '', null, null, t);
      if (!this.parent.isInitialLoad) {
        this.parent.renderTemplates();
      }
    } else ae(t, o.fn(r[i.column.columnName], this.parent, o.property, '', null, null, null, this.parent.root));
    return false;
  };
  e.prototype.refreshWithAggregate = function (t, i) {
    var r = this;
    var n = i;
    return function (a) {
      var o = i;
      var l = i.column.columnName ? i.column.columnName : null;
      var h = u(l)
        ? null
        : a.cells.filter(function (d) {
            return d.column.columnName === l;
          })[0];
      if (
        t.parentElement &&
        t.parentElement.getAttribute('data-uid') === a.dataUid &&
        l &&
        h &&
        l === h.column.columnName
      ) {
        r.refreshTD(t, h, a.data);
      }
    };
  };
  return e;
})(Oi);
var No = (function () {
  function s(e, t) {
    this.parent = e;
    this.locator = t;
    this.addEventListener();
  }
  s.prototype.getModuleName = function () {
    return 'aggregate';
  };
  s.prototype.initiateRender = function () {
    for (
      var e = this,
        t = this.locator.getService('cellRendererFactory'),
        i = new zo(this.parent, this.locator),
        r = [P.Summary, P.CaptionSummary, P.GroupSummary],
        n = 0;
      n < r.length;
      n++
    )
      t.addCellRenderer(r[parseInt(n.toString(), 10)], i);
    this.footerRenderer = new Mo(this.parent, this.locator);
    this.footerRenderer.renderPanel();
    this.footerRenderer.renderTable();
    var a = this.footerRenderer.getPanel();
    if (this.parent.element.scrollHeight >= this.parent.getHeight(this.parent.height) && a) {
      j([a], ['e-footerpadding']);
    }
    this.locator.register('footerRenderer', this.footerRenderer);
    var o = function () {
      e.prepareSummaryInfo();
      e.parent.off(et, o);
    };
    this.parent.on(et, o, this);
    this.parent.on(et, this.footerRenderer.refresh, this.footerRenderer);
  };
  s.prototype.prepareSummaryInfo = function () {
    var e = this;
    Po(this.parent.aggregates, function (t) {
      var i = re('customFormat', t);
      if (!u(i)) {
        t.setPropertiesSilent({ format: i });
      }
      if (typeof t.format == 'object') {
        var r = new wn();
        t.setFormatter(r.getFormatFunction(E({}, t.format)));
      } else if (typeof t.format == 'string') {
        var n = e.locator.getService('valueFormatter');
        t.setFormatter(n.getFormatFunction({ format: t.format }));
      }
      t.setPropertiesSilent({ columnName: t.columnName || t.field });
    });
  };
  s.prototype.onPropertyChanged = function (e) {
    if (e.module === this.getModuleName()) {
      if (u(this.footerRenderer)) {
        this.initiateRender();
      }
      this.prepareSummaryInfo();
      this.footerRenderer.refresh();
      var t = new yn(this.parent);
      var i = new Sn(this.parent);
      if (i.getData().length !== 0 || !t.isEmpty()) {
        this.parent.notify(ee, {});
      }
    }
  };
  s.prototype.addEventListener = function () {
    if (!this.parent.isDestroyed) {
      this.parent.on(Ce, this.initiateRender, this);
      this.parent.on(Se, this.onPropertyChanged, this);
      this.parent.on(fr, this.refresh, this);
      this.parent.on(M, this.destroy, this);
    }
  };
  s.prototype.removeEventListener = function () {
    if (!this.parent.isDestroyed) {
      this.footerRenderer.removeEventListener();
      this.parent.off(Ce, this.initiateRender);
      this.parent.off(et, this.footerRenderer.refresh);
      this.parent.off(Se, this.onPropertyChanged);
      this.parent.off(fr, this.refresh);
      this.parent.off(M, this.destroy);
      if (this.parent.element.querySelector('.' + qt)) {
        N(this.parent.element.querySelector('.' + qt));
      }
    }
  };
  s.prototype.destroy = function () {
    this.removeEventListener();
  };
  s.prototype.refresh = function (e, t) {
    var i = e instanceof Array ? e : [e];
    this.parent.notify(Le, i);
    if (t) {
      i.row = t;
    }
    if (this.parent.groupSettings.columns.length > 0) {
      this.parent.notify(Ot, i);
    }
  };
  return s;
})();
function Po(s, e) {
  for (var t = 0; t < s.length; t++)
    for (var i = 0; i < s[parseInt(t.toString(), 10)].columns.length; i++)
      e(s[parseInt(t.toString(), 10)].columns[parseInt(i.toString(), 10)], s[parseInt(t.toString(), 10)]);
}
var Ho = (function () {
  function s(e, t, i) {
    var r = this;
    this.fromWheel = false;
    this.touchMove = false;
    this.options = {};
    this.sentinelInfo = {
      up: {
        check: function (n, a) {
          var o = n.top - r.containerRect.top;
          var l = r.containerRect.bottom > n.bottom ? r.containerRect.bottom - n.bottom : 0;
          a.entered = o >= 0;
          return o + r.options.pageHeight / 2 >= 0 || (l > 0 && n.bottom > 0);
        },
        axis: 'Y',
      },
      down: {
        check: function (n, a) {
          var o = n.bottom;
          a.entered = n.bottom <= r.containerRect.bottom;
          return n.bottom - r.containerRect.top - r.options.pageHeight / 2 <= r.options.pageHeight / 2;
        },
        axis: 'Y',
      },
      right: {
        check: function (n, a) {
          var o = n.right;
          a.entered = n.right < r.containerRect.right;
          return n.right - r.containerRect.width <= r.containerRect.right;
        },
        axis: 'X',
      },
      left: {
        check: function (n, a) {
          var o = n.left;
          a.entered = n.left > 0;
          return n.left + r.containerRect.width >= r.containerRect.left;
        },
        axis: 'X',
      },
    };
    this.element = e;
    this.options = t;
    this.movableEle = i;
  }
  s.prototype.observe = function (e, t) {
    var i = this;
    this.containerRect = this.options.container.getBoundingClientRect();
    R.add(
      this.options.container,
      'wheel',
      function () {
        return (i.fromWheel = true);
      },
      this,
    );
    R.add(this.options.container, 'scroll', this.virtualScrollHandler(e, t), this);
  };
  s.prototype.check = function (e) {
    var t = this.sentinelInfo['' + e];
    return this.sentinelInfo['' + e].check(this.element.getBoundingClientRect(), this.sentinelInfo['' + e]);
  };
  s.prototype.virtualScrollHandler = function (e, t) {
    var i = this;
    var r = z.info.name === 'chrome' ? 200 : 100;
    var n = gr(e, r);
    var a = gr(e, 50);
    this.options.prevTop = this.options.prevLeft = 0;
    return function (o) {
      var l = o.target.scrollTop;
      var h = o.target.scrollLeft;
      var d = i.options.prevTop < o.target.scrollTop ? 'down' : 'up';
      d = i.options.prevLeft === o.target.scrollLeft ? d : i.options.prevLeft < o.target.scrollLeft ? 'right' : 'left';
      i.options.prevTop = o.target.scrollTop;
      i.options.prevLeft = o.target.scrollLeft;
      var p = i.sentinelInfo['' + d];
      if (i.options.axes.indexOf(i.sentinelInfo['' + d].axis) !== -1) {
        i.containerRect = i.options.container.getBoundingClientRect();
        var c = i.check(d);
        if (i.sentinelInfo['' + d].entered) {
          t(
            i.element,
            i.sentinelInfo['' + d],
            d,
            {
              top: o.target.scrollTop,
              left: o.target.scrollLeft,
            },
            i.fromWheel,
            c,
          );
        }
        if (c) {
          var f = n;
          if (i.sentinelInfo['' + d].axis === 'X') {
            f = a;
          }
          f({
            direction: d,
            sentinel: i.sentinelInfo['' + d],
            offset: {
              top: o.target.scrollTop,
              left: o.target.scrollLeft,
            },
            focusElement: document.activeElement,
          });
        }
        i.fromWheel = false;
      }
    };
  };
  s.prototype.setPageHeight = function (e) {
    this.options.pageHeight = e;
  };
  return s;
})();
var Nn = (function () {
  function s(e) {
    this.cOffsets = {};
    this.cache = {};
    this.rowCache = {};
    this.data = {};
    this.groups = {};
    this.currentInfo = {};
    this.prevInfo = {};
    this.parent = e;
    this.model = this.parent.pageSettings;
    this.rowModelGenerator = this.parent.allowGrouping ? new qs(this.parent) : new Mi(this.parent);
  }
  s.prototype.columnInfiniteRows = function (e, t) {
    var i = [];
    if (t.requestType === 'virtualscroll') {
      var r = this.parent.getRowsObject();
      i.push.apply(i, this.rowModelGenerator.refreshRows(r));
      if (this.parent.infiniteScrollSettings.enableCache) {
        var n =
          this.parent.frozenRows && this.parent.pageSettings.currentPage === 1
            ? 0
            : zs(this.parent.getContentTable().querySelector('.e-row:not(.e-addedrow)'));
        var a = i.slice(n, n + this.parent.pageSettings.pageSize * 3);
        if (this.parent.frozenRows && this.parent.pageSettings.currentPage !== 1) {
          a = i.slice(0, this.parent.frozenRows).concat(a);
        }
        i = a;
      }
    } else i.push.apply(i, this.rowModelGenerator.generateRows(e, t));
    return i;
  };
  s.prototype.generateRows = function (e, t) {
    var i = this;
    if (this.parent.enableColumnVirtualization && this.parent.enableInfiniteScrolling)
      return this.columnInfiniteRows(e, t);
    var r = false;
    var n = (t.virtualInfo =
      t.virtualInfo ||
      ((t.requestType === 'sorting' || t.requestType === 'delete') && Pt(this.parent) && this.prevInfo) ||
      this.getData());
    this.prevInfo = n;
    var a = n.sentinelInfo && n.sentinelInfo.axis === 'X';
    var o = !a && n.loadNext && !n.loadSelf ? n.nextInfo.page : n.page;
    var l = [];
    var h = this.getBlockIndexes(o);
    var d = [];
    if (this.currentInfo.blockIndexes) {
      h =
        n.blockIndexes =
        t.virtualInfo.blockIndexes =
          this.includePrevPage
            ? this.currentInfo.blockIndexes.slice(1)
            : this.currentInfo.blockIndexes.slice(0, this.currentInfo.blockIndexes.length - 1);
      r = true;
    }
    this.checkAndResetCache(t.requestType);
    if (X(this.parent) && this.parent.vcRows.length) {
      var p = this.parent.vcRows.filter(function (v) {
        return v.isDataRow;
      });
      if ((this.parent.isManualRefresh && p.length === e.records.length) || !this.parent.isManualRefresh)
        return (l = this.parent.vcRows);
    }
    if (this.parent.enableColumnVirtualization)
      for (var c = 0; c < n.blockIndexes.length; c++)
        if (this.isBlockAvailable(n.blockIndexes[parseInt(c.toString(), 10)])) {
          this.cache[n.blockIndexes[parseInt(c.toString(), 10)]] = this.rowModelGenerator.refreshRows(
            this.cache[n.blockIndexes[parseInt(c.toString(), 10)]],
          );
        }
    for (
      var f = n.blockIndexes,
        g = function (v) {
          if (!m.isBlockAvailable(f[parseInt(v.toString(), 10)])) {
            var b =
              !u(m.startIndex) && !isNaN(m.startIndex)
                ? m.startIndex
                : m.getStartIndex(f[parseInt(v.toString(), 10)], e);
            b =
              X(m.parent) &&
              !m.parent.vcRows.length &&
              (t.requestType === 'sorting' ||
                t.requestType === 'delete' ||
                t.requestType === 'refresh-aggregate-on-save')
                ? 0
                : b;
            var w = m.rowModelGenerator.generateRows(e, {
              virtualInfo: n,
              startIndex: b,
            });
            if (X(m.parent) && !m.parent.vcRows.length) {
              m.recordsCount = e.records.length;
              m.parent.vRows = w;
              m.parent.vcRows = w;
              m.parent.notify(bn, {});
            }
            var C = void 0;
            var I = 'isTreeGrid';
            if (X(m.parent)) m.getGroupVirtualRecordsByIndex(w);
            else if (r) m.setBlockForManualRefresh(m.cache, h, w);
            else if (
              (t.requestType === 'sorting' ||
                t.requestType === 'delete' ||
                (m.parent.isTreeGrid && m.parent.getDataModule().isRemote() && t.requestType === 'refresh')) &&
              Pt(m.parent)
            )
              for (var x = Cn(n.blockIndexes), O = 0, A = 0; A < x.length; A++) {
                var k = m.getBlockIndexes(x[parseInt(A.toString(), 10)]);
                var F = m.model.pageSize * A;
                var D = F + m.model.pageSize;
                if (m.parent.allowGrouping && m.parent.groupSettings.columns.length) {
                  var L = w
                    .filter(function (J) {
                      return J.isDataRow;
                    })
                    .slice(F, D);
                  F = O;
                  D = w.indexOf(L[L.length - 1]) + 1;
                }
                var K = w.slice(F, D);
                var V = ~~Math.max(K.length, m.model.pageSize) / 2;
                if (!m.isBlockAvailable(k[0])) {
                  m.cache[k[0]] = K.slice(0, V);
                }
                if (!m.isBlockAvailable(k[1])) {
                  m.cache[k[1]] = K.slice(V);
                }
                O = D;
              }
            else {
              C = ~~Math.max(w.length, m.model.pageSize) / 2;
              if (!m.isBlockAvailable(h[0])) {
                m.cache[h[0]] = w.slice(0, C);
              }
              if (!m.isBlockAvailable(h[1])) {
                m.cache[h[1]] = w.slice(C);
              }
            }
          }
          if (
            m.parent.groupSettings.columns.length &&
            !a &&
            m.cache[f[parseInt(v.toString(), 10)]] &&
            !m.parent.groupSettings.enableLazyLoading
          ) {
            m.cache[f[parseInt(v.toString(), 10)]] = m.updateGroupRow(
              m.cache[f[parseInt(v.toString(), 10)]],
              f[parseInt(v.toString(), 10)],
            );
          }
          if (!t.renderMovableContent && !t.renderFrozenRightContent && m.cache[f[parseInt(v.toString(), 10)]]) {
            l.push.apply(l, m.cache[f[parseInt(v.toString(), 10)]]);
            var W = [];
            if (m.parent.enableVirtualization && m.parent.groupSettings.columns.length) {
              l.forEach(function (J) {
                if (!W.includes(J)) {
                  W.push(J);
                }
              });
            }
            l = W.length ? W : l;
          }
          if (m.isBlockAvailable(f[parseInt(v.toString(), 10)])) {
            d.push(f[parseInt(v.toString(), 10)]);
          }
        },
        m = this,
        c = 0;
      c < f.length;
      c++
    )
      g(c);
    if (X(this.parent) && this.parent.vcRows.length && t.requestType === 'sorting' && t.scrollTop.top !== 0)
      return (l = this.parent.vcRows);
    n.blockIndexes = d;
    var y = 'records';
    this.parent.allowGrouping && this.parent.groupSettings.columns.length
      ? (this.parent.currentViewData.records = l.map(function (v) {
          return v.data;
        }))
      : (this.parent.currentViewData = l.map(function (v) {
          return v.data;
        }));
    if (t.requestType === 'grouping') {
      this.parent.currentViewData.records = this.parent.currentViewData.records.filter(function (v, b) {
        return i.parent.currentViewData.records.indexOf(v) === b;
      });
    }
    return X(this.parent) &&
      this.parent.vcRows.length &&
      ['save', 'delete', 'refresh-aggregate-on-save'].some(function (v) {
        return t.requestType === v;
      })
      ? (l = this.parent.vcRows)
      : l;
  };
  s.prototype.setBlockForManualRefresh = function (e, t, i) {
    var r = this.model.pageSize / 2;
    this.includePrevPage
      ? ((e[t[0] - 1] = i.slice(0, r)),
        (e[t[0]] = i.slice(r, r * 2)),
        (e[t[1]] = i.slice(r * 2, r * 3)),
        (e[t[2]] = i.slice(r * 3, r * 4)))
      : ((e[t[0]] = i.slice(0, r)),
        (e[t[1]] = i.slice(r, r * 2)),
        (e[t[2]] = i.slice(r * 2, r * 3)),
        (e[t[2] + 1] = i.slice(r * 3, r * 4)));
  };
  s.prototype.getBlockIndexes = function (e) {
    return [e + (e - 1), e * 2];
  };
  s.prototype.getPage = function (e) {
    return e % 2 === 0 ? e / 2 : (e + 1) / 2;
  };
  s.prototype.isBlockAvailable = function (e) {
    return e in this.cache;
  };
  s.prototype.getData = function () {
    return {
      page: this.model.currentPage,
      blockIndexes: this.getBlockIndexes(this.model.currentPage),
      direction: 'down',
      columnIndexes: this.parent.getColumnIndexesInView(),
    };
  };
  s.prototype.getStartIndex = function (e, t, i) {
    if (i === void 0) {
      i = true;
    }
    var r = this.getPage(e);
    var n = e % 2 === 0;
    var a = (r - 1) * this.model.pageSize;
    return i || !n ? a : a + ~~(this.model.pageSize / 2);
  };
  s.prototype.getColumnIndexes = function (e) {
    var t = this;
    if (e === void 0) {
      e = this.parent.getHeaderContent().querySelector('.' + je);
    }
    var i = [];
    var r = e.scrollLeft | 0;
    var n = Object.keys(this.cOffsets);
    var a = e.getBoundingClientRect().width;
    r = Math.min(this.cOffsets[n.length - 1] - e.getBoundingClientRect().width, r);
    var o = z.isDevice ? 2 * e.getBoundingClientRect().width : e.getBoundingClientRect().width / 2;
    var l = r + e.getBoundingClientRect().width + (r === 0 ? o : 0);
    var h = 0;
    var d = r - o;
    if (this.parent.isFrozenGrid()) {
      h = this.parent.leftrightColumnWidth('left');
      if (d > 0) {
        for (var p = this.parent.getVisibleFrozenLeftCount() - 1; p >= 0; p--)
          if (d <= this.cOffsets[parseInt(p.toString(), 10)]) {
            h = h - this.cOffsets[parseInt(p.toString(), 10)];
            break;
          }
      }
      if (this.parent.getFrozenMode() === Ns) {
        var c = this.parent.getVisibleFrozenRightCount();
        n.splice(n.length - 1 - c, c);
      }
    }
    var f = this.parent.getVisibleFrozenLeftCount();
    n.some(function (g) {
      var m = Number(g);
      var y = t.cOffsets['' + g];
      var v = (d < 0 && m < f) || (d + h <= t.cOffsets['' + g] && l + o >= t.cOffsets['' + g]);
      if (v) {
        i.push(m);
      }
      return l + o < t.cOffsets['' + g];
    });
    return i;
  };
  s.prototype.checkAndResetCache = function (e) {
    var t = [
      'paging',
      'refresh',
      'sorting',
      'filtering',
      'searching',
      'grouping',
      'ungrouping',
      'reorder',
      'save',
      'delete',
      'refresh-aggregate-on-save',
    ];
    var i = t.some(function (r) {
      return e === r;
    });
    if (i) {
      this.cache = {};
      this.data = {};
      this.groups = {};
    }
    return i;
  };
  s.prototype.refreshColOffsets = function () {
    var e = this;
    var t = 0;
    this.cOffsets = {};
    for (
      var i = this.parent.groupSettings.columns.length,
        r = this.parent.getVisibleColumns(),
        n = r.length,
        a = function (p) {
          return (
            p.visible &&
            (e.parent.groupSettings.showGroupedColumn ? p.visible : e.parent.groupSettings.columns.indexOf(p.field) < 0)
          );
        },
        o = this.parent.groupSettings.columns,
        l = 0;
      l < o.length;
      l++
    )
      this.cOffsets[parseInt(l.toString(), 10)] = (this.cOffsets[l - 1] | 0) + 30;
    for (
      var h = Array.apply(null, Array(n)).map(function () {
          return t++;
        }),
        d = 0;
      d < h.length;
      d++
    ) {
      h[parseInt(d.toString(), 10)] = h[parseInt(d.toString(), 10)] + i;
      this.cOffsets[h[parseInt(d.toString(), 10)]] =
        (this.cOffsets[h[parseInt(d.toString(), 10)] - 1] | 0) +
        (a(r[parseInt(d.toString(), 10)]) ? parseInt(r[parseInt(d.toString(), 10)].width, 10) : 0);
    }
  };
  s.prototype.updateGroupRow = function (e, t) {
    for (var i = e[0], r = [], n = Object.keys(this.cache), a = 0; a < n.length; a++)
      if (Number(n[parseInt(a.toString(), 10)]) < t) {
        r = r.concat(this.cache[n[parseInt(a.toString(), 10)]]);
      }
    return (i && i.isDataRow) || t % 2 === 0 ? e : this.iterateGroup(e, r);
  };
  s.prototype.iterateGroup = function (e, t) {
    var i = e[0];
    var r = 0;
    if (e[0] && e[0].isDataRow) return e;
    var n = e.some(function (a) {
      return t.some(function (o, l) {
        var h = o && o.data.field !== void 0 && o.data.field === a.data.field && o.data.key === a.data.key;
        if (h) {
          r = l;
        }
        return h;
      });
    });
    if (n) {
      e.shift();
      e = this.iterateGroup(e, t.slice(r));
    }
    return e;
  };
  s.prototype.getRows = function () {
    for (var e = [], t = Object.keys(this.cache), i = 0; i < t.length; i++)
      e = e.concat(this.cache[t[parseInt(i.toString(), 10)]]);
    return e;
  };
  s.prototype.generateCells = function (e) {
    for (var t = [], i = this.parent.columnModel, r = 0; r < i.length; r++)
      t.push(this.rowModelGenerator.generateCell(i[parseInt(r.toString(), 10)], null, null, null, null, e));
    return t;
  };
  s.prototype.getGroupVirtualRecordsByIndex = function (e) {
    var t = this.parent.contentModule.getGroupedTotalBlocks();
    var i = this.parent.contentModule.getBlockSize();
    if (Object.keys(this.cache).length === 0)
      for (var r = 0, n = 1; n <= t; n++) {
        var a = 0;
        this.cache[parseInt(n.toString(), 10)] = [];
        for (var o = (n - 1) * i + r; o < e.length && a !== i; o++) {
          this.cache[parseInt(n.toString(), 10)].push(e[parseInt(o.toString(), 10)]);
          if (e[parseInt(o.toString(), 10)].isDataRow) {
            a++;
          }
          r++;
        }
        r -= a;
      }
  };
  return s;
})();
var Pn = (function () {
  var s = function (e, t) {
    s =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (i, r) {
          i.__proto__ = r;
        }) ||
      function (i, r) {
        for (var n in r)
          if (r.hasOwnProperty(n)) {
            i[n] = r[n];
          }
      };
    return s(e, t);
  };
  return function (e, t) {
    s(e, t);
    function i() {
      this.constructor = e;
    }
    e.prototype = t === null ? Object.create(t) : ((i.prototype = t.prototype), new i());
  };
})();
var Vo = (function (s) {
  Pn(e, s);
  function e(t, i) {
    var r = s(t, i) || this;
    r.prevHeight = 0;
    r.startIndex = 0;
    r.preStartIndex = 0;
    r.preventEvent = false;
    r.actions = ['filtering', 'searching', 'grouping', 'ungrouping'];
    r.offsets = {};
    r.tmpOffsets = {};
    r.virtualEle = new Hn();
    r.offsetKeys = [];
    r.isFocused = false;
    r.isSelection = false;
    r.isBottom = false;
    r.isBottomNotify = false;
    r.diff = 0;
    r.heightChange = false;
    r.isTop = false;
    r.empty = void 0;
    r.isCancel = false;
    r.requestTypes = ['beginEdit', 'cancel', 'delete', 'add', 'save', 'sorting'];
    r.isNormaledit = r.parent.editSettings.mode === 'Normal';
    r.virtualData = {};
    r.virtualInfiniteData = {};
    r.emptyRowData = {};
    r.isContextMenuOpen = false;
    r.isSelectionScroll = false;
    r.validationCheck = false;
    r.firstCellFocus = false;
    r.prevPage = 0;
    r.prevCurrentInfo = {};
    r.locator = i;
    r.eventListener('on');
    r.widthServices = i.getService('widthService');
    r.parent.on(St, r.setVisible, r);
    r.vgenerator = r.generator;
    return r;
  }
  e.prototype.renderTable = function () {
    this.header = this.locator.getService('rendererFactory').getRenderer(Bt.Header);
    s.prototype.renderTable();
    this.virtualEle.table = this.getTable();
    this.virtualEle.content = this.content = this.getPanel().querySelector('.' + ct);
    this.virtualEle.renderWrapper(this.parent.height);
    this.virtualEle.renderPlaceHolder();
    if (!(!this.parent.enableVirtualization && this.parent.enableColumnVirtualization)) {
      this.virtualEle.wrapper.style.position = 'absolute';
    }
    var t = this.parent.dataSource instanceof H && !this.parent.dataSource.dataSource.offline;
    var i = {
      container: this.content,
      pageHeight: this.getBlockHeight() * 2,
      debounceEvent: t,
      axes: this.parent.enableColumnVirtualization ? ['X', 'Y'] : ['Y'],
    };
    this.observer = new Ho(this.virtualEle.wrapper, i);
  };
  e.prototype.renderEmpty = function (t) {
    this.getTable().appendChild(t);
    if (this.parent.frozenRows) {
      this.parent.getHeaderContent().querySelector(U).innerHTML = '';
    }
    this.virtualEle.adjustTable(0, 0);
  };
  e.prototype.getReorderedFrozenRows = function (t) {
    var i = t.virtualInfo.blockIndexes;
    var r = t.virtualInfo.columnIndexes;
    var n = t.virtualInfo.page;
    t.virtualInfo.blockIndexes = [1, 2];
    t.virtualInfo.page = 1;
    t.virtualInfo.columnIndexes = [];
    var a = this.parent.getCurrentViewRecords().length;
    var o = this.parent.renderModule.data.dataManager.dataSource.json.slice(
      0,
      this.parent.getCurrentViewRecords().length,
    );
    var l = this.vgenerator.generateRows(o, t);
    t.virtualInfo.blockIndexes = t.virtualInfo.blockIndexes;
    t.virtualInfo.columnIndexes = t.virtualInfo.columnIndexes;
    t.virtualInfo.page = t.virtualInfo.page;
    return l.splice(0, this.parent.frozenRows);
  };
  e.prototype.scrollListener = function (t) {
    if (
      !(
        (!this.parent.enableVirtualization &&
          this.parent.enableColumnVirtualization &&
          (t.direction === 'up' || t.direction === 'down')) ||
        this.isBottomNotify
      )
    ) {
      this.scrollAfterEdit();
      if (this.parent.enablePersistence) {
        this.parent.scrollPosition = t.offset;
      }
      if (this.preventEvent || this.parent.isDestroyed) {
        this.preventEvent = false;
        return;
      }
      u(document.activeElement)
        ? (this.isFocused = false)
        : (this.isFocused =
            this.content === T(document.activeElement, '.' + ct) || this.content === document.activeElement);
      if (this.parent.islazyloadRequest && t.direction === 'down') {
        this.parent.removeMaskRow();
        this.parent.islazyloadRequest = false;
        return;
      }
      var i = t.sentinel;
      var r = (this.currentInfo = this.getInfoFromView(t.direction, t.sentinel, t.offset));
      if (X(this.parent))
        if (r.blockIndexes && this.prevInfo.blockIndexes.toString() === r.blockIndexes.toString()) {
          this.parent.removeMaskRow();
          return;
        } else {
          r.event = 'refresh-virtual-block';
          if (!u(r.offsets)) {
            r.offsets.top = this.content.scrollTop;
          }
          this.parent.pageSettings.currentPage = r.page;
          if (this.parent.enableVirtualMaskRow) {
            this.parent.showMaskRow(t.sentinel.axis);
            this.parent.addShimmerEffect();
          }
          if (this.parent.editSettings.showAddNewRow) {
            this.parent.closeEdit();
          }
          this.parent.notify(r.event, {
            requestType: 'virtualscroll',
            virtualInfo: r,
            focusElement: t.focusElement,
          });
          return;
        }
      if (
        this.prevInfo &&
        ((t.sentinel.axis === 'Y' && this.prevInfo.blockIndexes.toString() === r.blockIndexes.toString()) ||
          (t.sentinel.axis === 'X' && this.prevInfo.columnIndexes.toString() === r.columnIndexes.toString()) ||
          (this.parent.isFrozenGrid() &&
            t.sentinel.axis === 'X' &&
            this.parent.getVisibleFrozenLeftCount() >= r.columnIndexes[0] &&
            this.prevInfo.columnIndexes.toString().includes(r.columnIndexes.toString())))
      ) {
        this.parent.removeMaskRow();
        if (z.isIE) {
          this.parent.hideSpinner();
        }
        this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;
        if (t.sentinel.axis === 'Y') {
          this.restoreEdit();
        }
        if (
          this.parent.groupSettings.enableLazyLoading &&
          this.prevInfo.blockIndexes[0] === 1 &&
          r.blockIndexes[0] === 1 &&
          t.direction === 'up'
        ) {
          this.virtualEle.adjustTable(0, r.offsets.top < this.offsets[1] ? 0 : this.getBlockHeight());
        }
        return;
      }
      this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization ? r.columnIndexes : []);
      if (!(!this.parent.enableVirtualization && this.parent.enableColumnVirtualization)) {
        this.parent.pageSettings.currentPage = r.loadNext && !r.loadSelf ? r.nextInfo.page : r.page;
      }
      this.requestType = 'virtualscroll';
      if (this.parent.enableVirtualMaskRow) {
        this.parent.showMaskRow(t.sentinel.axis);
        this.parent.addShimmerEffect();
      }
      this.parent.islazyloadRequest = false;
      if (this.parent.editSettings.showAddNewRow) {
        this.parent.closeEdit();
      }
      this.parent.notify(At, { action: 'clear' });
      if (!(!this.parent.isInitialLoad && this.parent.enablePersistence)) {
        if (this.prevPage === this.parent.pageSettings.currentPage && r.event === ee) {
          this.currentInfo = this.prevCurrentInfo;
          return;
        }
        if (r.event === ee) {
          this.prevPage = this.parent.pageSettings.currentPage;
          this.prevCurrentInfo = this.currentInfo;
        }
        this.isBottomNotify = this.isBottom && r.event === ee;
        this.parent.notify(r.event, {
          requestType: 'virtualscroll',
          virtualInfo: r,
          focusElement: t.focusElement,
        });
      }
      if (this.parent.enableColumnVirtualization && !this.parent.getContentTable().querySelector('tr.e-row')) {
        this.parent.removeMaskRow();
        this.appendContent(void 0, void 0, {
          requestType: 'virtualscroll',
          virtualInfo: r,
          focusElement: t.focusElement,
        });
        this.prevInfo = r;
      }
    }
  };
  e.prototype.block = function (t) {
    return this.vgenerator.isBlockAvailable(t);
  };
  e.prototype.getInfoFromView = function (t, i, r) {
    var n = false;
    var a = [];
    var o = {
      direction: t,
      sentinelInfo: i,
      offsets: r,
      startIndex: this.preStartIndex,
      endIndex: this.preEndIndex,
    };
    o.page = this.getPageFromTop(r.top, o);
    o.blockIndexes = a = this.vgenerator.getBlockIndexes(o.page);
    o.loadSelf = !this.vgenerator.isBlockAvailable(a[o.block]);
    var l = this.ensureBlocks(o);
    if (this.activeKey === 'upArrow' && o.blockIndexes.toString() !== l.toString()) {
      var h = l[l.length - 1];
      if (o.blockIndexes.indexOf(l[l.length - 1]) === -1) {
        n = true;
      }
    }
    if (!(!this.parent.enableVirtualization && this.parent.enableColumnVirtualization)) {
      o.blockIndexes = l;
    }
    o.loadNext = !l
      .filter(function (m) {
        return a.indexOf(m) === -1;
      })
      .every(this.block.bind(this));
    o.event = o.loadNext || o.loadSelf ? ee : dt;
    o.nextInfo = o.loadNext ? { page: Math.max(1, o.page + (t === 'down' ? 1 : -1)) } : {};
    if (n) {
      o.blockIndexes = [o.blockIndexes[0] - 1, o.blockIndexes[0], o.blockIndexes[0] + 1];
    }
    if (this.activeKey === 'downArrow' && !isNaN(this.rowIndex)) {
      var d = Math.ceil(this.rowIndex / this.getBlockSize());
      if (
        d !== 1 &&
        (o.blockIndexes[1] !== d || o.blockIndexes.length < 3) &&
        ((o.blockIndexes = [d - 1, d, d + 1]), o.loadNext)
      ) {
        for (
          var p = this.vgenerator.getBlockIndexes(o.nextInfo.page), c = false, f = 0;
          f < o.blockIndexes.length;
          f++
        ) {
          for (var g = 0; g < p.length; g++)
            if (o.blockIndexes[parseInt(f.toString(), 10)] === p[parseInt(g.toString(), 10)]) {
              c = true;
              break;
            }
          if (c) break;
        }
        if (!c) {
          o.loadNext = false;
          o.nextInfo = {};
          o.event = dt;
        }
      }
    }
    o.columnIndexes = i.axis === 'X' ? this.vgenerator.getColumnIndexes() : this.parent.getColumnIndexesInView();
    if (this.parent.enableColumnVirtualization && i.axis === 'X') {
      o.event = dt;
    }
    return o;
  };
  e.prototype.ensureBlocks = function (t) {
    var i = this;
    var r = t.blockIndexes[t.block];
    var n;
    var a = r;
    var o = Math.max;
    var l = t.direction === 'down' ? [Math.max(r, 1), ++r, ++r] : [Math.max(r - 1, 1), r, r + 1];
    this.prevInfo = this.prevInfo || this.vgenerator.getData();
    l = l.filter(function (d, p) {
      return l.indexOf(d) === p;
    });
    var h = false;
    if (
      Pt(this.parent) &&
      t.direction === 'up' &&
      (((t.page + 1 === this.prevInfo.page || t.page === this.prevInfo.page) &&
        (t.block === 1 || (t.block === 0 && t.page === 1))) ||
        (t.page === this.prevInfo.page && l.length === 2)) &&
      this.vgenerator.isBlockAvailable(t.blockIndexes[1] + 1)
    ) {
      h = t.page + 1 === this.prevInfo.page && t.block === 1;
      r += 1;
      l = [Math.max(r - 1, 1), r, r + 1];
    }
    if (!(this.prevInfo.blockIndexes.toString() === l.toString())) {
      if ((t.loadSelf && !h) || (t.direction === 'down' && this.isEndBlock(r))) {
        l = this.vgenerator.getBlockIndexes(t.page);
      }
      l.some(function (d, p) {
        var c = d === (X(i.parent) ? i.getGroupedTotalBlocks() : i.getTotalBlocks());
        if (c) {
          n = p;
        }
        return c;
      });
      if (n !== void 0) {
        l = l.slice(0, n + 1);
        if (t.block === 0 && l.length === 1 && this.vgenerator.isBlockAvailable(l[0] - 1)) {
          l = [l[0] - 1, l[0]];
        }
      }
    }
    return l;
  };
  e.prototype.appendContent = function (t, i, r) {
    var n = this;
    var a =
      r.virtualInfo.sentinelInfo &&
      r.virtualInfo.sentinelInfo.axis === 'Y' &&
      this.currentInfo.page &&
      this.currentInfo.page !== r.virtualInfo.page
        ? this.currentInfo
        : r.virtualInfo;
    this.prevInfo = this.prevInfo || r.virtualInfo;
    var o = a.columnIndexes[0] - 1;
    var l = this.getColumnOffset(o);
    var h;
    var d = a.blockIndexes;
    if (this.parent.groupSettings.columns.length) {
      this.refreshOffsets();
    }
    if (this.parent.height === '100%') {
      this.parent.element.style.height = '100%';
    }
    var p =
      this.parent.height.toString().indexOf('%') < 0
        ? this.content.getBoundingClientRect().height
        : this.parent.element.getBoundingClientRect().height;
    if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {
      p = 0;
    }
    var c = 0;
    if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid()) {
      var f = 0;
      this.parent.getColumns().filter(function (F) {
        if (F.visible) {
          c += parseInt(F.width.toString(), 10);
          if (F.freeze === 'Left') {
            f += parseInt(F.width.toString(), 10);
          }
        }
      });
      var g = a.columnIndexes;
      h =
        this.getColumnOffset(a.columnIndexes[a.columnIndexes.length - 1]) -
        this.getColumnOffset(a.columnIndexes[0] - 1) +
        '';
      if (o > this.parent.getVisibleFrozenLeftCount()) {
        l = l - f;
      }
      this.resetStickyLeftPos(l, i);
    }
    if (
      !this.requestTypes.some(function (F) {
        return F === n.requestType;
      })
    ) {
      var m = this.getTranslateY(this.content.scrollTop, p, a);
      this.parent.groupSettings.enableLazyLoading &&
      a &&
      this.prevInfo &&
      this.prevInfo.blockIndexes[0] === 1 &&
      a.blockIndexes[0] === 1 &&
      a.direction === 'up'
        ? this.virtualEle.adjustTable(0, this.content.scrollTop < this.offsets[1] ? 0 : this.getBlockHeight())
        : this.virtualEle.adjustTable(l, m);
    }
    if (this.parent.enableColumnVirtualization) {
      this.header.virtualEle.adjustTable(l, 0);
    }
    if (this.parent.enableColumnVirtualization) {
      var g = a.columnIndexes;
      h =
        this.getColumnOffset(a.columnIndexes[a.columnIndexes.length - 1]) -
        this.getColumnOffset(a.columnIndexes[0] - 1) +
        '';
      if (this.parent.isFrozenGrid()) {
        h = c.toString();
        if (this.parent.allowResizing) {
          this.parent.getHeaderTable().style.width = c + 'px';
          this.parent.getContentTable().style.width = c + 'Px';
        }
      }
      this.header.virtualEle.setWrapperWidth(h);
    }
    this.virtualEle.setWrapperWidth(h, z.isIE || z.info.name === 'edge');
    if (!(this.parent.enableColumnVirtualization && u(t) && u(i))) {
      if (!u(t) && !u(t.parentNode)) {
        N(t);
      }
      var y = this.parent.element.querySelector('.' + ct).querySelector(U);
      if (y) {
        N(y);
        t = null;
      }
      var v = this.parent.isReact && !u(this.parent.rowTemplate);
      v ? (t = i) : ((t = this.parent.createElement(U, { attrs: { role: 'rowgroup' } })), t.appendChild(i));
      if (
        this.parent.frozenRows &&
        r.requestType === 'virtualscroll' &&
        (this.parent.pageSettings.currentPage === 1 || this.isInfiniteColumnvirtualization())
      )
        for (var b = 0; b < this.parent.frozenRows; b++) t.children[0].remove();
      this.getTable().appendChild(t);
      this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;
      if (
        !this.parent.enableVirtualization &&
        this.parent.enableColumnVirtualization &&
        (a.direction === 'right' || a.direction === 'left')
      ) {
        this.content.scrollTop = this.currentInfo.offsets.top;
        this.content.scrollLeft = this.currentInfo.offsets.left;
      }
      if (this.parent.groupSettings.columns.length) {
        if (!X(this.parent) && a.direction === 'up') {
          var w = this.offsets[this.getTotalBlocks()] - this.prevHeight;
          var C = this.content.scrollTop;
          this.content.scrollTop = this.content.scrollTop + w;
        }
        this.setVirtualHeight();
        if (!this.parent.groupSettings.enableLazyLoading) {
          this.observer.setPageHeight(
            this.getOffset(a.blockIndexes[a.blockIndexes.length - 1]) - this.getOffset(a.blockIndexes[0] - 1),
          );
        }
      }
      if (
        !this.parent.groupSettings.enableLazyLoading &&
        this.parent.groupSettings.columns.length === 0 &&
        r.requestType === 'ungrouping'
      ) {
        this.observer.setPageHeight(this.getBlockHeight() * 2);
      }
      this.prevInfo = a;
      if (this.isFocused && this.activeKey !== 'downArrow' && this.activeKey !== 'upArrow') {
        this.content.focus();
      }
      var I = Math.ceil(this.getTotalBlocks() / 2);
      if (this.isBottom) {
        this.isBottom = false;
        this.isBottomNotify = false;
        this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 1];
      }
      if (
        (this.parent.pageSettings.currentPage + 1 === I || this.parent.pageSettings.currentPage === I) &&
        a.blockIndexes.length === 2 &&
        r.requestType === 'delete'
      ) {
        this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 1];
      }
      if (this.parent.pageSettings.currentPage === I && a.blockIndexes.length === 1) {
        this.isBottom = true;
        setTimeout(function () {
          var F = n.parent.getContent().firstElementChild;
          F.scrollTop = n.offsets[n.offsetKeys.length - 2];
          var D = {
            direction: 'up',
            sentinel: n.observer.sentinelInfo.up,
            offset: {
              top: F.scrollTop,
              left: F.scrollLeft,
            },
            focusElement: n.parent.element,
          };
          n.scrollListener(D);
        }, 0);
      }
      if (this.isTop) {
        this.parent.getContent().firstElementChild.scrollTop = 0;
        this.isTop = false;
      }
      if (r.requestType === 'virtualscroll' && r.virtualInfo.sentinelInfo.axis === 'X') {
        this.parent.notify(In, {});
      }
      this.focusCell(r);
      if (this.firstCellFocus) {
        this.firstCellFocus = false;
        var x = this.parent.focusModule;
        var O = this.parent.focusModule.active.matrix.current;
        var A =
          this.parent.getContentTable().rows[this.parent.focusModule.active.matrix.current[0]].cells[
            this.parent.focusModule.active.matrix.current[1]
          ];
        this.parent.focusModule.currentInfo.element = A;
        this.parent.focusModule.currentInfo.elementToFocus = A;
        A.classList.add('e-focus');
        A.classList.add('e-focused');
        A.tabIndex = 0;
        A.focus();
      }
      this.restoreEdit(r);
      this.restoreAdd();
      this.ensureSelectedRowPosition();
      this.validationScrollLeft();
      if (this.parent.isFrozenGrid() && this.parent.enableColumnVirtualization) {
        this.widthServices.refreshFrozenScrollbar();
      }
      if (!this.initialRowTop) {
        var k = this.parent.element.getBoundingClientRect().top;
        if (this.parent.getRowByIndex(0)) {
          this.initialRowTop =
            this.parent.getRowByIndex(0).getBoundingClientRect().top - this.parent.element.getBoundingClientRect().top;
        }
      }
    }
  };
  e.prototype.validationScrollLeft = function () {
    if (this.validationCheck)
      if (this.validationCol) {
        var t = this.vgenerator.cOffsets[this.validationCol.index - this.parent.getVisibleFrozenColumns() - 1];
        this.validationCol = null;
        this.content.scrollLeft =
          this.vgenerator.cOffsets[this.validationCol.index - this.parent.getVisibleFrozenColumns() - 1];
      } else {
        this.validationCheck = false;
        this.parent.editModule.editFormValidate();
      }
  };
  e.prototype.ensureSelectedRowPosition = function () {
    if (!this.isSelection && this.isSelectionScroll && !u(this.selectRowIndex)) {
      this.isSelectionScroll = false;
      var t = this.parent.getRowByIndex(this.selectRowIndex);
      if (t && !this.isRowInView(t)) {
        this.rowSelected(
          {
            rowIndex: this.selectRowIndex,
            row: t,
          },
          true,
        );
      }
    }
  };
  e.prototype.focusCell = function (t) {
    if (!(this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow')) {
      var i = this.parent.getRowByIndex(this.rowIndex);
      var r = i.cells[this.cellIndex];
      i.cells[this.cellIndex].focus({ preventScroll: true });
      if (!this.parent.selectionSettings.checkboxOnly) {
        this.parent.selectRow(parseInt(i.getAttribute(q), 10) - 1);
      }
      this.activeKey = this.empty;
    }
  };
  e.prototype.restoreEdit = function (t) {
    if (this.isNormaledit) {
      if (this.parent.editSettings.allowEditing && this.parent.editModule && !u(this.editedRowIndex)) {
        var i = this.getRowByIndex(this.editedRowIndex);
        var r = this.content;
        var n = Object.keys(this.virtualData);
        var a = t && t.virtualInfo && t.virtualInfo.sentinelInfo.axis === 'X';
        if (
          n.length &&
          i &&
          !this.content.querySelector('.' + Y) &&
          ['sorting', 'filtering', 'grouping', 'refresh', 'searching', 'ungrouping', 'reorder'].indexOf(
            t.requestType,
          ) === -1
        ) {
          var o = i.getBoundingClientRect().top - this.parent.element.getBoundingClientRect().top;
          if (a || (o < this.content.offsetHeight && o > this.parent.getRowHeight())) {
            this.parent.isEdit = false;
            this.parent.editModule.startEdit(i);
          }
        }
        if (i && this.content.querySelector('.' + Y) && !n.length) {
          var l =
            !this.parent.enableVirtualization && this.parent.enableColumnVirtualization
              ? this.enableCacheOnInfiniteColumnVirtual()
                ? this.virtualInfiniteData
                : E({}, this.parent.getCurrentViewRecords()[this.editedRowIndex])
              : E({}, this.getRowObjectByIndex(this.editedRowIndex));
          this.virtualData = this.getVirtualEditedData(l);
        }
      }
      this.restoreAdd();
    }
  };
  e.prototype.getVirtualEditedData = function (t) {
    var i = [].slice.call(this.parent.element.getElementsByClassName('e-gridform'));
    var r = this.parent.editModule && this.parent.editModule.formObj && this.parent.editModule.formObj.isDestroyed;
    if (!r)
      for (var n = 0; n < i.length; n++)
        t = this.parent.editModule.getCurrentEditedData(i[parseInt(n.toString(), 10)], t);
    return t;
  };
  e.prototype.restoreAdd = function () {
    var t = !this.parent.element.querySelector('.' + Fe);
    if (this.isNormaledit && this.isAdd && t) {
      var i = this.parent.editSettings.newRowPosition === 'Top' && this.content.scrollTop < this.parent.getRowHeight();
      var r =
        this.parent.editSettings.newRowPosition === 'Bottom' && this.parent.pageSettings.currentPage === this.maxPage;
      if (i || r) {
        this.parent.isEdit = false;
        this.parent.addRecord();
      }
    }
  };
  e.prototype.onDataReady = function (t) {
    if (!u(t.count)) {
      this.count = t.count;
      this.maxPage = Math.ceil(
        (this.parent.groupSettings.columns.length && this.parent.vcRows.length ? this.parent.vcRows.length : t.count) /
          this.parent.pageSettings.pageSize,
      );
    }
    this.vgenerator.checkAndResetCache(t.requestType);
    if (
      ['refresh', 'filtering', 'searching', 'grouping', 'ungrouping', 'reorder', void 0].some(function (i) {
        return t.requestType === i;
      })
    ) {
      this.refreshOffsets();
    }
    this.setVirtualHeight();
    this.resetScrollPosition(t.requestType);
  };
  e.prototype.setVirtualHeight = function (t) {
    var i = this.parent.enableColumnVirtualization
      ? this.getColumnOffset(this.parent.getVisibleColumns().length + this.parent.groupSettings.columns.length - 1) +
        'px'
      : '100%';
    var r = this.offsets[X(this.parent) && this.count !== 0 ? this.getGroupedTotalBlocks() : this.getTotalBlocks()];
    if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {
      r = 0;
    }
    var n = X(this.parent) && this.count !== 0 ? this.getGroupedTotalBlocks() : this.getTotalBlocks();
    var a = Math.ceil(n / 2);
    var o = Math.round(this.virtualEle.placeholder.getBoundingClientRect().bottom);
    var l = Math.round(this.virtualEle.wrapper.getBoundingClientRect().bottom);
    if (
      (this.currentInfo.page === a || this.currentInfo.page + 1 === a) &&
      this.currentInfo.direction === 'down' &&
      o > l &&
      !this.diff
    ) {
      this.diff = o - l;
    }
    this.diff &&
    this.currentInfo.page === a &&
    o > l &&
    !(this.isAdd && this.parent.editSettings.newRowPosition === 'Bottom')
      ? ((r -= this.diff), (this.heightChange = true))
      : this.requestType === 'virtualscroll' &&
        this.diff &&
        this.heightChange &&
        ((r -= this.diff), (this.heightChange = false));
    this.virtualEle.setVirtualHeight(r, i);
    if (this.virtualEle && this.virtualEle.wrapper) {
      !this.parent.enableVirtualization && this.parent.enableColumnVirtualization
        ? (this.virtualEle.wrapper.style.minHeight = '')
        : (this.virtualEle.wrapper.style.minHeight = u(r) ? '0px' : xe(this.parent.height));
    }
    if (this.parent.enableColumnVirtualization) {
      this.header.virtualEle.setVirtualHeight(1, i);
    }
  };
  e.prototype.getPageFromTop = function (t, i) {
    var r = this;
    var n = X(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();
    var a = 0;
    this.offsetKeys.some(function (o) {
      var l = Number(o);
      var h = t <= r.offsets['' + o] || (l === n && t > r.offsets['' + o]);
      if (h) {
        if (
          r.offsetKeys.length % 2 !== 0 &&
          l.toString() === r.offsetKeys[r.offsetKeys.length - 2] &&
          t <= r.offsets[r.offsetKeys.length - 1]
        ) {
          l = l + 1;
        }
        i.block = l % 2 === 0 ? 1 : 0;
        a = Math.max(1, Math.min(r.vgenerator.getPage(l), r.maxPage));
      }
      return h;
    });
    return a;
  };
  e.prototype.getTranslateY = function (t, i, r, n) {
    if (r === void 0) {
      r = { page: this.getPageFromTop(t, {}) };
      r.blockIndexes = this.vgenerator.getBlockIndexes(r.page);
    }
    var a = (r.blockIndexes[0] || 1) - 1;
    var o = this.getOffset(a);
    var l = this.getOffset(r.blockIndexes[r.blockIndexes.length - 1]);
    if (n) {
      r = this.prevInfo;
    }
    var h = o > t ? this.getOffset(a - 1) : l < t + i ? this.getOffset(a + 1) : o;
    var d = this.offsets[r.blockIndexes[r.blockIndexes.length - 1]] - this.tmpOffsets[r.blockIndexes[0]];
    var p = X(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();
    if (h + d > this.offsets[parseInt(p.toString(), 10)]) {
      h -= h + d - this.offsets[parseInt(p.toString(), 10)];
    }
    if (r.page === 1 && r.block === 0 && r.direction === 'up') {
      h = 0;
    }
    if (!this.parent.enableVirtualization && this.parent.enableColumnVirtualization) {
      h = 0;
    }
    return h;
  };
  e.prototype.getOffset = function (t) {
    return Math.min(this.offsets[parseInt(t.toString(), 10)] | 0, this.offsets[this.maxBlock] | 0);
  };
  e.prototype.onEntered = function () {
    var t = this;
    return function (i, r, n, a, o, l) {
      if (!((n === 'down' || n === 'up') && !t.parent.enableVirtualization && t.parent.enableColumnVirtualization)) {
        if (z.isIE && !o && l && !t.preventEvent && !t.parent.enableVirtualMaskRow) {
          t.parent.showSpinner();
        }
        t.prevInfo = t.prevInfo || t.vgenerator.getData();
        var h = t.getInfoFromView(n, r, a);
        if (
          !(
            t.parent.isFrozenGrid() &&
            r.axis === 'X' &&
            t.parent.getVisibleFrozenLeftCount() >= h.columnIndexes[0] &&
            t.prevInfo &&
            t.prevInfo.columnIndexes.toString().includes(h.columnIndexes.toString())
          )
        ) {
          if (t.parent.enableVirtualMaskRow && !t.preventEvent) {
            var d = parseInt(t.offsetKeys[0], 10);
            var p = parseInt(t.offsetKeys[t.offsetKeys.length - 1], 10);
            var c = t.currentInfo.blockIndexes;
            var f =
              (t.prevInfo && r.axis === 'X' && t.prevInfo.columnIndexes.toString() === h.columnIndexes.toString()) ||
              (n === 'down' &&
                t.parent.allowGrouping &&
                t.parent.groupSettings.columns.length &&
                ((t.parent.allowFiltering && t.parent.filterSettings.columns.length) ||
                  t.parent.searchSettings.key.length) &&
                t.offsetKeys.length <= 2);
            if (
              !(
                (t.currentInfo.blockIndexes && t.currentInfo.blockIndexes[0] === d && n === 'up') ||
                (t.currentInfo.blockIndexes &&
                  t.currentInfo.blockIndexes[t.currentInfo.blockIndexes.length - 1] === p &&
                  n === 'down') ||
                f
              )
            ) {
              setTimeout(function () {
                t.parent.showMaskRow(r.axis);
              }, 0);
            }
          }
          var g = r.axis === 'X';
          var m = t.prevInfo.offsets ? t.prevInfo.offsets.top : null;
          var y = t.content.getBoundingClientRect().height;
          var v = t.getColumnOffset(g ? t.vgenerator.getColumnIndexes()[0] - 1 : t.prevInfo.columnIndexes[0] - 1);
          if (
            t.parent.isFrozenGrid() &&
            t.parent.enableColumnVirtualization &&
            t.currentInfo &&
            t.currentInfo.columnIndexes
          ) {
            var b = t.currentInfo.columnIndexes[0] - 1;
            var w = 0;
            t.parent.getColumns().filter(function (O) {
              if (O.visible && O.freeze === 'Left') {
                w += parseInt(O.width.toString(), 10);
              }
            });
            if (b > t.parent.getVisibleFrozenLeftCount()) {
              v = v - w;
            }
          }
          if (g) {
            var C = Object.keys(t.vgenerator.cOffsets).length - t.prevInfo.columnIndexes.length;
            var I = t.vgenerator.cOffsets[C - 1];
            v = v > t.vgenerator.cOffsets[C - 1] ? t.vgenerator.cOffsets[C - 1] : v;
          }
          if (!t.parent.enableVirtualization && t.parent.enableColumnVirtualization) t.virtualEle.adjustTable(v, 0);
          else {
            var x = t.getTranslateY(
              a.top,
              t.content.getBoundingClientRect().height,
              g && m === a.top ? t.prevInfo : void 0,
              true,
            );
            t.virtualEle.adjustTable(v, Math.min(x, t.offsets[t.maxBlock]));
          }
          if (t.parent.enableColumnVirtualization) {
            t.header.virtualEle.adjustTable(v, 0);
            if (t.parent.isFrozenGrid()) {
              t.resetStickyLeftPos(v);
            }
          }
        }
      }
    };
  };
  e.prototype.dataBound = function () {
    this.parent.notify(Hs, {});
    this.isSelection && this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow'
      ? this.parent.selectRow(this.selectedRowIndex)
      : ((this.activeKey = this.empty), (this.requestType = this.empty));
  };
  e.prototype.resetStickyLeftPos = function (t, i) {
    var r = [].slice
      .call(this.parent.getHeaderContent().querySelectorAll('.e-leftfreeze,.e-rightfreeze,.e-fixedfreeze'))
      .concat(
        [].slice.call((i || this.parent.getContent()).querySelectorAll('.e-leftfreeze,.e-rightfreeze,.e-fixedfreeze')),
      );
    var n = 0;
    var a = 0;
    if (this.parent.getHeaderContent().querySelectorAll('.e-fixedfreeze').length) {
      n = this.parent.leftrightColumnWidth('left');
      a = this.parent.leftrightColumnWidth('right');
    }
    if (r.length)
      for (var o = 0; o < r.length; o++) {
        var l = r[parseInt(o.toString(), 10)];
        var h = void 0;
        if (r[parseInt(o.toString(), 10)].classList.contains('e-rowcell'))
          if (
            u(r[parseInt(o.toString(), 10)].getAttribute('aria-colindex')) &&
            r[parseInt(o.toString(), 10)].querySelector('[data-mappinguid]')
          ) {
            var d = r[parseInt(o.toString(), 10)].querySelector('[data-mappinguid]').getAttribute('data-mappinguid');
            h = this.parent.getColumnByUid(d);
          } else {
            var p = parseInt(r[parseInt(o.toString(), 10)].getAttribute('aria-colindex'), 10) - 1;
            h = this.parent.getColumnByIndex(parseInt(p.toString(), 10));
          }
        else if (
          r[parseInt(o.toString(), 10)].classList.contains('e-headercell') ||
          r[parseInt(o.toString(), 10)].classList.contains('e-filterbarcell')
        ) {
          var d = r[parseInt(o.toString(), 10)].classList.contains('e-filterbarcell')
            ? r[parseInt(o.toString(), 10)].getAttribute('data-mappinguid')
            : r[parseInt(o.toString(), 10)].querySelector('[data-mappinguid]').getAttribute('data-mappinguid');
          h = this.parent.getColumnByUid(d);
        }
        if (!u(h)) {
          h.freeze === 'Left'
            ? (r[parseInt(o.toString(), 10)].style.left = h.valueX - t + 'px')
            : h.freeze === 'Right'
              ? (r[parseInt(o.toString(), 10)].style.right = h.valueX + t + 'px')
              : h.freeze === 'Fixed' &&
                ((r[parseInt(o.toString(), 10)].style.left = n - t + 'px'),
                (r[parseInt(o.toString(), 10)].style.right = a + t + 'px'));
        }
      }
    this.parent.translateX = t;
  };
  e.prototype.rowSelected = function (t, i) {
    if ((this.isSelection || i) && !this.isLastBlockRow(t.rowIndex)) {
      var r = Vs(this.content.firstElementChild);
      var n = this.parent.element.getBoundingClientRect().top;
      var a = t.row.getBoundingClientRect().top - this.parent.element.getBoundingClientRect().top;
      var o = this.content.getBoundingClientRect().height;
      var l = this.content.getBoundingClientRect().height < a;
      var h = l ? a - this.content.getBoundingClientRect().height : this.initialRowTop - a;
      var d = l ? r.height - h : r.height + h;
      this.virtualEle.adjustTable(r.width, d);
      var p = this.virtualEle.wrapper.getBoundingClientRect();
      var c = this.content.getBoundingClientRect();
      if (p.top > c.top) {
        this.virtualEle.adjustTable(r.width, d - (p.top - c.top));
      }
      var f =
        this.content.querySelector('tbody').lastElementChild.getBoundingClientRect().top -
        this.parent.element.getBoundingClientRect().top;
      f < this.content.getBoundingClientRect().height
        ? ((d =
            d +
            (this.content.getBoundingClientRect().height -
              (t.row.getBoundingClientRect().top - this.parent.element.getBoundingClientRect().top))),
          this.virtualEle.adjustTable(r.width, d - this.parent.getRowHeight() / 2))
        : c.bottom > p.bottom && this.virtualEle.adjustTable(r.width, d + (c.bottom - p.bottom));
      if (this.parent.isFrozenGrid() && this.parent.enableColumnVirtualization) {
        this.resetStickyLeftPos(r.width);
      }
    }
    this.isSelection = false;
  };
  e.prototype.isLastBlockRow = function (t) {
    var i = this.parent.getContent().firstElementChild;
    var r = Math.floor(this.parent.getContent().firstElementChild.offsetHeight / this.parent.getRowHeight()) - 1;
    var n = this.maxPage * this.parent.pageSettings.pageSize - r;
    return t >= n;
  };
  e.prototype.refreshMaxPage = function () {
    if (this.parent.groupSettings.columns.length && this.parent.vcRows.length) {
      this.maxPage = Math.ceil(this.parent.vcRows.length / this.parent.pageSettings.pageSize);
    }
  };
  e.prototype.setVirtualPageQuery = function (t) {
    var i = [];
    if (this.prevInfo && this.prevInfo.blockIndexes) {
      i = Cn(this.prevInfo.blockIndexes);
    }
    if ((this.requestType === 'sorting' || this.requestType === 'delete') && i.length && Pt(this.parent)) {
      t.query.skip(this.parent.pageSettings.pageSize * (i[0] - 1));
      t.query.take(this.parent.pageSettings.pageSize * i.length);
      t.skipPage = true;
      return;
    }
    var r = this.parent.getContent().querySelector('.e-row');
    if (this.requestType === 'virtualscroll' && this.vgenerator.currentInfo.blockIndexes) {
      this.vgenerator.currentInfo = {};
    }
    if (
      r &&
      this.parent.isManualRefresh &&
      this.currentInfo.blockIndexes &&
      (this.currentInfo.blockIndexes.length === 3 || i.length > 1)
    ) {
      this.vgenerator.startIndex = parseInt(r.getAttribute('aria-rowindex'), 10) - 1;
      this.vgenerator.currentInfo = E({}, this.currentInfo);
      this.vgenerator.currentInfo.blockIndexes = this.currentInfo.blockIndexes.slice();
      var n = (this.vgenerator.includePrevPage = this.currentInfo.blockIndexes[0] % 2 === 0);
      n
        ? ((this.vgenerator.startIndex = this.vgenerator.startIndex - this.getBlockSize()),
          this.vgenerator.currentInfo.blockIndexes.unshift(this.currentInfo.blockIndexes[0] - 1))
        : this.vgenerator.currentInfo.blockIndexes.push(
            this.currentInfo.blockIndexes[this.currentInfo.blockIndexes.length - 1] + 1,
          );
      var a = (this.vgenerator.currentInfo.blockIndexes[0] - 1) * this.getBlockSize();
      var o = this.vgenerator.currentInfo.blockIndexes.length * this.getBlockSize();
      t.query.skip(a);
      t.query.take(o);
      t.skipPage = true;
    }
  };
  e.prototype.eventListener = function (t) {
    var i = this;
    this.parent['' + t](et, this.onDataReady, this);
    this.parent.addEventListener(Pe, this.dataBound.bind(this));
    this.parent.addEventListener(_, this.actionBegin.bind(this));
    this.parent.addEventListener(B, this.actionComplete.bind(this));
    this.parent.addEventListener(vi, this.rowSelected.bind(this));
    this.parent['' + t](dt, this.refreshContentRows, this);
    this.parent['' + t](_s, this.refreshVirtualLazyLoadCache, this);
    this.parent['' + t](js, this.selectVirtualRow, this);
    this.parent['' + t](Us, this.virtualCellFocus, this);
    this.parent['' + t](xn, this.editActionBegin, this);
    this.parent['' + t](En, this.addActionBegin, this);
    this.parent['' + t](Gs, this.restoreEdit, this);
    this.parent['' + t](bi, this.editSuccess, this);
    this.parent['' + t](Dn, this.refreshCache, this);
    this.parent['' + t](Ws, this.resetIsedit, this);
    this.parent['' + t](Ht, this.getVirtualData, this);
    this.parent['' + t](Rn, this.editCancel, this);
    this.parent['' + t](bn, this.refreshMaxPage, this);
    this.parent['' + t](Ks, this.setVirtualPageQuery, this);
    this.parent['' + t]($s, this.selectRowOnContextOpen, this);
    this.parent['' + t](Xs, this.resetVirtualFocus, this);
    this.parent['' + t](Fn, this.refreshCells, this);
    this.parent['' + t](Tn, this.scrollToEdit, this);
    for (var r = this.actions, n = 0; n < r.length; n++)
      this.parent['' + t](r[parseInt(n.toString(), 10)] + '-begin', this.onActionBegin, this);
    var a = function () {
      i.observer.observe(function (h) {
        return i.scrollListener(h);
      }, i.onEntered());
      var o = i.parent;
      if (i.parent.enablePersistence && i.parent.scrollPosition) {
        if (i.parent.scrollPosition.top > 0) {
          i.content.scrollTop = i.parent.scrollPosition.top;
          var l = {
            direction: 'down',
            sentinel: i.observer.sentinelInfo.down,
            offset: i.parent.scrollPosition,
            focusElement: i.parent.element,
          };
          i.scrollListener(l);
        }
        if (i.parent.enableColumnVirtualization) {
          i.content.scrollLeft = i.parent.scrollPosition.left;
        }
      }
      i.parent.off(Te, a);
    };
    this.parent.on(Te, a, this);
  };
  e.prototype.refreshVirtualLazyLoadCache = function (t) {
    var i = this.currentInfo.blockIndexes;
    if (u(this.currentInfo.blockIndexes)) {
      i = [1, 2];
    }
    for (var r, n, a, o = 0; o < i.length; o++)
      for (var l = this.vgenerator.cache[i[parseInt(o.toString(), 10)]], h = 0; h < l.length; h++)
        if (l[parseInt(h.toString(), 10)].uid === t.uid) {
          r = i[parseInt(o.toString(), 10)];
          n = h;
          a = l;
          break;
        }
    t.count
      ? this.vgenerator.cache[parseInt(r.toString(), 10)].splice(n + 1, t.count)
      : t.rows &&
        t.rows.length &&
        (this.vgenerator.cache[parseInt(r.toString(), 10)] = [].slice
          .call(a.slice(0, n + 1))
          .concat([].slice.call(t.rows))
          .concat([].slice.call(a.slice(n + 1, a.length))));
    this.refreshOffsets();
  };
  e.prototype.scrollToEdit = function (t) {
    var i = true;
    this.validationCheck = true;
    if (this.isAdd && this.content.scrollTop > 0) {
      i = false;
      var r = Object.keys(this.offsets);
      this.content.scrollTop = this.parent.editSettings.newRowPosition === 'Top' ? 0 : this.offsets[r.length - 1];
    }
    var n = this.parent.getRowByIndex(this.editedRowIndex);
    if (!n && !u(this.editedRowIndex) && (!n || !this.isRowInView(n))) {
      var a = this.parent.getRowHeight();
      var o = this.editedRowIndex * a;
      if (!u(o)) {
        i = false;
        this.content.scrollTop = o;
      }
    }
    if (t && i) {
      var l = this.vgenerator.cOffsets[t.index - this.parent.getVisibleFrozenColumns() - 1];
      if (!this.parent.enableColumnVirtualization) {
        var h = this.parent.getHeaderContent().querySelector('.e-headercelldiv[data-mappinguid="' + t.uid + '"]');
        l = h.parentElement.offsetLeft;
      }
      if (this.parent.enableColumnVirtualization && this.parent.getVisibleFrozenLeftCount()) {
        l -= this.parent.leftrightColumnWidth('left');
      }
      this.content.scrollLeft = this.parent.enableRtl ? -Math.abs(l) : l;
    }
    if (t && !i) {
      this.validationCol = t;
    }
  };
  e.prototype.refreshCells = function (t) {
    t.cells = this.vgenerator.generateCells(t.foreignKeyData);
  };
  e.prototype.resetVirtualFocus = function (t) {
    this.isCancel = t.isCancel;
  };
  e.prototype.getVirtualData = function (t) {
    if (this.isNormaledit) {
      var i = this.parent.element.querySelector('.e-griderror:not([style*="display: none"])');
      var r = Object.keys(this.virtualData);
      t.isScroll = r.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';
      if (i) return;
      this.virtualData = r.length ? this.virtualData : t.virtualData;
      this.getVirtualEditedData(this.virtualData);
      t.virtualData = this.virtualData;
      t.isAdd = this.isAdd || this.parent.editSettings.showAddNewRow;
      t.isCancel = this.isCancel;
    }
  };
  e.prototype.selectRowOnContextOpen = function (t) {
    this.isContextMenuOpen = t.isOpen;
  };
  e.prototype.editCancel = function (t) {
    var i = mr(this.parent, t.data);
    if (!u(i)) {
      t.data = this.parent.getCurrentViewRecords()[parseInt(i.toString(), 10)];
    }
  };
  e.prototype.editSuccess = function (t) {
    if (this.isNormaledit) {
      if (!this.isAdd && t.data) {
        this.updateCurrentViewData(t.data);
      }
      this.isAdd = false;
    }
  };
  e.prototype.updateCurrentViewData = function (t) {
    var i = mr(this.parent, t);
    if (!u(i)) {
      this.parent.getCurrentViewRecords()[parseInt(i.toString(), 10)] = t;
    }
  };
  e.prototype.actionBegin = function (t) {
    if (t.requestType !== 'virtualscroll') {
      this.requestType = t.requestType;
    }
    if (!t.cancel) {
      this.parent.notify(Js, t);
    }
  };
  e.prototype.virtualCellFocus = function (t) {
    var i = document.activeElement;
    if (!i.classList.contains(ie) && (i instanceof HTMLInputElement || !u(i.closest('.e-templatecell')))) {
      i = i.closest('.e-rowcell');
    }
    if (
      this.parent.allowGrouping &&
      this.parent.groupSettings.columns.length &&
      i &&
      (i.classList.contains(ie) || !u(S(i, Zs))) &&
      t &&
      (t.action === 'shiftEnter' || t.action === 'upArrow' || t.action === 'downArrow')
    ) {
      var r = this.parent.getContent().firstElementChild;
      var n = r.getBoundingClientRect();
      var a = T(i, 'tr');
      var o = t.action === 'downArrow' ? a.nextElementSibling : a.previousElementSibling;
      var l = u(o) ? void 0 : o.getBoundingClientRect();
      if (
        u(o) ||
        (t.action === 'downArrow' && l.bottom > n.bottom) ||
        ((t.action === 'upArrow' || t.action === 'shiftEnter') && l.top < n.top)
      ) {
        this.activeKey = t.action;
        this.parent.focusModule.virtualSelectionInfo = {
          isPending: u(o),
          direction: t.action,
          event: t,
        };
        var h = u(o) ? this.parent.getRowHeight() : t.action === 'downArrow' ? l.bottom - n.bottom : n.top - l.top;
        r.scrollTop = t.action === 'downArrow' ? r.scrollTop + h : r.scrollTop - h;
      } else this.activeKey = this.empty;
      return;
    }
    if (
      i &&
      i.classList.contains(ie) &&
      t &&
      (t.action === 'upArrow' || t.action === 'downArrow' || t.action === 'shiftEnter')
    ) {
      var d = parseInt(i.parentElement.getAttribute(q), 10) - 1;
      if (t && (t.action === 'upArrow' || t.action === 'shiftEnter' || t.action === 'downArrow')) {
        var r = this.parent.getContent().firstElementChild;
        t.action === 'downArrow' ? (d += 1) : (d -= 1);
        this.rowIndex = d;
        this.cellIndex = parseInt(i.getAttribute(kt), 10) - 1;
        var a = this.parent.getRowByIndex(d);
        var p = this.parent.pageSettings.currentPage;
        var c = Math.floor(r.offsetHeight / this.parent.getRowHeight()) - 1;
        var f = false;
        if (u(a)) {
          f = true;
          if (
            (t.action === 'downArrow' && this.parent.pageSettings.currentPage === this.maxPage - 1) ||
            ((t.action === 'upArrow' || t.action === 'shiftEnter') && this.parent.pageSettings.currentPage === 1)
          ) {
            f = false;
          }
        }
        f ||
        (Ys(a, this.parent) && t.action === 'downArrow') ||
        (Qs(a, this.parent.getRowHeight() * 2) && (t.action === 'upArrow' || t.action === 'shiftEnter'))
          ? ((this.activeKey = t.action),
            (r.scrollTop =
              t.action === 'downArrow' ? (d - c) * this.parent.getRowHeight() : d * this.parent.getRowHeight()))
          : (this.activeKey = this.empty);
        if (!this.parent.selectionSettings.checkboxOnly) {
          this.parent.selectRow(d);
        }
      }
    }
  };
  e.prototype.editActionBegin = function (t) {
    this.editedRowIndex = t.index;
    var i =
      !this.parent.enableVirtualization && this.parent.enableColumnVirtualization
        ? E({}, this.parent.getCurrentViewRecords()[t.index])
        : E({}, this.getRowObjectByIndex(t.index));
    var r = Object.keys(this.virtualData);
    t.data =
      r.length && !this.parent.editSettings.showAddNewRow
        ? this.virtualData
        : this.isInfiniteColumnvirtualization()
          ? t.data
          : i;
    if (this.enableCacheOnInfiniteColumnVirtual()) {
      this.virtualInfiniteData = t.data;
    }
    t.isScroll = r.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';
  };
  e.prototype.getEditedRowObject = function () {
    for (var t = this.parent.vcRows, i, r = 0; r < t.length; r++)
      if (t[parseInt(r.toString(), 10)].index === this.editedRowIndex) {
        i = t[parseInt(r.toString(), 10)];
      }
    return i;
  };
  e.prototype.refreshCache = function (t) {
    if (!this.isInfiniteColumnvirtualization()) {
      var i = Math.ceil((this.editedRowIndex + 1) / this.getBlockSize());
      if (this.parent.allowPaging && this.parent.enableColumnVirtualization) {
        i = Math.ceil(
          (this.editedRowIndex + 1 + (this.parent.pageSettings.currentPage - 1) * this.parent.pageSettings.pageSize) /
            this.getBlockSize(),
        );
      }
      var r =
        this.parent.allowPaging && this.parent.enableColumnVirtualization
          ? this.editedRowIndex % this.getBlockSize()
          : this.editedRowIndex - (i - 1) * this.getBlockSize();
      if (this.parent.groupSettings.columns.length) {
        var n = this.getEditedRowObject();
        if (n) {
          n.data = t.data;
        }
      } else this.vgenerator.cache[parseInt(i.toString(), 10)][parseInt(r.toString(), 10)].data = t.data;
    }
  };
  e.prototype.actionComplete = function (t) {
    if (this.parent.enableVirtualization || this.parent.enableColumnVirtualization) {
      var i = ['delete', 'save', 'cancel'];
      var r = ['sorting', 'filtering', 'grouping', 'refresh', 'searching', 'ungrouping', 'reorder'];
      if (
        i.some(function (n) {
          return n === t.requestType;
        })
      ) {
        this.refreshOffsets();
        this.refreshVirtualElement();
      }
      if (
        this.isNormaledit &&
        (r.some(function (n) {
          return n === t.requestType;
        }) ||
          i.some(function (n) {
            return n === t.requestType;
          }))
      ) {
        this.isCancel = true;
        if (this.isAdd && this.parent.editSettings && this.parent.editSettings.newRowPosition === 'Bottom') {
          this.virtualEle.placeholder.style.height =
            parseInt(this.virtualEle.placeholder.style.height.toString(), 10) - this.diff + 'px';
        }
        this.isAdd = this.parent.editSettings.showAddNewRow;
        this.editedRowIndex = this.empty;
        this.virtualData = {};
        this.virtualInfiniteData = {};
        if (this.parent.editModule) {
          this.parent.editModule.editModule.previousData = void 0;
        }
      }
      if (
        this.parent.enableColumnVirtualization &&
        t.requestType === 'filterAfterOpen' &&
        this.currentInfo.columnIndexes &&
        this.currentInfo.columnIndexes[0] > 0
      ) {
        this.parent.resetFilterDlgPosition(t.columnName);
      }
    }
  };
  e.prototype.resetIsedit = function () {
    if (
      this.parent.enableVirtualization &&
      this.isNormaledit &&
      ((this.parent.editSettings.allowEditing && Object.keys(this.virtualData).length) ||
        (this.parent.editSettings.allowAdding && this.isAdd))
    ) {
      this.parent.isEdit = true;
    }
  };
  e.prototype.scrollAfterEdit = function () {
    if (
      this.parent.editModule &&
      this.parent.editSettings.allowEditing &&
      this.isNormaledit &&
      this.parent.element.querySelector('.e-gridform')
    ) {
      var t = this.parent.element.querySelector('.' + Y);
      var i = this.parent.element.querySelector('.' + Fe);
      if (t || i) {
        var r = t ? E({}, this.getRowObjectByIndex(this.editedRowIndex)) : E({}, this.emptyRowData);
        var n = Object.keys(this.virtualData);
        this.virtualData = n.length ? this.getVirtualEditedData(this.virtualData) : this.getVirtualEditedData(r);
      }
    }
  };
  e.prototype.createEmptyRowdata = function () {
    var t = this;
    this.parent.columnModel.filter(function (i) {
      t.emptyRowData[i.field] = t.empty;
    });
  };
  e.prototype.addActionBegin = function (t) {
    if (this.isNormaledit) {
      if (!Object.keys(this.emptyRowData).length) {
        this.createEmptyRowdata();
      }
      this.isAdd = true;
      var i = this.parent.pageSettings.currentPage;
      if (!this.parent.frozenRows && this.content.scrollTop > 0 && this.parent.editSettings.newRowPosition === 'Top') {
        this.isAdd = true;
        this.onActionBegin();
        t.startEdit = false;
        this.content.scrollTop = 0;
      }
      if (
        this.parent.pageSettings.currentPage < this.maxPage - 1 &&
        this.parent.editSettings.newRowPosition === 'Bottom'
      ) {
        this.isAdd = true;
        this.parent.setProperties({ pageSettings: { currentPage: this.maxPage - 1 } }, true);
        t.startEdit = false;
        this.content.scrollTop = this.offsets[this.offsetKeys.length];
      }
    }
  };
  e.prototype.getRowObjectByIndex = function (t) {
    var i = this.getRowCollection(t, true);
    return i;
  };
  e.prototype.getBlockSize = function () {
    return this.parent.pageSettings.pageSize >> 1;
  };
  e.prototype.getBlockHeight = function () {
    return this.getBlockSize() * this.parent.getRowHeight();
  };
  e.prototype.isEndBlock = function (t) {
    var i = X(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();
    return t >= i || t === i - 1;
  };
  e.prototype.isOddPageSize = function () {
    return this.parent.pageSettings.pageSize % 2 !== 0;
  };
  e.prototype.getOddBlockSize = function () {
    return this.isOddPageSize() ? this.parent.pageSettings.pageSize / 2 : this.getBlockSize();
  };
  e.prototype.getGroupedTotalBlocks = function () {
    var t = this.parent.vcRows;
    return Math.floor(
      this.parent.vcRows.length / this.getOddBlockSize() < 1 ? 1 : this.parent.vcRows.length / this.getOddBlockSize(),
    );
  };
  e.prototype.getTotalBlocks = function () {
    return Math.ceil(this.count / this.getOddBlockSize());
  };
  e.prototype.getColumnOffset = function (t) {
    return this.vgenerator.cOffsets[parseInt(t.toString(), 10)] | 0;
  };
  e.prototype.getModelGenerator = function () {
    return new Nn(this.parent);
  };
  e.prototype.resetScrollPosition = function (t) {
    if (
      this.actions.some(function (i) {
        return i === t;
      })
    ) {
      this.preventEvent = this.content.scrollTop !== 0;
      this.content.scrollTop = 0;
    }
    if (t !== 'virtualscroll') {
      this.isAdd = false;
    }
  };
  e.prototype.onActionBegin = function (t) {
    this.parent.setProperties({ pageSettings: { currentPage: 1 } }, true);
  };
  e.prototype.getRows = function () {
    return this.isInfiniteColumnvirtualization() ? this.getInfiniteRows() : this.vgenerator.getRows();
  };
  e.prototype.getRowByIndex = function (t) {
    var i;
    if (X(this.parent))
      if (!u(t) && this.parent.enableVirtualization && this.parent.groupSettings.columns.length)
        for (var r = 0; r < this.parent.getDataRows().length; r++)
          if (parseInt(this.parent.getDataRows()[parseInt(r.toString(), 10)].getAttribute(q), 10) - 1 === t) {
            i = this.parent.getDataRows()[parseInt(r.toString(), 10)];
          } else i = u(t) ? void 0 : this.parent.getDataRows()[parseInt(t.toString(), 10)];
      else
        !this.parent.enableVirtualization && this.parent.enableColumnVirtualization
          ? (i = u(t)
              ? void 0
              : this.enableCacheOnInfiniteColumnVirtual()
                ? this.parent.getDataRows().find(function (n) {
                    return parseInt(n.getAttribute(q), 10) - 1 === t;
                  })
                : this.parent.getDataRows()[parseInt(t.toString(), 10)])
          : this.prevInfo && (i = this.getRowCollection(t, false));
    return i;
  };
  e.prototype.getMovableVirtualRowByIndex = function (t) {
    return this.getRowCollection(t, false);
  };
  e.prototype.getFrozenRightVirtualRowByIndex = function (t) {
    return this.getRowCollection(t, false);
  };
  e.prototype.getRowCollection = function (t, i) {
    var r = this.prevInfo.blockIndexes;
    var n = (this.prevInfo.blockIndexes[0] - 1) * this.getBlockSize();
    if (this.parent.pageSettings.pageSize % 2 !== 0) {
      n += Math.floor(n / this.getBlockSize() / 2);
    }
    var a = this.parent.getDataRows();
    var o = i ? this.parent.getCurrentViewRecords() : a;
    if (i && this.parent.allowGrouping && this.parent.groupSettings.columns.length) {
      n = parseInt(this.parent.getRows()[0].getAttribute(q), 10) - 1;
      o = o.filter(function (p) {
        return u(p.items);
      });
    }
    if (!i && this.parent.allowGrouping && this.parent.groupSettings.columns.length && a.length) {
      n = parseInt(a[0].getAttribute(q), 10) - 1;
    }
    var l = o[t - n];
    if (
      i &&
      !this.parent.groupSettings.enableLazyLoading &&
      this.parent.groupSettings.columns.length &&
      this.parent.aggregates
    ) {
      var h = a[t - n];
      var d = this.parent.getRowObjectFromUID(a[t - n].getAttribute('data-uid'));
      if (d) {
        l = d.data;
      }
    }
    if (this.parent.frozenRows && this.parent.pageSettings.currentPage > 1) {
      i
        ? (l = t <= this.parent.frozenRows ? this.parent.getRowsObject()[parseInt(t.toString(), 10)].data : l)
        : (l = t <= this.parent.frozenRows ? a[parseInt(t.toString(), 10)] : a[t - n + this.parent.frozenRows]);
    }
    return l;
  };
  e.prototype.getVirtualRowIndex = function (t) {
    if (u(this.prevInfo)) return t;
    var i = this.prevInfo.blockIndexes;
    var r = (this.prevInfo.blockIndexes[0] - 1) * this.getBlockSize();
    if (this.parent.enableVirtualization && this.parent.allowGrouping && this.parent.groupSettings.columns.length) {
      for (var n = this.vgenerator.cache[this.prevInfo.blockIndexes[0]], a = 0; a < n.length; a++)
        if (n['' + a].isDataRow) {
          r = n['' + a].index;
          break;
        }
    }
    return r + t;
  };
  e.prototype.refreshOffsets = function () {
    var t = this.parent;
    var i = 0;
    var r = this.getBlockSize();
    var n = this.getOddBlockSize();
    var a = X(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();
    this.prevHeight = this.offsets[parseInt(a.toString(), 10)];
    this.maxBlock = a % 2 === 0 ? a - 2 : a - 1;
    this.offsets = {};
    for (
      var o = Array.apply(null, Array(a)).map(function () {
          return ++i;
        }),
        l = 0;
      l < o.length;
      l++
    ) {
      var h = (this.vgenerator.cache[o[parseInt(l.toString(), 10)]] || []).length;
      var d = X(this.parent)
        ? this.isOddPageSize()
          ? Math.ceil(this.parent.vcRows.length % n)
          : this.parent.vcRows.length % r
        : this.isOddPageSize()
          ? Math.ceil(this.count % n)
          : this.count % r;
      var p =
        !X(this.parent) && o[parseInt(l.toString(), 10)] in this.vgenerator.cache
          ? (this.vgenerator.cache[o[parseInt(l.toString(), 10)]] || []).length * this.parent.getRowHeight()
          : d && o[parseInt(l.toString(), 10)] === a
            ? d * this.parent.getRowHeight()
            : this.getBlockHeight();
      if (
        this.isOddPageSize() &&
        !(o[parseInt(l.toString(), 10)] in this.vgenerator.cache) &&
        !(d && o[parseInt(l.toString(), 10)] === a)
      ) {
        p = (o[parseInt(l.toString(), 10)] % 2 !== 0 ? Math.floor(n) : Math.ceil(n)) * this.parent.getRowHeight();
      }
      this.offsets[o[parseInt(l.toString(), 10)]] = (this.offsets[o[parseInt(l.toString(), 10)] - 1] | 0) + p;
      this.tmpOffsets[o[parseInt(l.toString(), 10)]] = this.offsets[o[parseInt(l.toString(), 10)] - 1] | 0;
    }
    this.offsetKeys = Object.keys(this.offsets);
    if (X(this.parent)) {
      this.parent.vGroupOffsets = this.offsets;
    }
    if (this.parent.enableColumnVirtualization) {
      this.vgenerator.refreshColOffsets();
    }
  };
  e.prototype.refreshVirtualElement = function () {
    this.vgenerator.refreshColOffsets();
    this.setVirtualHeight();
  };
  e.prototype.setVisible = function (t) {
    var i = this.parent;
    var r = [];
    r = this.getRows();
    var n;
    r.some(function (m) {
      if (m.isDataRow) {
        n = m;
      }
      return m.isDataRow;
    });
    var a = true;
    if (!this.parent.groupSettings.columns.length && n) {
      a = false;
    }
    for (var o = this.parent.getDataRows(), l = 0, h = t.length; l < h; l++) {
      var d = t[parseInt(l.toString(), 10)];
      var p = this.parent.getNormalizedColumnIndex(t[parseInt(l.toString(), 10)].uid);
      var c = t[parseInt(l.toString(), 10)].visible === true ? '' : 'none';
      var f = this.getColGroup().children;
      if (p !== -1 && n && p < n.cells.length) {
        wi(this.getColGroup().children[parseInt(p.toString(), 10)], { display: c });
      }
      if (!a) {
        var g = void 0;
        if (t[parseInt(l.toString(), 10)].width) {
          t[parseInt(l.toString(), 10)].visible
            ? (g = this.virtualEle.wrapper.offsetWidth + parseInt(t[parseInt(l.toString(), 10)].width.toString(), 10))
            : (g = this.virtualEle.wrapper.offsetWidth - parseInt(t[parseInt(l.toString(), 10)].width.toString(), 10));
        }
        g > this.parent.width
          ? (this.setDisplayNone(o, p, c, r),
            this.parent.enableColumnVirtualization && this.virtualEle.setWrapperWidth(g + ''),
            this.refreshVirtualElement())
          : (a = true);
      }
      if (!this.parent.invokedFromMedia && t[parseInt(l.toString(), 10)].hideAtMedia) {
        this.parent.updateMediaColumns(t[parseInt(l.toString(), 10)]);
      }
      this.parent.invokedFromMedia = false;
    }
    a &&
    !(
      this.parent.enableVirtualization &&
      this.parent.groupSettings &&
      this.parent.groupSettings.columns.length &&
      this.parent.groupSettings.enableLazyLoading
    )
      ? this.refreshContentRows({ requestType: 'refresh' })
      : this.parent.notify(ea, {
          rows: r,
          args: {
            isFrozen: false,
            rows: r,
          },
        });
  };
  e.prototype.selectVirtualRow = function (t) {
    var i = this;
    var r = X(this.parent) ? this.vgenerator.recordsCount : this.count;
    t.isAvailable = t.selectedIndex < r;
    if (
      t.isAvailable &&
      !this.isContextMenuOpen &&
      this.activeKey !== 'upArrow' &&
      this.activeKey !== 'downArrow' &&
      !this.isSelection &&
      !this.requestTypes.some(function (c) {
        return c === i.requestType;
      }) &&
      !this.parent.selectionModule.isInteracted
    ) {
      var n = this.parent.getRowByIndex(t.selectedIndex);
      var a = this.parent.getRowHeight();
      if (!n || !this.isRowInView(n)) {
        this.isSelection = true;
        this.selectedRowIndex = t.selectedIndex;
        var o = t.selectedIndex * a;
        if (X(this.parent)) {
          var l = this.parent.vcRows.findIndex(function (c) {
            return c.index === t.selectedIndex;
          });
          o = l !== -1 ? l * a : void 0;
          this.isSelection = l !== -1 ? this.isSelection : false;
        } else if (this.parent.groupSettings.columns.length && this.parent.getDataModule().isRemote()) {
          var h = Math.ceil((t.selectedIndex + 1) / this.parent.pageSettings.pageSize);
          var d = this.vgenerator.getBlockIndexes(h);
          o = this.offsets[d[0]];
        }
        if (!u(o)) {
          var p = this.content.scrollTop < o ? 'down' : 'up';
          this.selectRowIndex = t.selectedIndex;
          this.content.scrollTop = o;
          this.isSelectionScroll = this.observer.check(p);
        }
      }
    }
    this.requestType = this.empty;
  };
  e.prototype.isRowInView = function (t) {
    var i = t.getBoundingClientRect().top;
    var r = t.getBoundingClientRect().bottom;
    return (
      t.getBoundingClientRect().top >= this.content.getBoundingClientRect().top &&
      t.getBoundingClientRect().bottom <= this.content.getBoundingClientRect().bottom
    );
  };
  return e;
})(vn);
var _o = (function (s) {
  Pn(e, s);
  function e(t, i) {
    var r = s(t, i) || this;
    r.virtualEle = new Hn();
    r.isMovable = false;
    r.gen = new Nn(r.parent);
    r.parent.on(St, r.setVisible, r);
    r.parent.on(
      dt,
      function (n) {
        return n.virtualInfo.sentinelInfo.axis === 'X' ? r.refreshUI() : null;
      },
      r,
    );
    return r;
  }
  e.prototype.renderTable = function () {
    this.gen.refreshColOffsets();
    this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + je)));
    s.prototype.renderTable();
    this.virtualEle.table = this.getTable();
    this.virtualEle.content = this.getPanel().querySelector('.' + je);
    this.virtualEle.content.style.position = 'relative';
    this.virtualEle.renderWrapper();
    !(this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) && this.parent.enableColumnVirtualization
      ? this.virtualEle.renderPlaceHolder()
      : this.virtualEle.renderPlaceHolder('absolute');
  };
  e.prototype.appendContent = function (t) {
    this.virtualEle.wrapper.appendChild(t);
  };
  e.prototype.refreshUI = function () {
    this.gen.refreshColOffsets();
    this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + je)));
    s.prototype.refreshUI();
  };
  e.prototype.setVisible = function (t) {
    for (var i = this.parent, r, n, a, o = 0, l = t.length; o < l; o++) {
      var h = t[parseInt(o.toString(), 10)];
      n = i.getNormalizedColumnIndex(t[parseInt(o.toString(), 10)].uid);
      r = t[parseInt(o.toString(), 10)].visible ? '' : 'none';
      var d = this.getColGroup().children;
      if (i.getColumnByField(t[parseInt(o.toString(), 10)].field)) {
        wi(this.getColGroup().children[parseInt(n.toString(), 10)], { display: r });
      }
      if (i.enableColumnVirtualization && !i.groupSettings.columns.length) {
        var p = void 0;
        t[parseInt(o.toString(), 10)].visible
          ? (p = this.virtualEle.wrapper.offsetWidth + parseInt(t[parseInt(o.toString(), 10)].width.toString(), 10))
          : (p = this.virtualEle.wrapper.offsetWidth - parseInt(t[parseInt(o.toString(), 10)].width.toString(), 10));
        p > i.width
          ? (this.setDisplayNone(t[parseInt(o.toString(), 10)], r),
            this.virtualEle.setWrapperWidth(p + ''),
            this.gen.refreshColOffsets())
          : (a = true);
      } else a = true;
      if (a) {
        this.refreshUI();
      }
    }
  };
  e.prototype.setDisplayNone = function (t, i) {
    for (var r = this.getTable(), n = 0, a = [].slice.apply(r.querySelectorAll('th.e-headercell')); n < a.length; n++) {
      var o = a[n];
      if (
        a[n].querySelector('[data-mappinguid]') &&
        a[n].querySelector('[data-mappinguid]').getAttribute('data-mappinguid') === t.uid
      ) {
        wi(a[n], { display: i });
        if (i === '') {
          Q([a[n]], 'e-hide');
        }
        break;
      }
    }
  };
  return e;
})(Ps);
var Hn = (function () {
  function s() {}
  s.prototype.renderWrapper = function (e) {
    this.wrapper = ve('div', { className: 'e-virtualtable' });
    this.wrapper.style.minHeight = xe(e);
    this.wrapper.appendChild(this.table);
    this.content.appendChild(this.wrapper);
  };
  s.prototype.renderPlaceHolder = function (e) {
    if (e === void 0) {
      e = 'relative';
    }
    this.placeholder = ve('div', { className: 'e-virtualtrack' });
    this.placeholder.style.position = e;
    this.content.appendChild(this.placeholder);
  };
  s.prototype.renderFrozenWrapper = function (e) {
    this.wrapper = ve('div', { className: 'e-virtualtable' });
    this.wrapper.style.cssText = 'min-height:' + xe(e) + '; display: flex;';
    this.content.appendChild(this.wrapper);
  };
  s.prototype.renderFrozenPlaceHolder = function () {
    this.placeholder = ve('div', { className: 'e-virtualtrack' });
    this.content.appendChild(this.placeholder);
  };
  s.prototype.adjustTable = function (e, t) {
    this.wrapper.style.transform = 'translate(' + e + 'px, ' + t + 'px)';
  };
  s.prototype.setWrapperWidth = function (e, t) {
    if (e && e.indexOf('%') === -1 && !(this.content.getBoundingClientRect().width < parseInt(e, 10))) {
      e = void 0;
      t = true;
    }
    this.wrapper.style.width = e ? e + 'px' : t ? '100%' : '';
  };
  s.prototype.setVirtualHeight = function (e, t) {
    this.placeholder.style.height = u(e) ? '0px' : e + 'px';
    if (t && t.indexOf('%') === -1 && !(this.content.getBoundingClientRect().width < parseInt(t, 10))) {
      t = '100%';
    }
    this.placeholder.style.width = t;
  };
  s.prototype.setFreezeWrapperWidth = function (e, t, i) {
    e.style.width = t ? t + 'px' : i ? '100%' : '';
  };
  return s;
})();
var jo = (function () {
  function s(e, t) {
    this.parent = e;
    this.locator = t;
    this.addEventListener();
  }
  s.prototype.getModuleName = function () {
    return 'virtualscroll';
  };
  s.prototype.instantiateRenderer = function () {
    this.parent.log(['limitation', 'virtual_height'], 'virtualization');
    var e = this.locator.getService('rendererFactory');
    if (this.parent.enableColumnVirtualization) {
      e.addRenderer(Bt.Header, new _o(this.parent, this.locator));
    }
    e.addRenderer(Bt.Content, new Vo(this.parent, this.locator));
    if (!(!this.parent.enableVirtualization && this.parent.enableColumnVirtualization)) {
      this.ensurePageSize();
    }
  };
  s.prototype.ensurePageSize = function () {
    var e = this.parent.getRowHeight();
    var t =
      this.parent.height.toString().indexOf('%') < 0
        ? this.parent.height
        : this.parent.element.getBoundingClientRect().height;
    this.blockSize = ~~(parseFloat(t.toString()) / e);
    var i = this.blockSize * 2;
    var r = this.parent.pageSettings.pageSize;
    this.parent.setProperties(
      { pageSettings: { pageSize: this.parent.pageSettings.pageSize < i ? i : this.parent.pageSettings.pageSize } },
      true,
    );
  };
  s.prototype.addEventListener = function () {
    if (!this.parent.isDestroyed) {
      this.parent.on(di, this.instantiateRenderer, this);
      this.parent.on(yi, this.refreshVirtualElement, this);
      this.parent.on(Vt, this.createVirtualValidationForm, this);
      this.parent.on(Ci, this.virtualEditFormValidation, this);
      this.parent.on(M, this.destroy, this);
    }
  };
  s.prototype.removeEventListener = function () {
    if (!this.parent.isDestroyed) {
      this.parent.off(di, this.instantiateRenderer);
      this.parent.off(yi, this.refreshVirtualElement);
      this.parent.off(Vt, this.createVirtualValidationForm);
      this.parent.off(Ci, this.virtualEditFormValidation);
      this.parent.off(M, this.destroy);
    }
  };
  s.prototype.getCurrentEditedData = function (e) {
    var t = {
      virtualData: E({}, {}, e, true),
      isAdd: false,
      isScroll: false,
      endEdit: true,
    };
    this.parent.notify(Ht, t);
    return t.virtualData;
  };
  s.prototype.createVirtualValidationForm = function (e) {
    var t = this.parent;
    if (this.parent.enableVirtualization && this.parent.editSettings.mode === 'Normal') {
      var i = this.parent.columns;
      var r = new nt(this.locator, null, this.parent);
      var n = E({}, {}, this.parent.getRowObjectFromUID(e.uid), true);
      this.parent.notify(Fn, n);
      var a = e.argsCreator(this.getCurrentEditedData(e.prevData), {}, false);
      a.isCustomFormValidation = true;
      a.row = r.render(n, this.parent.columns);
      e.renderer.update(a);
      for (var o = {}, l = 0; l < this.parent.columns.length; l++)
        if (
          this.parent.columns[parseInt(l.toString(), 10)].visible &&
          this.parent.columns[parseInt(l.toString(), 10)].validationRules
        ) {
          On(this.parent.columns[parseInt(l.toString(), 10)], 0, o, {}, {}, this.parent.columns.length, true);
        }
      a.form.classList.add('e-virtual-validation');
      this.parent.editModule.virtualFormObj = this.parent.editModule.createFormObj(a.form, o);
    }
  };
  s.prototype.virtualEditFormValidation = function (e) {
    var t = this.parent;
    var i = this.parent.element.querySelector('.e-griderror:not([style*="display: none"])');
    if (this.parent.editModule.virtualFormObj) {
      if (i && i.style.display !== 'none') {
        var r = i.getBoundingClientRect();
        var n = this.parent.element.querySelectorAll('.e-gridform');
        var a = n[0];
        var o = this.parent.getContent().getBoundingClientRect().left;
        if (n.length > 1) {
          a = n[1];
        }
        if (
          r.left < this.parent.getContent().getBoundingClientRect().left ||
          r.right > this.parent.element.offsetWidth
        ) {
          var l = a.querySelector('.e-tooltip-wrap:not([style*="display: none"])');
          this.scrollToEdit(
            l,
            {
              editIdx: e.editIdx,
              addIdx: e.addIdx,
            },
            true,
          );
        }
      } else if (this.parent.editModule.virtualFormObj && (!i || i.style.display === 'none')) {
        for (
          var h = this.parent.editModule.virtualFormObj.element.querySelectorAll(
              '.e-tooltip-wrap:not([style*="display: none"])',
            ),
            d = 0;
          d < h.length;
          d++
        )
          N(h[parseInt(d.toString(), 10)]);
        this.setEditedDataToValidationForm(
          this.parent.editModule.virtualFormObj.element,
          this.getCurrentEditedData(e.prevData),
        );
        e.isValid = this.parent.editModule.virtualFormObj.validate();
        if (!e.isValid) {
          var l = this.parent.editModule.virtualFormObj.element.querySelector(
            '.e-tooltip-wrap:not([style*="display: none"])',
          );
          this.scrollToEdit(l, {
            editIdx: e.editIdx,
            addIdx: e.addIdx,
          });
        }
      }
    }
  };
  s.prototype.scrollToEdit = function (e, t, i) {
    var r = this.parent;
    if (e) {
      var n = this.parent.columnModel;
      var a = Ii(e.id).split('_')[0];
      var o = this.parent.getColumnByField(Ii(e.id).split('_')[0]);
      var l = this.parent.getContent().firstElementChild.scrollTop;
      var h = this.parent.getRowByIndex(t.editIdx);
      if (
        (!u(t.addIdx) && this.parent.getContent().firstElementChild.scrollTop > 0) ||
        (!u(t.editIdx) && !h) ||
        i ||
        !o
      ) {
        for (var d = void 0, p = 0; p < this.parent.columnModel.length && !o; p++)
          if (this.parent.columnModel[parseInt(p.toString(), 10)].field === Ii(e.id).split('_')[0]) {
            d = this.parent.columnModel[parseInt(p.toString(), 10)];
            break;
          }
        if (i) {
          d = o;
        }
        this.parent.notify(Tn, d);
      }
    }
  };
  s.prototype.setEditedDataToValidationForm = function (e, t) {
    for (var i = [].slice.call(e.getElementsByClassName('e-field')), r = 0, n = i.length; r < n; r++) {
      var a = ta(this.parent, i[parseInt(r.toString(), 10)].getAttribute('data-mappinguid'));
      if (a.field) {
        var o = re(a.field, t);
        o = u(o) ? '' : o;
        i[parseInt(r.toString(), 10)].value = o;
      }
    }
  };
  s.prototype.refreshVirtualElement = function (e) {
    if (this.parent.enableColumnVirtualization && e.module === 'resize') {
      var t = this.locator.getService('rendererFactory');
      t.getRenderer(Bt.Content).refreshVirtualElement();
    }
  };
  s.prototype.destroy = function () {
    this.removeEventListener();
  };
  return s;
})();
var zr = (function () {
  function s(e) {
    this.parent = e;
  }
  s.prototype.addNew = function (e, t) {
    this.isEdit = false;
    var i;
    (this.parent.frozenRows ||
      ((this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) &&
        this.parent.editSettings.showAddNewRow)) &&
    this.parent.editSettings.newRowPosition === 'Top'
      ? (i = this.parent.getHeaderTable().querySelector(U))
      : (i = this.parent.getContentTable().querySelector(U));
    t.row = this.parent.createElement('tr', { className: 'e-row e-addedrow' });
    if (this.parent.getContentTable().querySelector('.e-emptyrow') && !this.parent.editSettings.showAddNewRow) {
      var r = this.parent.getContentTable().querySelector('.e-emptyrow');
      r.parentNode.removeChild(r);
      if (this.parent.frozenRows && this.parent.element.querySelector('.e-frozenrow-empty')) {
        this.parent.element.querySelector('.e-frozenrow-empty').classList.remove('e-frozenrow-empty');
      }
    }
    this.parent.editSettings.newRowPosition === 'Top' ? i.insertBefore(t.row, i.firstChild) : i.appendChild(t.row);
    t.row.appendChild(this.getEditElement(e, false, void 0, t, true));
    this.parent.editModule.checkLastRow(t.row, t);
  };
  s.prototype.update = function (e, t) {
    this.isEdit = true;
    var i = [].slice.call(t.row.querySelectorAll('td.e-rowcell'));
    t.row.innerHTML = '';
    t.row.appendChild(this.getEditElement(e, true, i, t, true));
    t.row.classList.add(Y);
    this.parent.editModule.checkLastRow(t.row, t);
  };
  s.prototype.getEditElement = function (e, t, i, r, n) {
    var a = this.parent;
    var o = 0;
    var l = !u(this.parent.detailTemplate) || !u(this.parent.childGrid) ? 1 : 0;
    if (this.parent.allowGrouping) {
      o = this.parent.groupSettings.columns.length;
    }
    var h = this.parent.createElement('td', {
      className: 'e-editcell e-normaledit',
      attrs: {
        colspan: (
          this.parent.getCurrentVisibleColumns(this.parent.enableColumnVirtualization).length +
          this.parent.getIndentCount()
        ).toString(),
      },
    });
    var d = (r.form = this.parent.createElement('form', {
      id: this.parent.element.id + 'EditForm',
      className: 'e-gridform',
    }));
    if (this.parent.editSettings.template) {
      this.appendChildren(d, r.rowData, n);
      h.appendChild(d);
      return h;
    }
    var p = this.parent.createElement('table', {
      className: 'e-table e-inline-edit',
      attrs: {
        cellspacing: '0.25',
        role: 'grid',
      },
    });
    p.appendChild(this.parent.getContentTable().querySelector(mn).cloneNode(true));
    var c = this.parent.createElement(U, { attrs: { role: 'rowgroup' } });
    var f = this.parent.createElement('tr');
    if (this.parent.rowHeight) {
      f.style.height = this.parent.rowHeight + 'px';
    }
    var g = 0;
    for (
      l && f.insertBefore(this.parent.createElement('td', { className: 'e-detailrowcollapse' }), f.firstChild),
        this.parent.isRowDragable() &&
          f.appendChild(this.parent.createElement('td', { className: 'e-dragindentcell' }));
      g < o;

    ) {
      f.appendChild(this.parent.createElement('td', { className: 'e-indentcell' }));
      g++;
    }
    var m = 0;
    g = 0;
    for (
      var y, v = true, b = r.isCustomFormValidation ? this.parent.columnModel : this.parent.getColumns();
      (t && m < i.length && g < b.length) || g < b.length;

    ) {
      var w = t && i[parseInt(m.toString(), 10)] ? i[parseInt(m.toString(), 10)].getAttribute('colspan') : null;
      var C = b[parseInt(g.toString(), 10)];
      y = e[b[parseInt(g.toString(), 10)].uid].value;
      y = u(y) ? '' : y;
      var I = this.parent.createElement('td', {
        className: ie,
        attrs: { colspan: w || '' },
      });
      I.style.cssText = b[parseInt(g.toString(), 10)].textAlign
        ? 'text-align: ' + b[parseInt(g.toString(), 10)].textAlign + ';'
        : '';
      b[parseInt(g.toString(), 10)].visible
        ? (I.appendChild(e[b[parseInt(g.toString(), 10)].uid]),
          this.parent.rowRenderingMode === 'Vertical' &&
            (ia(I, { 'data-cell': b[parseInt(g.toString(), 10)].headerText }),
            g === 0 && I.classList.add('e-responsive-editcell')),
          b[parseInt(g.toString(), 10)].editType === 'booleanedit'
            ? I.classList.add('e-boolcell')
            : (b[parseInt(g.toString(), 10)].commands || b[parseInt(g.toString(), 10)].commandsTemplate) &&
              j([I], 'e-unboundcell'),
          !this.parent.enableRtl &&
            (this.parent.gridLines === 'Vertical' || this.parent.gridLines === 'Both') &&
            o &&
            v &&
            (I.classList.add('e-grid-group-first-cell'), (v = false)))
        : I.classList.add('e-hide');
      if (this.parent.isFrozenGrid()) {
        Ti(this.parent, b[parseInt(g.toString(), 10)], I);
        if (this.parent.isSpan) {
          var x = I.getAttribute('colspan') ? parseInt(I.getAttribute('colspan'), 10) : 1;
          ra(this.parent, b[parseInt(g.toString(), 10)], I, x);
        }
        if (this.parent.enableColumnVirtualization) {
          b[parseInt(g.toString(), 10)].freeze === 'Left' && !u(b[parseInt(g.toString(), 10)].valueX)
            ? (I.style.left = b[parseInt(g.toString(), 10)].valueX - this.parent.translateX + 'px')
            : b[parseInt(g.toString(), 10)].freeze === 'Right' && !u(b[parseInt(g.toString(), 10)].valueX)
              ? (I.style.right = b[parseInt(g.toString(), 10)].valueX + this.parent.translateX + 'px')
              : b[parseInt(g.toString(), 10)].freeze === 'Fixed' &&
                ((I.style.left = this.parent.leftrightColumnWidth('left') - this.parent.translateX + 'px'),
                (I.style.right = this.parent.leftrightColumnWidth('right') + this.parent.translateX + 'px'));
        }
      }
      I.setAttribute(
        'aria-label',
        y + this.parent.localeObj.getConstant('ColumnHeader') + b[parseInt(g.toString(), 10)].headerText,
      );
      f.appendChild(I);
      g = w ? g + parseInt(w, 10) : g + 1;
      m++;
    }
    Kt(f);
    c.appendChild(f);
    p.appendChild(c);
    d.appendChild(p);
    h.appendChild(d);
    return h;
  };
  s.prototype.removeEventListener = function () {};
  s.prototype.appendChildren = function (e, t, i) {
    var r = E(
      {},
      t,
      {
        isAdd: !this.isEdit,
        isFrozen: i,
      },
      true,
    );
    var n = this.parent.element.id + 'editSettingsTemplate';
    this.parent.isReact &&
    typeof this.parent.editSettings.template != 'string' &&
    !(this.parent.editSettings.template.prototype && this.parent.editSettings.template.prototype.CSPTemplate)
      ? (this.parent.getEditTemplate()(r, this.parent, 'editSettingsTemplate', n, null, null, e),
        this.parent.renderTemplates())
      : ae(
          e,
          this.parent.getEditTemplate()(r, this.parent, 'editSettingsTemplate', n, null, null, null, this.parent.root),
        );
  };
  return s;
})();
var Uo = (function () {
  function s(e) {
    this.parent = e;
  }
  s.prototype.update = function (e, t) {
    if (this.parent.isReact && t.columnObject && t.columnObject.template) {
      var i = t.cell.parentElement;
      var r = t.cell.cloneNode(true);
      t.cell.parentElement.insertBefore(r, t.cell);
      r.focus();
      t.cell.remove();
      t.cell = r;
    }
    t.cell.setAttribute(
      'aria-label',
      t.cell.innerHTML + this.parent.localeObj.getConstant('ColumnHeader') + t.columnObject.field,
    );
    t.cell.innerHTML = '';
    t.cell.appendChild(this.getEditElement(e, t));
    t.cell.classList.add('e-editedbatchcell');
    G(t.row, [Y, 'e-batchrow'], []);
  };
  s.prototype.getEditElement = function (e, t) {
    var i = this.parent;
    var r = this.parent.createElement('form', {
      id: this.parent.element.id + 'EditForm',
      className: 'e-gridform',
    });
    r.appendChild(e[t.columnObject.uid]);
    if (t.columnObject.editType === 'booleanedit') {
      t.cell.classList.add('e-boolcell');
    }
    if (!t.columnObject.editType) {
      t.cell.classList.add('e-inputbox');
    }
    return r;
  };
  return s;
})();
var Go = (function () {
  function s(e, t) {
    this.parent = e;
    this.serviceLocator = t;
    if (!this.parent.isDestroyed) {
      this.parent.on(_t, this.destroy, this);
      this.parent.on(M, this.destroy, this);
    }
  }
  s.prototype.setLocaleObj = function () {
    this.l10n = this.serviceLocator.getService('localization');
  };
  s.prototype.addNew = function (e, t) {
    this.isEdit = false;
    this.createDialog(e, t);
  };
  s.prototype.update = function (e, t) {
    this.isEdit = true;
    this.createDialog(e, t);
  };
  s.prototype.createDialogHeader = function (e) {
    var t = this;
    var i = this.parent;
    var r;
    if (this.parent.enableAdaptiveUI) {
      var n = new na(this.parent, this.serviceLocator);
      n.action = this.isEdit ? gt.isEdit : gt.isAdd;
      return n.renderResponsiveHeader(void 0, e);
    } else
      this.parent.editSettings.headerTemplate
        ? (r = vr(function () {
            return t.getDialogEditTemplateElement('HeaderTemplate', e).outerHTML;
          }))
        : this.isEdit
          ? (r = this.l10n.getConstant('EditFormTitle') + e.primaryKeyValue[0])
          : (r = this.l10n.getConstant('AddFormTitle'));
    return r;
  };
  s.prototype.createDialog = function (e, t) {
    var i = this;
    var r = this.parent;
    this.dialog = this.parent.createElement('div', { id: this.parent.element.id + '_dialogEdit_wrapper' });
    this.dialog.style.width = 'auto';
    if (this.parent.enableAdaptiveUI) {
      this.dialog.classList.add('e-responsive-dialog');
    }
    this.parent.element.appendChild(this.dialog);
    this.setLocaleObj();
    this.dialog.setAttribute('aria-label', this.l10n.getConstant('DialogEdit'));
    this.dialogObj = new Wt(
      E(
        {
          header: this.createDialogHeader(t),
          isModal: true,
          visible: true,
          cssClass: this.parent.cssClass ? 'e-edit-dialog ' + this.parent.cssClass : 'e-edit-dialog',
          content: this.getEditElement(e, t),
          showCloseIcon: true,
          allowDragging: true,
          close: this.dialogClose.bind(this),
          created: this.dialogCreated.bind(this),
          closeOnEscape: true,
          width: this.parent.editSettings.template ? 'auto' : '330px',
          target: t.target ? t.target : document.body,
          animationSettings: { effect: 'None' },
          footerTemplate: this.parent.editSettings.footerTemplate
            ? vr(function () {
                return i.getDialogEditTemplateElement('FooterTemplate', t).outerHTML;
              })
            : null,
          buttons: [
            {
              click: this.btnClick.bind(this),
              buttonModel: {
                content: this.l10n.getConstant('SaveButton'),
                cssClass: this.parent.cssClass ? 'e-primary ' + this.parent.cssClass : 'e-primary',
                isPrimary: true,
              },
            },
            {
              click: this.btnClick.bind(this),
              buttonModel: {
                cssClass: this.parent.cssClass ? 'e-flat ' + this.parent.cssClass : 'e-flat',
                content: this.l10n.getConstant('CancelButton'),
              },
            },
          ],
        },
        this.parent.editSettings.dialog ? this.parent.editSettings.dialog.params || {} : {},
      ),
    );
    t.dialog = this.dialogObj;
    var n = 'isStringTemplate';
    this.dialogObj.isStringTemplate = true;
    this.renderResponsiveDialog();
    this.dialogObj.appendTo(this.dialog);
    un(this.parent.element, this.dialogObj.element.parentElement);
    if (this.parent.enableAdaptiveUI) {
      this.dialogObj.show(true);
    }
  };
  s.prototype.dialogCreated = function () {
    sa(this.parent);
  };
  s.prototype.renderResponsiveDialog = function () {
    var e = this;
    if (this.parent.enableAdaptiveUI) {
      if (this.parent.adaptiveDlgTarget) {
        this.dialogObj.target = this.parent.adaptiveDlgTarget;
      }
      this.dialogObj.buttons = [{}];
      this.dialogObj.showCloseIcon = true;
      this.dialogObj.visible = false;
      this.dialogObj.width = '100%';
      this.dialogObj.open = function () {
        e.dialogObj.element.style.maxHeight = '100%';
      };
    }
  };
  s.prototype.btnClick = function (e) {
    this.l10n.getConstant('CancelButton').toLowerCase() === e.target.innerText.trim().toLowerCase()
      ? this.dialogClose()
      : this.parent.endEdit();
  };
  s.prototype.dialogClose = function () {
    this.parent.closeEdit();
  };
  s.prototype.destroy = function (e) {
    for (var t = ['template', 'headerTemplate', 'footerTemplate'], i = 0; i < t.length; i++)
      if (this.parent.editSettings[t[parseInt(i.toString(), 10)]]) {
        var r = t[parseInt(i.toString(), 10)].charAt(0).toUpperCase() + t[parseInt(i.toString(), 10)].slice(1);
        var n = this.parent.element.id + 'editSettings' + r;
        rt(n, r, this.parent.editSettings);
      }
    this.parent.notify(qi, {});
    this.parent.isEdit = false;
    this.parent.notify(Me, {});
    if (this.dialog && !this.dialogObj.isDestroyed) {
      this.dialogObj.destroy();
      N(this.dialog);
    }
  };
  s.prototype.getDialogEditTemplateElement = function (e, t) {
    var i = this.parent.createElement('div', { className: 'e-dialog' + e });
    var r = E({}, t.rowData, { isAdd: !this.isEdit }, true);
    var n = this.parent.element.id + 'editSettings' + e;
    ae(
      i,
      (e === 'HeaderTemplate' ? this.parent.getEditHeaderTemplate() : this.parent.getEditFooterTemplate())(
        r,
        this.parent,
        'editSettings' + e,
        n,
      ),
    );
    rt(n, e, this.parent.editSettings);
    return i;
  };
  s.prototype.getEditElement = function (e, t) {
    var i = this.parent;
    var r = this.parent.createElement('div', { className: this.isEdit ? Y : 'e-insertedrow' });
    var n = (t.form = this.parent.createElement('form', {
      id: this.parent.element.id + 'EditForm',
      className: 'e-gridform',
    }));
    if (this.parent.editSettings.template) {
      var a = this.parent.element.id + 'editSettingsTemplate';
      var o = E({}, t.rowData, { isAdd: !this.isEdit }, true);
      var l =
        this.parent.isReact &&
        typeof this.parent.editSettings.template != 'string' &&
        !(this.parent.editSettings.template.prototype && this.parent.editSettings.template.prototype.CSPTemplate);
      var h =
        this.parent.parentDetails &&
        this.parent.parentDetails.parentInstObj &&
        this.parent.parentDetails.parentInstObj.isReact;
      l || h
        ? (this.parent.getEditTemplate()(o, this.parent, 'editSettingsTemplate', a, null, null, n),
          this.parent.renderTemplates())
        : ae(
            n,
            this.parent.getEditTemplate()(
              o,
              this.parent,
              'editSettingsTemplate',
              a,
              null,
              null,
              null,
              this.parent.root,
            ),
          );
      rt(a, 'Template', this.parent.editSettings);
      r.appendChild(n);
      return r;
    }
    for (
      var d = this.parent.createElement('table', {
          className: Li,
          attrs: {
            cellspacing: '6px',
            role: 'grid',
          },
        }),
        p = this.parent.createElement(U, { attrs: { role: 'rowgroup' } }),
        c = this.parent.getColumns(),
        f = 0;
      f < c.length;
      f++
    )
      if (
        !(
          this.parent.editModule.checkColumnIsGrouped(c[parseInt(f.toString(), 10)]) ||
          c[parseInt(f.toString(), 10)].commands ||
          c[parseInt(f.toString(), 10)].commandsTemplate ||
          c[parseInt(f.toString(), 10)].type === 'checkbox'
        )
      ) {
        var g = this.parent.createElement('tr', { attrs: { role: 'row' } });
        var m = this.parent.createElement('td', { className: ie });
        m.style.cssText = 'text-align: ' + (this.parent.enableRtl ? 'right' : 'left') + '; width: 190px;';
        e[c[parseInt(f.toString(), 10)].uid].classList.remove('e-input');
        m.appendChild(e[c[parseInt(f.toString(), 10)].uid]);
        g.appendChild(m);
        p.appendChild(g);
      }
    d.appendChild(p);
    n.appendChild(d);
    r.appendChild(n);
    return r;
  };
  s.prototype.removeEventListener = function () {
    if (!this.parent.isDestroyed) {
      this.parent.off(_t, this.destroy);
      this.parent.off(M, this.destroy);
    }
  };
  return s;
})();
var Wo = (function () {
  function s(e, t) {
    this.editType = {
      Inline: zr,
      Normal: zr,
      Batch: Uo,
      Dialog: Go,
    };
    this.parent = e;
    this.serviceLocator = t;
    this.renderer = new this.editType[this.parent.editSettings.mode](e, t);
    this.focus = t.getService('focus');
  }
  s.prototype.addNew = function (e) {
    this.renderer.addNew(this.getEditElements(e), e);
    this.convertWidget(e);
  };
  s.prototype.update = function (e) {
    this.renderer.update(this.getEditElements(e), e);
    var t = e.isCustomFormValidation;
    if (!e.isCustomFormValidation) {
      this.parent.notify(aa, e);
      this.convertWidget(e);
    }
  };
  s.prototype.convertWidget = function (e) {
    for (
      var t = this.parent,
        i,
        r,
        n =
          t.editSettings.mode === 'Dialog'
            ? Ee('#' + t.element.id + '_dialogEdit_wrapper .e-gridform', document)
            : t.editSettings.showAddNewRow && t.element.querySelector('.e-editedrow')
              ? t.element.querySelector('.e-editedrow').getElementsByClassName('e-gridform')[0]
              : t.element.getElementsByClassName('e-gridform')[0],
        a = t.editSettings.mode !== 'Batch' ? t.getColumns() : [t.getColumnByField(e.columnName)],
        o = 0,
        l = a;
      o < l.length;
      o++
    ) {
      var h = l[o];
      if (this.parent.editSettings.template && !u(l[o].field)) {
        var d = E({}, e);
        d.element = n.querySelector('[name=' + Ue(l[o].field) + ']');
        typeof l[o].edit.write == 'string' ? te(l[o].edit.write, window)(d) : l[o].edit.write(d);
        continue;
      }
      if (!(this.parent.editModule.checkColumnIsGrouped(l[o]) || l[o].commands)) {
        l[o].valueAccessor(l[o].field, e.rowData, l[o]);
        r = n.querySelector('[data-mappinguid=' + l[o].uid + ']');
        var p = l[o].edit.write;
        if (
          !u(r) &&
          (typeof p == 'string'
            ? ((p = te(p, window)),
              p({
                rowData: e.rowData,
                element: r,
                column: l[o],
                requestType: e.requestType,
                row: e.row,
                foreignKeyData: l[o].isForeignColumn() && te(l[o].field, e.foreignKeyData),
              }))
            : l[o].edit.write({
                rowData: e.rowData,
                element: r,
                column: l[o],
                requestType: e.requestType,
                row: e.row,
                foreignKeyData: l[o].isForeignColumn() && te(l[o].field, e.foreignKeyData),
              }),
          !i && u(r.getAttribute('disabled')) && !S(r, 'e-checkbox-disabled'))
        ) {
          var c = !u(l[o].edit) && !u(l[o].edit.params) && l[o].edit.params.multiline;
          if (
            r.getAttribute('type') === 'hidden' &&
            c &&
            r.parentElement &&
            r.parentElement.classList.contains('e-multi-line-input')
          ) {
            var f = r.parentElement.querySelector('textarea');
            if (f) {
              this.focusElement(f, e.type);
            }
          } else this.focusElement(r, e.type);
          i = true;
        }
      }
    }
  };
  s.prototype.focusElement = function (e, t) {
    var i = this.parent.element.querySelector('.e-edit-checkselect');
    if (!u(i) && i.nextElementSibling) {
      i.nextElementSibling.classList.add('e-focus');
    }
    if (this.parent.editSettings.mode === 'Batch') this.focus.onClick({ target: T(e, 'td') }, true);
    else {
      var r = !(
        (this.parent.enableVirtualization || this.parent.enableColumnVirtualization) &&
        this.parent.editSettings.mode === 'Normal'
      );
      var n = e.classList.contains('e-dropdownlist') ? e.parentElement : e;
      (r ||
        ((this.parent.enableVirtualization || this.parent.enableColumnVirtualization) &&
          this.parent.editSettings.newRowPosition === 'Bottom' &&
          S(e, Fe))) &&
      (!this.parent.editSettings.showAddNewRow ||
        (this.parent.editSettings.showAddNewRow && !S(e, Fe)) ||
        this.parent.addNewRowFocus)
        ? (n.focus(),
          this.parent.enableVirtualization &&
            this.parent.contentModule &&
            this.parent.contentModule.content &&
            (this.parent.contentModule.content.scrollTop += this.parent.getRowHeight()))
        : n.focus({ preventScroll: true });
    }
    if (e.classList.contains('e-defaultcell')) {
      e.setSelectionRange(e.value.length, e.value.length);
    }
  };
  s.prototype.getEditElements = function (e) {
    var t = this.parent;
    var i = {};
    var r =
      this.parent.editSettings.mode !== 'Batch'
        ? this.parent.getColumns()
        : [this.parent.getColumnByField(e.columnName)];
    if (e.isCustomFormValidation) {
      r = this.parent.columnModel;
    }
    if (this.parent.editSettings.template) return {};
    for (var n = 0, a = r.length; n < a; n++) {
      var o = r[parseInt(n.toString(), 10)];
      if (r[parseInt(n.toString(), 10)].commands || r[parseInt(n.toString(), 10)].commandsTemplate) {
        var l = this.serviceLocator.getService('cellRendererFactory');
        var h = new Mi(this.parent);
        var d = l.getCellRenderer(P.CommandColumn);
        var p = h.generateRows(e.rowData)[0].cells;
        var c = h.generateRows(e.rowData)[0].cells.filter(function (D) {
          return D.rowID;
        });
        var f = d.render(
          c[parseInt(n.toString(), 10)],
          e.rowData,
          { 'data-index': e.row ? (parseInt(e.row.getAttribute(q), 10) - 1).toString() : 0 },
          this.parent.enableVirtualization,
        );
        var g = f.firstElementChild;
        f.firstElementChild.setAttribute('textAlign', f.getAttribute('textAlign'));
        i[r[parseInt(n.toString(), 10)].uid] = f.firstElementChild;
        continue;
      }
      if (
        r[parseInt(n.toString(), 10)].type === 'dateonly' &&
        e.rowData[r[parseInt(n.toString(), 10)].field] instanceof Date
      ) {
        var m = e.rowData[r[parseInt(n.toString(), 10)].field];
        e.rowData[r[parseInt(n.toString(), 10)].field] =
          e.rowData[r[parseInt(n.toString(), 10)].field].getFullYear() +
          '-' +
          jt(e.rowData[r[parseInt(n.toString(), 10)].field].getMonth() + 1) +
          '-' +
          jt(e.rowData[r[parseInt(n.toString(), 10)].field].getDate());
      }
      var y = r[parseInt(n.toString(), 10)].valueAccessor(
        r[parseInt(n.toString(), 10)].field,
        e.rowData,
        r[parseInt(n.toString(), 10)],
      );
      var v = {
        column: r[parseInt(n.toString(), 10)],
        value: y,
        type: e.requestType,
        data: e.rowData,
      };
      var b = r[parseInt(n.toString(), 10)].edit.create;
      var w = void 0;
      if (r[parseInt(n.toString(), 10)].editTemplate) {
        w = this.parent.createElement('span', { attrs: { 'data-mappinguid': r[parseInt(n.toString(), 10)].uid } });
        var C = this.parent.element.id + r[parseInt(n.toString(), 10)].uid + 'editTemplate';
        var I = oa({}, e.rowData, { column: r[parseInt(n.toString(), 10)] });
        var x =
          this.parent.isReact &&
          typeof r[parseInt(n.toString(), 10)].editTemplate != 'string' &&
          !(
            r[parseInt(n.toString(), 10)].editTemplate.prototype &&
            r[parseInt(n.toString(), 10)].editTemplate.prototype.CSPTemplate
          );
        var O =
          this.parent.parentDetails &&
          this.parent.parentDetails.parentInstObj &&
          this.parent.parentDetails.parentInstObj.isReact;
        if (x || O) {
          r[parseInt(n.toString(), 10)].getEditTemplate()(
            E({ index: e.rowIndex }, I),
            this.parent,
            'editTemplate',
            C,
            null,
            null,
            w,
          );
          this.parent.renderTemplates();
        } else {
          var A = r[parseInt(n.toString(), 10)].getEditTemplate()(
            E({ index: e.rowIndex }, I),
            this.parent,
            'editTemplate',
            C,
            null,
            null,
            null,
            this.parent.root,
          );
          ae(w, A);
        }
      } else {
        typeof b == 'string' ? ((b = te(b, window)), (w = b(v))) : (w = r[parseInt(n.toString(), 10)].edit.create(v));
        if (typeof w == 'string') {
          var g = this.parent.createElement('div');
          g.innerHTML = w;
          w = g.firstChild;
        }
        var k = w.tagName !== 'input' && w.querySelectorAll('input').length;
        var F = Ue(r[parseInt(n.toString(), 10)].field);
        Ft(k ? w.querySelector('input') : w, {
          name: F,
          'data-mappinguid': r[parseInt(n.toString(), 10)].uid,
          id: this.parent.element.id + F,
        });
        G(w, ['e-input', 'e-field'], []);
        if (r[parseInt(n.toString(), 10)].textAlign === 'Right') {
          w.classList.add('e-ralign');
        }
        if (
          ((r[parseInt(n.toString(), 10)].isPrimaryKey || r[parseInt(n.toString(), 10)].isIdentity) &&
            e.requestType === 'beginEdit') ||
          (r[parseInt(n.toString(), 10)].isIdentity && e.requestType === 'add')
        ) {
          w.setAttribute('disabled', '');
        }
      }
      i[r[parseInt(n.toString(), 10)].uid] = w;
    }
    return i;
  };
  s.prototype.destroy = function () {
    this.renderer.removeEventListener();
  };
  return s;
})();
var Zt = (function () {
  function s(e) {
    this.parent = e;
  }
  s.prototype.create = function (e) {
    return $t(this.parent, e.column, 'e-field', { type: 'text' });
  };
  s.prototype.read = function (e) {
    return e.ej2_instances[0].value;
  };
  s.prototype.destroy = function () {
    if (this.obj && !this.obj.isDestroyed) {
      if (this.removeEventHandler) {
        this.removeEventHandler();
      }
      this.obj.destroy();
      this.obj.element.remove();
    }
  };
  return s;
})();
var Ko = (function () {
  var s = function (e, t) {
    s =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (i, r) {
          i.__proto__ = r;
        }) ||
      function (i, r) {
        for (var n in r)
          if (r.hasOwnProperty(n)) {
            i[n] = r[n];
          }
      };
    return s(e, t);
  };
  return function (e, t) {
    s(e, t);
    function i() {
      this.constructor = e;
    }
    e.prototype = t === null ? Object.create(t) : ((i.prototype = t.prototype), new i());
  };
})();
var $o = (function (s) {
  Ko(e, s);
  function e() {
    var t = (s !== null && s()) || this;
    t.activeClasses = ['e-selectionbackground', 'e-active'];
    return t;
  }
  e.prototype.create = function (t) {
    var i = t.column;
    var r = 'e-field e-boolcell';
    if (t.column.type === 'checkbox') {
      r = 'e-field e-boolcell e-edit-checkselect';
    }
    this.removeEventHandler = this.removeEventListener;
    return $t(this.parent, t.column, r, {
      type: 'checkbox',
      value: t.value,
    });
  };
  e.prototype.read = function (t) {
    return t.checked;
  };
  e.prototype.write = function (t) {
    var i;
    var r;
    if (!u(t.row)) {
      i = t.row.querySelector('.e-edit-checkselect');
    }
    if (te(t.column.field, t.rowData)) {
      r = JSON.parse(te(t.column.field, t.rowData).toString().toLowerCase());
    }
    if (!u(i) && t.column.type === 'checkbox') {
      this.editType = this.parent.editSettings.mode;
      this.editRow = t.row;
      if (t.requestType !== 'add') {
        var n = this.parent.getRowObjectFromUID(t.row.getAttribute('data-uid'));
        r = n ? n.isSelected : false;
      }
      De.apply(void 0, [[].slice.call(t.row.getElementsByClassName(ie)), r].concat(this.activeClasses));
    }
    this.obj = new la(
      E(
        {
          label: this.parent.editSettings.mode !== 'Dialog' ? ' ' : t.column.headerText,
          checked: r,
          disabled: !bt(t.column, t.requestType, t.element),
          enableRtl: this.parent.enableRtl,
          cssClass: this.parent.cssClass ? this.parent.cssClass : '',
        },
        t.column.edit.params,
      ),
    );
    this.addEventListener();
    this.obj.appendTo(t.element);
  };
  e.prototype.addEventListener = function () {
    this.cbChange = this.checkBoxChange.bind(this);
    this.obj.addEventListener(yr, this.cbChange);
  };
  e.prototype.removeEventListener = function () {
    if (!this.obj.isDestroyed) {
      this.obj.removeEventListener(yr, this.cbChange);
    }
  };
  e.prototype.checkBoxChange = function (t) {
    if (this.editRow && this.editType !== 'Dialog') {
      var i = false;
      t.checked
        ? ((i = true), this.editRow.setAttribute('aria-selected', i.toString()))
        : this.editRow.removeAttribute('aria-selected');
      De.apply(void 0, [[].slice.call(this.editRow.getElementsByClassName(ie)), i].concat(this.activeClasses));
    }
  };
  return e;
})(Zt);
var Xo = (function () {
  var s = function (e, t) {
    s =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (i, r) {
          i.__proto__ = r;
        }) ||
      function (i, r) {
        for (var n in r)
          if (r.hasOwnProperty(n)) {
            i[n] = r[n];
          }
      };
    return s(e, t);
  };
  return function (e, t) {
    s(e, t);
    function i() {
      this.constructor = e;
    }
    e.prototype = t === null ? Object.create(t) : ((i.prototype = t.prototype), new i());
  };
})();
var Jo = (function (s) {
  Xo(e, s);
  function e(t) {
    var i = s() || this;
    i.parent = t;
    i.flag = false;
    i.removeEventHandler = i.removeEventListener;
    return i;
  }
  e.prototype.write = function (t) {
    var i = this.parent.editSettings.mode !== 'Dialog';
    this.column = t.column;
    var r = new tn(t.column.field, 'notequal', null, true, false);
    var n = {};
    if (t.column.edit.params)
      for (var a = Object.keys(t.column.edit.params), o = 0; o < a.length; o++)
        n[a[parseInt(o.toString(), 10)]] =
          a[parseInt(o.toString(), 10)] === 'query'
            ? t.column.edit.params[a[parseInt(o.toString(), 10)]].clone()
            : t.column.edit.params[a[parseInt(o.toString(), 10)]];
    this.obj = new wt(
      E(
        {
          dataSource: this.parent.dataSource instanceof H ? this.parent.dataSource : new H(this.parent.dataSource),
          query: new ue().where(r).select(t.column.field),
          enabled: bt(t.column, t.requestType, t.element) && Xt(S(t.element, 'e-rowcell'), this.parent),
          fields: { value: t.column.field },
          value: te(t.column.field, t.rowData),
          enableRtl: this.parent.enableRtl,
          placeholder: i ? '' : t.column.headerText,
          popupHeight: '200px',
          floatLabelType: i ? 'Never' : 'Always',
          sortOrder: 'Ascending',
          cssClass: this.parent.cssClass ? this.parent.cssClass : null,
          close: this.dropDownClose.bind(this),
        },
        n,
      ),
    );
    if (this.parent.enableVirtualization) {
      n.dataSource
        ? (this.obj.dataSource = n.dataSource)
        : (this.obj.dataSource = t.column.isForeignColumn() ? [t.foreignKeyData[0]] : [t.rowData]);
    }
    this.addEventListener();
    this.obj.query.params = this.parent.query.params;
    this.obj.appendTo(t.element);
    t.element.setAttribute('name', Ue(t.column.field));
  };
  e.prototype.dropDownClose = function (t) {
    if (t.event) {
      t.event.action === 'escape'
        ? (this.parent.editModule.editCellDialogClose = true)
        : this.parent.isEdit &&
          this.parent.editSettings.mode === 'Batch' &&
          t.event.action === 'enter' &&
          t.event.stopPropagation();
    }
  };
  e.prototype.addEventListener = function () {
    this.ddCreated = this.dropdownCreated.bind(this);
    this.ddOpen = this.dropDownOpen.bind(this);
    this.ddBeforeOpen = this.dropdownBeforeOpen.bind(this);
    this.ddComplete = this.ddActionComplete.bind(this);
    this.obj.addEventListener(Lt, this.ddCreated);
    this.obj.addEventListener(oe, this.ddOpen);
    this.obj.addEventListener(Sr, this.ddBeforeOpen);
    this.obj.addEventListener(B, this.ddComplete);
  };
  e.prototype.removeEventListener = function () {
    if (!this.obj.isDestroyed) {
      this.obj.removeEventListener(Lt, this.ddCreated);
      this.obj.removeEventListener(oe, this.ddOpen);
      this.obj.removeEventListener(Sr, this.ddBeforeOpen);
      this.obj.removeEventListener(B, this.ddComplete);
    }
  };
  e.prototype.dropdownCreated = function (t) {
    this.flag = true;
  };
  e.prototype.dropdownBeforeOpen = function () {
    if (this.parent.enableVirtualization) {
      this.column.edit.params && this.column.edit.params.dataSource
        ? (this.obj.dataSource = this.column.edit.params.dataSource)
        : (this.obj.dataSource = this.column.isForeignColumn()
            ? this.column.dataSource instanceof H
              ? this.column.dataSource
              : new H(this.column.dataSource)
            : this.parent.dataSource instanceof H
              ? this.parent.dataSource
              : new H(this.parent.dataSource));
    }
  };
  e.prototype.ddActionComplete = function (t) {
    t.result = le.distinct(t.result, this.obj.fields.value, true);
    if (this.flag && this.column.dataSource && !(this.column.edit.params && this.column.edit.params.ddEditedData)) {
      'result' in this.column.dataSource
        ? (this.column.dataSource.result = t.result)
        : this.column.dataSource instanceof H && (this.column.dataSource.dataSource.json = t.result);
    }
    this.flag = false;
  };
  e.prototype.dropDownOpen = function (t) {
    var i = S(this.obj.element, 'e-dialog');
    if (this.parent.editSettings.mode === 'Dialog' && !u(i)) {
      var r = Ee('#' + i.id, document).ej2_instances[0];
      t.popup.element.style.zIndex = (Ee('#' + i.id, document).ej2_instances[0].zIndex + 1).toString();
    }
  };
  return e;
})(Zt);
var Zo = (function () {
  function s(e) {
    this.parent = e;
  }
  s.prototype.keyEventHandler = function (e) {
    if (e.keyCode === 13 || e.keyCode === 9) {
      var t = document.createEvent('HTMLEvents');
      t.initEvent('change', false, true);
      this.dispatchEvent(t);
    }
  };
  s.prototype.create = function (e) {
    this.instances = new Jt(this.parent.locale);
    return $t(this.parent, e.column, 'e-field', {});
  };
  s.prototype.read = function (e) {
    return this.obj.value;
  };
  s.prototype.write = function (e) {
    var t = e.column;
    var i = this.parent.editSettings.mode !== 'Dialog';
    this.obj = new sn(
      E(
        {
          value: parseFloat(te(e.column.field, e.rowData)),
          enableRtl: this.parent.enableRtl,
          placeholder: i ? '' : e.column.headerText,
          enabled: bt(e.column, e.requestType, e.element) && Xt(S(e.element, 'e-rowcell'), this.parent),
          floatLabelType: this.parent.editSettings.mode !== 'Dialog' ? 'Never' : 'Always',
          locale: this.parent.locale,
          cssClass: this.parent.cssClass ? this.parent.cssClass : null,
        },
        e.column.edit.params,
      ),
    );
    e.element.setAttribute('name', Ue(e.column.field));
    this.obj.appendTo(e.element);
    this.obj.element.addEventListener('keydown', this.keyEventHandler);
  };
  s.prototype.destroy = function () {
    if (this.obj && !this.obj.isDestroyed) {
      this.obj.element.removeEventListener('keydown', this.keyEventHandler);
      this.obj.destroy();
      this.obj.element.remove();
    }
  };
  return s;
})();
var Yo = (function () {
  var s = function (e, t) {
    s =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (i, r) {
          i.__proto__ = r;
        }) ||
      function (i, r) {
        for (var n in r)
          if (r.hasOwnProperty(n)) {
            i[n] = r[n];
          }
      };
    return s(e, t);
  };
  return function (e, t) {
    s(e, t);
    function i() {
      this.constructor = e;
    }
    e.prototype = t === null ? Object.create(t) : ((i.prototype = t.prototype), new i());
  };
})();
var Qo = (function (s) {
  Yo(e, s);
  function e() {
    return (s !== null && s()) || this;
  }
  e.prototype.create = function (t) {
    var i = {
      type: 'text',
      value: u(t.value) ? '' : t.value,
    };
    var r = $t(this.parent, t.column, 'e-field e-input e-defaultcell', i);
    if (t.column.textAlign) {
      r.style.textAlign = t.column.textAlign;
    }
    return r;
  };
  e.prototype.read = function (t) {
    return t.type === 'hidden' && !u(t.ej2_instances[0]) && !u(t.ej2_instances[0].textarea)
      ? t.ej2_instances[0].value
      : t.value;
  };
  e.prototype.write = function (t) {
    var i;
    var r = t.column;
    var n = this.parent.editSettings.mode !== 'Dialog';
    var a = {
      element: t.element,
      floatLabelType: this.parent.editSettings.mode !== 'Dialog' ? 'Never' : 'Always',
      enableRtl: this.parent.enableRtl,
      enabled: bt(t.column, t.requestType, t.element) && Xt(S(t.element, 'e-rowcell'), this.parent),
      placeholder: n ? '' : t.column.headerText,
      cssClass: this.parent.cssClass ? this.parent.cssClass : '',
    };
    if (!u(t.column.edit) && !u(t.column.edit.params) && t.column.edit.params.multiline) {
      var o = t.column.valueAccessor(t.column.field, t.rowData, t.column);
      a.value = o;
      i = a.element.getAttribute('data-mappinguid');
      a.element.removeAttribute('data-mappinguid');
      a.element.setAttribute('e-mappinguid', i);
    }
    this.obj = new ha(E(a, t.column.edit.params));
    this.obj.appendTo(t.element);
    if (!u(i)) {
      this.obj.element.removeAttribute('e-mappinguid');
      this.obj.element.setAttribute('data-mappinguid', i);
    }
    if (this.parent.editSettings.mode === 'Batch') {
      this.obj.element.addEventListener('keydown', this.keyEventHandler);
    }
  };
  e.prototype.keyEventHandler = function (t) {
    if (t.key === 'Enter' || t.key === 'Tab') {
      var i = new Event('change', {
        bubbles: false,
        cancelable: true,
      });
      this.dispatchEvent(i);
    }
  };
  e.prototype.destroy = function () {
    if (this.obj && !this.obj.isDestroyed) {
      this.obj.element.removeEventListener('keydown', this.keyEventHandler);
      this.obj.destroy();
      this.obj.element.remove();
    }
  };
  return e;
})(Zt);
var Vn = (function () {
  function s(e, t, i) {
    this.args = {};
    this.currentVirtualData = {};
    this.parent = e;
    this.renderer = i;
    this.serviceLocator = t;
    this.addEventListener();
  }
  s.prototype.clickHandler = function (e) {
    var t = e.target;
    var i = this.parent;
    if (!(this.parent.editSettings.showAddNewRow && u(this.parent.element.querySelector('.' + Y)))) {
      if (
        ((S(e.target, pe) && S(S(e.target, pe), 'e-grid').id === this.parent.element.id) ||
          (this.parent.frozenRows && S(e.target, je) && !S(e.target, 'e-columnheader'))) &&
        !S(e.target, 'e-unboundcelldiv')
      ) {
        this.rowIndex = S(e.target, ie) ? parseInt(e.target.parentElement.getAttribute(q), 10) - 1 : -1;
        if (this.parent.isEdit) {
          this.parent.editModule.endEdit();
        }
      }
    }
  };
  s.prototype.dblClickHandler = function (e) {
    if (
      S(e.target, ie) &&
      this.parent.editSettings.allowEditOnDblClick &&
      (!this.parent.editSettings.showAddNewRow ||
        (this.parent.editSettings.showAddNewRow && !S(e.target, 'e-addedrow')))
    ) {
      this.parent.editModule.startEdit(S(e.target, de));
    }
  };
  s.prototype.editComplete = function (e) {
    this.parent.isEdit = !!this.parent.editSettings.showAddNewRow;
    var t = 'action';
    switch (e.requestType) {
      case 'save':
        {
          if (
            (!(this.parent.isCheckBoxSelection || this.parent.selectionSettings.type === 'Multiple') ||
              !this.parent.isPersistSelection) &&
            e.action !== 'edit' &&
            (!this.parent.editSettings.showAddNewRow || (this.parent.editSettings.showAddNewRow && e.action !== 'add'))
          ) {
            if (this.parent.allowPaging && e.index > 0) {
              e.index =
                this.parent.pageSettings.currentPage === Math.floor(e.index / this.parent.pageSettings.pageSize) + 1
                  ? e.index % this.parent.pageSettings.pageSize
                  : -1;
            }
            if (this.parent.enableVirtualization && e.index > 0) {
              this.parent.selectVirtualRowOnAdd = true;
            }
            if (
              !this.parent.isTreeGrid ||
              !(
                this.parent.enableVirtualization &&
                ((this.parent.sortSettings && this.parent.sortSettings.columns.length) ||
                  (this.parent.filterSettings && this.parent.filterSettings.columns.length) ||
                  (this.parent.searchSettings && this.parent.searchSettings.key.length))
              )
            ) {
              this.parent.selectRow(e.index);
            }
          }
          this.parent.trigger(
            B,
            E(e, {
              requestType: 'save',
              type: B,
            }),
          );
          this.parent.notify(pt, {
            requestType: 'save',
            action: e.action,
          });
        }
        break;
      case 'delete':
        {
          this.parent.trigger(
            B,
            E(e, {
              requestType: 'delete',
              type: B,
            }),
          );
          if (
            !this.parent.isCheckBoxSelection &&
            !(this.parent.enableInfiniteScrolling && (this.parent.childGrid || this.parent.detailTemplate))
          ) {
            this.parent.selectRow(this.editRowIndex);
          }
          this.parent.notify(pt, {
            requestType: 'delete',
            action: e.action,
          });
        }
        break;
      case 'refresh-aggregate-on-save':
        {
          this.parent.trigger(
            B,
            E(e, {
              requestType: 'refresh-aggregate-on-save',
              type: B,
            }),
          );
          this.parent.selectRow(this.rowIndex);
          this.parent.notify(pt, {
            requestType: 'refresh-aggregate-on-save',
            action: e.action,
          });
        }
        break;
    }
  };
  s.prototype.getEditArgs = function (e, t, i) {
    for (var r = this.parent.getPrimaryKeyFieldNames(), n = [], a = 0; a < r.length; a++)
      n.push(te(r[parseInt(a.toString(), 10)], e));
    var o = {
      primaryKey: r,
      primaryKeyValue: n,
      requestType: 'beginEdit',
      rowData: e,
      rowIndex: this.rowIndex,
      type: 'edit',
      cancel: false,
      foreignKeyData: t && t.foreignKeyData,
      target: void 0,
      isScroll: i,
    };
    return o;
  };
  s.prototype.startEdit = function (e) {
    var t = this;
    var i = this.parent;
    this.rowIndex = this.editRowIndex = parseInt(e.getAttribute(q), 10) - 1;
    if (
      this.parent.enableVirtualization ||
      this.parent.enableColumnVirtualization ||
      this.parent.enableInfiniteScrolling
    ) {
      var r = '.e-row[aria-rowindex="' + (this.rowIndex + 1) + '"]';
      var n = this.parent.element.querySelector(r);
      if (!n) return;
    }
    var a = {
      data: void 0,
      index: this.rowIndex,
      isScroll: false,
    };
    this.parent.notify(xn, a);
    if (X(this.parent)) {
      var o = this.parent.getRowObjectFromUID(e.getAttribute('data-uid'));
      this.previousData = o.data;
    } else
      this.parent.enableVirtualization ||
      this.parent.enableColumnVirtualization ||
      (this.parent.enableInfiniteScrolling && (!this.previousData || this.parent.infiniteScrollSettings.enableCache))
        ? (this.previousData = a.data)
        : this.parent.enableVirtualization ||
          (this.previousData = E(
            {},
            {},
            this.parent.getForeignKeyColumns().length ||
              (this.parent.allowGrouping && this.parent.groupSettings.columns.length)
              ? this.parent.getRowObjectFromUID(e.getAttribute('data-uid')).data
              : this.parent.getCurrentViewRecords()[this.rowIndex],
            true,
          ));
    var l = E({}, {}, a.data || this.previousData, true);
    this.uid = e.getAttribute('data-uid');
    var h = this.parent.getRowObjectFromUID(this.uid);
    var d = this.getEditArgs(l, h, false);
    d.row = e;
    d.isScroll
      ? this.inlineEditHandler(d, e)
      : (this.parent.notify(Vt, {
          uid: this.uid,
          prevData: this.previousData,
          argsCreator: this.getEditArgs.bind(this),
          renderer: this.renderer,
        }),
        this.parent.trigger(da, d, function (p) {
          p.type = 'actionBegin';
          this.parent.trigger(_, p, function (c) {
            if (!c.cancel) {
              t.inlineEditHandler(c, e);
            }
          });
        }));
  };
  s.prototype.disabledShowAddRow = function (e, t) {
    var i = this.parent.element.querySelector('.e-addedrow');
    var r = [].slice.call(i ? i.querySelectorAll('.e-input') : []);
    if (i && i.querySelector('.e-unboundcell'))
      for (
        var n = [].slice.call(i.querySelector('.e-unboundcell').querySelectorAll('.e-btn')), a = 0;
        a < n.length;
        a++
      )
        e
          ? (n[parseInt(a.toString(), 10)].classList.remove('e-disabled'),
            n[parseInt(a.toString(), 10)].removeAttribute('disabled'))
          : (n[parseInt(a.toString(), 10)].classList.add('e-disabled'),
            n[parseInt(a.toString(), 10)].setAttribute('disabled', 'disabled'));
    if (r.length)
      for (var a = 0; a < r.length; a++) {
        var o = r[parseInt(a.toString(), 10)];
        var l = o.getAttribute('data-mappinguid');
        var h = this.parent.getColumnByUid(l);
        var d = S(o, 'e-rowcell').querySelector('.e-error');
        if (d) {
          d.classList.remove('e-error');
        }
        o.ej2_instances
          ? (t &&
              u(h.defaultValue) &&
              (o.type === 'checkbox'
                ? ((o.ej2_instances[0].checked = false), (o.checked = false))
                : ((o.ej2_instances[0].value = null), (o.value = null))),
            o.type === 'checkbox' && !u(e)
              ? (o.ej2_instances[0].disabled = !(e && h.allowEditing))
              : u(e) || (o.ej2_instances[0].enabled = !!(e && h.allowEditing)))
          : (t && o.value && o.value.length && u(h.defaultValue) && (o.value = null),
            u(e) ||
              (e
                ? h.allowEditing && (o.classList.remove('e-disabled'), o.removeAttribute('disabled'))
                : (o.classList.add('e-disabled'), o.setAttribute('disabled', 'disabled'))));
      }
  };
  s.prototype.inlineEditHandler = function (e, t) {
    var i = this.parent;
    i.isEdit = true;
    e.row = e.row ? e.row : t;
    if (i.editSettings.mode !== 'Dialog') {
      i.clearSelection();
    }
    if (i.editSettings.mode === 'Dialog' && i.selectionModule) {
      i.selectionModule.preventFocus = true;
      e.row.classList.add('e-dlgeditrow');
    }
    this.renderer.update(e);
    this.uid = t.getAttribute('data-uid');
    i.editModule.applyFormValidation();
    if (i.editSettings.showAddNewRow && !t.classList.contains('e-addedrow')) {
      this.disabledShowAddRow(false, true);
    }
    e.type = 'actionComplete';
    i.trigger(B, e);
    if (i.editSettings.template) {
      i.editModule.applyFormValidation(void 0, e.form.ej2_instances[0].rules);
    }
    this.args = e;
    if (this.parent.allowTextWrap) {
      this.parent.notify(ki, { case: 'textwrap' });
    }
  };
  s.prototype.updateRow = function (e, t) {
    var i = this;
    var r = this.parent;
    this.editRowIndex = e;
    var n = this.parent.getRowByIndex(e);
    if (n) {
      var a = {
        requestType: 'save',
        action: 'edit',
        type: _,
        data: t,
        cancel: false,
        previousData: this.parent.getCurrentViewRecords()[parseInt(e.toString(), 10)],
        row: n,
      };
      this.parent.showSpinner();
      if (this.parent.enableInfiniteScrolling) {
        this.uid = a.row.getAttribute('data-uid');
        var o = parseInt(a.row.getAttribute('aria-rowindex'), 10) - 1;
        this.parent.notify(pa, { index: o });
      }
      this.parent.notify(wr, a);
      a.promise
        ? a.promise
            .then(function () {
              return this.parent.refresh();
            })
            .catch(function (l) {
              return i.edFail(l);
            })
        : this.parent.enableInfiniteScrolling ||
          (this.parent.refresh(),
          this.parent.enableVirtualization && (this.parent.contentModule.vgenerator.startIndex = null));
    }
  };
  s.prototype.editFormValidate = function () {
    var e = this.parent;
    var t = this.parent.editModule.editFormValidate();
    var i = {
      prevData: this.previousData,
      isValid: true,
      editIdx: this.editRowIndex,
      addIdx: this.addedRowIndex,
    };
    this.parent.notify(Ci, i);
    return t && true;
  };
  s.prototype.endEdit = function () {
    var e = this;
    var t = this.parent;
    if (!(!this.parent.isEdit || !this.editFormValidate())) {
      var i = E({}, {}, this.previousData, true);
      var r = E(this.args, {
        requestType: 'save',
        type: _,
        data: i,
        cancel: false,
        previousData: this.previousData,
        selectedRow: this.parent.selectedRowIndex,
        foreignKeyData: {},
      });
      var n = this.parent.editSettings.mode === 'Dialog';
      var a = Ee('#' + this.parent.element.id + '_dialogEdit_wrapper', document);
      var o = n
        ? a.querySelector('.e-gridform')
        : this.parent.editSettings.showAddNewRow && this.parent.element.querySelector('.' + Y)
          ? this.parent.element.querySelector('.' + Y).getElementsByClassName('e-gridform')[0]
          : this.parent.element.getElementsByClassName('e-gridform')[0];
      var l = {
        virtualData: E({}, {}, this.previousData, true),
        isAdd: false,
        isScroll: false,
        endEdit: true,
      };
      this.parent.notify(Ht, l);
      (this.parent.enableVirtualization ||
        this.parent.enableColumnVirtualization ||
        this.parent.enableInfiniteScrolling) &&
      this.parent.editSettings.mode === 'Normal' &&
      Object.keys(l.virtualData).length
        ? this.parent.isEdit && (this.currentVirtualData = i = r.data = l.virtualData)
        : (i = this.parent.editModule.getCurrentEditedData(o, i));
      var h = [].slice.call(this.parent.element.getElementsByClassName(Y)).length;
      if (!l.isAdd && Object.keys(this.currentVirtualData).length && !h) {
        h = 1;
      }
      if (n ? a.getElementsByClassName(Y).length : h) {
        r.action = 'edit';
        this.parent.trigger(_, r, function (d) {
          if (!d.cancel) {
            if (e.parent.loadingIndicator.indicatorType === 'Spinner') {
              this.parent.showSpinner();
            }
            if (e.parent.loadingIndicator.indicatorType === 'Shimmer') {
              e.parent.showMaskRow();
            }
            if (this.parent.editSettings.showAddNewRow) {
              e.disabledShowAddRow(true);
            }
            this.parent.notify(wr, d);
          }
        });
      } else {
        r.action = 'add';
        r.selectedRow = 0;
        r.index = this.addedRowIndex;
        this.parent.notify(bi, {});
        this.parent.notify(ee, r);
        this.addedRowIndex = null;
        if (r.cancel) return;
        if (this.parent.editSettings.showAddNewRow) {
          this.parent.notify(xi, {});
          if (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) {
            this.disabledShowAddRow(true, true);
          }
        }
      }
    }
  };
  s.prototype.destroyElements = function () {
    var e = this.parent;
    if (
      !this.parent.editSettings.showAddNewRow ||
      (this.parent.editSettings.showAddNewRow && this.parent.element.querySelector('.e-editedrow'))
    ) {
      this.parent.editModule.destroyWidgets();
      this.parent.editModule.destroyForm();
    }
    this.parent.notify(_t, {});
  };
  s.prototype.editHandler = function (e) {
    var t = this;
    e.promise
      ? e.promise
          .then(function (i) {
            return t.edSucc(i, e);
          })
          .catch(function (i) {
            return t.edFail(i);
          })
      : this.editSuccess(e.data, e);
    if (this.parent.editSettings.showAddNewRow) {
      this.parent.editModule.applyFormValidation();
    }
  };
  s.prototype.edSucc = function (e, t) {
    this.editSuccess(e, t);
  };
  s.prototype.edFail = function (e) {
    this.editFailure(e);
  };
  s.prototype.updateCurrentViewData = function (e) {
    if (!this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling) {
      this.parent.getCurrentViewRecords()[this.editRowIndex] = e;
    }
  };
  s.prototype.requestSuccess = function (e) {
    if (this.parent.editModule.formObj && !this.parent.editModule.formObj.isDestroyed) {
      this.destroyElements();
      this.stopEditStatus();
      if (this.parent.editSettings.mode === 'Dialog' && e.action !== 'add' && this.parent.selectionModule) {
        this.parent.element.querySelector('.e-dlgeditrow').classList.remove('e-dlgeditrow');
      }
    }
  };
  s.prototype.editSuccess = function (e, t) {
    if (!u(e) && !(e instanceof Array)) {
      var i = 'rowData';
      t.data = E({}, E({}, t.rowData, t.data), e);
    }
    this.requestSuccess(t);
    this.parent.trigger(fi, t);
    t.type = B;
    this.parent.isEdit = !!this.parent.editSettings.showAddNewRow;
    this.refreshRow(t.data);
    this.parent.notify(bi, t);
    this.parent.editModule.checkLastRow(t.row);
    this.parent.editModule.isLastRow = false;
    this.updateCurrentViewData(t.data);
    this.blazorTemplate();
    this.editRowIndex = null;
    if (
      this.parent.allowGrouping &&
      this.parent.groupSettings.columns.length &&
      this.parent.groupSettings.showGroupedColumn
    ) {
      for (
        var r = t.row,
          n = this.parent.getRowsObject(),
          a = r.getAttribute('data-uid'),
          o = this.parent.getRowObjectFromUID(a),
          l = function (c) {
            var f = h;
            n = n.filter(function (g) {
              var m = g.isDataRow && g !== o && !u(g.data);
              if (m) {
                for (
                  var y = h.parent.groupSettings.columns[parseInt(c.toString(), 10)].split('.'),
                    v = g.data[y[0]],
                    b = t.data[y[0]],
                    w = 1;
                  w < y.length;
                  w++
                ) {
                  v = v[y[w]];
                  b = b[y[w]];
                }
                return m && v === b;
              } else return m;
            });
          },
          h = this,
          d = 0;
        d < this.parent.groupSettings.columns.length;
        d++
      )
        l(d);
      var p = n[0];
      !u(o) && !u(n[0]) && o.parentUid !== n[0].parentUid
        ? this.parent.groupModule.groupedRowReorder(o, n[0])
        : !this.parent.groupSettings.enableLazyLoading &&
            this.parent.aggregates.length &&
            (this.parent.enableVirtualization ||
              (this.parent.allowPaging && this.parent.groupSettings.disablePageWiseAggregates))
          ? this.parent.notify(ee, {
              requestType: 'refresh-aggregate-on-save',
              action: 'update',
            })
          : this.parent.aggregates.length &&
            this.parent.aggregateModule.refresh(t.data, this.parent.groupSettings.enableLazyLoading ? t.row : void 0);
    } else
      !this.parent.groupSettings.enableLazyLoading &&
      this.parent.aggregates.length &&
      (this.parent.enableVirtualization ||
        (this.parent.allowPaging && this.parent.groupSettings.disablePageWiseAggregates))
        ? this.parent.notify(ee, {
            requestType: 'refresh-aggregate-on-save',
            action: 'update',
          })
        : this.parent.aggregates.length &&
          this.parent.aggregateModule.refresh(t.data, this.parent.groupSettings.enableLazyLoading ? t.row : void 0);
    this.parent.trigger(B, t);
    if (
      (!(this.parent.isCheckBoxSelection || this.parent.selectionSettings.type === 'Multiple') ||
        (!this.parent.isPersistSelection && !this.parent.selectionSettings.checkboxOnly)) &&
      this.parent.editSettings.mode !== 'Dialog'
    ) {
      this.parent.selectRow(this.rowIndex > -1 ? this.rowIndex : this.editRowIndex);
    }
    this.parent.notify(pt, {
      requestType: t.requestType,
      action: t.action,
    });
    if (
      !(
        this.parent.aggregates.length &&
        this.parent.groupSettings.enableLazyLoading &&
        this.parent.groupSettings.columns.length &&
        (this.parent.groupModule.getGroupAggregateTemplates(true).length ||
          this.parent.groupModule.getGroupAggregateTemplates(false).length)
      )
    ) {
      this.parent.removeMaskRow();
      this.parent.hideSpinner();
    }
  };
  s.prototype.closeForm = function () {
    if (!this.cloneRow && this.parent.isEdit) {
      this.stopEditStatus();
    }
    if (this.cloneRow) {
      this.cloneRow.remove();
      this.cloneRow = null;
      this.originalRow.classList.remove('e-hiddenrow');
    }
  };
  s.prototype.blazorTemplate = function () {
    var e = this.parent.getColumns();
    if (this.parent.editSettings.template && this.parent.editSettings.mode === 'Normal') {
      rt(this.parent.element.id + 'editSettingsTemplate', 'Template', this.parent.editSettings);
    }
    for (var t = 0; t < e.length; t++) {
      var i = e[parseInt(t.toString(), 10)];
      if (e[parseInt(t.toString(), 10)].template) {
        rt(this.parent.element.id + e[parseInt(t.toString(), 10)].uid);
      }
      if (e[parseInt(t.toString(), 10)].editTemplate) {
        rt(this.parent.element.id + e[parseInt(t.toString(), 10)].uid + 'editTemplate');
      }
    }
  };
  s.prototype.editFailure = function (e) {
    if (!e.cancel) {
      this.parent.removeMaskRow();
      this.parent.trigger(Bn, { error: e });
      this.parent.hideSpinner();
      this.parent.log('actionfailure', { error: e });
    }
  };
  s.prototype.needRefresh = function () {
    var e = true;
    var t = this.parent.element.querySelector('.e-gridform');
    if (
      (this.parent.enableVirtualization || this.parent.infiniteScrollSettings.enableCache) &&
      this.parent.editSettings.mode === 'Normal' &&
      !t
    ) {
      e = false;
    }
    return e;
  };
  s.prototype.refreshRow = function (e) {
    var t = new nt(this.serviceLocator, null, this.parent);
    var i = this.parent.getRowObjectFromUID(this.uid);
    if (i) {
      i.changes = e;
      this.parent.notify(Dn, { data: e });
      Ei(i, this.parent.getForeignKeyColumns(), i.changes);
      if (this.needRefresh()) {
        t.refresh(i, this.parent.getColumns(), true);
      }
      for (
        var r = [].slice.call(this.parent.element.querySelectorAll('[aria-rowindex="' + (i.index + 1) + '"]')), n = 0;
        n < r.length;
        n++
      ) {
        Kt(r[parseInt(n.toString(), 10)]);
        if (
          this.parent.enableColumnVirtualization &&
          r[parseInt(n.toString(), 10)].querySelectorAll('.e-leftfreeze,.e-rightfreeze,.e-fixedfreeze').length
        )
          for (
            var a = this.parent.getColumns(),
              o = [].slice.call(
                r[parseInt(n.toString(), 10)].querySelectorAll('.e-leftfreeze,.e-rightfreeze.e-fixedfreeze'),
              ),
              l = 0;
            l < o.length;
            l++
          )
            if (o[parseInt(l.toString(), 10)].classList.contains('e-leftfreeze'))
              o[parseInt(l.toString(), 10)].style.left =
                a[parseInt(l.toString(), 10)].valueX - this.parent.translateX + 'px';
            else if (o[parseInt(l.toString(), 10)].classList.contains('e-rightfreeze')) {
              var h = parseInt(o[parseInt(l.toString(), 10)].getAttribute('aria-colindex'), 10) - 1;
              o[parseInt(l.toString(), 10)].style.right =
                a[parseInt(h.toString(), 10)].valueX + this.parent.translateX + 'px';
            } else {
              o[parseInt(l.toString(), 10)].style.left =
                this.parent.leftrightColumnWidth('left') - this.parent.translateX + 'px';
              o[parseInt(l.toString(), 10)].style.right =
                this.parent.leftrightColumnWidth('right') + this.parent.translateX + 'px';
            }
      }
    }
  };
  s.prototype.closeEdit = function () {
    var e = this;
    if (
      !this.parent.isEdit ||
      (this.parent.editSettings.showAddNewRow &&
        this.parent.element.querySelector('.e-addedrow') &&
        u(this.parent.element.querySelector('.' + Y)))
    ) {
      if (this.parent.editSettings.showAddNewRow) {
        this.disabledShowAddRow(true, true);
        this.parent.notify(xi, {});
      }
      return;
    }
    var t = this.parent;
    var i = E(this.args, {
      requestType: 'cancel',
      type: _,
      cancel: false,
      data: this.previousData,
      selectedRow: t.selectedRowIndex,
    });
    t.notify(Rn, i);
    this.blazorTemplate();
    t.trigger(_, i, function (r) {
      if (!r.cancel) {
        e.parent.notify(Di, i);
        if (e.parent.editSettings.mode === 'Dialog') {
          e.parent.notify(_t, {});
        }
        r.type = B;
        if (!e.parent.editSettings.showAddNewRow) {
          t.isEdit = false;
        }
        if (t.editSettings.mode !== 'Dialog') {
          e.refreshRow(r.data);
        }
        e.stopEditStatus();
        t.isEdit = false;
        if (t.editSettings.showAddNewRow) {
          e.disabledShowAddRow(true);
          t.editModule.applyFormValidation();
          t.isEdit = true;
        }
        var n =
          t.groupSettings.enableLazyLoading &&
          t.groupSettings.columns.length &&
          !t.getContentTable().querySelector('tr.e-emptyrow');
        if (
          !t.getContentTable().querySelector('tr.e-emptyrow') &&
          !t.getContentTable().querySelector('tr.e-row') &&
          !n
        ) {
          t.renderModule.emptyRow();
        }
        if (t.editSettings.mode !== 'Dialog') {
          t.selectRow(e.rowIndex);
        }
        t.trigger(B, r);
      }
    });
  };
  s.prototype.addRecord = function (e, t) {
    var i = this;
    var r = this.parent;
    this.addedRowIndex = t = u(t) ? 0 : t;
    if (e) {
      this.parent.notify(ee, {
        requestType: 'save',
        type: _,
        data: e,
        selectedRow: 0,
        action: 'add',
        index: t,
      });
      return;
    }
    if (!this.parent.isEdit) {
      this.previousData = {};
      this.uid = '';
      var n = this.parent.getColumns();
      var a = {
        virtualData: {},
        isScroll: false,
      };
      if (!this.parent.editSettings.showAddNewRow) {
        this.parent.notify(Ht, a);
      }
      for (var o = 0; o < n.length; o++)
        if (!a.isScroll) {
          if (n[parseInt(o.toString(), 10)].field) {
            if (n[parseInt(o.toString(), 10)].type === 'string') {
              n[parseInt(o.toString(), 10)].defaultValue = this.parent.sanitize(
                n[parseInt(o.toString(), 10)].defaultValue,
              );
            }
            le.setValue(
              n[parseInt(o.toString(), 10)].field,
              n[parseInt(o.toString(), 10)].defaultValue,
              this.previousData,
            );
          }
        }
      var l = {
        cancel: false,
        foreignKeyData: {},
        requestType: 'add',
        data: this.previousData,
        type: _,
        index: t,
        rowData: this.previousData,
        target: void 0,
        isScroll: a.isScroll,
      };
      if (
        (this.parent.enableVirtualization ||
          this.parent.enableColumnVirtualization ||
          this.parent.infiniteScrollSettings.enableCache) &&
        Object.keys(a.virtualData).length
      ) {
        l.data = l.rowData = a.virtualData;
      }
      l.isScroll
        ? this.inlineAddHandler(l)
        : (this.parent.notify(Vt, {
            uid: this.uid,
            prevData: this.previousData,
            argsCreator: this.getEditArgs.bind(this),
            renderer: this.renderer,
          }),
          this.parent.editSettings.showAddNewRow
            ? this.inlineAddHandler(l)
            : this.parent.trigger(_, l, function (h) {
                if (!h.cancel) {
                  i.inlineAddHandler(h);
                }
              }));
    }
  };
  s.prototype.inlineAddHandler = function (e) {
    var t = this.parent;
    t.isEdit = true;
    if (t.editSettings.mode !== 'Dialog') {
      t.clearSelection();
    }
    this.renderer.addNew(e);
    t.editModule.applyFormValidation();
    e.type = B;
    e.row = t.element.querySelector('.' + Fe);
    if (!t.editSettings.showAddNewRow) {
      t.trigger(B, e);
    }
    if (t.editSettings.template) {
      t.editModule.applyFormValidation(void 0, e.form.ej2_instances[0].rules);
    }
    this.args = e;
  };
  s.prototype.deleteRecord = function (e, t) {
    this.editRowIndex = this.parent.selectedRowIndex;
    if (t) {
      t = t instanceof Array ? t : [t];
      var i = this.parent;
      var r = Object.keys(t).length;
      e = e || this.parent.getPrimaryKeyFieldNames()[0];
      for (
        var n = function (l) {
            var h;
            var d;
            var p = this.parent.currentViewData.some(function (c) {
              d = c;
              return t[parseInt(l.toString(), 10)] === te(e, c) || t[parseInt(l.toString(), 10)] === c;
            });
            t[parseInt(l.toString(), 10)] = p
              ? d
              : t[parseInt(l.toString(), 10)]['' + e]
                ? t[parseInt(l.toString(), 10)]
                : ((h = {}), (h[e] = t[parseInt(l.toString(), 10)]), h);
          },
          a = 0;
        a < Object.keys(t).length;
        a++
      )
        n(a);
    }
    var o = {
      requestType: 'delete',
      type: _,
      foreignKeyData: {},
      data: t || this.parent.getSelectedRecords(),
      tr: this.parent.getSelectedRows(),
      cancel: false,
    };
    if (!u(this.parent.commandDelIndex)) {
      o.data[0] = this.parent.getRowObjectFromUID(
        this.parent.getRowByIndex(this.parent.commandDelIndex).getAttribute('data-uid'),
      ).data;
    }
    this.parent.notify(ee, o);
  };
  s.prototype.stopEditStatus = function () {
    for (
      var e = this.parent,
        t = [].slice.call(e.editSettings.showAddNewRow ? [] : e.element.getElementsByClassName(Fe)),
        i = [].slice.call(e.element.getElementsByClassName(Y)),
        r = 0;
      r < t.length;
      r++
    )
      N(t[parseInt(r.toString(), 10)]);
    for (var r = 0; r < i.length; r++) i[parseInt(r.toString(), 10)].classList.remove(Y);
  };
  s.prototype.addEventListener = function () {
    if (!this.parent.isDestroyed) {
      this.evtHandlers = [
        {
          event: ua,
          handler: this.editHandler,
        },
        {
          event: An,
          handler: this.dblClickHandler,
        },
        {
          event: Ne,
          handler: this.clickHandler,
        },
        {
          event: ca,
          handler: this.requestSuccess,
        },
        {
          event: zt,
          handler: this.dblClickHandler,
        },
        {
          event: fa,
          handler: this.editComplete,
        },
        {
          event: ga,
          handler: this.editComplete,
        },
        {
          event: fn,
          handler: this.closeEdit,
        },
        {
          event: ma,
          handler: this.closeForm,
        },
        {
          event: va,
          handler: this.editComplete,
        },
      ];
      ce(this.parent, this.evtHandlers, true, this);
    }
  };
  s.prototype.removeEventListener = function () {
    if (!this.parent.isDestroyed) {
      ce(this.parent, this.evtHandlers, false);
    }
  };
  s.prototype.destroy = function () {
    this.removeEventListener();
    this.renderer.destroy();
  };
  return s;
})();
var el = (function () {
  var s = function (e, t) {
    s =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (i, r) {
          i.__proto__ = r;
        }) ||
      function (i, r) {
        for (var n in r)
          if (r.hasOwnProperty(n)) {
            i[n] = r[n];
          }
      };
    return s(e, t);
  };
  return function (e, t) {
    s(e, t);
    function i() {
      this.constructor = e;
    }
    e.prototype = t === null ? Object.create(t) : ((i.prototype = t.prototype), new i());
  };
})();
var Nr = (function (s) {
  el(e, s);
  function e(t, i, r) {
    var n = s(t, i) || this;
    n.parent = t;
    n.serviceLocator = i;
    n.renderer = r;
    return n;
  }
  e.prototype.closeEdit = function () {
    s.prototype.closeEdit();
  };
  e.prototype.addRecord = function (t, i) {
    s.prototype.addRecord(t, i);
  };
  e.prototype.endEdit = function () {
    s.prototype.endEdit();
  };
  e.prototype.updateRow = function (t, i) {
    s.prototype.updateRow(t, i);
  };
  e.prototype.deleteRecord = function (t, i) {
    s.prototype.deleteRecord(t, i);
  };
  e.prototype.startEdit = function (t) {
    s.prototype.startEdit(t);
  };
  return e;
})(Vn);
var tl = (function () {
  function s(e, t, i) {
    this.cellDetails = {};
    this.originalCell = {};
    this.cloneCell = {};
    this.editNext = false;
    this.preventSaveCell = false;
    this.initialRender = true;
    this.validationColObj = [];
    this.addBatchRow = false;
    this.prevEditedBatchCell = false;
    this.parent = e;
    this.serviceLocator = t;
    this.renderer = i;
    this.focus = t.getService('focus');
    this.addEventListener();
  }
  s.prototype.addEventListener = function () {
    if (!this.parent.isDestroyed) {
      this.evtHandlers = [
        {
          event: Ne,
          handler: this.clickHandler,
        },
        {
          event: zt,
          handler: this.dblClickHandler,
        },
        {
          event: ya,
          handler: this.onBeforeCellFocused,
        },
        {
          event: Sa,
          handler: this.onCellFocused,
        },
        {
          event: An,
          handler: this.dblClickHandler,
        },
        {
          event: be,
          handler: this.keyDownHandler,
        },
        {
          event: Ri,
          handler: this.editNextValCell,
        },
        {
          event: M,
          handler: this.destroy,
        },
      ];
      ce(this.parent, this.evtHandlers, true, this);
      R.add(this.parent.element, 'mousedown', this.mouseDownHandler, this);
      this.dataBoundFunction = this.dataBound.bind(this);
      this.batchCancelFunction = this.batchCancel.bind(this);
      this.parent.addEventListener(Pe, this.dataBoundFunction);
      this.parent.addEventListener(xt, this.batchCancelFunction);
    }
  };
  s.prototype.removeEventListener = function () {
    if (!this.parent.isDestroyed) {
      ce(this.parent, this.evtHandlers, false);
      R.remove(this.parent.element, 'mousedown', this.mouseDownHandler);
      this.parent.removeEventListener(Pe, this.dataBoundFunction);
      this.parent.removeEventListener(xt, this.batchCancelFunction);
    }
  };
  s.prototype.batchCancel = function () {
    this.parent.focusModule.restoreFocus({ requestType: 'batchCancel' });
  };
  s.prototype.dataBound = function () {
    this.parent.notify(Me, {});
  };
  s.prototype.destroy = function () {
    this.removeEventListener();
  };
  s.prototype.mouseDownHandler = function (e) {
    u(this.parent.element.querySelector('.e-gridform'))
      ? (this.mouseDownElement = void 0)
      : (this.mouseDownElement = e.target);
  };
  s.prototype.clickHandler = function (e) {
    if (!S(e.target, this.parent.element.id + '_add', true)) {
      if (
        (this.parent.isEdit && T(this.form, 'td') !== T(e.target, 'td') && u(this.mouseDownElement)) ||
        this.mouseDownElement === e.target
      ) {
        this.saveCell();
        this.editNextValCell();
      }
      if (S(e.target, ie) && !this.parent.isEdit) {
        this.setCellIdx(e.target);
      }
    }
  };
  s.prototype.dblClickHandler = function (e) {
    var t = S(e.target, ie);
    var i = S(e.target, de);
    var r = i && parseInt(i.getAttribute(q), 10) - 1;
    var n = t && parseInt(t.getAttribute(kt), 10) - 1;
    if (
      !u(t) &&
      !u(r) &&
      !isNaN(n) &&
      !t.parentElement.classList.contains(Y) &&
      this.parent.getColumns()[parseInt(n.toString(), 10)].allowEditing
    ) {
      this.editCell(r, this.parent.getColumns()[parseInt(n.toString(), 10)].field, this.isAddRow(r));
    }
  };
  s.prototype.onBeforeCellFocused = function (e) {
    if (
      this.parent.isEdit &&
      this.validateFormObj() &&
      (e.byClick || ['tab', 'shiftTab', 'enter', 'shiftEnter'].indexOf(e.keyArgs.action) > -1)
    ) {
      e.cancel = true;
      e.byClick ? e.clickArgs.preventDefault() : e.keyArgs.preventDefault();
    }
  };
  s.prototype.onCellFocused = function (e) {
    var t = (!e.container.isContent || !e.container.isDataCell) && !(this.parent.frozenRows && e.container.isHeader);
    if (this.parent.focusModule.active) {
      this.prevEditedBatchCell =
        this.parent.focusModule.active.matrix.current.toString() === this.prevEditedBatchCellMatrix().toString();
      this.crtRowIndex = [].slice.call(this.parent.focusModule.active.getTable().rows).indexOf(T(e.element, 'tr'));
    }
    if (!e.byKey || t) {
      if (this.parent.isEdit && t) {
        this.saveCell();
      }
      return;
    }
    var i = e.container.indexes;
    var r = e.container.indexes[0];
    var n = e.container.indexes[1];
    var a = e.element.getAttribute('aria-colindex') ? parseInt(e.element.getAttribute('aria-colindex'), 10) - 1 : n;
    if (a !== n) {
      n = a;
    }
    if (this.parent.frozenRows && e.container.isContent) {
      r +=
        (this.parent.getContent().querySelector('.e-hiddenrow') ? 0 : this.parent.frozenRows) +
        this.parent.getHeaderContent().querySelectorAll('.e-insertedrow').length;
    }
    var o = this.parent.isEdit;
    if (!this.parent.element.getElementsByClassName('e-popup-open').length)
      switch (((o = o && !this.validateFormObj()), e.keyArgs.action)) {
        case 'tab':
        case 'shiftTab':
          {
            var l =
              this.parent.isRowDragable() && this.parent.isDetail()
                ? 2
                : this.parent.isRowDragable() || this.parent.isDetail()
                  ? 1
                  : 0;
            var h = this.parent.getColumns()[n - l];
          }
          {
            if (h && !this.parent.isEdit) {
              this.editCell(r, h.field);
            }
            if (o || this.parent.isLastCellPrimaryKey) {
              this.editCellFromIndex(r, n);
            }
          }
          break;
        case 'enter':
        case 'shiftEnter':
          e.keyArgs.preventDefault();
          var d = {
            cancel: false,
            keyArgs: e.keyArgs,
          };
          {
            this.parent.notify('beforeFocusCellEdit', d);
            if (!d.cancel && o) {
              this.editCell(r, this.cellDetails.column.field);
            }
          }
          break;
        case 'f2':
          {
            this.editCellFromIndex(r, n);
            this.focus.focus();
          }
          break;
      }
  };
  s.prototype.isAddRow = function (e) {
    return this.parent.getDataRows()[parseInt(e.toString(), 10)].classList.contains('e-insertedrow');
  };
  s.prototype.editCellFromIndex = function (e, t) {
    this.cellDetails.rowIndex = e;
    this.cellDetails.cellIndex = t;
    this.editCell(e, this.parent.getColumns()[parseInt(t.toString(), 10)].field, this.isAddRow(e));
  };
  s.prototype.closeEdit = function () {
    var e = this.parent;
    var t = this.parent.getRowsObject();
    var i = {
      cancel: false,
      batchChanges: this.getBatchChanges(),
    };
    this.parent.notify(wa, i);
    if (!i.cancel) {
      if (this.parent.isEdit) {
        this.saveCell(true);
      }
      this.isAdded = false;
      var r = [];
      if (this.parent.selectionModule) {
        r = this.parent.selectionModule.selectedRowIndexes;
      }
      this.parent.clearSelection();
      for (var n = 0; n < t.length; n++) {
        var a = false;
        var o = t[parseInt(n.toString(), 10)].isDirty;
        a = this.removeBatchElementChanges(t[parseInt(n.toString(), 10)], t[parseInt(n.toString(), 10)].isDirty);
        if (a) {
          t.splice(n, 1);
        }
        if (a) {
          n--;
        }
      }
      if (!this.parent.getContentTable().querySelector('tr.e-row')) {
        this.parent.renderModule.renderEmptyRow();
      }
      var l = {
        requestType: 'batchCancel',
        rows: this.parent.getRowsObject(),
      };
      this.parent.notify(xt, {
        rows: this.parent.getRowsObject().length
          ? this.parent.getRowsObject()
          : [
              new yt({
                isDataRow: true,
                cells: [
                  new ze({
                    isDataCell: true,
                    visible: true,
                  }),
                ],
              }),
            ],
      });
      this.parent.isCheckBoxSelection &&
      (this.parent.selectionSettings.checkboxOnly || this.parent.selectionSettings.persistSelection)
        ? this.parent.selectRows(r)
        : this.parent.selectRow(this.cellDetails.rowIndex);
      this.refreshRowIdx();
      this.parent.notify(Me, {});
      this.parent.notify(Ut, {});
      l = {
        requestType: 'batchCancel',
        rows: this.parent.getRowsObject(),
      };
      this.parent.trigger(xt, l);
    }
  };
  s.prototype.removeBatchElementChanges = function (e, t) {
    var i = this.parent;
    var r = new nt(this.serviceLocator, null, this.parent);
    var n = false;
    if (t) {
      e.isDirty = t;
      var a = this.parent.getRowElementByUID(e.uid);
      if (
        a &&
        (a.classList.contains('e-insertedrow')
          ? (N(a), (n = true))
          : (Ei(e, this.parent.getForeignKeyColumns(), e.data),
            delete e.changes,
            delete e.edit,
            (e.isDirty = false),
            G(a, [], ['e-hiddenrow', 'e-updatedtd']),
            r.refresh(e, this.parent.getColumns(), false)),
        this.parent.aggregates.length > 0)
      ) {
        var o = 'type';
        var l = [];
        l.type = 'cancel';
        this.parent.notify(Le, l);
        if (this.parent.groupSettings.columns.length > 0) {
          this.parent.notify(Ot, l);
        }
      }
    }
    return n;
  };
  s.prototype.deleteRecord = function (e, t) {
    this.saveCell();
    if (this.validateFormObj()) {
      this.saveCell(true);
    }
    this.isAdded = false;
    this.bulkDelete(e, t);
    if (this.parent.aggregates.length > 0) {
      if (!(this.parent.isReact || this.parent.isVue)) {
        this.parent.notify(Le, {});
      }
      if (this.parent.groupSettings.columns.length > 0) {
        this.parent.notify(Ot, {});
      }
      if (this.parent.isReact || this.parent.isVue) {
        this.parent.notify(Le, {});
      }
    }
  };
  s.prototype.addRecord = function (e) {
    this.bulkAddRow(e);
  };
  s.prototype.endEdit = function () {
    if (!(this.parent.isEdit && this.validateFormObj())) {
      this.batchSave();
    }
  };
  s.prototype.validateFormObj = function () {
    return this.parent.editModule.formObj && !this.parent.editModule.formObj.validate();
  };
  s.prototype.batchSave = function () {
    var e = this.parent;
    var t = 'deletedRecords';
    if (this.parent.isCheckBoxSelection) {
      var i = this.parent.element.querySelector('.e-checkselectall').parentElement;
      if (
        this.parent.element
          .querySelector('.e-checkselectall')
          .parentElement.classList.contains('e-checkbox-disabled') &&
        this.parent.pageSettings.totalRecordsCount > this.parent.currentViewData.length
      ) {
        Q([this.parent.element.querySelector('.e-checkselectall').parentElement], ['e-checkbox-disabled']);
      }
    }
    this.saveCell();
    if (!(this.parent.isEdit || this.editNextValCell() || this.parent.isEdit)) {
      var r = this.getBatchChanges();
      if (
        this.parent.selectionSettings.type === 'Multiple' &&
        r.deletedRecords.length &&
        this.parent.selectionSettings.persistSelection
      ) {
        r.deletedRecords = this.removeSelectedData;
        this.removeSelectedData = [];
      }
      var n = {
        changedRecords: this.parent
          .getRowsObject()
          .filter(function (o) {
            return o.isDirty && ['add', 'delete'].indexOf(o.edit) === -1;
          })
          .map(function (o) {
            return o.data;
          }),
      };
      var a = {
        batchChanges: r,
        cancel: false,
      };
      this.parent.trigger(ba, a, function (o) {
        if (!o.cancel) {
          this.parent.showSpinner();
          this.parent.notify(Ca, {
            changes: r,
            original: n,
          });
        }
      });
    }
  };
  s.prototype.getBatchChanges = function () {
    for (
      var e = {
          addedRecords: [],
          deletedRecords: [],
          changedRecords: [],
        },
        t = this.parent.getRowsObject(),
        i = 0,
        r = t;
      i < r.length;
      i++
    ) {
      var n = r[i];
      if (r[i].isDirty)
        switch (r[i].edit) {
          case 'add':
            e.addedRecords.push(r[i].changes);
            break;
          case 'delete':
            e.deletedRecords.push(r[i].data);
            break;
          default:
            e.changedRecords.push(r[i].changes);
        }
    }
    return e;
  };
  s.prototype.removeRowObjectFromUID = function (e) {
    for (
      var t = this.parent.getRowsObject(), i = 0, r = t.length;
      i < r && t[parseInt(i.toString(), 10)].uid !== e;
      i++
    );
    t.splice(i, 1);
  };
  s.prototype.addRowObject = function (e) {
    var t = this.parent;
    var i = this.parent.editSettings.newRowPosition === 'Top';
    var r = e.clone();
    i ? this.parent.getRowsObject().unshift(r) : this.parent.getRowsObject().push(r);
  };
  s.prototype.bulkDelete = function (e, t) {
    var i = this;
    this.removeSelectedData = [];
    var r = this.parent;
    var n = this.parent.selectedRowIndex;
    var a = this.parent.getSelectedRows();
    var o = {
      primaryKey: this.parent.getPrimaryKeyFieldNames(),
      rowIndex: n,
      rowData: t || this.parent.getSelectedRecords(),
      cancel: false,
    };
    t
      ? (o.row = this.parent.editModule.deleteRowUid
          ? this.parent.getRowElementByUID(this.parent.editModule.deleteRowUid)
          : this.parent.getRows()[this.parent.getCurrentViewRecords().indexOf(t)])
      : (o.row = a);
    if (o.row) {
      this.parent.trigger(Ia, o, function (l) {
        if (!l.cancel) {
          i.removeSelectedData = this.parent.getSelectedRecords();
          this.parent.clearSelection();
          l.row = l.row ? l.row : t ? this.parent.getRows()[parseInt(n.toString(), 10)] : a;
          if (a.length === 1 || t) {
            if (Array.isArray(l.row)) {
              l.row = l.row[0];
            }
            var h = l.row.getAttribute('data-uid');
            h = t && i.parent.editModule.deleteRowUid ? (h = i.parent.editModule.deleteRowUid) : h;
            if (l.row.classList.contains('e-insertedrow')) {
              i.removeRowObjectFromUID(h);
              N(l.row);
            } else {
              var d = this.parent.getRowObjectFromUID(h);
              d.isDirty = true;
              d.edit = 'delete';
              G(l.row, ['e-hiddenrow', 'e-updatedtd'], []);
              if (
                this.parent.frozenRows &&
                n < this.parent.frozenRows &&
                this.parent.getDataRows().length >= this.parent.frozenRows
              ) {
                this.parent
                  .getHeaderTable()
                  .querySelector(U)
                  .appendChild(this.parent.getRowByIndex(this.parent.frozenRows - 1));
              }
            }
            delete l.row;
          } else {
            if (t) {
              n = parseInt(l.row.getAttribute(q), 10) - 1;
            }
            for (var p = 0; p < a.length; p++) {
              var c = a[parseInt(p.toString(), 10)].getAttribute('data-uid');
              if (a[parseInt(p.toString(), 10)].classList.contains('e-insertedrow')) {
                i.removeRowObjectFromUID(c);
                N(a[parseInt(p.toString(), 10)]);
              } else {
                G(a[parseInt(p.toString(), 10)], ['e-hiddenrow', 'e-updatedtd'], []);
                var f = this.parent.getRowObjectFromUID(c);
                f.isDirty = true;
                f.edit = 'delete';
                if (
                  this.parent.frozenRows &&
                  n < this.parent.frozenRows &&
                  this.parent.getDataRows().length >= this.parent.frozenRows
                ) {
                  this.parent
                    .getHeaderTable()
                    .querySelector(U)
                    .appendChild(this.parent.getRowByIndex(this.parent.frozenRows - 1));
                }
              }
            }
            delete l.row;
          }
          i.refreshRowIdx();
          if (t) {
            this.parent.editModule.deleteRowUid = void 0;
          }
          if (!this.parent.isCheckBoxSelection) {
            this.parent.selectRow(n);
          }
          this.parent.trigger(br, l);
          this.parent.notify(br, { rows: i.parent.getRowsObject() });
          this.parent.focusModule.restoreFocus({ requestType: 'batchDelete' });
          this.parent.notify(Me, {});
          if (!this.parent.getContentTable().querySelector('tr.e-row')) {
            this.parent.renderModule.renderEmptyRow();
          }
        }
      });
    }
  };
  s.prototype.refreshRowIdx = function () {
    for (
      var e = this.parent,
        t = e.getAllDataRows(true),
        i = e.getRowsObject().filter(function (o) {
          return !o.isDetailRow;
        }),
        r = 0,
        n = 0,
        a = t.length;
      r < a;
      r++
    )
      t[parseInt(r.toString(), 10)].classList.contains(de) &&
      !t[parseInt(r.toString(), 10)].classList.contains('e-hiddenrow')
        ? (t[parseInt(r.toString(), 10)].setAttribute(q, (n + 1).toString()),
          (i[parseInt(r.toString(), 10)].index = n),
          n++)
        : (t[parseInt(r.toString(), 10)].removeAttribute(q), (i[parseInt(r.toString(), 10)].index = -1));
  };
  s.prototype.bulkAddRow = function (e) {
    var t = this;
    var i = this.parent;
    if (!this.parent.editSettings.allowAdding) {
      if (this.parent.isEdit) {
        this.saveCell();
      }
      return;
    }
    if (this.parent.isEdit) {
      this.saveCell();
      this.parent.notify(Ri, {});
    }
    if (!this.validateFormObj()) {
      if (this.initialRender) {
        for (var r = this.parent.getVisibleColumns(), n = 0; n < r.length; n++)
          if (r[parseInt(n.toString(), 10)].validationRules && r[parseInt(n.toString(), 10)].validationRules.required) {
            var a = {
              field: r[parseInt(n.toString(), 10)].field.slice(),
              cellIdx: n,
            };
            this.validationColObj.push(a);
          }
        this.initialRender = false;
      }
      this.parent.element.classList.add('e-editing');
      var o = e || this.getDefaultData();
      var l = {
        defaultData: o,
        primaryKey: this.parent.getPrimaryKeyFieldNames(),
        cancel: false,
      };
      this.parent.trigger(xa, l, function (h) {
        if (!h.cancel) {
          t.isAdded = true;
          this.parent.clearSelection();
          var d = new nt(t.serviceLocator, null, t.parent);
          var p = new Mi(t.parent);
          var c = p.generateRows([h.defaultData]);
          var f = d.render(c[0], this.parent.getColumns());
          Kt(f);
          for (var g, m, y = 0; y < t.parent.groupSettings.columns.length; y++) {
            f.insertBefore(t.parent.createElement('td', { className: 'e-indentcell' }), f.firstChild);
            c[0].cells.unshift(new ze({ cellType: P.Indent }));
          }
          var v = this.parent.getContentTable().querySelector(U);
          f.classList.add('e-insertedrow');
          if (v.querySelector('.e-emptyrow')) {
            var b = v.querySelector('.e-emptyrow');
            b.parentNode.removeChild(b);
            if (this.parent.frozenRows && this.parent.element.querySelector('.e-frozenrow-empty')) {
              this.parent.element.querySelector('.e-frozenrow-empty').classList.remove('e-frozenrow-empty');
            }
          }
          this.parent.frozenRows && this.parent.editSettings.newRowPosition === 'Top'
            ? (v = this.parent.getHeaderTable().querySelector(U))
            : (v = this.parent.getContentTable().querySelector(U));
          t.parent.editSettings.newRowPosition === 'Top' ? v.insertBefore(f, v.firstChild) : v.appendChild(f);
          j([].slice.call(f.getElementsByClassName(ie)), ['e-updatedtd']);
          c[0].isDirty = true;
          c[0].changes = E({}, {}, c[0].data, true);
          c[0].edit = 'add';
          t.addRowObject(c[0]);
          t.refreshRowIdx();
          t.focus.forgetPrevious();
          this.parent.notify(Cr, { rows: t.parent.getRowsObject() });
          var w = t.getBatchChanges();
          var C = t.getBottomIndex();
          t.parent.editSettings.newRowPosition === 'Top' ? this.parent.selectRow(0) : this.parent.selectRow(C);
          if (!e) {
            m = t.findNextEditableCell(0, true);
            g = this.parent.getColumns()[parseInt(m.toString(), 10)];
            t.parent.editSettings.newRowPosition === 'Top'
              ? t.editCell(0, g.field, true)
              : t.editCell(C, g.field, true);
          }
          if (t.parent.aggregates.length > 0 && (e || w[it].length)) {
            t.parent.notify(Le, {});
          }
          var I = {
            defaultData: h.defaultData,
            row: f,
            columnObject: g,
            columnIndex: m,
            primaryKey: h.primaryKey,
            cell: u(m) ? void 0 : f.cells[parseInt(m.toString(), 10)],
          };
          this.parent.trigger(Cr, I);
        }
      });
    }
  };
  s.prototype.findNextEditableCell = function (e, t, i) {
    for (var r = this.parent.getColumns(), n = r.length, a, o = e; o < n; o++) {
      a = i ? u(r[parseInt(o.toString(), 10)].validationRules) : false;
      if (
        t &&
        (!r[parseInt(o.toString(), 10)].template || r[parseInt(o.toString(), 10)].field) &&
        r[parseInt(o.toString(), 10)].allowEditing &&
        r[parseInt(o.toString(), 10)].visible &&
        !(r[parseInt(o.toString(), 10)].isIdentity && r[parseInt(o.toString(), 10)].isPrimaryKey) &&
        !a
      )
        return o;
    }
    return -1;
  };
  s.prototype.getDefaultData = function () {
    for (
      var e = this.parent,
        t = {},
        i = {
          number: 0,
          string: null,
          boolean: false,
          date: null,
          datetime: null,
          dateonly: null,
        },
        r = 0,
        n = e.columnModel;
      r < n.length;
      r++
    ) {
      var a = n[r];
      if (n[r].field) {
        Ir(n[r].field, Object.keys(n[r]).indexOf('defaultValue') >= 0 ? n[r].defaultValue : i[n[r].type], t);
      }
    }
    return t;
  };
  s.prototype.setCellIdx = function (e) {
    var t = 0;
    if (this.parent.allowGrouping) {
      t = this.parent.groupSettings.columns.length;
    }
    this.cellDetails.cellIndex = e.cellIndex - t;
    this.cellDetails.rowIndex = parseInt(e.getAttribute('data-index'), 10);
  };
  s.prototype.editCell = function (e, t, i) {
    var r = this.parent;
    var n = this.parent.getColumnByField(t);
    this.index = e;
    this.field = t;
    this.isAdd = i;
    var a = this.parent.getDataRows();
    a = a.filter(function (h) {
      return h.style.display !== 'none' && !h.classList.contains('e-childrow-hidden');
    });
    var o = parseInt(a[a.length - 1].getAttribute('aria-rowindex'), 10) - 1;
    var l =
      this.parent.isEdit &&
      !(this.cellDetails.column.field === t && this.cellDetails.rowIndex === e && o !== e && this.prevEditedBatchCell);
    if (this.parent.editSettings.allowEditing) {
      !l &&
      (n.allowEditing ||
        (!n.allowEditing &&
          this.parent.focusModule.active &&
          this.parent.focusModule.active.getTable().rows[this.crtRowIndex] &&
          this.parent.focusModule.active.getTable().rows[this.crtRowIndex].classList.contains('e-insertedrow')))
        ? this.editCellExtend(e, t, i)
        : l && ((this.editNext = true), this.saveCell());
    }
  };
  s.prototype.editCellExtend = function (e, t, i) {
    var r = this;
    var n = this.parent;
    var a = n.getColumnByField(t);
    var o = n.getPrimaryKeyFieldNames();
    if (!n.isEdit) {
      var l = E({}, {}, this.getDataByIndex(e), true);
      var h = n.getDataRows()[parseInt(e.toString(), 10)];
      l = E({}, {}, this.getDataByIndex(e), true);
      if (
        (o[0] === a.field && !n.getDataRows()[parseInt(e.toString(), 10)].classList.contains('e-insertedrow')) ||
        a.columns ||
        (a.isPrimaryKey && a.isIdentity) ||
        a.commands
      ) {
        this.parent.isLastCellPrimaryKey = true;
        return;
      }
      this.parent.isLastCellPrimaryKey = false;
      this.parent.element.classList.add('e-editing');
      var d = n.getRowObjectFromUID(n.getDataRows()[parseInt(e.toString(), 10)].getAttribute('data-uid'));
      var p = [].slice.apply(n.getDataRows()[parseInt(e.toString(), 10)].cells);
      var c = {
        columnName: a.field,
        isForeignKey: !u(a.foreignKeyValue),
        primaryKey: o,
        rowData: l,
        validationRules: E({}, a.validationRules ? a.validationRules : {}),
        value: te(a.field, l),
        type: i ? 'add' : 'edit',
        cancel: false,
        foreignKeyData: d && d.foreignKeyData,
      };
      c.cell = p[this.getColIndex(p, this.getCellIdx(a.uid))];
      c.row = n.getDataRows()[parseInt(e.toString(), 10)];
      c.columnObject = a;
      if (c.cell) {
        n.trigger(Ea, c, function (f) {
          if (!f.cancel) {
            f.cell = f.cell ? f.cell : p[r.getColIndex(p, r.getCellIdx(a.uid))];
            f.row = f.row ? f.row : n.getDataRows()[parseInt(e.toString(), 10)];
            f.columnObject = f.columnObject ? f.columnObject : a;
            r.cellDetails = {
              rowData: l,
              column: a,
              value: f.value,
              isForeignKey: f.isForeignKey,
              rowIndex: e,
              cellIndex: parseInt(f.cell.getAttribute(kt), 10) - 1,
              foreignKeyData: f.foreignKeyData,
            };
            if (f.cell.classList.contains('e-updatedtd')) {
              r.isColored = true;
              f.cell.classList.remove('e-updatedtd');
            }
            n.isEdit = true;
            var g = !u(f.row.querySelector('.e-selectionbackground'));
            n.clearSelection();
            if ((!n.isCheckBoxSelection || !n.isPersistSelection) && (g || !n.selectionSettings.checkboxOnly)) {
              n.selectRow(r.cellDetails.rowIndex, true);
            }
            r.renderer.update(f);
            r.parent.notify(Da, f);
            r.form = Ee('#' + n.element.id + 'EditForm', n.element);
            n.editModule.applyFormValidation([a]);
            r.parent.element.querySelector('.e-gridpopup').style.display = 'none';
          }
        });
      }
    }
  };
  s.prototype.updateCell = function (e, t, i) {
    var r = this.parent;
    var n = this.parent.getColumnByField(t);
    var a = this.parent.getColumnIndexByField(t);
    var o =
      this.parent.getRowByIndex(e).classList.contains('e-insertedrow') &&
      this.parent.getRowByIndex(e).classList.contains('e-batchrow');
    if (n && (!n.isPrimaryKey || o) && n.allowEditing) {
      var l = this.parent.isSpan ? Ra(this.parent, e, a) : Fa(this.parent, n, e, a);
      if (this.parent.isSpan && !l) return;
      var h = this.parent.getRowObjectFromUID(l.parentElement.getAttribute('data-uid'));
      if (
        this.parent.isEdit ||
        (!h.changes &&
          ((!(i instanceof Date) && h.data['' + t] !== i) ||
            (i instanceof Date && new Date(h.data['' + t]).toString() !== new Date(i).toString()))) ||
        (h.changes &&
          ((!(i instanceof Date) && h.changes['' + t] !== i) ||
            (i instanceof Date && new Date(h.changes['' + t]).toString() !== new Date(i).toString())))
      ) {
        this.refreshTD(l, n, h, i);
        var d =
          this.parent.parentDetails &&
          this.parent.parentDetails.parentInstObj &&
          this.parent.parentDetails.parentInstObj.isReact;
        if (
          ((this.parent.isReact && this.parent.requireTemplateRef) ||
            (d && this.parent.parentDetails.parentInstObj.requireTemplateRef)) &&
          n.template
        ) {
          var p = this;
          var c = this.newReactTd;
          p.parent.renderTemplates(function () {
            p.parent.trigger(si, {
              cell: this.newReactTd || l,
              column: n,
              data: h.changes,
            });
          });
        } else
          (this.parent.isReact || d) && n.template
            ? (this.parent.renderTemplates(),
              this.parent.trigger(si, {
                cell: this.newReactTd || l,
                column: n,
                data: h.changes,
              }))
            : this.parent.trigger(si, {
                cell: this.newReactTd || l,
                column: n,
                data: h.changes,
              });
      }
    }
  };
  s.prototype.setChanges = function (e, t, i) {
    if (!e.changes) {
      e.changes = E({}, {}, e.data, true);
    }
    if (!u(t)) {
      if (typeof i == 'string') {
        i = this.parent.sanitize(i);
      }
      le.setValue(t, i, e.changes);
    }
    if (e.data['' + t] !== i) {
      var r = this.parent.getColumnByField(t).type;
      this.parent.getColumnByField(t).type === 'date' || this.parent.getColumnByField(t).type === 'datetime'
        ? new Date(e.data['' + t]).toString() !== new Date(i).toString() && (e.isDirty = true)
        : (e.isDirty = true);
    }
  };
  s.prototype.updateRow = function (e, t) {
    for (var i = Object.keys(t), r = 0, n = i; r < n.length; r++) {
      var a = n[r];
      this.updateCell(e, n[r], t['' + n[r]]);
    }
  };
  s.prototype.getCellIdx = function (e) {
    var t = this.parent.getColumnIndexByUid(e) + this.parent.groupSettings.columns.length;
    if (!u(this.parent.detailTemplate) || !u(this.parent.childGrid)) {
      t++;
    }
    if (this.parent.isRowDragable()) {
      t++;
    }
    return t;
  };
  s.prototype.refreshTD = function (e, t, i, r) {
    var n = new Oi(this.parent, this.serviceLocator);
    r = t.type === 'number' && !u(r) ? parseFloat(r) : r;
    if (i) {
      this.setChanges(i, t.field, r);
      Ei(i, this.parent.getForeignKeyColumns(), i.changes);
    }
    var a = i ? i.cells : void 0;
    var o;
    var l;
    if (this.parent.isReact) {
      o = e.parentElement;
      l = e.cellIndex;
    }
    var h = 0;
    if (i) {
      n.refreshTD(e, a[this.getCellIdx(t.uid) - 0], i.changes, { index: this.getCellIdx(t.uid) });
    }
    this.parent.isReact
      ? ((this.newReactTd = o.cells[parseInt(l.toString(), 10)]),
        o.cells[parseInt(l.toString(), 10)].classList.add('e-updatedtd'))
      : e.classList.add('e-updatedtd');
    e.classList.add('e-updatedtd');
    this.parent.notify(Me, {});
  };
  s.prototype.getColIndex = function (e, t) {
    var i = 0;
    if (this.parent.allowGrouping && this.parent.groupSettings.columns) {
      i = this.parent.groupSettings.columns.length;
    }
    if (!u(this.parent.detailTemplate) || !u(this.parent.childGrid)) {
      i++;
    }
    if (this.parent.isRowDragable()) {
      i++;
    }
    for (var r = 0; r < e.length; r++) {
      var n = parseInt(e[parseInt(r.toString(), 10)].getAttribute(kt), 10) - 1;
      if (n === t - i) return r;
    }
    return -1;
  };
  s.prototype.editNextValCell = function () {
    var e = this.parent;
    var t = this.parent.element.querySelectorAll('.e-insertedrow');
    var i = t.length === 1;
    if (i && this.isAdded && !this.parent.isEdit) {
      for (var r = this.getBottomIndex(), n = this.cellDetails.cellIndex; n < this.parent.getColumns().length; n++) {
        if (this.parent.isEdit) return;
        var a = this.findNextEditableCell(this.cellDetails.cellIndex + 1, true, true);
        var o = this.parent.getColumns()[parseInt(a.toString(), 10)];
        if (this.parent.getColumns()[parseInt(a.toString(), 10)]) {
          if (this.parent.editSettings.newRowPosition === 'Bottom')
            this.editCell(r, this.parent.getColumns()[parseInt(a.toString(), 10)].field, true);
          else {
            var l = {
              index: 0,
              column: this.parent.getColumns()[parseInt(a.toString(), 10)],
            };
            this.parent.notify(Ta, l);
            this.editCell(l.index, this.parent.getColumns()[parseInt(a.toString(), 10)].field, true);
          }
          this.saveCell();
        }
      }
      if (!this.parent.isEdit) {
        this.isAdded = false;
      }
    } else if (!i && this.isAdded && !this.parent.isEdit) {
      for (var n = 0; n < t.length && !this.parent.isEdit; n++)
        for (var h = 0; h < this.validationColObj.length && !this.parent.isEdit; h++)
          if (
            t[parseInt(n.toString(), 10)].querySelectorAll(
              'td:not(.e-hide, .e-rowdragdrop, .e-detailrowcollapse, .e-detailrowexpand, .e-indentcell)',
            )[this.validationColObj[parseInt(h.toString(), 10)].cellIdx].innerHTML === ''
          ) {
            this.editCell(
              parseInt(t[parseInt(n.toString(), 10)].getAttribute('aria-rowindex'), 10) - 1,
              this.validationColObj[parseInt(h.toString(), 10)].field,
            );
            if (this.validateFormObj()) {
              this.saveCell();
            }
          }
      if (!this.parent.isEdit) {
        this.isAdded = false;
      }
    }
  };
  s.prototype.escapeCellEdit = function () {
    var e = this.generateCellArgs();
    e.value = e.previousValue;
    if (e.value || !this.cellDetails.column.validationRules) {
      this.successCallBack(e, e.cell.parentElement, e.column, true)(e);
    }
  };
  s.prototype.generateCellArgs = function () {
    var e = this.parent;
    this.parent.element.classList.remove('e-editing');
    var t = this.cellDetails.column;
    var i = {};
    i[this.cellDetails.column.field] = te(this.cellDetails.column.field, this.cellDetails.rowData);
    var r = this.parent.editModule.getCurrentEditedData(this.form, i);
    var n = E({}, r);
    r = E({}, r, this.cellDetails.rowData);
    var a = te(this.cellDetails.column.field, n);
    if (!u(this.cellDetails.column.field) && !an(a)) {
      Ir(this.cellDetails.column.field, a, r);
    }
    var o = {
      columnName: this.cellDetails.column.field,
      value: te(this.cellDetails.column.field, r),
      rowData: this.cellDetails.rowData,
      column: this.cellDetails.column,
      previousValue: this.cellDetails.value,
      isForeignKey: this.cellDetails.isForeignKey,
      cancel: false,
    };
    o.cell = this.form.parentElement;
    o.columnObject = this.cellDetails.column;
    return o;
  };
  s.prototype.saveCell = function (e) {
    if (!(this.preventSaveCell || !this.form)) {
      var t = this.parent;
      if (!(!e && (!this.parent.isEdit || this.validateFormObj()))) {
        this.preventSaveCell = true;
        var i = this.generateCellArgs();
        var r = i.cell.parentElement;
        var n = i.column;
        i.cell.removeAttribute('aria-label');
        e
          ? this.successCallBack(i, i.cell.parentElement, i.column)(i)
          : (this.parent.trigger(Oa, i, this.successCallBack(i, i.cell.parentElement, i.column)),
            this.parent.notify(Ba, { formObj: this.form }));
      }
    }
  };
  s.prototype.successCallBack = function (e, t, i, r) {
    var n = this;
    return function (a) {
      var o = n.parent;
      a.cell = a.cell ? a.cell : n.form.parentElement;
      a.columnObject = a.columnObject ? a.columnObject : i;
      if (a.cancel) {
        n.preventSaveCell = false;
        if (n.editNext) {
          n.editNext = false;
          if (n.cellDetails.rowIndex === n.index && n.cellDetails.column.field === n.field) return;
          n.editCellExtend(n.index, n.field, n.isAdd);
        }
        return;
      }
      o.editModule.destroyWidgets([i]);
      o.isEdit = false;
      o.editModule.destroyForm();
      n.parent.notify(Ut, {});
      var l = o.getRowObjectFromUID(t.getAttribute('data-uid'));
      n.refreshTD(a.cell, i, l, a.value);
      if (n.parent.isReact) {
        a.cell = n.newReactTd;
      }
      Q([t], [Y, 'e-batchrow']);
      Q([a.cell], ['e-editedbatchcell', 'e-boolcell']);
      if (
        (!u(a.value) &&
          a.value.toString() === (u(n.cellDetails.value) ? '' : n.cellDetails.value).toString() &&
          !n.isColored) ||
        (u(a.value) &&
          u(l.data[i.field]) &&
          u(n.cellDetails.value) &&
          !a.cell.parentElement.classList.contains('e-insertedrow'))
      ) {
        a.cell.classList.remove('e-updatedtd');
      }
      if (u(r)) {
        var h = o.isReact && i.template && typeof i.template != 'string';
        var d = o.parentDetails && o.parentDetails.parentInstObj && o.parentDetails.parentInstObj.isReact;
        h || d
          ? o.requireTemplateRef
            ? o.renderTemplates(function () {
                o.trigger(ai, a);
              })
            : (o.renderTemplates(), o.trigger(ai, a))
          : o.trigger(ai, a);
      }
      o.notify(Me, {});
      n.isColored = false;
      if (n.parent.aggregates.length > 0) {
        if (!(n.parent.isReact || n.parent.isVue)) {
          n.parent.notify(Le, {});
        }
        if (n.parent.groupSettings.columns.length > 0 && !n.isAddRow(n.cellDetails.rowIndex)) {
          n.parent.notify(Ot, {});
        }
        if (n.parent.isReact || n.parent.isVue) {
          n.parent.notify(Le, {});
        }
      }
      n.preventSaveCell = false;
      if (n.editNext) {
        n.editNext = false;
        if (n.cellDetails.rowIndex === n.index && n.cellDetails.column.field === n.field && n.prevEditedBatchCell)
          return;
        var p = o.getColumnByField(n.field);
        if (
          p &&
          (p.allowEditing ||
            (!p.allowEditing &&
              o.focusModule.active &&
              o.focusModule.active.getTable().rows[n.crtRowIndex] &&
              o.focusModule.active.getTable().rows[n.crtRowIndex].classList.contains('e-insertedrow')))
        ) {
          n.editCellExtend(n.index, n.field, n.isAdd);
        }
      }
      if (r) {
        o.notify(vt, {});
      }
    };
  };
  s.prototype.prevEditedBatchCellMatrix = function () {
    var e = [];
    var t = this.parent;
    var i = this.parent.focusModule.active.getTable().querySelector('.e-editedbatchcell');
    if (i) {
      var r = i.parentElement;
      var n = [].slice.call(this.parent.focusModule.active.getTable().rows).indexOf(i.parentElement);
      var a = [].slice.call(i.parentElement.cells).indexOf(i);
      e = [n, a];
    }
    return e;
  };
  s.prototype.getDataByIndex = function (e) {
    var t = this.parent.getRowObjectFromUID(
      this.parent.getDataRows()[parseInt(e.toString(), 10)].getAttribute('data-uid'),
    );
    return t.changes ? t.changes : t.data;
  };
  s.prototype.keyDownHandler = function (e) {
    if (this.addBatchRow || ((e.action === 'tab' || e.action === 'shiftTab') && this.parent.isEdit)) {
      var t = this.parent;
      var i = this.getBottomIndex();
      var r = S(e.target, ie);
      if (this.addBatchRow || (r && !this.parent.isReact)) {
        var n = void 0;
        if (r) {
          n = r.querySelector('.e-field');
        }
        if (this.addBatchRow || n) {
          var a = this.parent.getVisibleColumns();
          var o = e.action === 'tab' ? a.length - 1 : 0;
          if (
            this.addBatchRow ||
            a[parseInt(o.toString(), 10)].field === n.getAttribute('id').slice(this.parent.element.id.length)
          ) {
            this.cellDetails.rowIndex === i && e.action === 'tab'
              ? (this.parent.editSettings.newRowPosition === 'Top'
                  ? ((this.parent.editSettings.newRowPosition = 'Bottom'),
                    this.addRecord(),
                    (this.parent.editSettings.newRowPosition = 'Top'))
                  : this.addRecord(),
                (this.addBatchRow = false))
              : this.saveCell();
          }
        }
      }
    }
  };
  s.prototype.addCancelWhilePaging = function () {
    if (this.validateFormObj()) {
      this.parent.notify(qi, {});
      this.parent.isEdit = false;
      this.editNext = false;
      this.mouseDownElement = void 0;
      this.isColored = false;
    }
  };
  s.prototype.getBottomIndex = function () {
    var e = this.getBatchChanges();
    return this.parent.getCurrentViewRecords().length + e[it].length - e[Si].length - 1;
  };
  return s;
})();
var il = (function () {
  var s = function (e, t) {
    s =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (i, r) {
          i.__proto__ = r;
        }) ||
      function (i, r) {
        for (var n in r)
          if (r.hasOwnProperty(n)) {
            i[n] = r[n];
          }
      };
    return s(e, t);
  };
  return function (e, t) {
    s(e, t);
    function i() {
      this.constructor = e;
    }
    e.prototype = t === null ? Object.create(t) : ((i.prototype = t.prototype), new i());
  };
})();
var rl = (function (s) {
  il(e, s);
  function e(t, i, r) {
    var n = s(t, i) || this;
    n.parent = t;
    n.serviceLocator = i;
    n.renderer = r;
    return n;
  }
  e.prototype.closeEdit = function () {
    s.prototype.closeEdit();
  };
  e.prototype.addRecord = function (t, i) {
    s.prototype.addRecord(t, i);
  };
  e.prototype.endEdit = function () {
    s.prototype.endEdit();
  };
  e.prototype.updateRow = function (t, i) {
    s.prototype.updateRow(t, i);
  };
  e.prototype.deleteRecord = function (t, i) {
    s.prototype.deleteRecord(t, i);
  };
  e.prototype.startEdit = function (t) {
    s.prototype.startEdit(t);
  };
  return e;
})(Vn);
var nl = (function () {
  var s = function (e, t) {
    s =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (i, r) {
          i.__proto__ = r;
        }) ||
      function (i, r) {
        for (var n in r)
          if (r.hasOwnProperty(n)) {
            i[n] = r[n];
          }
      };
    return s(e, t);
  };
  return function (e, t) {
    s(e, t);
    function i() {
      this.constructor = e;
    }
    e.prototype = t === null ? Object.create(t) : ((i.prototype = t.prototype), new i());
  };
})();
var Pr = (function (s) {
  nl(e, s);
  function e(t) {
    var i = s(t) || this;
    i.isMaskModuleInjected = true;
    return i;
  }
  e.prototype.write = function (t) {
    this.edit = this.parent.editModule;
    if (t.column.editType === 'datepickeredit') {
      this.obj = new ui(
        E(
          Hr(t, this.parent.editSettings.mode, this.parent.enableRtl, this.parent.cssClass, this),
          t.column.edit.params,
        ),
      );
      if (this.isMaskModuleInjected) {
        ui.Inject(fo);
        this.isMaskModuleInjected = false;
      }
    }
    if (t.column.editType === 'datetimepickeredit') {
      this.obj = new ln(
        E(
          Hr(t, this.parent.editSettings.mode, this.parent.enableRtl, this.parent.cssClass, this),
          t.column.edit.params,
        ),
      );
    }
    this.obj.appendTo(t.element);
  };
  return e;
})(Zt);
function Hr(s, e, t, i, r) {
  var n = e !== 'Dialog';
  var a = on(s.column.format, s.column.type);
  var o = te(s.column.field, s.rowData);
  o = o ? new Date(o) : null;
  return {
    floatLabelType: n ? 'Never' : 'Always',
    value: o,
    format: a,
    placeholder: n ? '' : s.column.headerText,
    enableRtl: t,
    enabled: bt(s.column, s.requestType, s.element) && Xt(S(s.element, 'e-rowcell'), r && r.parent ? r.parent : null),
    cssClass: i || null,
    close: sl.bind(r),
  };
}
function sl(s) {
  if (s.event && s.event.action === 'escape') {
    this.edit.editCellDialogClose = true;
  }
}
var al = (function () {
  function s(e) {
    this.parent = e;
  }
  s.prototype.read = function (e, t) {
    return t;
  };
  s.prototype.write = function () {};
  s.prototype.destroy = function () {};
  return s;
})();
var ol = (function () {
  function s(e, t) {
    this.isShowAddedRowValidate = false;
    this.editType = {
      Inline: Nr,
      Normal: Nr,
      Batch: tl,
      Dialog: rl,
    };
    this.fieldname = '';
    this.data = {};
    this.editCellDialogClose = false;
    this.parent = e;
    this.serviceLocator = t;
    this.l10n = this.serviceLocator.getService('localization');
    this.addEventListener();
    this.updateEditObj();
    this.createAlertDlg();
    this.createConfirmDlg();
  }
  s.prototype.updateColTypeObj = function () {
    for (var e = this.parent.columnModel, t = 0; t < e.length; t++)
      if (this.parent.editSettings.template || e[parseInt(t.toString(), 10)].editTemplate) {
        var i = 'templateedit';
        e[parseInt(t.toString(), 10)].edit = E(
          new s.editCellType.templateedit(this.parent),
          e[parseInt(t.toString(), 10)].edit || {},
        );
      } else
        e[parseInt(t.toString(), 10)].edit = E(
          new s.editCellType[
            e[parseInt(t.toString(), 10)].editType && s.editCellType[e[parseInt(t.toString(), 10)].editType]
              ? e[parseInt(t.toString(), 10)].editType
              : 'defaultedit'
          ](this.parent, this.serviceLocator),
          e[parseInt(t.toString(), 10)].edit || {},
        );
    this.parent.log('primary_column_missing');
  };
  s.prototype.getModuleName = function () {
    return 'edit';
  };
  s.prototype.onPropertyChanged = function (e) {
    if (e.module === this.getModuleName())
      for (var t = this.parent, i = 0, r = Object.keys(e.properties); i < r.length; i++) {
        var n = r[i];
        switch (r[i]) {
          case 'allowAdding':
          case 'allowDeleting':
          case 'allowEditing':
            if (t.editSettings.allowAdding || t.editSettings.allowEditing || t.editSettings.allowDeleting) {
              this.initialEnd();
            }
            break;
          case 'mode':
            {
              this.updateEditObj();
              t.isEdit = !!t.editSettings.showAddNewRow;
              t.refresh();
            }
            break;
        }
      }
  };
  s.prototype.updateEditObj = function () {
    if (this.editModule) {
      this.editModule.destroy();
    }
    this.renderer = new Wo(this.parent, this.serviceLocator);
    this.editModule = new this.editType[this.parent.editSettings.mode](this.parent, this.serviceLocator, this.renderer);
  };
  s.prototype.initialEnd = function () {
    this.updateColTypeObj();
  };
  s.prototype.startEdit = function (e) {
    var t = this.parent;
    var i = 'isTreeGrid';
    if (
      !(
        !this.parent.editSettings.allowEditing ||
        (this.parent.isEdit &&
          (!this.parent.editSettings.showAddNewRow ||
            (this.parent.editSettings.showAddNewRow && !u(this.parent.element.querySelector('.' + Y))))) ||
        this.parent.editSettings.mode === 'Batch'
      )
    ) {
      this.parent.element.classList.add('e-editing');
      if (
        !this.parent.getSelectedRows().length ||
        u(this.parent.getRowByIndex(parseInt(this.parent.getSelectedRows()[0].getAttribute('aria-rowindex'), 10) - 1))
      ) {
        if (!e) {
          this.showDialog('EditOperationAlert', this.alertDObj);
          return;
        }
      } else if (!e)
        if (
          this.parent.isTreeGrid &&
          this.parent.allowPaging &&
          this.parent.selectionModule.selectedRowIndexes.length
        ) {
          var r = this.parent.selectionModule.selectedRowIndexes[0];
          e = this.parent.getRowByIndex(this.parent.selectionModule.selectedRowIndexes[0]);
        } else e = this.parent.getSelectedRows()[0];
      if (this.parent.enableVirtualization && this.parent.editSettings.mode === 'Normal') {
        var n = parseInt(e.getAttribute('aria-rowindex'), 10) - 1;
        e = this.parent.getRowByIndex(n);
      }
      var a = this.parent.getContent().querySelector('tr:last-child');
      var o = this.parent.getHeaderContent().querySelector('tbody');
      this.parent.frozenRows && u(a) && o && o.querySelector('tr:last-child')
        ? (this.isLastRow =
            e.rowIndex ===
            parseInt(
              this.parent
                .getHeaderContent()
                .querySelector('tbody')
                .querySelector('tr:last-child')
                .getAttribute('aria-rowindex'),
              10,
            ) -
              1)
        : a && (this.isLastRow = e.rowIndex === a.rowIndex);
      if (e.style.display !== 'none') {
        this.editModule.startEdit(e);
        this.refreshToolbar();
        this.parent.element.querySelector('.e-gridpopup').style.display = 'none';
        this.parent.notify('start-edit', {});
        if (this.parent.editSettings.showAddNewRow) {
          this.destroyToolTip();
        }
      }
    }
  };
  s.prototype.checkLastRow = function (e, t) {
    var i = this.isLastRow;
    this.parent.height !== 'auto' &&
    this.parent.editSettings.newRowPosition === 'Bottom' &&
    t &&
    t.requestType === 'add' &&
    this.parent.getContent().firstElementChild.offsetHeight > this.parent.getContentTable().scrollHeight
      ? j([].slice.call(e.getElementsByClassName(ie)), 'e-lastrowadded')
      : this.isLastRow && e && e.classList && j([].slice.call(e.getElementsByClassName(ie)), 'e-lastrowcell');
  };
  s.prototype.closeEdit = function () {
    if (
      this.parent.editSettings.mode === 'Batch' &&
      this.parent.editSettings.showConfirmDialog &&
      this.parent.element.getElementsByClassName('e-updatedtd').length
    ) {
      this.showDialog('CancelEdit', this.dialogObj);
      return;
    }
    this.parent.element.classList.remove('e-editing');
    this.editModule.closeEdit();
    this.refreshToolbar();
    this.parent.notify(pt, { requestType: 'cancel' });
    if (this.parent.editSettings.showAddNewRow) {
      this.destroyToolTip();
    }
  };
  s.prototype.refreshToolbar = function () {
    this.parent.notify(Me, {});
  };
  s.prototype.addRecord = function (e, t) {
    if (this.parent.editSettings.allowAdding) {
      var i = { startEdit: true };
      if (!e) {
        this.parent.notify(En, i);
      }
      this.parent.element.classList.add('e-editing');
      this.editModule.addRecord(e, t);
      this.refreshToolbar();
      this.parent.notify('start-add', {});
    }
  };
  s.prototype.deleteRecord = function (e, t) {
    var i = this.parent;
    if (this.parent.editSettings.allowDeleting) {
      if (!t && !this.parent.getSelectedRecords().length && u(this.parent.commandDelIndex)) {
        this.showDialog('DeleteOperationAlert', this.alertDObj);
        return;
      }
      if (this.parent.editSettings.showDeleteConfirmDialog) {
        this.fieldname = e;
        this.data = t;
        this.showDialog('ConfirmDelete', this.dialogObj);
        return;
      }
      this.editModule.deleteRecord(e, t);
    }
  };
  s.prototype.deleteRow = function (e) {
    this.deleteRowUid = e.getAttribute('data-uid');
    var t = this.parent.getRowObjectFromUID(this.deleteRowUid);
    if (!u(t)) {
      this.deleteRecord(null, t.data);
    }
  };
  s.prototype.endEdit = function () {
    if (
      this.parent.editSettings.mode === 'Batch' &&
      this.parent.editSettings.showConfirmDialog &&
      (u(this.formObj) || this.formObj.validate()) &&
      (this.parent.editModule.saveCell(), this.parent.notify(Ri, {}), u(this.formObj) || this.formObj.validate())
    ) {
      this.showDialog('BatchSaveConfirm', this.dialogObj);
      return;
    }
    this.endEditing();
  };
  s.prototype.updateCell = function (e, t, i) {
    this.editModule.updateCell(e, t, i);
  };
  s.prototype.updateRow = function (e, t) {
    this.editModule.updateRow(e, t);
  };
  s.prototype.batchCancel = function () {
    this.closeEdit();
  };
  s.prototype.batchSave = function () {
    this.endEdit();
  };
  s.prototype.editCell = function (e, t) {
    this.editModule.editCell(e, t);
  };
  s.prototype.editFormValidate = function () {
    return this.formObj ? this.formObj.validate() : true;
  };
  s.prototype.getBatchChanges = function () {
    return this.editModule.getBatchChanges ? this.editModule.getBatchChanges() : {};
  };
  s.prototype.getCurrentEditCellData = function () {
    var e = this.getCurrentEditedData(this.formObj.element, {});
    return e[Object.keys(e)[0]];
  };
  s.prototype.saveCell = function () {
    this.editModule.saveCell();
  };
  s.prototype.endEditing = function () {
    if (!this.parent.editSettings.showAddNewRow) {
      this.parent.element.classList.remove('e-editing');
    }
    this.editModule.endEdit();
    this.isShowAddedRowValidate = false;
    this.refreshToolbar();
  };
  s.prototype.showDialog = function (e, t) {
    t.content = '<div>' + this.l10n.getConstant(e) + '</div>';
    t.dataBind();
    t.show();
    if (this.parent.enableRtl) {
      t.refresh();
    }
  };
  s.prototype.getValueFromType = function (e, t) {
    var i = t;
    switch (e.type) {
      case 'number':
        i = isNaN(parseFloat(t)) ? null : parseFloat(t);
        break;
      case 'boolean':
        if (e.editType !== 'booleanedit') {
          i = t === this.l10n.getConstant('True') || t === true;
        }
        break;
      case 'date':
      case 'datetime':
        e.editType !== 'datepickeredit' && e.editType !== 'datetimepickeredit' && t && t.length
          ? (i = new Date(t))
          : t === '' && (i = null);
        break;
      case 'dateonly':
        i = t && (t = new Date(t)) ? t.getFullYear() + '-' + jt(t.getMonth() + 1) + '-' + jt(t.getDate()) : null;
        break;
    }
    return i;
  };
  s.prototype.destroyToolTip = function () {
    for (
      var e = [].slice.call(this.parent.element.getElementsByClassName('e-griderror')), t = 0, i = e;
      t < i.length;
      t++
    ) {
      var r = i[t];
      N(i[t]);
    }
    this.parent.getContent().firstElementChild.style.position = 'relative';
    if (this.parent.isFrozenGrid()) {
      if (this.parent.element.querySelector('.e-gridheader')) {
        this.parent.element.querySelector('.e-gridheader').style.position = '';
      }
      this.parent.element.querySelector('.e-gridcontent').style.position = '';
    }
  };
  s.prototype.createConfirmDlg = function () {
    this.dialogObj = this.dlgWidget(
      [
        {
          click: this.dlgOk.bind(this),
          buttonModel: {
            content: this.l10n.getConstant('OKButton'),
            cssClass: this.parent.cssClass ? 'e-primary ' + this.parent.cssClass : 'e-primary',
            isPrimary: true,
          },
        },
        {
          click: this.dlgCancel.bind(this),
          buttonModel: {
            cssClass: this.parent.cssClass ? 'e-flat ' + this.parent.cssClass : 'e-flat',
            content: this.l10n.getConstant('CancelButton'),
          },
        },
      ],
      'EditConfirm',
    );
  };
  s.prototype.createAlertDlg = function () {
    this.alertDObj = this.dlgWidget(
      [
        {
          click: this.alertClick.bind(this),
          buttonModel: {
            content: this.l10n.getConstant('OKButton'),
            cssClass: this.parent.cssClass ? 'e-flat ' + this.parent.cssClass : 'e-flat',
            isPrimary: true,
          },
        },
      ],
      'EditAlert',
    );
  };
  s.prototype.alertClick = function () {
    this.alertDObj.hide();
  };
  s.prototype.dlgWidget = function (e, t) {
    var i = this.parent.createElement('div', { id: this.parent.element.id + t });
    this.parent.element.appendChild(i);
    var r = {
      showCloseIcon: false,
      isModal: true,
      visible: false,
      closeOnEscape: true,
      target: this.parent.element,
      width: '320px',
      animationSettings: { effect: 'None' },
      cssClass: this.parent.cssClass ? this.parent.cssClass : '',
    };
    r.buttons = e;
    var n = new Wt(r);
    var a = 'isStringTemplate';
    n.isStringTemplate = true;
    n.appendTo(i);
    return n;
  };
  s.prototype.dlgCancel = function () {
    if (this.parent.pagerModule) {
      this.parent.pagerModule.isForceCancel = false;
    }
    this.parent.focusModule.clearIndicator();
    this.dialogObj.hide();
    this.parent.focusModule.restoreFocus({ requestType: 'cancel' });
    this.parent.notify('cancelcnfrmDlg', {});
  };
  s.prototype.dlgOk = function () {
    switch (this.dialogObj.element.querySelector('.e-dlg-content').firstElementChild.innerText) {
      case this.l10n.getConstant('ConfirmDelete'):
        {
          this.editModule.deleteRecord(this.fieldname, this.data);
          if (this.parent.editSettings.showDeleteConfirmDialog && !this.parent.allowSelection) {
            this.parent.commandDelIndex = void 0;
          }
        }
        break;
      case this.l10n.getConstant('CancelEdit'):
        this.editModule.closeEdit();
        break;
      case this.l10n.getConstant('BatchSaveConfirm'):
        this.endEditing();
        break;
      case this.l10n.getConstant('BatchSaveLostChanges'):
        {
          if (this.parent.editSettings.mode === 'Batch') {
            this.editModule.addCancelWhilePaging();
          }
          if (this.parent.pagerModule) {
            this.parent.pagerModule.isForceCancel = false;
          }
          this.executeAction();
        }
        break;
    }
    this.dlgCancel();
  };
  s.prototype.destroyEditComponents = function () {
    if (this.parent.isEdit) {
      this.destroyWidgets();
      this.destroyForm();
    }
    this.destroy();
  };
  s.prototype.addEventListener = function () {
    if (!this.parent.isDestroyed) {
      this.eventDetails = [
        {
          event: Ge,
          handler: this.onPropertyChanged,
        },
        {
          event: Ce,
          handler: this.initialEnd,
        },
        {
          event: be,
          handler: this.keyPressHandler,
        },
        {
          event: In,
          handler: this.updateColTypeObj,
        },
        {
          event: Ut,
          handler: this.destroyToolTip,
        },
        {
          event: ye,
          handler: this.preventBatch,
        },
        {
          event: qi,
          handler: this.destroyForm,
        },
        {
          event: M,
          handler: this.destroyEditComponents,
        },
      ];
      ce(this.parent, this.eventDetails, true, this);
      this.actionBeginFunction = this.onActionBegin.bind(this);
      this.actionCompleteFunction = this.actionComplete.bind(this);
      this.parent.on(Di, this.actionBeginFunction);
      this.parent.addEventListener(B, this.actionCompleteFunction);
    }
  };
  s.prototype.removeEventListener = function () {
    if (!this.parent.isDestroyed) {
      ce(this.parent, this.eventDetails, false);
      this.parent.removeEventListener(B, this.actionCompleteFunction);
      this.parent.off(Di, this.actionBeginFunction);
    }
  };
  s.prototype.actionComplete = function (e) {
    var t = ['add', 'beginEdit', 'save', 'delete', 'cancel', 'filterAfterOpen', 'filterchoicerequest'];
    if (t.indexOf(e.requestType) < 0) {
      this.parent.isEdit = !!this.parent.editSettings.showAddNewRow;
    }
    if (e.requestType === 'batchsave') {
      this.parent.focusModule.restoreFocus({ requestType: 'save' });
    }
    this.refreshToolbar();
  };
  s.prototype.getCurrentEditedData = function (e, t) {
    var i = this.parent;
    if (this.parent.editSettings.template) {
      for (var r = [].slice.call(e.elements), n = 0; n < r.length; n++)
        if (
          ((r[parseInt(n.toString(), 10)].hasAttribute('name') &&
            r[parseInt(n.toString(), 10)].className !== 'e-multi-hidden') ||
            r[parseInt(n.toString(), 10)].classList.contains('e-multiselect')) &&
          !(
            r[parseInt(n.toString(), 10)].type === 'hidden' &&
            (S(r[parseInt(n.toString(), 10)], 'e-switch-wrapper') ||
              S(r[parseInt(n.toString(), 10)], 'e-checkbox-wrapper'))
          )
        ) {
          var a = r[parseInt(n.toString(), 10)].hasAttribute('name')
            ? Ii(r[parseInt(n.toString(), 10)].getAttribute('name'))
            : Ii(r[parseInt(n.toString(), 10)].getAttribute('id'));
          var o = this.parent.getColumnByField(a) || {
            field: a,
            type: r[parseInt(n.toString(), 10)].getAttribute('type'),
          };
          var l = void 0;
          o.type === 'checkbox' || o.type === 'boolean'
            ? (l = r[parseInt(n.toString(), 10)].checked)
            : r[parseInt(n.toString(), 10)].value
              ? ((l = r[parseInt(n.toString(), 10)].value),
                r[parseInt(n.toString(), 10)].ej2_instances &&
                  r[parseInt(n.toString(), 10)].ej2_instances.length &&
                  !u(r[parseInt(n.toString(), 10)].ej2_instances[0].value) &&
                  (r[parseInt(n.toString(), 10)].blur(), (l = r[parseInt(n.toString(), 10)].ej2_instances[0].value)))
              : r[parseInt(n.toString(), 10)].ej2_instances &&
                (l = r[parseInt(n.toString(), 10)].ej2_instances[0].value);
          o.edit && typeof o.edit.read == 'string'
            ? (l = re(o.edit.read, window)(r[parseInt(n.toString(), 10)], l))
            : o.edit && o.edit.read && (l = o.edit.read(r[parseInt(n.toString(), 10)], l));
          l = this.parent.editModule.getValueFromType(o, l);
          r[parseInt(n.toString(), 10)].type === 'radio'
            ? r[parseInt(n.toString(), 10)].checked && le.setValue(o.field, l, t)
            : (typeof l == 'string' && this.parent.sanitize(l), le.setValue(o.field, l, t));
        }
      return t;
    }
    for (
      var h = this.parent.columnModel.filter(function (v) {
          return v.editTemplate;
        }),
        d = 0;
      d < h.length;
      d++
    )
      if (e[Ue(h[parseInt(d.toString(), 10)].field)]) {
        var p = [].slice.call(e[Ue(h[parseInt(d.toString(), 10)].field)]).filter(function (v) {
          return v.tagName.toLowerCase() === 'input';
        });
        p = p.length ? p : [e[Ue(h[parseInt(d.toString(), 10)].field)]];
        var c = p.filter(function (v) {
          return !u(v.ej2_instances);
        });
        if (c.length === 0) {
          c = p.filter(function (v) {
            return v.hasAttribute('name');
          });
        }
        for (var n = 0; n < c.length; n++) {
          var l = this.getValue(h[parseInt(d.toString(), 10)], c[parseInt(n.toString(), 10)], t);
          if (h[parseInt(d.toString(), 10)].type === 'string') {
            l = this.parent.sanitize(l);
          }
          le.setValue(h[parseInt(d.toString(), 10)].field, l, t);
        }
      }
    for (var f = [].slice.call(e.getElementsByClassName('e-field')), g = 0, m = f.length; g < m; g++) {
      var y = this.parent.getColumnByUid(f[parseInt(g.toString(), 10)].getAttribute('data-mappinguid'));
      if (y && y.field) {
        var l = this.getValue(y, f[parseInt(g.toString(), 10)], t);
        if (y.type === 'string' && !(y.isForeignColumn() && typeof l != 'string')) {
          l = this.parent.sanitize(l);
        }
        le.setValue(y.field, l, t);
      }
    }
    return t;
  };
  s.prototype.getValue = function (e, t, i) {
    var r = t.ej2_instances ? t.ej2_instances[0].value : t.value;
    var n = this.parent;
    var a = e.edit.read;
    if (e.type === 'checkbox' || e.type === 'boolean') {
      r = t.checked;
    }
    typeof a == 'string'
      ? ((a = re(a, window)), (r = this.parent.editModule.getValueFromType(e, a(t, r))))
      : (r = this.parent.editModule.getValueFromType(e, e.edit.read(t, r)));
    if (u(i[e.field]) && r === '') {
      r = i[e.field];
    }
    return r;
  };
  s.prototype.onActionBegin = function (e) {
    if (
      (e.requestType === 'columnstate' ||
        (this.parent.enableInfiniteScrolling &&
          this.parent.infiniteScrollSettings.enableCache &&
          e.requestType === 'sorting')) &&
      this.parent.isEdit &&
      this.parent.editSettings.mode !== 'Batch'
    )
      this.closeEdit();
    else {
      var t = this.parent.element.querySelector('.' + Y);
      var i = this.parent.element.querySelector('.' + Fe);
      if (
        t &&
        this.parent.frozenRows &&
        e.requestType === 'virtualscroll' &&
        parseInt(S(t, de).getAttribute(q), 10) - 1 < this.parent.frozenRows
      )
        return;
      var r = [
        'filterAfterOpen',
        'filterBeforeOpen',
        'filterchoicerequest',
        'filterSearchBegin',
        'save',
        'infiniteScroll',
        'virtualscroll',
      ];
      var n = r.indexOf(e.requestType) === -1;
      var a =
        !this.parent.editSettings.showAddNewRow ||
        (this.parent.editSettings.showAddNewRow && !u(this.parent.element.querySelector('.e-editedrow')));
      var o =
        (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) &&
        this.formObj &&
        a &&
        !this.formObj.isDestroyed &&
        (t || i || e.requestType === 'cancel') &&
        n;
      if (
        (!this.parent.enableVirtualization &&
          a &&
          this.parent.editSettings.mode !== 'Batch' &&
          this.formObj &&
          !this.formObj.isDestroyed &&
          n &&
          !e.cancel) ||
        o
      ) {
        this.destroyWidgets();
        this.destroyForm();
      }
    }
  };
  s.prototype.destroyWidgets = function (e) {
    var t = this.parent;
    t.isWidgetsDestroyed = true;
    if (t.editSettings.template) {
      var i = xr(this.parent);
      i = i.isReact ? i : this.parent;
      i.destroyTemplate(['editSettingsTemplate']);
      if (this.parent.isReact) {
        this.parent.renderTemplates();
      }
    }
    if (
      this.parent.editSettings.mode === 'Dialog' &&
      this.parent.allowGrouping &&
      this.parent.groupSettings.columns.length
    ) {
      e = [];
      for (var r = this.parent.getColumns(), n = 0; n < r.length; n++) {
        var a = r[parseInt(n.toString(), 10)];
        if (
          r[parseInt(n.toString(), 10)].visible ||
          this.parent.groupSettings.columns.indexOf(r[parseInt(n.toString(), 10)].field) > -1
        ) {
          e.push(r[parseInt(n.toString(), 10)]);
        }
      }
    } else e = e || this.parent.getCurrentVisibleColumns(this.parent.enableColumnVirtualization);
    if (
      e.some(function (g) {
        return !u(g.editTemplate);
      })
    ) {
      this.parent.destroyTemplate(['editTemplate']);
      if (this.parent.isReact) {
        this.parent.renderTemplates();
      }
    }
    for (var o = 0, l = e; o < l.length; o++) {
      var h = l[o];
      var d = l[o].edit.destroy;
      if (l[o].edit.destroy) {
        typeof d == 'string' ? ((d = re(d, window)), d()) : l[o].edit.destroy();
      }
    }
    for (var p = [].slice.call(this.formObj.element.elements), n = 0; n < p.length; n++) {
      var c = p[parseInt(n.toString(), 10)];
      if (p[parseInt(n.toString(), 10)].hasAttribute('name')) {
        var f = u(p[parseInt(n.toString(), 10)].parentElement)
          ? null
          : p[parseInt(n.toString(), 10)].parentElement.classList.contains('e-ddl')
            ? p[parseInt(n.toString(), 10)].parentElement.querySelector('input')
            : p[parseInt(n.toString(), 10)];
        if (f && f.ej2_instances && f.ej2_instances.length && !f.ej2_instances[0].isDestroyed) {
          f.ej2_instances[0].destroy();
          f.remove();
        }
      }
    }
  };
  s.prototype.destroyForm = function () {
    this.destroyToolTip();
    for (
      var e = [this.formObj, this.virtualFormObj],
        t = this.parent.columnModel.filter(function (n) {
          return n.editTemplate;
        }),
        i = 0;
      i < e.length;
      i++
    )
      if (
        e[parseInt(i.toString(), 10)] &&
        e[parseInt(i.toString(), 10)].element &&
        !e[parseInt(i.toString(), 10)].isDestroyed
      ) {
        e[parseInt(i.toString(), 10)].destroy();
        var r = xr(this.parent);
        if (
          r.isReact &&
          this.parent.editSettings.mode === 'Dialog' &&
          (!u(this.parent.editSettings.template) || t.length)
        ) {
          e[parseInt(i.toString(), 10)].element.remove();
        }
      }
    this.destroyToolTip();
  };
  s.prototype.destroy = function () {
    var e = this.parent.element;
    if (this.parent.element) {
      var t = !!(this.parent.element.querySelector('.' + Oe) && this.parent.element.querySelector('.' + pe));
      if (t) {
        this.destroyForm();
      }
      this.removeEventListener();
      var i = this.dialogObj.element;
      if (i.childElementCount > 0) {
        this.dialogObj.destroy();
        N(i);
      }
      i = this.alertDObj.element;
      if (i.childElementCount > 0) {
        this.alertDObj.destroy();
        N(i);
      }
      if (t && this.editModule) {
        this.editModule.destroy();
      }
    }
  };
  s.prototype.keyPressHandler = function (e) {
    var t = /(Mac)/i.test(navigator.platform);
    switch ((t && e.metaKey && e.action === 'ctrlEnter' && (e.action = 'insert'), e.action)) {
      case 'insert':
        this.addRecord();
        break;
      case 'delete':
        if (
          (e.target.tagName !== 'INPUT' || e.target.classList.contains('e-checkselect')) &&
          !document.querySelector('.e-popup-open.e-edit-dialog')
        ) {
          this.deleteRecord();
        }
        break;
      case 'f2':
        this.startEdit();
        break;
      case 'enter':
        if (
          !S(e.target, 'e-unboundcelldiv') &&
          this.parent.editSettings.mode !== 'Batch' &&
          (S(e.target, pe) ||
            ((this.parent.frozenRows ||
              (this.parent.editSettings.showAddNewRow &&
                (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling))) &&
              S(e.target, je))) &&
          (!document.getElementsByClassName('e-popup-open').length ||
            (document.querySelectorAll('.e-popup-open .e-editcell').length &&
              !document.querySelectorAll('.e-popup-open:not(.e-dialog)').length))
        ) {
          e.preventDefault();
          if (this.parent.isEdit) {
            this.parent.isFocusFirstCell = true;
          }
          this.endEdit();
        }
        break;
      case 'escape':
        {
          if (this.parent.isEdit && !this.editCellDialogClose) {
            this.parent.editSettings.mode === 'Batch' ? this.editModule.escapeCellEdit() : this.curretRowFocus(e);
          }
          if (this.editCellDialogClose) {
            this.editCellDialogClose = false;
          }
        }
        break;
      case 'tab':
      case 'shiftTab':
        this.curretRowFocus(e);
        break;
    }
  };
  s.prototype.curretRowFocus = function (e) {
    if (this.parent.isEdit && this.parent.editSettings.mode !== 'Batch') {
      this.parent.isWidgetsDestroyed = false;
      var t = S(e.target, 'e-editedrow') || S(e.target, 'e-addedrow');
      if (t) {
        var i = [].slice.call(t.querySelectorAll('.e-input:not(.e-disabled)'));
        var r = [].slice.call(t.querySelectorAll('.e-unboundcell'));
        if (r && r.length)
          for (var n = 0; n < r.length; n++)
            i = i.concat([].slice.call(r[parseInt(n.toString(), 10)].querySelectorAll('.e-btn:not(.e-hide)')));
        var a = S(e.target, 'e-rowcell');
        a = a && a.classList.contains('e-unboundcell') ? e.target : a;
        var o = S(i[i.length - 1], 'e-rowcell');
        o = o && o.classList.contains('e-unboundcell') ? i[i.length - 1] : o;
        if (
          (a === o && e.action === 'tab') ||
          e.action === 'escape' ||
          (a === S(i[0], 'e-rowcell') && e.action === 'shiftTab' && !this.parent.editSettings.showAddNewRow)
        ) {
          var l = t.getAttribute('data-uid');
          var h = this.parent.allowGrouping
            ? u(this.parent.getContent())
              ? []
              : [].slice.call(this.parent.getContent().querySelectorAll('tr'))
            : this.parent.getRows();
          var d = h
            .map(function (y) {
              return y.getAttribute('data-uid');
            })
            .indexOf(l);
          if (this.parent.frozenRows) {
            S(t, 'e-gridheader') ? (d = t.rowIndex) : S(t, 'e-gridcontent') && (d = d - this.parent.frozenRows);
          }
          if (t.classList.contains('e-addedrow')) {
            d = 0;
          }
          e.action === 'escape'
            ? ((this.parent.isFocusFirstCell = true), this.closeEdit())
            : ((this.isShowAddedRowValidate = true),
              (this.parent.selectionModule.preventFocus = false),
              (this.parent.isFocusFirstCell = true),
              this.endEdit(),
              (this.isShowAddedRowValidate = false));
          if (
            this.parent.focusModule.active &&
            (!this.parent.editSettings.showAddNewRow ||
              t.classList.contains('e-editedrow') ||
              (this.parent.editSettings.showAddNewRow &&
                t.classList.contains('e-addedrow') &&
                u(this.parent.element.querySelector('.e-griderror:not([style*="display: none"])'))))
          ) {
            var p = 0;
            var c = this.parent.focusModule.active.matrix;
            if (
              this.parent.focusModule.active.matrix &&
              this.parent.focusModule.active.matrix.matrix.length &&
              this.parent.focusModule.active.matrix.matrix[parseInt(d.toString(), 10)]
            ) {
              for (
                var f = this.parent.focusModule.active.matrix.matrix[parseInt(d.toString(), 10)], n = 0;
                n < f.length;
                n++
              )
                if (f[parseInt(n.toString(), 10)] > 0) {
                  p = n;
                  break;
                }
            }
            var g = re(
              d + '.cells.' + p,
              this.parent.focusModule.active.matrix.getRowsFromIndex(d, this.parent.focusModule.active),
            );
            if (g && g.getBoundingClientRect().width === 0) {
              var m = this.parent.focusModule.active.matrix.nextVisibleCellFocus(
                d,
                p,
                e.action,
                this.parent.focusModule.active.keyActions[e.action],
                this.parent.focusModule.active,
                this.parent.focusModule.active.matrix.current[1],
              );
              p = m[1];
            }
            this.parent.focusModule.active.matrix.current = [d, p];
          }
        }
        if (this.parent.editSettings.showAddNewRow && e.action === 'tab' && S(e.target, 'e-addedrow')) {
          this.isShowAddedRowValidate = true;
        }
      }
    }
  };
  s.prototype.preventBatch = function (e) {
    this.preventObj = e;
    this.showDialog('BatchSaveLostChanges', this.dialogObj);
  };
  s.prototype.executeAction = function () {
    this.preventObj.handler.call(
      this.preventObj.instance,
      this.preventObj.arg1,
      this.preventObj.arg2,
      this.preventObj.arg3,
      this.preventObj.arg4,
      this.preventObj.arg5,
      this.preventObj.arg6,
      this.preventObj.arg7,
      this.preventObj.arg8,
    );
  };
  s.prototype.applyFormValidation = function (e, t) {
    var i = this.parent;
    var r = 0;
    var n =
      this.parent.editSettings.mode !== 'Dialog'
        ? this.parent.editSettings.showAddNewRow && this.parent.element.querySelector('.' + Y)
          ? this.parent.element.querySelector('.' + Y).getElementsByClassName('e-gridform')[0]
          : this.parent.element.getElementsByClassName('e-gridform')[0]
        : Ee('#' + this.parent.element.id + '_dialogEdit_wrapper .e-gridform', document);
    var a = 1;
    var o = {};
    var l = {};
    var h = {};
    e = e || this.parent.getColumns();
    for (var d = 0; d < e.length; d++)
      if (
        !(
          !e[parseInt(d.toString(), 10)].visible &&
          (this.parent.editSettings.mode !== 'Dialog' ||
            (this.parent.groupSettings.columns.indexOf(e[parseInt(d.toString(), 10)].field) === -1 &&
              this.parent.editSettings.mode === 'Dialog'))
        )
      ) {
        if (e[parseInt(d.toString(), 10)].validationRules && u(t)) {
          On(e[parseInt(d.toString(), 10)], 1, o, l, h, e.length);
        }
      }
    o = E(o, l, h);
    this.parent.editModule.formObj = this.createFormObj(n, t || o);
  };
  s.prototype.createFormObj = function (e, t) {
    var i = this;
    return new Aa(e, {
      rules: t,
      locale: this.parent.locale,
      validationComplete: function (r) {
        i.validationComplete(r);
      },
      customPlacement: function (r, n) {
        var a = r.getAttribute('data-mappinguid');
        var o = {
          column: i.parent.getColumnByUid(a),
          error: n,
          inputElement: r,
          value: r.value,
        };
        if (
          (!(event && event.relatedTarget && event.relatedTarget.classList.contains('e-cancelbutton')) &&
            !i.parent.editSettings.showAddNewRow) ||
          (i.parent.editSettings.showAddNewRow &&
            event &&
            event.target &&
            (S(event.target, i.parent.element.id + '_update', true) ||
              (S(event.target, 'e-grid-menu') &&
                (event.target.classList.contains('e-save') || event.target.querySelector('.e-save'))) ||
              i.isShowAddedRowValidate ||
              (S(event.target, 'e-unboundcell') && S(event.target, 'e-update')) ||
              (event.action === 'enter' && (S(event.target, 'e-content') || S(event.target, 'e-addedrow'))))) ||
          (i.parent.editSettings.showAddNewRow && !u(i.parent.element.querySelector('.' + Y)))
        ) {
          i.valErrorPlacement(r, n);
        }
        i.isShowAddedRowValidate = false;
        i.parent.notify(ka, o);
      },
    });
  };
  s.prototype.valErrorPlacement = function (e, t) {
    if (this.parent.isEdit) {
      var i = t.getAttribute('for');
      var r = this.getElemTable(e).querySelector('#' + Er(i) + '_Error');
      r ? (r.querySelector('.e-tip-content').innerHTML = t.outerHTML) : this.createTooltip(e, t, i, '');
    }
  };
  s.prototype.getElemTable = function (e) {
    var t;
    var i = this.parent;
    var r;
    this.parent.editSettings.mode !== 'Dialog'
      ? ((t =
          this.parent.frozenRows &&
          T(e, '.' + de) &&
          this.parent.frozenRows > (parseInt(T(e, '.' + de).getAttribute(q), 10) - 1 || 0)),
        (r = this.parent.isFrozenGrid()
          ? this.parent.element
          : t ||
              (this.parent.editSettings.showAddNewRow &&
                (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling))
            ? this.parent.getHeaderTable()
            : this.parent.getContentTable()))
      : (r = Ee('#' + this.parent.element.id + '_dialogEdit_wrapper', document));
    return r;
  };
  s.prototype.resetElemPosition = function (e, t) {
    var i = S(t.element, ie);
    if (i) {
      var r = i.getBoundingClientRect().right;
      var n = e.getBoundingClientRect().right;
      if (e.getBoundingClientRect().right > i.getBoundingClientRect().right) {
        var a = e.getBoundingClientRect().right - i.getBoundingClientRect().right;
        e.style.left = e.offsetLeft - a + 'px';
      }
    }
  };
  s.prototype.validationComplete = function (e) {
    if (this.parent.isEdit) {
      var t = this.getElemTable(e.element).querySelector('#' + Er(e.inputName) + '_Error');
      if (this.parent.editSettings.showAddNewRow && !t && e.element) {
        var i = S(e.element, 'e-rowcell').querySelector('.e-error');
        if (i) {
          i.classList.remove('e-error');
        }
      }
      if (t) {
        e.status === 'failure' ? ((t.style.display = ''), this.resetElemPosition(t, e)) : (t.style.display = 'none');
      }
    }
  };
  s.prototype.createTooltip = function (e, t, i, r) {
    var n = this.formObj.element;
    var a = S(e, 'e-virtual-validation');
    if (a) {
      n = this.virtualFormObj.element;
    }
    var o = this.parent.getContent().firstElementChild;
    var l = o.scrollHeight > o.clientHeight || o.scrollWidth > o.clientWidth;
    var h = this.parent.editSettings.mode !== 'Dialog';
    var d = T(e, '.' + ie);
    var p = T(e, '.' + de);
    var c;
    var f = false;
    var g;
    var m = false;
    var y =
      this.parent.editSettings.showAddNewRow &&
      !u(S(e, Fe)) &&
      (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling);
    var v = Math.round(this.parent.getContent().clientHeight / this.parent.getRowHeight()) - 1;
    var b = [].slice.call(this.parent.getContent().getElementsByClassName(de));
    if (this.parent.editSettings.mode === 'Batch') {
      b = [].slice.call(this.parent.getContent().querySelectorAll('.e-row:not(.e-hiddenrow)'));
      if (
        v > 1 &&
        b.length > v &&
        parseInt(b[b.length - 1].getAttribute(q), 10) - 1 === parseInt(p.getAttribute(q), 10) - 1
      ) {
        m = true;
      }
    }
    if (h) {
      if (this.parent.frozenRows || y) {
        var w = this.parent.editSettings.showAddNewRow
          ? '.e-row:not(.e-hiddenrow.e-addedrow)'
          : '.e-row:not(.e-hiddenrow)';
        var C = [].slice.call(this.parent.getHeaderTable().querySelector(U).querySelectorAll(w));
        c = C.length > (parseInt(p.getAttribute(q), 10) - 1 || 0);
        f = c && parseInt(p.getAttribute(q), 10) - 1 === C.length - 1;
        var I = [].slice.call(
          this.parent.getHeaderTable().querySelector(U).querySelectorAll('.e-row:not(.e-hiddenrow)'),
        );
        if (I.length === 1 && (I[0].classList.contains('e-addedrow') || I[0].classList.contains('e-insertedrow'))) {
          f = true;
        }
      }
      if (
        f ||
        (v > 1 &&
          b.length > v &&
          ((this.parent.editSettings.newRowPosition === 'Bottom' &&
            this.editModule.args &&
            this.editModule.args.requestType === 'add') ||
            (d.classList.contains('e-lastrowcell') && !p.classList.contains(Fe)))) ||
        m
      ) {
        g = true;
      }
    }
    var x = h
      ? c
        ? this.parent.getHeaderTable()
        : this.parent.getContentTable()
      : Ee('#' + this.parent.element.id + '_dialogEdit_wrapper .e-dlg-content', document);
    var O = x.getBoundingClientRect();
    var A = h ? this.parent.element.getBoundingClientRect().left : O.left;
    var k = T(e, 'td');
    var F = k ? k.getBoundingClientRect() : e.parentElement.getBoundingClientRect();
    var D = this.parent.createElement('div', {
      className: 'e-tooltip-wrap e-lib e-control e-popup e-griderror',
      id: i + '_Error',
    });
    var L =
      'display:' +
      r +
      ';top:' +
      ((c ? F.top + F.height : F.bottom - O.top) + x.scrollTop + 9) +
      'px;left:' +
      (F.left - A + x.scrollLeft + F.width / 2) +
      'px;max-width:' +
      F.width +
      'px;text-align:center;';
    kn(D, L);
    if (this.parent.cssClass) {
      D.classList.add(this.parent.cssClass);
    }
    if (h && O.left < A) {
      D.style.left = parseInt(D.style.left, 10) - O.left + A + 'px';
    }
    var K = this.parent.createElement('div', { className: 'e-tip-content' });
    K.appendChild(t);
    var V;
    g
      ? ((V = this.parent.createElement('div', { className: 'e-arrow-tip e-tip-bottom' })),
        V.appendChild(this.parent.createElement('div', { className: 'e-arrow-tip-outer e-tip-bottom' })),
        V.appendChild(this.parent.createElement('div', { className: 'e-arrow-tip-inner e-tip-bottom' })))
      : ((V = this.parent.createElement('div', { className: 'e-arrow-tip e-tip-top' })),
        V.appendChild(this.parent.createElement('div', { className: 'e-arrow-tip-outer e-tip-top' })),
        V.appendChild(this.parent.createElement('div', { className: 'e-arrow-tip-inner e-tip-top' })));
    D.appendChild(K);
    D.appendChild(V);
    if (!a && (this.parent.frozenRows || y) && this.parent.editSettings.mode !== 'Dialog') {
      var W = this.parent.editSettings.mode === 'Normal' ? T(e, '.e-editcell') : T(e, '.' + Li);
      W.style.position = 'relative';
      D.style.position = 'absolute';
      if (this.parent.editSettings.mode === 'Batch' || T(e, '.' + La) || T(e, '.' + Ma) || this.parent.frozenRows || y)
        if (this.parent.isFrozenGrid())
          if (d.classList.contains('e-unfreeze')) {
            j([D], 'e-unfreeze');
            n.appendChild(D);
          } else {
            var J = T(d, '.e-gridheader')
              ? this.parent.element.querySelector('.e-gridheader')
              : b.length === 1
                ? this.parent.element.querySelector('.e-gridcontent').querySelector('.e-content')
                : this.parent.element.querySelector('.e-gridcontent');
            J.appendChild(D);
            J.style.position = 'relative';
          }
        else n.appendChild(D);
    } else if (a) this.virtualFormObj.element.appendChild(D);
    else if (this.parent.editSettings.mode !== 'Dialog' && this.parent.isFrozenGrid())
      if (d.classList.contains('e-unfreeze')) {
        j([D], 'e-unfreeze');
        this.formObj.element.appendChild(D);
      } else {
        var J = T(d, '.e-gridheader')
          ? this.parent.element.querySelector('.e-gridheader')
          : b.length === 1
            ? this.parent.element.querySelector('.e-gridcontent').querySelector('.e-content')
            : this.parent.element.querySelector('.e-gridcontent');
        J.appendChild(D);
        J.style.position = 'relative';
      }
    else this.formObj.element.appendChild(D);
    if (!u(d)) {
      d.classList.contains('e-fixedfreeze')
        ? D.classList.add('e-fixederror')
        : (d.classList.contains('e-leftfreeze') || d.classList.contains('e-rightfreeze')) &&
          D.classList.add('e-freezeerror');
    }
    if (!g && h && o.getBoundingClientRect().bottom < F.bottom + F.height) {
      var we = this.parent.getContent().querySelector('.e-content');
      this.parent.currentViewData.length === 0 && we.scrollTop === 0
        ? (we.scrollTop = D.offsetHeight + V.scrollHeight)
        : (o.scrollTop = o.scrollTop + D.offsetHeight + V.scrollHeight);
    }
    var he = parseInt(document.defaultView.getComputedStyle(D, null).getPropertyValue('font-size'), 10);
    (this.parent.frozenRows || y) && this.parent.editSettings.mode !== 'Dialog'
      ? (D.style.left = k.offsetLeft + (k.offsetWidth / 2 - D.offsetWidth / 2) + 'px')
      : (D.style.left = parseInt(D.style.left, 10) - D.offsetWidth / 2 + 'px');
    if (
      D.getBoundingClientRect().width < F.width &&
      D.querySelector('label').getBoundingClientRect().height / (he * 1.2) >= 2
    ) {
      D.style.width = D.style.maxWidth;
    }
    if ((h && !l && !this.parent.allowPaging) || this.parent.frozenRows || y) {
      var Be = Ln(k, D);
      D.style.top = Be.top + F.height + 9 + 'px';
    }
    if (g) {
      if (
        l &&
        this.parent.height !== 'auto' &&
        (!this.parent.frozenRows || !y) &&
        !this.parent.enableVirtualization &&
        !this.parent.enableInfiniteScrolling &&
        !(D.classList.contains('e-freezeerror') && D.classList.contains('e-fixederror'))
      ) {
        var $e = o.scrollWidth > o.offsetWidth ? hn() : 0;
        var Ae = this.parent.height.toString().indexOf('%') === -1 ? parseInt(this.parent.height, 10) : o.offsetHeight;
        D.style.bottom = Ae - o.querySelector('table').offsetHeight - $e + F.height + 9 + 'px';
      } else D.style.bottom = F.height + 9 + 'px';
      if (
        b.length < v &&
        this.parent.editSettings.newRowPosition === 'Bottom' &&
        this.editModule.args &&
        this.editModule.args.requestType === 'add'
      ) {
        var Xe = this.parent.frozenRows
          ? (y ? this.parent.frozenRows + 1 : this.parent.frozenRows) + (b.length - 1)
          : b.length - 1;
        var Gn = Xe * this.parent.getRowHeight();
        var Wn = this.parent.getContent().clientHeight - Gn;
        D.style.bottom = Wn + 9 + 'px';
      }
      D.style.top = null;
    }
  };
  s.prototype.checkColumnIsGrouped = function (e) {
    return !e.visible && !(this.parent.groupSettings.columns.indexOf(e.field) > -1);
  };
  s.AddEditors = function (e) {
    s.editCellType = E(s.editCellType, e);
  };
  s.editCellType = {
    dropdownedit: Jo,
    numericedit: Zo,
    datepickeredit: Pr,
    datetimepickeredit: Pr,
    booleanedit: $o,
    defaultedit: Qo,
    templateedit: al,
  };
  return s;
})();
var Fi = function () {
  Fi =
    Object.assign ||
    function (s) {
      for (var e, t = 1, i = arguments.length; t < i; t++) {
        e = arguments[t];
        for (var r in e)
          if (Object.prototype.hasOwnProperty.call(e, r)) {
            s[r] = e[r];
          }
      }
      return s;
    };
  return Fi();
};
var ll = (function () {
  function s(e, t) {
    this.filterColumns = [];
    this.showColumn = [];
    this.hideColumn = [];
    this.changedColumns = [];
    this.unchangedColumns = [];
    this.infiniteLoadedElement = [];
    this.isDlgOpen = false;
    this.isColumnChooserOpen = false;
    this.initialOpenDlg = true;
    this.stateChangeColumns = [];
    this.changedStateColumns = [];
    this.isInitialOpen = false;
    this.isCustomizeOpenCC = false;
    this.searchOperator = 'startswith';
    this.sortDirection = 'None';
    this.selectedColumnModels = [];
    this.selectedColumns = [];
    this.itemsCount = 50;
    this.infiniteSkipCount = 0;
    this.infiniteColumns = [];
    this.infiniteInitialLoad = false;
    this.prevInfiniteScrollDirection = '';
    this.prevShowedCols = [];
    this.hideDialogFunction = this.hideDialog.bind(this);
    this.infiniteRenderMode = false;
    this.parent = e;
    this.serviceLocator = t;
    this.infiniteRenderMode = !!this.parent.enableColumnVirtualization;
    this.addEventListener();
    this.cBoxTrue = Tr(this.parent.createElement, false, {
      checked: true,
      label: ' ',
    });
    this.cBoxFalse = Tr(this.parent.createElement, false, {
      checked: false,
      label: ' ',
    });
    this.cBoxTrue.insertBefore(
      this.parent.createElement('input', {
        className: 'e-chk-hidden e-cc e-cc-chbox',
        attrs: { type: 'checkbox' },
      }),
      this.cBoxTrue.firstChild,
    );
    this.cBoxFalse.insertBefore(
      this.parent.createElement('input', {
        className: 'e-chk-hidden e-cc e-cc-chbox',
        attrs: { type: 'checkbox' },
      }),
      this.cBoxFalse.firstChild,
    );
    this.cBoxFalse.querySelector('.e-frame').classList.add('e-uncheck');
    if (this.parent.enableRtl) {
      j([this.cBoxTrue, this.cBoxFalse], ['e-rtl']);
    }
    if (this.parent.cssClass) {
      this.parent.cssClass.indexOf(' ') !== -1
        ? j([this.cBoxTrue, this.cBoxFalse], this.parent.cssClass.split(' '))
        : j([this.cBoxTrue, this.cBoxFalse], [this.parent.cssClass]);
    }
    if (this.parent.enableAdaptiveUI) {
      this.setFullScreenDialog();
    }
  }
  s.prototype.destroy = function () {
    var e = this;
    var t = this.parent.element;
    if (
      !(
        (!this.parent.element.querySelector('.' + pe) && !this.parent.element.querySelector('.' + Oe)) ||
        !this.parent.element
      ) &&
      (this.removeEventListener(),
      this.unWireEvents(),
      (this.infiniteLoadedElement = null),
      (this.infiniteDiv = null),
      !u(this.dlgObj) && this.dlgObj.element && !this.dlgObj.isDestroyed)
    ) {
      this.parent.isReact && this.parent.columnChooserSettings.template
        ? me.timer
          ? (clearTimeout(me.timer), (me.timer = null))
          : (me.timer = setTimeout(function () {
              if (!u(e.dlgObj) && e.dlgObj.element && !e.dlgObj.isDestroyed) {
                e.dlgObj.destroy();
              }
            }, 0))
        : this.dlgObj.destroy();
      var i = document.getElementById(this.parent.element.id + '_e-popup');
      if (!u(i)) {
        N(i);
        i = null;
      }
    }
  };
  s.prototype.setFullScreenDialog = function () {
    if (this.serviceLocator) {
      this.serviceLocator.registerAdaptiveService(this, this.parent.enableAdaptiveUI, gt.isColumnChooser);
    }
    if (this.parent.enableAdaptiveUI) {
      this.parent.on(At, this.renderResponsiveColumnChooserDiv, this);
      this.parent.on(Re, this.renderResponsiveChangeAction, this);
    }
  };
  s.prototype.rtlUpdate = function () {
    if (!u(this.innerDiv)) {
      this.parent.enableRtl
        ? j([].slice.call(this.innerDiv.getElementsByClassName('e-checkbox-wrapper')), ['e-rtl'])
        : Q([].slice.call(this.innerDiv.getElementsByClassName('e-checkbox-wrapper')), ['e-rtl']);
    }
  };
  s.prototype.addEventListener = function () {
    if (!this.parent.isDestroyed) {
      R.add(document, 'click', this.clickHandler, this);
      this.parent.on(Se, this.enableAfterRenderEle, this);
      this.parent.on(Ce, this.render, this);
      this.parent.addEventListener(Pe, this.hideDialogFunction);
      this.parent.on(M, this.destroy, this);
      this.parent.on(Dr, this.rtlUpdate, this);
      this.parent.on(Rr, this.onResetColumns, this);
      this.parent.on(_e, this.setFullScreenDialog, this);
      if (this.parent.enableAdaptiveUI) {
        this.parent.on(Re, this.renderResponsiveChangeAction, this);
      }
      if (this.infiniteRenderMode || this.parent.enableAdaptiveUI) {
        this.parent.on(At, this.renderResponsiveColumnChooserDiv, this);
      }
    }
  };
  s.prototype.removeEventListener = function () {
    if (!this.parent.isDestroyed) {
      R.remove(document, 'click', this.clickHandler);
      this.parent.off(Ce, this.render);
      this.parent.off(M, this.destroy);
      this.parent.off(Se, this.enableAfterRenderEle);
      this.parent.off(Dr, this.rtlUpdate);
      this.parent.off(Rr, this.onResetColumns);
      this.parent.removeEventListener(Pe, this.hideDialogFunction);
      this.parent.off(_e, this.setFullScreenDialog);
      if (this.infiniteDiv) {
        R.remove(this.infiniteDiv, 'scroll', this.infiniteScrollHandler);
        R.remove(this.infiniteDiv, 'mouseup', this.infiniteScrollMouseKeyUpHandler);
        R.remove(this.infiniteDiv, 'mousedown', this.infiniteScrollMouseKeyDownHandler);
      }
      if (this.parent.enableAdaptiveUI) {
        this.parent.off(_e, this.setFullScreenDialog);
        this.parent.off(Re, this.renderResponsiveChangeAction);
      }
      if (this.infiniteRenderMode || this.parent.enableAdaptiveUI) {
        this.parent.off(At, this.renderResponsiveColumnChooserDiv);
      }
    }
  };
  s.prototype.render = function () {
    this.l10n = this.serviceLocator.getService('localization');
    if (!this.parent.enableAdaptiveUI) {
      this.renderDlgContent();
    }
    this.getShowHideService = this.serviceLocator.getService('showHideService');
  };
  s.prototype.clickHandler = function (e) {
    var t = e.target;
    if (!this.isCustomizeOpenCC) {
      if (!u(T(e.target, '.e-cc-toolbar')) || !u(T(e.target, '.e-cc')))
        if (e.target.classList.contains('e-columnchooser-btn') || e.target.classList.contains('e-cc-toolbar')) {
          if ((this.initialOpenDlg && this.dlgObj.visible) || !this.isDlgOpen) {
            this.isDlgOpen = true;
            return;
          }
        } else if (e.target.classList.contains('e-cc-cancel')) {
          e.target.parentElement.querySelector('.e-ccsearch').value = '';
          this.columnChooserSearch('', false);
          this.removeCancelIcon();
          this.refreshCheckboxButton();
        } else if (!u(this.dlgObj) && this.dlgObj.visible && !e.target.classList.contains('e-toolbar-items')) {
          this.dlgObj.hide();
          this.clearActions();
          this.refreshCheckboxState();
          this.isDlgOpen = false;
        }
      if (this.parent.detailTemplate || this.parent.childGrid) {
        this.targetdlg = e.target;
      }
    }
    if (this.isCustomizeOpenCC && e.target.classList.contains('e-cc-cancel')) {
      this.refreshCheckboxState();
    }
    this.parent.enableAdaptiveUI
      ? this.parent.enableRtl && j([this.cBoxTrue, this.cBoxFalse], ['e-rtl'])
      : this.rtlUpdate();
  };
  s.prototype.hideDialog = function () {
    if (!u(this.dlgObj) && this.dlgObj.visible) {
      this.parent.enableAdaptiveUI
        ? this.responsiveDialogRenderer.hideResponsiveColumnChooser()
        : (this.dlgObj.hide(), (this.isDlgOpen = false));
    }
  };
  s.prototype.renderColumnChooser = function (e, t, i) {
    if (!this.dlgObj.visible && (this.parent.detailTemplate || this.parent.childGrid)) {
      this.hideOpenedDialog();
    }
    if (this.dlgObj.visible) {
      this.hideDialog();
      this.addcancelIcon();
      this.clearActions();
      this.refreshCheckboxState();
    } else {
      var r = this.beforeOpenColumnChooserEvent();
      if (r.cancel) return;
      if (
        !this.infiniteRenderMode &&
        this.selectedColumns.length &&
        this.sortDirection === 'None' &&
        !this.parent.columnChooserSettings.template
      ) {
        this.setOrderedColumns();
      }
      r.columns = null;
      if (i) {
        this.targetdlg = i;
      }
      if (this.infiniteRenderMode) {
        this.dlgObj.show();
      }
      this.refreshCheckboxState();
      this.dlgObj.dataBind();
      this.dlgObj.element.style.maxHeight = '430px';
      var n = this.dlgObj.element.style.display;
      if (!this.parent.columnChooserSettings.enableSearching) {
        var a = this.dlgObj.element.querySelector('.e-dlg-content');
        a.style.margin = '0px';
      }
      this.dlgObj.element.style.display = 'block';
      var o = this.parent.getHeaderContent().classList.contains('e-sticky');
      var l = T(i, '.e-toolbar-item');
      var h = void 0;
      if (
        document.getElementById(this.parent.element.id + '_e-popup') &&
        document.getElementById(this.parent.element.id + '_e-popup').querySelector('.e-ccdlg')
      ) {
        this.parent.element.appendChild(this.dlgObj.element);
      }
      o
        ? ((h = l.getBoundingClientRect()), this.dlgObj.element.classList.add('e-sticky'))
        : (this.dlgObj.element.classList.remove('e-sticky'), (h = Ln(l, this.dlgObj.element)));
      this.dlgObj.element.style.display = this.dlgObj.element.style.display;
      this.dlgObj.element.style.top = h.top + T(i, '.e-cc-toolbar').getBoundingClientRect().height + 'px';
      var d = 250;
      if (!u(T(i, '.e-bigger'))) {
        this.dlgObj.width = 258;
      }
      z.isDevice
        ? ((this.dlgObj.position = {
            X: 'center',
            Y: 'center',
          }),
          this.dlgObj.refreshPosition(),
          (this.dlgObj.open = this.mOpenDlg.bind(this)))
        : this.parent.enableRtl
          ? (this.dlgObj.element.style.left = i.offsetLeft + 'px')
          : (this.dlgObj.element.style.left = h.left - 250 + T(i, '.e-cc-toolbar').clientWidth + 2 + 'px');
      this.removeCancelIcon();
      if (!this.infiniteRenderMode) {
        this.dlgObj.show();
      }
      if (
        this.parent.getContent().firstElementChild.offsetHeight < this.dlgObj.element.offsetHeight &&
        !this.parent.element.classList.contains('e-drillthrough-grid')
      ) {
        ci(this.parent, this.dlgObj);
        if (this.dlgObj.element.querySelector('.e-ccsearch')) {
          this.dlgObj.element.querySelector('.e-ccsearch').select();
        }
      }
      this.parent.notify(qa, { dialog: this.dlgObj });
    }
    this.rtlUpdate();
  };
  s.prototype.openColumnChooser = function (e, t) {
    this.isCustomizeOpenCC = true;
    if (this.parent.enableAdaptiveUI) {
      if (!this.isColumnChooserOpen) {
        this.parent.showResponsiveCustomColumnChooser();
        return;
      }
      this.isColumnChooserOpen = false;
      this.renderDlgContent();
    }
    if (this.dlgObj.visible) {
      this.hideDialog();
      return;
    }
    var i = this.beforeOpenColumnChooserEvent();
    if (!i.cancel) {
      if (
        !this.infiniteRenderMode &&
        this.selectedColumns.length &&
        this.sortDirection === 'None' &&
        !this.parent.columnChooserSettings.template
      ) {
        this.setOrderedColumns();
      }
      i.columns = null;
      if (this.infiniteRenderMode) {
        this.dlgObj.show();
      }
      this.isInitialOpen
        ? this.refreshCheckboxState()
        : ((this.dlgObj.content = this.renderChooserList()),
          this.parent.columnChooserSettings.template || this.updateIntermediateBtn());
      this.dlgObj.dataBind();
      if (this.infiniteRenderMode) {
        this.refreshCheckboxState();
      }
      this.dlgObj.position = {
        X: 'center',
        Y: 'center',
      };
      u(e)
        ? (this.parent.enableAdaptiveUI &&
            (this.dlgObj.position = {
              X: '',
              Y: '',
            }),
          this.dlgObj.refreshPosition())
        : ((this.dlgObj.element.style.top = ''),
          (this.dlgObj.element.style.left = ''),
          (this.dlgObj.element.style.top = t + 'px'),
          (this.dlgObj.element.style.left = e + 'px'));
      if (!this.parent.columnChooserSettings.enableSearching) {
        var r = this.dlgObj.element.querySelector('.e-dlg-content');
        r.style.margin = '0px';
      }
      this.dlgObj.beforeOpen = this.customDialogOpen.bind(this);
      if (!this.infiniteRenderMode) {
        this.dlgObj.show();
      }
      if (
        this.parent.getContent().firstElementChild.offsetHeight < this.dlgObj.element.offsetHeight &&
        !this.parent.element.classList.contains('e-drillthrough-grid')
      ) {
        ci(this.parent, this.dlgObj);
      }
      this.isInitialOpen = true;
      this.dlgObj.beforeClose = this.customDialogClose.bind(this);
    }
  };
  s.prototype.enableAfterRenderEle = function (e) {
    if (e.module === this.getModuleName() && e.enable) {
      this.render();
    }
  };
  s.prototype.keyUpHandler = function (e) {
    if (e.key === 'Escape') {
      this.resetColumnState();
    }
    if (e && e.target && !u(T(e.target, '.e-grid-popup'))) {
      this.parent.trigger('keyPressed', e);
    }
    this.setFocus(S(e.target, 'e-cclist'));
  };
  s.prototype.setFocus = function (e) {
    var t = this.dlgDiv.querySelector('.e-colfocus');
    if (t) {
      t.classList.remove('e-colfocus');
    }
    if (e) {
      e.classList.add('e-colfocus');
    }
  };
  s.prototype.customDialogOpen = function () {
    var e = this.dlgObj.content.querySelector('input.e-ccsearch');
    R.add(e, 'keyup', this.columnChooserManualSearch, this);
  };
  s.prototype.customDialogClose = function () {
    var e = this.dlgObj.content.querySelector('input.e-ccsearch');
    R.remove(e, 'keyup', this.columnChooserManualSearch);
  };
  s.prototype.getColumns = function () {
    var e = (this.infiniteRenderMode ? this.infiniteColumns : this.parent.getColumns()).filter(function (t) {
      return (t.type !== 'checkbox' && t.showInColumnChooser === true) || (t.type === 'checkbox' && t.field !== void 0);
    });
    return e;
  };
  s.prototype.setOrderedColumns = function () {
    this.selectedColumnModels = [];
    for (var e = 0; e < this.selectedColumns.length; e++) {
      var t = this.parent.getColumnByField(this.selectedColumns[parseInt(e.toString(), 10)]);
      if (t.showInColumnChooser) {
        this.selectedColumnModels.push(t);
      }
    }
  };
  s.prototype.renderDlgContent = function () {
    var e = this.parent.enableAdaptiveUI;
    this.dlgDiv = this.parent.createElement('div', {
      className: 'e-ccdlg e-cc',
      id: this.parent.element.id + '_ccdlg',
    });
    if (!this.parent.enableAdaptiveUI) {
      this.parent.element.appendChild(this.dlgDiv);
    }
    this.dlgObj = new Wt({
      header: this.parent.enableAdaptiveUI ? null : this.renderHeader(),
      showCloseIcon: false,
      closeOnEscape: false,
      locale: this.parent.locale,
      visible: false,
      enableRtl: this.parent.enableRtl,
      target: document.getElementById(this.parent.element.id),
      content: this.renderChooserList(),
      width: 250,
      cssClass: this.parent.cssClass ? 'e-cc ' + this.parent.cssClass : 'e-cc',
      animationSettings: { effect: 'None' },
      footerTemplate: this.parent.enableAdaptiveUI ? null : this.renderFooter(),
    });
    if (
      !this.parent.enableAdaptiveUI &&
      (this.infiniteRenderMode || !this.parent.columnChooserSettings.footerTemplate)
    ) {
      this.dlgObj.buttons = [
        {
          click: this.confirmDlgBtnClick.bind(this),
          buttonModel: {
            content: this.l10n.getConstant('OKButton'),
            isPrimary: true,
            cssClass: this.parent.cssClass ? 'e-cc e-cc_okbtn ' + this.parent.cssClass : 'e-cc e-cc_okbtn',
          },
        },
        {
          click: this.clearBtnClick.bind(this),
          buttonModel: {
            cssClass: this.parent.cssClass
              ? 'e-flat e-cc e-cc-cnbtn ' + this.parent.cssClass
              : 'e-flat e-cc e-cc-cnbtn',
            content: this.l10n.getConstant('CancelButton'),
          },
        },
      ];
    }
    var t = 'isStringTemplate';
    this.dlgObj.isStringTemplate = true;
    this.dlgObj.appendTo(this.dlgDiv);
    if (this.parent.enableAdaptiveUI) {
      var i = document.querySelector('.e-responsive-dialog > .e-dlg-content > .e-mainfilterdiv');
      if (i) {
        i.appendChild(this.dlgDiv);
      }
      this.dlgObj.open = this.mOpenDlg.bind(this);
      this.dlgObj.target = document.querySelector('.e-rescolumnchooser > .e-dlg-content > .e-mainfilterdiv');
    }
    this.wireEvents();
  };
  s.prototype.renderHeader = function () {
    var e = this.parent;
    if (this.parent.columnChooserSettings.headerTemplate && !this.infiniteRenderMode) {
      var t = this.parent.createElement('div', { className: 'e-columnChooserHeaderTemplate' });
      var i = this.parent.element.id + 'columnChooserHeaderTemplate';
      this.parent.isReact
        ? (this.parent.getColumnChooserHeaderTemplate()(
            null,
            this.parent,
            'columnChooserHeaderTemplate',
            i,
            null,
            null,
            t,
          ),
          this.parent.renderTemplates())
        : ae(t, this.parent.getColumnChooserHeaderTemplate()(null, this.parent, 'columnChooserHeaderTemplate', i));
      return t;
    }
    return this.l10n.getConstant('ChooseColumns');
  };
  s.prototype.renderFooter = function () {
    var e = this.parent;
    if (this.parent.columnChooserSettings.footerTemplate && !this.infiniteRenderMode) {
      var t = this.parent.createElement('div', { className: 'e-columnChooserFooterTemplate' });
      var i = this.parent.element.id + 'columnChooserFooterTemplate';
      this.parent.isReact
        ? (this.parent.getColumnChooserFooterTemplate()(
            null,
            this.parent,
            'columnChooserFooterTemplate',
            i,
            null,
            null,
            t,
          ),
          this.parent.renderTemplates())
        : ae(t, this.parent.getColumnChooserFooterTemplate()(null, this.parent, 'columnChooserFooterTemplate', i));
      return t;
    }
    return null;
  };
  s.prototype.renderChooserList = function () {
    this.mainDiv = this.parent.createElement('div', { className: 'e-main-div e-cc' });
    var e = this.parent.createElement('div', { className: 'e-cc-searchdiv e-cc e-input-group' });
    var t = this.parent.createElement('input', {
      className: 'e-ccsearch e-cc e-input',
      attrs: {
        placeholder: this.l10n.getConstant('Search'),
        cssClass: this.parent.cssClass,
      },
    });
    var i = this.parent.createElement('span', {
      className: 'e-ccsearch-icon e-icons e-cc e-input-group-icon',
      attrs: { title: this.l10n.getConstant('Search') },
    });
    var r = this.parent.createElement('div', { className: 'e-cc-contentdiv' });
    this.innerDiv = this.parent.createElement('div', { className: 'e-innerdiv e-cc' });
    e.appendChild(t);
    e.appendChild(i);
    this.searchBoxObj = new cn(t, this.serviceLocator);
    var n = this.getColumns();
    var a = [];
    var o = [];
    n.forEach(function (g) {
      g.visible ? a.push(g.headerText) : o.push(g.headerText);
    });
    if (this.infiniteRenderMode && !this.isInitialOpen) {
      n = this.parent.columns;
      for (var l = 0; l < n.length; l++)
        if (n[parseInt(l.toString(), 10)].showInColumnChooser) {
          this.infiniteColumns.push(n[parseInt(l.toString(), 10)]);
        }
    }
    if (this.parent.columnChooserSettings.template && !this.infiniteRenderMode) {
      var h = this.parent.createElement('div', { className: 'e-columnChooserTemplate' });
      h.style.cssText = this.parent.enableAdaptiveUI
        ? 'height: 90%; min-height: 160px; overflow-y: auto;'
        : 'height: 196px; overflow-y: auto;';
      var d = this.parent.element.id + 'columnChooserTemplate';
      var p = {
        columns: n,
        hideColumns: o,
        showColumns: a,
      };
      this.parent.isReact
        ? (this.parent.getColumnChooserTemplate()(p, this.parent, 'columnChooserTemplate', d, null, null, h),
          this.parent.renderTemplates())
        : ae(
            h,
            this.parent.getColumnChooserTemplate()(
              p,
              this.parent,
              'columnChooserTemplate',
              d,
              null,
              null,
              null,
              this.parent.root,
            ),
          );
      if (this.parent.columnChooserSettings.renderCustomColumnChooser) {
        typeof this.parent.columnChooserSettings.renderCustomColumnChooser == 'function'
          ? this.parent.columnChooserSettings.renderCustomColumnChooser(h, n)
          : typeof this.parent.columnChooserSettings.renderCustomColumnChooser == 'string' &&
            ((this.parent.columnChooserSettings.renderCustomColumnChooser = te(
              this.parent.columnChooserSettings.renderCustomColumnChooser,
              window,
            )),
            this.parent.columnChooserSettings.renderCustomColumnChooser(h, n));
      }
      this.mainDiv.appendChild(e);
      this.mainDiv.appendChild(h);
    } else {
      var c = this.refreshCheckboxList(n);
      this.innerDiv.appendChild(c);
      r.appendChild(this.innerDiv);
      if (this.parent.enableAdaptiveUI) {
        var f = this.parent.createElement('div', { className: 'e-cc-searchBox' });
        f.appendChild(e);
        this.mainDiv.appendChild(f);
      } else this.mainDiv.appendChild(e);
      this.mainDiv.appendChild(r);
    }
    if (!this.parent.columnChooserSettings.enableSearching) {
      e.style.display = 'none';
    }
    return this.mainDiv;
  };
  s.prototype.confirmDlgBtnClick = function (e) {
    var t = {
      requestType: 'columnVisibilityUpdate',
      columns: this.getColumns(),
      cancel: false,
    };
    this.parent.trigger(_, t);
    if (!t.cancel) {
      this.stateChangeColumns = [];
      this.changedStateColumns = [];
      var i = this.infiniteRenderMode ? this.infiniteColumns : this.parent.getColumns();
      this.changedColumns = this.changedColumns.length > 0 ? this.changedColumns : this.unchangedColumns;
      this.changedColumnState(this.changedColumns);
      var r = this.infiniteRenderMode
        ? this.infiniteLoadedElement.filter(function (o) {
            return o.querySelector('.e-uncheck');
          }).length
        : this.ulElement &&
          this.ulElement.querySelector('.e-uncheck') &&
          this.ulElement.querySelectorAll('.e-uncheck:not(.e-selectall)').length;
      if (!u(e)) {
        if (
          r < i.length &&
          (this.changeColumnVisibility(
            {
              visibleColumns: this.showColumn,
              hiddenColumns: this.hideColumn,
            },
            'uid',
          ),
          this.parent.getCurrentViewRecords().length === 0)
        ) {
          var n = this.parent.element.querySelector('.e-emptyrow').querySelector('td');
          n.setAttribute('colSpan', this.parent.getVisibleColumns().length.toString());
        }
        if (this.parent.enableAdaptiveUI && this.parent.scrollModule) {
          this.parent.scrollModule.refresh();
        }
        if (this.parent.editSettings.showAddNewRow) {
          this.parent.notify(xi, {});
        }
      }
      var a = {
        requestType: 'columnVisibilityUpdate',
        columns: this.getColumns(),
        cancel: false,
      };
      this.parent.trigger(B, a);
    }
  };
  s.prototype.changeColumnVisibility = function (e, t) {
    t = t || 'headerText';
    if (t !== 'uid' && (e.visibleColumns || e.hiddenColumns)) {
      this.stateChangeColumns = [];
      this.changedStateColumns = [];
      var i = this.getColumns();
      e.hiddenColumns = i
        .filter(function (r) {
          return e.hiddenColumns.indexOf(r[t]) !== -1;
        })
        .map(function (r) {
          return r.uid;
        });
      e.visibleColumns = i
        .filter(function (r) {
          return e.visibleColumns.indexOf(r[t]) !== -1;
        })
        .map(function (r) {
          return r.uid;
        });
    }
    if (e.hiddenColumns.length) {
      this.columnStateChange(e.hiddenColumns, false);
    }
    if (e.visibleColumns.length) {
      this.columnStateChange(e.visibleColumns, true);
    }
    this.getShowHideService.setVisible(this.stateChangeColumns, this.changedStateColumns);
    this.clearActions();
    this.parent.notify(Ut, { module: 'edit' });
  };
  s.prototype.onResetColumns = function (e) {
    if (e.requestType === 'columnstate') {
      this.resetColumnState();
      return;
    }
  };
  s.prototype.renderResponsiveColumnChooserDiv = function (e) {
    e.action === 'open'
      ? ((this.isColumnChooserOpen = true), this.openColumnChooser())
      : e.action === 'clear'
        ? this.clearBtnClick()
        : e.action === 'confirm' && this.confirmDlgBtnClick(true);
  };
  s.prototype.resetColumnState = function () {
    this.showColumn = [];
    this.hideColumn = [];
    this.changedColumns = [];
    this.filterColumns = [];
    this.searchValue = '';
    this.selectedColumnModels = [];
    this.selectedColumns = [];
    this.sortDirection = '';
    if (this.infiniteRenderMode) {
      var e = this.dlgDiv.querySelector('.e-cclist.e-cc-selectall.e-colfocus');
      if (e) {
        e.classList.remove('e-colfocus');
      }
    }
    this.hideDialog();
  };
  s.prototype.changedColumnState = function (e) {
    for (var t = 0; t < e.length; t++) {
      var i = e[parseInt(t.toString(), 10)];
      var r = this.parent.getColumnByUid(e[parseInt(t.toString(), 10)], this.infiniteRenderMode);
      this.changedStateColumns.push(r);
    }
  };
  s.prototype.columnStateChange = function (e, t) {
    for (var i = 0; i < e.length; i++) {
      var r = e[parseInt(i.toString(), 10)];
      var n = this.parent.getColumnByUid(e[parseInt(i.toString(), 10)], this.infiniteRenderMode);
      if (n) {
        if (n.type !== 'checkbox') {
          n.visible = t;
        }
        this.stateChangeColumns.push(n);
      }
    }
  };
  s.prototype.clearActions = function () {
    this.resetColumnState();
    this.addcancelIcon();
  };
  s.prototype.clearBtnClick = function () {
    var e = {
      requestType: 'columnChooserClose',
      cancel: false,
    };
    this.parent.trigger(_, e);
    if (!e.cancel) {
      this.clearActions();
      this.parent.notify(za, { dialog: this.dlgObj });
      var t = {
        requestType: 'columnChooserClose',
        cancel: false,
      };
      this.parent.trigger(B, t);
    }
  };
  s.prototype.checkstatecolumn = function (e, t, i) {
    if (i === void 0) {
      i = false;
    }
    var r = this.parent.getColumnByUid(t, this.infiniteRenderMode);
    e
      ? (this.hideColumn.indexOf(t) !== -1 && this.hideColumn.splice(this.hideColumn.indexOf(t), 1),
        this.showColumn.indexOf(t) === -1 && !(r && r.visible) && this.showColumn.push(t))
      : (this.showColumn.indexOf(t) !== -1 && this.showColumn.splice(this.showColumn.indexOf(t), 1),
        this.hideColumn.indexOf(t) === -1 && r && r.visible && this.hideColumn.push(t));
    i
      ? e
        ? this.unchangedColumns.push(t)
        : this.changedColumns.push(t)
      : this.changedColumns.indexOf(t) !== -1
        ? this.changedColumns.splice(this.changedColumns.indexOf(t), 1)
        : this.changedColumns.push(t);
  };
  s.prototype.columnChooserSearch = function (e, t) {
    if (t) {
      var i = {
        requestType: 'columnChooserSearch',
        columns: this.getColumns(),
        cancel: false,
      };
      this.parent.trigger(_, i);
      if (i.cancel) return;
    }
    var r = false;
    var n;
    var a = this.dlgDiv.querySelector('.e-footer-content');
    var o =
      this.ulElement &&
      this.ulElement.querySelector('.e-check') &&
      this.ulElement.querySelectorAll('.e-check:not(.e-selectall)').length;
    if (this.infiniteRenderMode) {
      o = this.infiniteLoadedElement.filter(function (w) {
        return w.querySelector('.e-check');
      }).length;
    }
    this.isInitialOpen = true;
    if (a && a.querySelector('.e-btn')) {
      n = a.querySelector('.e-btn').ej2_instances[0];
    }
    if (e === '') {
      this.removeCancelIcon();
      this.filterColumns = this.selectedColumnModels.length ? this.selectedColumnModels : this.getColumns();
      r = true;
    } else {
      var l = this.selectedColumnModels.length ? this.selectedColumnModels : this.getColumns();
      this.filterColumns = new H(l).executeLocal(
        new ue().where('headerText', this.searchOperator, e, true, this.parent.columnChooserSettings.ignoreAccent),
      );
    }
    if (
      this.selectedColumnModels.length === 0 &&
      this.sortDirection !== 'None' &&
      !this.parent.columnChooserSettings.template
    ) {
      this.filterColumns = this.sortColumnChooser(this.filterColumns, this.sortDirection);
    }
    if (this.infiniteRenderMode) {
      this.updateIfiniteSelectAll();
    }
    if (this.parent.columnChooserSettings.template && !this.infiniteRenderMode) {
      var h = void 0;
      var d = this.parent.isReact;
      this.parent.isReact
        ? (Na(this.parent, ['columnChooserTemplate']), (h = this.mainDiv.querySelector('.e-columnChooserTemplate')))
        : (this.mainDiv.querySelector('.e-columnChooserTemplate').remove(),
          (h = this.parent.createElement('div', { className: 'e-columnChooserTemplate' })),
          (h.style.cssText = this.parent.enableAdaptiveUI
            ? 'height: 90%; min-height: 160px; overflow-y: auto;'
            : 'height: 196px; overflow-y: auto;'));
      var p = this.parent.element.id + 'columnChooserTemplate';
      var c = this.filterColumns;
      var f = e;
      var g = [];
      var m = [];
      c.forEach(function (w) {
        w.visible ? g.push(w.headerText) : m.push(w.headerText);
      });
      var y = {
        columns: c,
        hideColumns: m,
        showColumns: g,
        searchValue: e,
      };
      this.parent.isReact
        ? (this.parent.getColumnChooserTemplate()(y, this.parent, 'columnChooserTemplate', p, null, null, h),
          this.parent.renderTemplates())
        : ae(
            h,
            this.parent.getColumnChooserTemplate()(
              y,
              this.parent,
              'columnChooserTemplate',
              p,
              null,
              null,
              null,
              this.parent.root,
            ),
          );
      if (this.parent.columnChooserSettings.renderCustomColumnChooser) {
        typeof this.parent.columnChooserSettings.renderCustomColumnChooser == 'function'
          ? this.parent.columnChooserSettings.renderCustomColumnChooser(h, this.filterColumns)
          : typeof this.parent.columnChooserSettings.renderCustomColumnChooser == 'string' &&
            ((this.parent.columnChooserSettings.renderCustomColumnChooser = te(
              this.parent.columnChooserSettings.renderCustomColumnChooser,
              window,
            )),
            this.parent.columnChooserSettings.renderCustomColumnChooser(h, this.filterColumns));
      }
      this.mainDiv.appendChild(h);
    } else if (this.filterColumns.length) {
      this.innerDiv.innerHTML = ' ';
      this.innerDiv.classList.remove('e-ccnmdiv');
      this.infiniteInitialLoad = true;
      this.infiniteLoadedElement = [];
      this.innerDiv.appendChild(this.refreshCheckboxList(this.filterColumns));
      if (this.infiniteRenderMode) {
        this.mainDiv.querySelector('.e-ccheck .e-selectall').parentElement.classList.remove('e-checkbox-disabled');
        this.updateIntermediateBtn();
      }
      r
        ? (n && o && (n.disabled = false),
          o &&
            this.parent.enableAdaptiveUI &&
            this.responsiveDialogRenderer &&
            this.parent.notify(Je, { disabled: false }))
        : (this.addcancelIcon(), this.refreshCheckboxButton());
    } else {
      var v = this.parent.createElement('span', { className: 'e-cc e-nmatch' });
      v.innerHTML = this.l10n.getConstant('Matchs');
      this.innerDiv.innerHTML = ' ';
      if (this.infiniteRenderMode) {
        Q([this.mainDiv.querySelector('.e-frame.e-selectall')], ['e-check', 'e-stop', 'e-uncheck']);
        this.mainDiv.querySelector('.e-ccheck .e-selectall').parentElement.classList.add('e-checkbox-disabled');
      }
      this.innerDiv.appendChild(v);
      this.innerDiv.classList.add('e-ccnmdiv');
      if (n) {
        n.disabled = true;
      }
      if (this.parent.enableAdaptiveUI && this.responsiveDialogRenderer) {
        this.parent.notify(Je, { disabled: true });
      }
    }
    this.flag = true;
    this.stopTimer();
    if (t) {
      var b = {
        requestType: 'columnChooserSearch',
        columns: this.getColumns(),
        cancel: false,
      };
      this.parent.trigger(B, b);
    }
  };
  s.prototype.sortColumnChooser = function (e, t) {
    return t === 'Ascending'
      ? e.slice().sort(function (i, r) {
          return i.field.toLowerCase() < r.field.toLowerCase() ? -1 : 1;
        })
      : t === 'Descending'
        ? e.slice().sort(function (i, r) {
            return i.field.toLowerCase() > r.field.toLowerCase() ? -1 : 1;
          })
        : e;
  };
  s.prototype.updateIfiniteSelectAll = function () {
    this.changedColumns = [];
    this.hideColumn = [];
    this.showColumn = [];
    for (
      var e = this.infiniteLoadedElement.filter(function (i) {
          return i.querySelector('.e-uncheck');
        }),
        t = 0;
      t < e.length;
      t++
    )
      this.checkState(e[parseInt(t.toString(), 10)].querySelector('.e-frame'), true);
  };
  s.prototype.wireEvents = function () {
    R.add(this.dlgObj.element, 'click', this.checkBoxClickHandler, this);
    R.add(this.searchBoxObj.searchBox, 'keyup', this.columnChooserManualSearch, this);
    R.add(this.dlgObj.element, 'keyup', this.keyUpHandler, this);
    this.searchBoxObj.wireEvent();
  };
  s.prototype.unWireEvents = function () {
    if (!this.parent.isDestroyed) {
      if (this.dlgObj && this.dlgObj.element) {
        R.remove(this.dlgObj.element, 'click', this.checkBoxClickHandler);
        R.remove(this.dlgObj.element, 'keyup', this.keyUpHandler);
      }
      if (this.searchBoxObj) {
        R.remove(this.searchBoxObj.searchBox, 'keyup', this.columnChooserManualSearch);
        this.searchBoxObj.unWireEvent();
      }
    }
  };
  s.prototype.checkBoxClickHandler = function (e) {
    if (!(this.parent.columnChooserSettings.template && !this.infiniteRenderMode)) {
      var t;
      var i = S(e.target, 'e-checkbox-wrapper');
      var r = this.infiniteRenderMode ? this.infiniteColumns : this.parent.getColumns();
      if (i) {
        var n = i.querySelector('.e-selectall');
        n ? this.updateSelectAll(!i.querySelector('.e-check')) : Pa(i.parentElement);
        i.querySelector('.e-chk-hidden').focus();
        i.querySelector('.e-check') ? (t = true) : i.querySelector('.e-uncheck') && (t = false);
        if (!this.infiniteRenderMode) {
          this.updateIntermediateBtn();
        }
        var a = S(i, 'e-ccheck').getAttribute('data-uid');
        var o =
          (this.searchValue && this.searchValue.length) || this.selectedColumnModels.length ? this.filterColumns : r;
        if (a === this.parent.element.id + '-selectAll') {
          this.changedColumns = [];
          this.unchangedColumns = [];
          for (var l = 0; l < o.length; l++)
            if (o[parseInt(l.toString(), 10)].showInColumnChooser) {
              this.checkstatecolumn(t, o[parseInt(l.toString(), 10)].uid, true);
            }
        } else this.checkstatecolumn(t, a);
        var h = false;
        if (!this.parent.columnChooserSettings.footerTemplate) {
          this.refreshCheckboxButton(h);
        }
        this.setFocus(S(e.target, 'e-cclist'));
        if (this.infiniteRenderMode) {
          this.updateIntermediateBtn();
        }
      }
    }
  };
  s.prototype.updateIntermediateBtn = function () {
    var e = this.infiniteRenderMode ? this.infiniteLoadedElement.length : this.ulElement.children.length - 1;
    var t = [];
    var i = 0;
    var r = 0;
    ((this.searchValue && this.searchValue.length) || this.sortDirection !== 'None'
      ? this.filterColumns
      : this.infiniteColumns
    ).filter(function (h) {
      h.visible === false ? i++ : r++;
    });
    var n = (
      this.infiniteRenderMode && this.mainDiv.querySelector('.e-cc-selectall')
        ? this.mainDiv.querySelector('.e-cc-selectall')
        : this.ulElement.children[0]
    ).querySelector('.e-frame');
    var a = this.infiniteRenderMode
      ? this.infiniteLoadedElement.filter(function (h) {
          return h.querySelector('.e-check');
        }).length
      : this.ulElement.querySelectorAll('.e-check:not(.e-selectall)').length;
    var o;
    !this.parent.enableAdaptiveUI && !this.parent.columnChooserSettings.footerTemplate
      ? ((o = this.dlgObj.btnObj[0]), (o.disabled = false))
      : this.parent.enableAdaptiveUI && this.responsiveDialogRenderer && this.parent.notify(Je, { disabled: false });
    var l = n.parentElement.querySelector('input');
    e === a && (!this.infiniteRenderMode || (this.infiniteRenderMode && i === this.showColumn.length))
      ? ((t = ['e-check']), at(l, true))
      : a || (this.infiniteRenderMode && !a && r !== this.hideColumn.length)
        ? ((t = ['e-stop']), (l.indeterminate = true))
        : ((t = ['e-uncheck']),
          at(l, false),
          o && !this.parent.enableAdaptiveUI
            ? (o.disabled = true)
            : this.parent.enableAdaptiveUI &&
              this.responsiveDialogRenderer &&
              this.parent.notify(Je, { disabled: true }));
    if (o && !this.parent.enableAdaptiveUI) {
      o.dataBind();
    }
    Q([n], ['e-check', 'e-stop', 'e-uncheck']);
    j([n], t);
  };
  s.prototype.updateSelectAll = function (e) {
    var t = [].slice.call(this.ulElement.getElementsByClassName('e-frame'));
    if (this.infiniteRenderMode) {
      t = [];
      this.infiniteLoadedElement.map(function (o) {
        return t.push(o.querySelector('.e-frame'));
      });
      t.unshift(this.mainDiv.querySelector('.e-cc-selectall').querySelector('.e-frame'));
    }
    for (var i = 0, r = t; i < r.length; i++) {
      var n = r[i];
      Ha(r[i], e);
      var a = r[i].parentElement.querySelector('input');
      r[i].classList.contains('e-check') ? at(a, true) : r[i].classList.contains('e-uncheck') && at(a, false);
    }
  };
  s.prototype.refreshCheckboxButton = function (e) {
    for (var t = this.parent.getVisibleColumns(), i = 0; i < t.length; i++) {
      var r = t[parseInt(i.toString(), 10)].uid;
      if (
        this.prevShowedCols.indexOf(t[parseInt(i.toString(), 10)].uid) === -1 &&
        t[parseInt(i.toString(), 10)].type !== 'checkbox'
      ) {
        this.prevShowedCols.push(t[parseInt(i.toString(), 10)].uid);
      }
    }
    for (var i = 0; i < this.hideColumn.length; i++) {
      var n = this.prevShowedCols.indexOf(this.hideColumn[parseInt(i.toString(), 10)]);
      if (n !== -1) {
        this.prevShowedCols.splice(n, 1);
      }
    }
    var a = this.showColumn.length !== 0 ? 1 : this.prevShowedCols.length;
    if (this.infiniteRenderMode) {
      a = this.infiniteLoadedElement.filter(function (f) {
        return f.querySelector('.e-uncheck');
      }).length;
    }
    var o;
    this.parent.enableAdaptiveUI
      ? this.parent.enableAdaptiveUI && this.responsiveDialogRenderer && this.parent.notify(Je, { disabled: false })
      : ((o = this.dlgDiv.querySelector('.e-footer-content').querySelector('.e-btn').ej2_instances[0]),
        (o.disabled = false));
    for (
      var l = [], h = [].slice.call(document.getElementsByClassName('e-cc-chbox')), i = 0, d = h.length;
      i < d;
      i++
    ) {
      var p = h[parseInt(i.toString(), 10)];
      if (!(this.infiniteRenderMode && h[parseInt(i.toString(), 10)].classList.contains('e-selectall'))) {
        var r = S(h[parseInt(i.toString(), 10)], 'e-ccheck').getAttribute('data-uid');
        l.push(r);
      }
    }
    var c = this.showColumn.filter(function (f) {
      return l.indexOf(f) !== -1;
    });
    if ((this.infiniteRenderMode && (e || l.length === a)) || (!this.infiniteRenderMode && a === 0 && c.length === 0)) {
      this.parent.enableAdaptiveUI
        ? this.parent.enableAdaptiveUI && this.responsiveDialogRenderer && this.parent.notify(Je, { disabled: true })
        : (o.disabled = true);
    }
    if (!this.parent.enableAdaptiveUI) {
      o.dataBind();
    }
  };
  s.prototype.refreshCheckboxList = function (e) {
    this.ulElement = this.parent.createElement('ul', { className: 'e-ccul-ele e-cc' });
    var t = this.l10n.getConstant('SelectAll');
    var i = this.parent.createElement('li', { className: 'e-cclist e-cc e-cc-selectall' });
    kn(i, this.infiniteRenderMode ? 'list-style: None;' : '');
    var r = this.createCheckBox(t, false, this.parent.element.id + '-selectAll');
    if (e.length) {
      r.querySelector('.e-checkbox-wrapper').firstElementChild.classList.add('e-selectall');
      r.querySelector('.e-frame').classList.add('e-selectall');
      this.checkState(r.querySelector('.e-icons'), true);
      i.appendChild(r);
      this.infiniteRenderMode
        ? this.mainDiv.querySelector('.e-cc-contentdiv') &&
          !this.mainDiv.querySelector('.e-cc-selectall') &&
          ((this.infiniteDiv = this.mainDiv.querySelector('.e-cc-contentdiv')),
          this.mainDiv.insertBefore(i, this.infiniteDiv),
          this.infiniteDiv.classList.add('e-checkbox-infinitescroll'),
          R.add(this.infiniteDiv, 'scroll', this.infiniteScrollHandler, this),
          R.add(this.infiniteDiv, 'mouseup', this.infiniteScrollMouseKeyUpHandler, this),
          R.add(this.infiniteDiv, 'mousedown', this.infiniteScrollMouseKeyDownHandler, this))
        : this.ulElement.appendChild(i);
    }
    if (this.parent.cssClass) {
      this.parent.cssClass.indexOf(' ') !== -1
        ? j([r], this.parent.cssClass.split(' '))
        : j([r], [this.parent.cssClass]);
    }
    if (this.infiniteRenderMode && e.length > this.itemsCount * 3) {
      this.infiniteSkipCount = this.itemsCount * 2;
    }
    this.renderCheckbox(e.slice(0, this.infiniteRenderMode ? this.itemsCount * 3 : e.length));
    return this.ulElement;
  };
  s.prototype.infiniteScrollMouseKeyDownHandler = function () {
    R.remove(this.infiniteDiv, 'scroll', this.infiniteScrollHandler);
  };
  s.prototype.infiniteScrollMouseKeyUpHandler = function (e) {
    var t = this;
    R.add(this.infiniteDiv, 'scroll', this.infiniteScrollHandler, this);
    var i = this.infiniteDiv;
    if (
      this.ulElement.children.length > 1 &&
      (this.infiniteDiv.scrollTop >= this.infiniteDiv.scrollHeight - this.infiniteDiv.offsetHeight ||
        this.infiniteDiv.scrollTop <= 0)
    ) {
      this.infiniteScrollHandler();
    }
    me.timer = setTimeout(function () {
      t.clickHandler(e);
      me.timer = null;
    }, 0);
  };
  s.prototype.infiniteScrollHandler = function () {
    var e = this.infiniteDiv;
    var t =
      (this.searchValue && this.searchValue.length) || this.sortDirection !== 'None'
        ? this.filterColumns
        : this.infiniteColumns;
    if (
      this.infiniteDiv.scrollTop >= this.infiniteDiv.scrollHeight - this.infiniteDiv.offsetHeight &&
      this.infiniteLoadedElement.length <= this.infiniteSkipCount + this.itemsCount &&
      this.ulElement.children.length === this.itemsCount * 3 &&
      (!t.length || t.length > this.infiniteSkipCount + this.itemsCount)
    ) {
      var i = t.length - (this.infiniteSkipCount + this.itemsCount);
      var r = 0;
      if (i < this.itemsCount) {
        r = i;
      }
      Et([].slice.call(this.ulElement.children).splice(0, this.itemsCount));
      this.infiniteInitialLoad = true;
      this.infiniteSkipCount += this.itemsCount;
      this.renderCheckbox(t.slice(this.infiniteSkipCount, this.infiniteSkipCount + (r + this.itemsCount)));
      this.prevInfiniteScrollDirection = 'down';
    } else
      this.infiniteDiv.scrollTop >= this.infiniteDiv.scrollHeight - this.infiniteDiv.offsetHeight &&
      this.infiniteLoadedElement.length > this.infiniteSkipCount + this.itemsCount &&
      this.ulElement.children.length === this.itemsCount * 3
        ? (Et([].slice.call(this.ulElement.children).splice(0, this.itemsCount)),
          (this.infiniteSkipCount +=
            this.prevInfiniteScrollDirection === 'down' ? this.itemsCount : this.itemsCount * 3),
          ae(
            this.ulElement,
            this.infiniteLoadedElement.slice(this.infiniteSkipCount, this.itemsCount + this.infiniteSkipCount),
          ),
          (this.prevInfiniteScrollDirection = 'down'))
        : this.infiniteDiv.scrollTop === 0 &&
            !this.infiniteInitialLoad &&
            this.infiniteSkipCount &&
            this.infiniteLoadedElement.length &&
            this.infiniteLoadedElement.length > this.itemsCount * 3 &&
            this.ulElement.children.length === this.itemsCount * 3
          ? (Et([].slice.call(this.ulElement.children).splice(this.itemsCount * 2, this.itemsCount)),
            (this.infiniteSkipCount -=
              this.prevInfiniteScrollDirection === 'up' ? this.itemsCount : this.itemsCount * 3),
            Fr(
              [].slice.call(
                this.infiniteLoadedElement.slice(this.infiniteSkipCount, this.infiniteSkipCount + this.itemsCount),
              ),
              this.ulElement,
            ),
            (this.prevInfiniteScrollDirection = 'up'),
            (this.infiniteDiv.scrollTop = this.infiniteScrollAppendDiff))
          : this.infiniteDiv.scrollTop === 0 &&
            !this.infiniteInitialLoad &&
            this.infiniteSkipCount &&
            this.infiniteSkipCount > this.itemsCount * 2 &&
            this.infiniteLoadedElement.length &&
            this.ulElement.children.length < this.itemsCount * 3 &&
            (Et([].slice.call(this.ulElement.children).splice(this.itemsCount * 2, t.length % this.itemsCount)),
            (this.infiniteSkipCount = (Math.floor(t.length / this.itemsCount) - 3) * this.itemsCount),
            Fr(
              [].slice.call(
                this.infiniteLoadedElement.slice(this.infiniteSkipCount, this.infiniteSkipCount + this.itemsCount),
              ),
              this.ulElement,
            ),
            (this.infiniteDiv.scrollTop = this.infiniteScrollAppendDiff),
            (this.prevInfiniteScrollDirection = 'up'));
  };
  s.prototype.refreshCheckboxState = function () {
    if (
      !(
        !this.parent.columnChooserSettings.enableSearching &&
        !this.selectedColumnModels.length &&
        this.sortDirection === 'None'
      )
    ) {
      this.dlgObj.element.querySelector('.e-cc.e-input').value = '';
      this.columnChooserSearch('', false);
      for (
        var e = this.parent,
          t = this.dlgObj.element.querySelectorAll('.e-cc-chbox:not(.e-selectall)'),
          i = 0,
          r = t.length;
        i < r;
        i++
      ) {
        var n = t[parseInt(i.toString(), 10)];
        var a = void 0;
        this.parent.childGrid || this.parent.detailTemplate
          ? (a = S(
              this.dlgObj.element.querySelectorAll('.e-cc-chbox:not(.e-selectall)')[parseInt(i.toString(), 10)],
              'e-ccheck',
            ).getAttribute('data-uid'))
          : (a = S(n, 'e-ccheck').getAttribute('data-uid'));
        var o = e.getColumnByUid(a, this.infiniteRenderMode);
        var l = [].slice.call(n.parentElement.getElementsByClassName('e-uncheck'));
        o.visible && !l.length
          ? ((n.checked = true), this.checkState(n.parentElement.querySelector('.e-icons'), true))
          : ((n.checked = false), this.checkState(n.parentElement.querySelector('.e-icons'), false));
      }
    }
  };
  s.prototype.checkState = function (e, t) {
    t ? G(e, ['e-check'], ['e-uncheck']) : G(e, ['e-uncheck'], ['e-check']);
  };
  s.prototype.createCheckBox = function (e, t, i) {
    var r = t ? this.cBoxTrue.cloneNode(true) : this.cBoxFalse.cloneNode(true);
    if (!this.parent.enableAdaptiveUI && this.parent.enableRtl && !r.classList.contains('e-rtl')) {
      r.classList.add('e-rtl');
    }
    var n = r.querySelector('.e-label');
    var a = r.querySelector('input');
    at(a, t);
    n.setAttribute('id', i + 'label');
    n.innerHTML = e;
    a.setAttribute('aria-labelledby', n.id);
    return Va(i, r, 'e-ccheck');
  };
  s.prototype.renderCheckbox = function (e) {
    for (var t, i = this.parent.createElement('div'), r = this.ulElement.offsetHeight, n = 0; n < e.length; n++) {
      var a = e[parseInt(n.toString(), 10)];
      if (e[parseInt(n.toString(), 10)].showInColumnChooser) {
        var o = this.parent.createElement('li', {
          className: 'e-cclist e-cc',
          id: 'e-ccli_' + e[parseInt(n.toString(), 10)].uid,
        });
        o.style.listStyle = 'none';
        var l = this.hideColumn.indexOf(e[parseInt(n.toString(), 10)].uid) !== -1;
        var h = this.showColumn.indexOf(e[parseInt(n.toString(), 10)].uid) !== -1;
        var d = this.createCheckBox(
          e[parseInt(n.toString(), 10)].headerText,
          (e[parseInt(n.toString(), 10)].visible && !l) || h,
          e[parseInt(n.toString(), 10)].uid,
        );
        o.appendChild(d);
        if (this.parent.cssClass) {
          this.parent.cssClass.indexOf(' ') !== -1
            ? j([d], this.parent.cssClass.split(' '))
            : j([d], [this.parent.cssClass]);
        }
        if (this.infiniteRenderMode && this.infiniteDiv) {
          o.style.height = _a(this.infiniteDiv, true) + 'px';
        }
        i.appendChild(o);
      }
    }
    if (this.infiniteRenderMode && this.infiniteInitialLoad) {
      (t = this.infiniteLoadedElement).push.apply(t, [].slice.call(i.children));
      this.infiniteInitialLoad = false;
    }
    ae(this.ulElement, [].slice.call(i.children));
    if (this.infiniteRenderMode && !this.infiniteScrollAppendDiff) {
      this.infiniteScrollAppendDiff = this.ulElement.offsetHeight - r;
    }
    if (this.isInitialOpen) {
      this.updateIntermediateBtn();
    }
  };
  s.prototype.columnChooserManualSearch = function (e) {
    this.addcancelIcon();
    this.searchValue = e.target.value;
    this.stopTimer();
    this.startTimer(e);
  };
  s.prototype.startTimer = function (e) {
    var t = this;
    var i = !t.flag && e.keyCode !== 13 ? 500 : 0;
    this.timer = window.setInterval(function () {
      t.columnChooserSearch(t.searchValue, true);
    }, i);
  };
  s.prototype.stopTimer = function () {
    window.clearInterval(this.timer);
  };
  s.prototype.addcancelIcon = function () {
    if (this.dlgDiv.querySelector('.e-cc.e-ccsearch-icon')) {
      this.dlgDiv.querySelector('.e-cc.e-ccsearch-icon').classList.add('e-cc-cancel');
      this.dlgDiv.querySelector('.e-cc-cancel').setAttribute('title', this.l10n.getConstant('Clear'));
    }
  };
  s.prototype.removeCancelIcon = function () {
    if (this.dlgDiv.querySelector('.e-cc.e-ccsearch-icon')) {
      this.dlgDiv.querySelector('.e-cc.e-ccsearch-icon').classList.remove('e-cc-cancel');
      this.dlgDiv.querySelector('.e-cc.e-ccsearch-icon').setAttribute('title', this.l10n.getConstant('Search'));
    }
  };
  s.prototype.mOpenDlg = function () {
    if (z.isDevice) {
      if (this.dlgObj.element.querySelector('.e-cc-searchdiv')) {
        this.dlgObj.element.querySelector('.e-cc-searchdiv').classList.remove('e-input-focus');
      }
      if (this.dlgObj.element.querySelectorAll('.e-cc-chbox')[0]) {
        this.dlgObj.element.querySelectorAll('.e-cc-chbox')[0].focus();
      }
    }
    if (this.parent.enableAdaptiveUI && this.dlgObj.element.querySelector('.e-cc-searchdiv')) {
      this.dlgObj.element.querySelector('.e-cc-searchdiv').classList.add('e-input-focus');
    }
  };
  s.prototype.getModuleName = function () {
    return 'columnChooser';
  };
  s.prototype.hideOpenedDialog = function () {
    for (
      var e = [].slice.call(document.getElementsByClassName('e-ccdlg')).filter(function (r) {
          return r.classList.contains('e-popup-open');
        }),
        t = 0,
        i = e.length;
      t < i;
      t++
    )
      if (
        this.parent.element.id + '_ccdlg' !== e[parseInt(t.toString(), 10)].id ||
        e[parseInt(t.toString(), 10)].classList.contains('e-dialog')
      ) {
        e[parseInt(t.toString(), 10)].ej2_instances[0].hide();
      }
  };
  s.prototype.beforeOpenColumnChooserEvent = function () {
    var e = Fi(
      {
        requestType: 'beforeOpenColumnChooser',
        element: this.parent.element,
        columns: this.getColumns(),
        cancel: false,
        searchOperator: this.parent.columnChooserSettings.operator,
        sortDirection: 'None',
      },
      this.parent.enableColumnVirtualization ? {} : { selectedColumns: [] },
    );
    this.parent.trigger(ja, e);
    this.searchOperator = e.searchOperator;
    this.sortDirection = e.sortDirection;
    if (!this.parent.enableColumnVirtualization) {
      this.selectedColumns = e.selectedColumns;
    }
    return e;
  };
  s.prototype.renderResponsiveChangeAction = function (e) {
    this.responsiveDialogRenderer.action = e.action;
  };
  s.prototype.showCustomColumnChooser = function (e) {
    this.responsiveDialogRenderer.isCustomDialog = e;
    this.responsiveDialogRenderer.showResponsiveDialog();
  };
  return s;
})();
var ke = (function () {
  function s() {
    this.numFmtId = 0;
    this.backColor = 'none';
    this.fontName = 'Calibri';
    this.fontSize = 10.5;
    this.fontColor = '#000000';
    this.italic = false;
    this.bold = false;
    this.underline = false;
    this.strikeThrough = false;
    this.wrapText = false;
    this.hAlign = 'general';
    this.vAlign = 'bottom';
    this.indent = 0;
    this.rotation = 0;
    this.numberFormat = 'GENERAL';
    this.type = 'datetime';
    this.borders = new _n();
    this.isGlobalStyle = false;
  }
  return s;
})();
var Vr = (function () {
  function s() {
    this.sz = 10.5;
    this.name = 'Calibri';
    this.u = false;
    this.b = false;
    this.i = false;
    this.color = 'FF000000';
    this.strike = false;
  }
  return s;
})();
var hl = (function () {
  function s() {}
  return s;
})();
var dl = (function () {
  function s() {}
  return s;
})();
var pl = (function () {
  function s() {}
  return s;
})();
var _r = (function () {
  function s() {
    this.name = 'Normal';
    this.xfId = 0;
  }
  return s;
})();
var jr = (function () {
  function s(e, t) {
    this.numFmtId = e;
    this.formatCode = t;
  }
  return s;
})();
var ot = (function () {
  function s(e, t) {
    this.lineStyle = e;
    this.color = t;
  }
  return s;
})();
var _n = (function () {
  function s() {
    this.left = new ot('none', '#FFFFFF');
    this.right = new ot('none', '#FFFFFF');
    this.top = new ot('none', '#FFFFFF');
    this.bottom = new ot('none', '#FFFFFF');
    this.all = new ot('none', '#FFFFFF');
  }
  return s;
})();
var ul = (function () {
  var s = function (e, t) {
    s =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (i, r) {
          i.__proto__ = r;
        }) ||
      function (i, r) {
        for (var n in r)
          if (r.hasOwnProperty(n)) {
            i[n] = r[n];
          }
      };
    return s(e, t);
  };
  return function (e, t) {
    s(e, t);
    function i() {
      this.constructor = e;
    }
    e.prototype = t === null ? Object.create(t) : ((i.prototype = t.prototype), new i());
  };
})();
var Ur = (function () {
  function s() {}
  return s;
})();
var Gr = (function (s) {
  ul(e, s);
  function e() {
    var t = (s !== null && s()) || this;
    t.add = function (i) {
      for (var r = false, n = 0, a = 0, o = t; a < o.length; a++) {
        var l = o[a];
        if (o[a].index === i.index) {
          t[n] = i;
          r = true;
        }
        n++;
      }
      if (!r) {
        t.push(i);
      }
    };
    return t;
  }
  return e;
})(Array);
var cl = (function () {
  function s() {}
  return s;
})();
var fl = (function () {
  var s = function (e, t) {
    s =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (i, r) {
          i.__proto__ = r;
        }) ||
      function (i, r) {
        for (var n in r)
          if (r.hasOwnProperty(n)) {
            i[n] = r[n];
          }
      };
    return s(e, t);
  };
  return function (e, t) {
    s(e, t);
    function i() {
      this.constructor = e;
    }
    e.prototype = t === null ? Object.create(t) : ((i.prototype = t.prototype), new i());
  };
})();
var Wr = (function () {
  function s() {}
  return s;
})();
var gl = (function (s) {
  fl(e, s);
  function e() {
    var t = (s !== null && s()) || this;
    t.add = function (i) {
      t.push(i);
    };
    return t;
  }
  return e;
})(Array);
var ml = (function () {
  var s = function (e, t) {
    s =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (i, r) {
          i.__proto__ = r;
        }) ||
      function (i, r) {
        for (var n in r)
          if (r.hasOwnProperty(n)) {
            i[n] = r[n];
          }
      };
    return s(e, t);
  };
  return function (e, t) {
    s(e, t);
    function i() {
      this.constructor = e;
    }
    e.prototype = t === null ? Object.create(t) : ((i.prototype = t.prototype), new i());
  };
})();
var vl = (function (s) {
  ml(e, s);
  function e() {
    return (s !== null && s()) || this;
  }
  return e;
})(Array);
var yl = (function () {
  var s = function (e, t) {
    s =
      Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array &&
        function (i, r) {
          i.__proto__ = r;
        }) ||
      function (i, r) {
        for (var n in r)
          if (r.hasOwnProperty(n)) {
            i[n] = r[n];
          }
      };
    return s(e, t);
  };
  return function (e, t) {
    s(e, t);
    function i() {
      this.constructor = e;
    }
    e.prototype = t === null ? Object.create(t) : ((i.prototype = t.prototype), new i());
  };
})();
var Sl = (function () {
  function s() {
    this.isSummaryRowBelow = true;
    this.showGridLines = true;
    this.enableRtl = false;
  }
  return s;
})();
var Kr = (function () {
  function s() {}
  return s;
})();
var wl = (function () {
  function s() {}
  return s;
})();
var bl = (function () {
  function s() {}
  return s;
})();
var jn = (function () {
  function s() {}
  return s;
})();
var Cl = (function (s) {
  yl(e, s);
  function e() {
    var t = (s !== null && s()) || this;
    t.add = function (i) {
      for (var r = false, n = 0, a = 0, o = t; a < o.length; a++) {
        var l = o[a];
        if (e.isIntersecting(o[a], i)) {
          var h = new jn();
          h.x = Math.min(o[a].x, i.x);
          h.y = Math.min(o[a].Y, i.y);
          h.width = Math.max(o[a].Width + o[a].X, i.width + i.x);
          h.height = Math.max(o[a].Height + o[a].Y, i.height + i.y);
          h.ref = t[n].ref.split(':')[0] + ':' + i.ref.split(':')[1];
          t[n] = h;
          i = h;
          r = true;
        }
        n++;
      }
      if (!r) {
        t.push(i);
      }
      return i;
    };
    return t;
  }
  e.isIntersecting = function (t, i) {
    return t.x <= i.x + i.width && i.x <= t.x + t.width && t.y <= i.y + i.height && i.y <= t.y + t.height;
  };
  return e;
})(Array);
var Il = (function () {
  function s() {}
  return s;
})();
var $r = (function () {
  function s() {}
  s.save = function (e, t) {
    if (e == null || e === '') throw new Error('ArgumentException: fileName cannot be undefined, null or empty');
    var i = e.substring(e.lastIndexOf('.') + 1, e.length);
    var r = this.getMimeType(i);
    if (r !== '') {
      t = new Blob([t], { type: r });
    }
    if (this.isMicrosoftBrowser) navigator.msSaveBlob(t, e);
    else {
      var n = document.createElementNS('http://www.w3.org/1999/xhtml', 'a');
      this.saveInternal(e, i, t, n, 'download' in n);
    }
  };
  s.saveInternal = function (e, t, i, r, n) {
    if (n) {
      r.download = e;
      var a = window.URL.createObjectURL(i);
      r.href = a;
      var o = document.createEvent('MouseEvent');
      o.initEvent('click', true, true);
      r.dispatchEvent(o);
      setTimeout(function () {
        window.URL.revokeObjectURL(a);
        a = void 0;
      });
    } else if (t !== 'docx' && t !== 'xlsx') {
      var l = window.URL.createObjectURL(i);
      var h = window.open(l, '_blank');
      if (!h) {
        window.location.href = l;
      }
    } else {
      var d = new FileReader();
      d.onloadend = function () {
        var p = window.open(d.result, '_blank');
        if (!p) {
          window.location.href = d.result;
        }
      };
      d.readAsDataURL(i);
    }
  };
  s.getMimeType = function (e) {
    var t = '';
    switch (e) {
      case 'html':
        t = 'text/html';
        break;
      case 'pdf':
        t = 'application/pdf';
        break;
      case 'docx':
        t = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document';
        break;
      case 'xlsx':
        t = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet';
        break;
      case 'txt':
        t = 'text/plain';
        break;
    }
    return t;
  };
  return s;
})();
var Un = (function () {
  function s(e) {
    this.emitBOM = true;
    this.encodingType = 'Ansi';
    this.initBOM(e);
  }
  Object.defineProperty(s.prototype, 'includeBom', {
    get: function () {
      return this.emitBOM;
    },
    enumerable: true,
    configurable: true,
  });
  Object.defineProperty(s.prototype, 'type', {
    get: function () {
      return this.encodingType;
    },
    set: function (e) {
      this.encodingType = e;
    },
    enumerable: true,
    configurable: true,
  });
  s.prototype.initBOM = function (e) {
    e == null ? (this.emitBOM = true) : (this.emitBOM = e);
  };
  s.prototype.getByteCount = function (e) {
    Ve(e, 'string');
    if (e === '') {
      var t = this.utf8Len(e.charCodeAt(0));
      return t;
    }
    if (this.type === null || this.type === void 0) {
      this.type = 'Ansi';
    }
    return this.getByteCountInternal(e, 0, e.length);
  };
  s.prototype.utf8Len = function (e) {
    var t = e <= 127 ? 1 : e <= 2047 ? 2 : e <= 65535 ? 3 : e <= 2097151 ? 4 : 0;
    return t;
  };
  s.prototype.isHighSurrogate = function (e) {
    return e >= 55296 && e <= 56319;
  };
  s.prototype.toCodepoint = function (e, t) {
    e = (1023 & e) << 10;
    var i = e | (1023 & t);
    return i + 65536;
  };
  s.prototype.getByteCountInternal = function (e, t, i) {
    var r = 0;
    if (this.encodingType === 'Utf8' || this.encodingType === 'Unicode') {
      for (var n = this.encodingType === 'Utf8', a = 0; a < i; a++) {
        var o = e.charCodeAt(n ? t : t++);
        if (this.isHighSurrogate(o))
          if (n) {
            var l = o;
            var h = e.charCodeAt(++t);
            r += this.utf8Len(this.toCodepoint(o, h));
          } else {
            r += 4;
            ++a;
          }
        else n ? (r += this.utf8Len(o)) : (r += 2);
        if (n) {
          t++;
        }
      }
      return r;
    } else {
      r = i;
      return r;
    }
  };
  s.prototype.getBytes = function (e, t, i) {
    Ve(e, 'string');
    Ve(t, 'charIndex');
    Ve(i, 'charCount');
    if (t < 0 || i < 0)
      throw new RangeError('Argument Out Of Range Exception: charIndex or charCount is less than zero');
    if (e.length - t < i)
      throw new RangeError(
        'Argument Out Of Range Exception: charIndex and charCount do not denote a valid range in string',
      );
    var r;
    if (e === '') {
      r = new ArrayBuffer(0);
      return r;
    }
    if (this.type === null || this.type === void 0) {
      this.type = 'Ansi';
    }
    var n = this.getByteCountInternal(e, t, i);
    switch (this.type) {
      case 'Utf8': {
        r = this.getBytesOfUtf8Encoding(n, e, t, i);
        return r;
      }
      case 'Unicode': {
        r = this.getBytesOfUnicodeEncoding(n, e, t, i);
        return r;
      }
      default: {
        r = this.getBytesOfAnsiEncoding(n, e, t, i);
        return r;
      }
    }
  };
  s.prototype.getString = function (e, t, i) {
    Ve(e, 'bytes');
    Ve(t, 'index');
    Ve(i, 'count');
    if (t < 0 || i < 0) throw new RangeError('Argument Out Of Range Exception: index or count is less than zero');
    if (e.byteLength - t < i)
      throw new RangeError('Argument Out Of Range Exception: index and count do not denote a valid range in bytes');
    if (e.byteLength === 0 || i === 0) return '';
    if (this.type === null || this.type === void 0) {
      this.type = 'Ansi';
    }
    var r = '';
    var n = new Uint8Array(e);
    switch (this.type) {
      case 'Utf8':
        var a = this.getStringOfUtf8Encoding(n, t, i);
        return a;
      case 'Unicode':
        var o = new Uint16Array(e);
        {
          r = this.getStringofUnicodeEncoding(o, t, i);
          return r;
        }
      default:
        for (var l = t, h = 0; h < i; h++) {
          var d = n[l];
          r += String.fromCharCode(n[l]);
          l++;
        }
        return r;
    }
  };
  s.prototype.getBytesOfAnsiEncoding = function (e, t, i, r) {
    for (var n = new ArrayBuffer(e), a = new Uint8Array(n), o = 0, l = 0; l < r; l++) {
      var h = t.charCodeAt(i++);
      h < 2048 ? (a[o] = h) : (a[o] = 63);
      o++;
    }
    return n;
  };
  s.prototype.getBytesOfUtf8Encoding = function (e, t, i, r) {
    for (var n = new ArrayBuffer(e), a = new Uint8Array(n), o = i, l = 0, h = 0; h < r; h++) {
      var d = t.charCodeAt(o);
      d <= 127
        ? (a[l] = d)
        : d < 2048
          ? ((a[l] = 192 | (d >> 6)), (a[++l] = 128 | (d & 63)))
          : d < 55296 || d >= 57344
            ? ((a[l] = 224 | (d >> 12)), (a[++l] = 128 | ((d >> 6) & 63)), (a[++l] = 128 | (d & 63)))
            : ((a[l] = 239), (a[++l] = 191), (a[++l] = 189));
      ++l;
      ++o;
    }
    return n;
  };
  s.prototype.getBytesOfUnicodeEncoding = function (e, t, i, r) {
    for (var n = new ArrayBuffer(e), a = new Uint16Array(n), o = 0; o < r; o++) {
      var l = t.charCodeAt(o);
      a[o] = l;
    }
    return n;
  };
  s.prototype.getStringOfUtf8Encoding = function (e, t, i) {
    var r = 0;
    var n = t;
    var a = '';
    for (r; r < i; r++) {
      for (var o = e[n++]; n > e.length; ) return a;
      if (o > 127) {
        o > 191 && o < 224 && n < i
          ? (o = ((o & 31) << 6) | (e[n] & 63))
          : o > 223 && o < 240 && n < e.byteLength
            ? (o = ((o & 15) << 12) | ((e[n] & 63) << 6) | (e[++n] & 63))
            : o > 239 &&
              o < 248 &&
              n < e.byteLength &&
              (o = ((o & 7) << 18) | ((e[n] & 63) << 12) | ((e[++n] & 63) << 6) | (e[++n] & 63));
        ++n;
      }
      a += String.fromCharCode(o);
    }
    return a;
  };
  s.prototype.getStringofUnicodeEncoding = function (e, t, i) {
    if (i > e.length) throw new RangeError('ArgumentOutOfRange_Count');
    for (var r = new Uint16Array(i), n = '', a = 0; a < i && a < e.length; a++) r[a] = e[t++];
    n = String.fromCharCode.apply(null, r);
    return n;
  };
  s.prototype.destroy = function () {
    this.emitBOM = void 0;
    this.encodingType = void 0;
  };
  return s;
})();
function Ve(s, e) {
  if (s == null) throw new Error('ArgumentException: ' + e + ' cannot be null or undefined');
}
var Z = (function () {
  function s() {}
  s.bitReverse = function (e) {
    return (
      (s.reverseBits[e & 15] << 12) |
      (s.reverseBits[(e >> 4) & 15] << 8) |
      (s.reverseBits[(e >> 8) & 15] << 4) |
      s.reverseBits[e >> 12]
    );
  };
  s.bitConverterToInt32 = function (e, t) {
    return e[t] | (e[t + 1] << 8) | (e[t + 2] << 16) | (e[t + 3] << 24);
  };
  s.bitConverterToInt16 = function (e, t) {
    return e[t] | (e[t + 1] << 8);
  };
  s.bitConverterToUInt32 = function (e) {
    var t = new Uint32Array(1);
    t[0] = e;
    return t[0];
  };
  s.bitConverterToUInt16 = function (e, t) {
    var i = new Uint16Array(1);
    i[0] = e[t] | (e[t + 1] << 8);
    return i[0];
  };
  s.bitConverterUintToInt32 = function (e) {
    var t = new Int32Array(1);
    t[0] = e;
    return t[0];
  };
  s.bitConverterInt32ToUint = function (e) {
    var t = new Uint32Array(1);
    t[0] = e;
    return t[0];
  };
  s.bitConverterInt32ToInt16 = function (e) {
    var t = new Int16Array(1);
    t[0] = e;
    return t[0];
  };
  s.byteToString = function (e) {
    for (var t = '', i = 0; i < e.length; i++) t += String.fromCharCode(e[i]);
    return t;
  };
  s.byteIntToString = function (e) {
    for (var t = '', i = 0; i < e.length; i++) t += String.fromCharCode(e[i]);
    return t;
  };
  s.arrayCopy = function (e, t, i, r, n) {
    var a = new Uint8Array(e.buffer, t);
    var o = a.subarray(0, n);
    i.set(o, r);
  };
  s.mergeArray = function (e, t) {
    var i = new Uint8Array(e.length + t.length);
    i.set(e);
    i.set(t, e.length);
    return i;
  };
  s.encodedString = function (e) {
    var t = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';
    var i;
    var r;
    var n;
    var a;
    var o;
    var l;
    var h;
    var d = 0;
    var p = 0;
    e = e.replace(/[^A-Za-z0-9\+\/\=]/g, '');
    var c = (e.length * 3) / 4;
    if (e.charAt(e.length - 1) === '=') {
      c--;
    }
    if (e.charAt(e.length - 2) === '=') {
      c--;
    }
    if (c % 1 !== 0) throw new Error('Invalid base64 input, bad content length.');
    for (var f = new Uint8Array(c | 0); d < e.length; ) {
      a = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='.indexOf(e.charAt(d++));
      o = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='.indexOf(e.charAt(d++));
      l = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='.indexOf(e.charAt(d++));
      h = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='.indexOf(e.charAt(d++));
      i = (a << 2) | (o >> 4);
      r = ((o & 15) << 4) | (l >> 2);
      n = ((l & 3) << 6) | h;
      f[p++] = i;
      if (l !== 64) {
        f[p++] = r;
      }
      if (h !== 64) {
        f[p++] = n;
      }
    }
    return f;
  };
  s.reverseBits = [0, 8, 4, 12, 2, 10, 6, 14, 1, 9, 5, 13, 3, 11, 7, 15];
  s.huffCodeLengthOrders = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];
  return s;
})();
var Dt = [];
var lt = 4;
var Ze = 2;
var xl = 101010256;
var El = 12;
var Dl = 33639248;
var Rt = 4096;
var ne = (function () {
  function s() {
    if (Dt.length === 0) {
      s.initCrc32Table();
    }
    this.files = [];
    this.level = 'Normal';
    $r.isMicrosoftBrowser = !!navigator.msSaveBlob;
  }
  Object.defineProperty(s.prototype, 'items', {
    get: function () {
      return this.files;
    },
    enumerable: true,
    configurable: true,
  });
  Object.defineProperty(s.prototype, 'compressionLevel', {
    get: function () {
      return this.level;
    },
    set: function (e) {
      this.level = e;
    },
    enumerable: true,
    configurable: true,
  });
  Object.defineProperty(s.prototype, 'length', {
    get: function () {
      return this.files === void 0 ? 0 : this.files.length;
    },
    enumerable: true,
    configurable: true,
  });
  s.prototype.addItem = function (e) {
    if (e == null) throw new Error('ArgumentException: item cannot be null or undefined');
    for (var t = 0; t < this.files.length; t++) {
      var i = this.files[t];
      if (this.files[t] instanceof tt && this.files[t].name === e.name)
        throw new Error('item with same name already exist');
    }
    this.files.push(e);
  };
  s.prototype.addDirectory = function (e) {
    if (e == null) throw new Error('ArgumentException: string cannot be null or undefined');
    if (e.length === 0) throw new Error('ArgumentException: string cannot be empty');
    if (e.slice(-1) !== '/') {
      e += '/';
    }
    if (this.files.indexOf(e) !== -1) throw new Error('item with same name already exist');
    this.files.push(e);
  };
  s.prototype.getItem = function (e) {
    if (e >= 0 && e < this.files.length) return this.files[e];
  };
  s.prototype.contains = function (e) {
    return this.files.indexOf(e) !== -1;
  };
  s.prototype.open = function (e) {
    var t = Z.encodedString(e);
    if (t.length == 0) throw new DOMException('stream');
    var i = new Gt(t);
    var r = s.findValueFromEnd(i, 101010256, 65557);
    if (r < 0)
      throw new DOMException(
        "Can't locate end of central directory record. Possible wrong file format or archive is corrupt.",
      );
    i.position = r + 12;
    var n = s.ReadInt32(i);
    var a = r - n;
    i.position = a;
    this.readCentralDirectoryDataAndExtractItems(i);
  };
  s.prototype.readCentralDirectoryDataAndExtractItems = function (e) {
    if (e == null) throw new DOMException('stream');
    for (var t; s.ReadInt32(e) == 33639248; ) {
      t = new Rl();
      t.readCentralDirectoryData(e);
    }
    t.readData(e, t.checkCrc);
    t.decompressData();
    this.files.push(new tt(t.unCompressedStream.buffer, t.name));
  };
  s.prototype.save = function (e) {
    if (e == null || e.length === 0) throw new Error('ArgumentException: fileName cannot be null or undefined');
    if (this.files.length === 0) throw new Error('InvalidOperation');
    var t = this;
    return new Promise(function (i, r) {
      t.saveInternal(e, false).then(function () {
        i(t);
      });
    });
  };
  s.prototype.saveAsBlob = function () {
    var e = this;
    return new Promise(function (t, i) {
      e.saveInternal('', true).then(function (r) {
        t(r);
      });
    });
  };
  s.prototype.saveInternal = function (e, t) {
    var i = this;
    var r = this;
    return new Promise(function (n, a) {
      for (var o = [], l = 0, h = 0; h < r.files.length; h++) {
        var d = i.getCompressedData(i.files[h]);
        d.then(function (p) {
          l = r.constructZippedObject(o, p, l, p.isDirectory);
          if (o.length === r.files.length) {
            var c = r.writeZippedContent(e, o, l, t);
            n(c);
          }
        });
      }
    });
  };
  s.prototype.destroy = function () {
    if (this.files !== void 0 && this.files.length > 0) {
      for (var e = 0; e < this.files.length; e++) {
        var t = this.files[e];
        if (t instanceof tt) {
          t.destroy();
        }
        t = void 0;
      }
      this.files = [];
    }
    this.files = void 0;
    this.level = void 0;
  };
  s.prototype.getCompressedData = function (e) {
    var t = this;
    var i = new Promise(function (r, n) {
      if (e instanceof tt) {
        var a = new FileReader();
        a.onload = function () {
          var l = new Uint8Array(a.result);
          var h = {
            fileName: e.name,
            crc32Value: 0,
            compressedData: [],
            compressedSize: void 0,
            uncompressedDataSize: l.length,
            compressionType: void 0,
            isDirectory: false,
          };
          if (t.level === 'Normal') {
            t.compressData(l, h, Dt);
            for (var d = 0, p = 0; p < h.compressedData.length; p++) d += h.compressedData[p].length;
            h.compressedSize = d;
            h.compressionType = '\b\0';
          } else {
            h.compressedSize = l.length;
            h.crc32Value = t.calculateCrc32Value(0, l, Dt);
            h.compressionType = '\0\0';
            h.compressedData.push(l);
          }
          r(h);
        };
        a.readAsArrayBuffer(e.data);
      } else {
        var o = {
          fileName: e,
          crc32Value: 0,
          compressedData: '',
          compressedSize: 0,
          uncompressedDataSize: 0,
          compressionType: '\0\0',
          isDirectory: true,
        };
        r(o);
      }
    });
    return i;
  };
  s.prototype.compressData = function (e, t, i) {
    var r = new Fl(true);
    var n = 0;
    var a = 0;
    do {
      if (n >= e.length) {
        r.close();
        break;
      }
      a = Math.min(e.length, n + 16384);
      var o = e.subarray(n, a);
      t.crc32Value = this.calculateCrc32Value(t.crc32Value, o, i);
      r.write(o, 0, a - n);
      n = a;
    } while (n <= e.length);
    t.compressedData = r.compressedData;
    r.destroy();
  };
  s.prototype.constructZippedObject = function (e, t, i, r) {
    var n = 0;
    var a = new Date();
    if (r) {
      n = n | 16;
    }
    n = n | 0;
    var o = this.writeHeader(t, a);
    var l = 'PK\x03\x04' + o + t.fileName;
    var h = this.writeCentralDirectory(t, o, i, n);
    e.push({
      localHeader: l,
      centralDir: h,
      compressedData: t,
    });
    return i + l.length + t.compressedSize;
  };
  s.prototype.writeHeader = function (e, t) {
    var i = '';
    i += `
\0\0\0`;
    i += e.compressionType;
    i += this.getBytes(this.getModifiedTime(t), 2);
    i += this.getBytes(this.getModifiedDate(t), 2);
    i += this.getBytes(e.crc32Value, 4);
    i += this.getBytes(e.compressedSize, 4);
    i += this.getBytes(e.uncompressedDataSize, 4);
    i += this.getBytes(e.fileName.length, 2);
    i += this.getBytes(0, 2);
    return i;
  };
  s.prototype.writeZippedContent = function (e, t, i, r) {
    for (var n = 0, a = [], o = 0; o < t.length; o++) {
      var l = t[o];
      for (
        n += t[o].centralDir.length, a.push(this.getArrayBuffer(t[o].localHeader));
        t[o].compressedData.compressedData.length;

      )
        a.push(t[o].compressedData.compressedData.shift().buffer);
    }
    for (var o = 0; o < t.length; o++) a.push(this.getArrayBuffer(t[o].centralDir));
    a.push(this.getArrayBuffer(this.writeFooter(t, n, i)));
    var h = new Blob(a, { type: 'application/zip' });
    if (!r) {
      $r.save(e, h);
    }
    return h;
  };
  s.prototype.writeCentralDirectory = function (e, t, i, r) {
    var n =
      'PK\x01\x02' +
      this.getBytes(20, 2) +
      t +
      this.getBytes(0, 2) +
      '\0\0\0\0' +
      this.getBytes(r, 4) +
      this.getBytes(i, 4) +
      e.fileName;
    return n;
  };
  s.prototype.writeFooter = function (e, t, i) {
    var r =
      'PK\x05\x06\0\0\0\0' +
      this.getBytes(e.length, 2) +
      this.getBytes(e.length, 2) +
      this.getBytes(t, 4) +
      this.getBytes(i, 4) +
      this.getBytes(0, 2);
    return r;
  };
  s.prototype.getArrayBuffer = function (e) {
    for (var t = new Uint8Array(e.length), i = 0; i < e.length; ++i) t[i] = e.charCodeAt(i) & 255;
    return t.buffer;
  };
  s.prototype.getBytes = function (e, t) {
    for (var i = '', r = 0; r < t; r++) {
      i += String.fromCharCode(e & 255);
      e = e >>> 8;
    }
    return i;
  };
  s.prototype.getModifiedTime = function (e) {
    var t = e.getHours();
    t = t << 6;
    t = t | e.getMinutes();
    t = t << 5;
    return (t = t | (e.getSeconds() / 2));
  };
  s.prototype.getModifiedDate = function (e) {
    var t = e.getFullYear() - 1980;
    t = t << 4;
    t = t | (e.getMonth() + 1);
    t = t << 5;
    return (t = t | e.getDate());
  };
  s.prototype.calculateCrc32Value = function (e, t, i) {
    e ^= -1;
    for (var r = 0; r < t.length; r++) e = (e >>> 8) ^ i[(e ^ t[r]) & 255];
    return e ^ -1;
  };
  s.initCrc32Table = function () {
    for (var e, t = 0; t < 256; t++) {
      e = t;
      for (var i = 0; i < 8; i++) e = e & 1 ? 3988292384 ^ (e >>> 1) : e >>> 1;
      Dt[t] = e;
    }
  };
  s.findValueFromEnd = function (e, t, i) {
    if (e == null) throw new DOMException('stream');
    var r = e.inputStream.buffer.byteLength;
    if (e.inputStream.buffer.byteLength < 4) return -1;
    var n = new Uint8Array(4);
    var a = Math.max(0, e.inputStream.buffer.byteLength - i);
    var o = e.inputStream.buffer.byteLength - 1 - 4;
    e.position = o;
    e.read(n, 0, 4);
    var l = 0;
    var h = l == t;
    if (!h) {
      for (; o > a; ) {
        l <<= 8;
        o--;
        e.position = o;
        l += e.readByte();
        if (l == t) {
          h = true;
          break;
        }
      }
    }
    return h ? o : -1;
  };
  s.ReadInt32 = function (e) {
    var t = new Uint8Array(4);
    if (e.read(t, 0, 4) != 4)
      throw new DOMException('Unable to read value at the specified position - end of stream was reached.');
    return Z.bitConverterToInt32(t, 0);
  };
  s.ReadInt16 = function (e) {
    var t = new Uint8Array(2);
    if (e.read(t, 0, 2) != 2)
      throw new DOMException('Unable to read value at the specified position - end of stream was reached.');
    return Z.bitConverterToInt16(t, 0);
  };
  s.ReadUInt16 = function (e) {
    {
      var t = new Uint8Array(2);
      if (e.read(t, 0, 2) != 2)
        throw new DOMException('Unable to read value at the specified position - end of stream was reached.');
      return Z.bitConverterToInt16(t, 0);
    }
  };
  return s;
})();
var Rl = (function () {
  function s() {
    this.headerSignature = 67324752;
    this.checkCrc = true;
    this.crc32 = 0;
  }
  s.prototype.readCentralDirectoryData = function (e) {
    e.position += 4;
    this.options = ne.ReadInt16(e);
    this.compressionMethod = ne.ReadInt16(e);
    this.checkCrc = this.compressionMethod != 99;
    ne.ReadInt32(e);
    this.crc32 = Z.bitConverterToUInt32(ne.ReadInt32(e));
    this.compressedSize = ne.ReadInt32(e);
    this.originalSize = ne.ReadInt32(e);
    var t = ne.ReadInt16(e);
    var i = ne.ReadInt16(e);
    var r = ne.ReadInt16(e);
    e.position += 4;
    this.externalAttributes = ne.ReadInt32(e);
    this.localHeaderOffset = ne.ReadInt32(e);
    var n = new Uint8Array(t);
    e.read(n, 0, t);
    var a = Z.byteToString(n);
    a = a.replace('\\', '/');
    this.name = a;
    e.position += i + r;
    if (this.options != 0) {
      this.options = 0;
    }
  };
  s.prototype.readData = function (e, t) {
    if (e.length == 0) throw new DOMException('stream');
    e.position = this.localHeaderOffset;
    this.checkCrc = t;
    this.readLocalHeader(e);
    this.readCompressedData(e);
  };
  s.prototype.decompressData = function () {
    if (this.compressionMethod == 8 && this.originalSize > 0) {
      this.decompressDataOld();
    }
  };
  s.prototype.decompressDataOld = function () {
    var e = new Bl(this.compressedStream, true);
    var t;
    if (this.originalSize > 0) {
      t = new Gt(new Uint8Array(this.originalSize));
    }
    for (var i = new Uint8Array(4096), r; (r = e.read(i, 0, 4096)) > 0; ) t.write(i.subarray(0, r), 0, r);
    this.unCompressedStream = t.toByteArray();
    this.checkCrc;
  };
  s.prototype.readLocalHeader = function (e) {
    if (e.length == 0) throw new DOMException('stream');
    if (ne.ReadInt32(e) != this.headerSignature)
      throw new DOMException("Can't find local header signature - wrong file format or file is corrupt.");
    e.position += 22;
    var t = ne.ReadInt16(e);
    var i = ne.ReadUInt16(e);
    if (this.compressionMethod != 99)
      if (i > 2) {
        e.position += t;
        var r = ne.ReadInt16(e);
        if (r == 23) throw new DOMException('UnSupported');
        e.position += i - 2;
      } else e.position += t + i;
  };
  s.prototype.readCompressedData = function (e) {
    var t;
    if (this.compressedSize > 0) {
      var i = this.compressedSize;
      t = new Gt(new Uint8Array(i));
      for (var r = new Uint8Array(4096); i > 0; ) {
        var n = Math.min(i, 4096);
        if (e.read(r, 0, n) != n) throw new DOMException('End of file reached - wrong file format or file is corrupt.');
        t.write(r.subarray(0, n), 0, n);
        i -= n;
      }
      this.compressedStream = new Uint8Array(t.inputStream);
    } else if (!(this.compressedSize < 0)) {
      this.compressedSize == 0;
    }
  };
  return s;
})();
var tt = (function () {
  function s(e, t) {
    if (e == null) throw new Error('ArgumentException: data cannot be null or undefined');
    if (t == null) throw new Error('ArgumentException: string cannot be null or undefined');
    if (t.length === 0) throw new Error('string cannot be empty');
    this.data = e;
    this.name = t;
  }
  Object.defineProperty(s.prototype, 'dataStream', {
    get: function () {
      return this.decompressedStream;
    },
    enumerable: true,
    configurable: true,
  });
  Object.defineProperty(s.prototype, 'name', {
    get: function () {
      return this.fileName;
    },
    set: function (e) {
      this.fileName = e;
    },
    enumerable: true,
    configurable: true,
  });
  s.prototype.destroy = function () {
    this.fileName = void 0;
    this.data = void 0;
  };
  return s;
})();
var ht = new Int16Array(286);
var Ye = new Uint8Array(286);
var Xr = new Int16Array(30);
var li = new Uint8Array(30);
var Fl = (function () {
  function s(e) {
    this.pendingBuffer = new Uint8Array(65536);
    this.pendingBufLength = 0;
    this.pendingBufCache = 0;
    this.pendingBufBitsInCache = 0;
    this.bufferPosition = 0;
    this.extraBits = 0;
    this.currentHash = 0;
    this.matchStart = 0;
    this.matchLength = 0;
    this.matchPrevAvail = false;
    this.blockStart = 0;
    this.stringStart = 0;
    this.lookAhead = 0;
    this.totalBytesIn = 0;
    this.inputOffset = 0;
    this.inputEnd = 0;
    this.windowSize = 32768;
    this.windowMask = this.windowSize - 1;
    this.hashSize = 32768;
    this.hashMask = this.hashSize - 1;
    this.hashShift = Math.floor(5.666666666666667);
    this.maxDist = this.windowSize - 262;
    this.checkSum = 1;
    this.noWrap = false;
    if (!s.isHuffmanTreeInitiated) {
      s.initHuffmanTree();
      s.isHuffmanTreeInitiated = true;
    }
    this.treeLiteral = new Ie(this, 286, 257, 15);
    this.treeDistances = new Ie(this, 30, 1, 15);
    this.treeCodeLengths = new Ie(this, 19, 4, 7);
    this.arrDistances = new Uint16Array(16384);
    this.arrLiterals = new Uint8Array(16384);
    this.stream = [];
    this.dataWindow = new Uint8Array(2 * this.windowSize);
    this.hashHead = new Int16Array(this.hashSize);
    this.hashPrevious = new Int16Array(this.windowSize);
    this.blockStart = this.stringStart = 1;
    this.noWrap = e;
    if (!e) {
      this.writeZLibHeader();
    }
  }
  Object.defineProperty(s.prototype, 'compressedData', {
    get: function () {
      return this.stream;
    },
    enumerable: true,
    configurable: true,
  });
  Object.defineProperty(s.prototype, 'getCompressedString', {
    get: function () {
      var e = '';
      if (this.stream !== void 0)
        for (var t = 0; t < this.stream.length; t++) e += String.fromCharCode.apply(null, this.stream[t]);
      return e;
    },
    enumerable: true,
    configurable: true,
  });
  s.prototype.write = function (e, t, i) {
    if (e == null) throw new Error('ArgumentException: data cannot null or undefined');
    var r = t + i;
    if (0 > t || t > r || r > e.length) throw new Error('ArgumentOutOfRangeException: Offset or length is incorrect');
    if (typeof e == 'string') {
      var n = new Un(false);
      n.type = 'Utf8';
      e = new Uint8Array(n.getBytes(e, 0, e.length));
      r = t + e.length;
    }
    for (
      this.inputBuffer = e,
        this.inputOffset = t,
        this.inputEnd = r,
        this.noWrap || (this.checkSum = Tl.checksumUpdate(this.checkSum, this.inputBuffer, this.inputOffset, r));
      this.inputEnd !== this.inputOffset || this.pendingBufLength !== 0;

    ) {
      this.pendingBufferFlush();
      this.compressData(false);
    }
  };
  s.prototype.writeZLibHeader = function () {
    var e = 30720;
    e |= 64;
    e += 31 - (e % 31);
    this.pendingBufferWriteShortBytes(e);
  };
  s.prototype.pendingBufferWriteShortBytes = function (e) {
    this.pendingBuffer[this.pendingBufLength++] = e >> 8;
    this.pendingBuffer[this.pendingBufLength++] = e;
  };
  s.prototype.compressData = function (e) {
    var t;
    do {
      this.fillWindow();
      var i = e && this.inputEnd === this.inputOffset;
      t = this.compressSlow(i, e);
    } while (this.pendingBufLength === 0 && t);
    return t;
  };
  s.prototype.compressSlow = function (e, t) {
    if (this.lookAhead < 262 && !e) return false;
    for (; this.lookAhead >= 262 || e; ) {
      if (this.lookAhead === 0) return this.lookAheadCompleted(t);
      if (this.stringStart >= 2 * this.windowSize - 262) {
        this.slideWindow();
      }
      var i = this.matchStart;
      var r = this.matchLength;
      if (this.lookAhead >= 3) {
        this.discardMatch();
      }
      r >= 3 && this.matchLength <= r
        ? (r = this.matchPreviousBest(this.matchStart, r))
        : this.matchPreviousAvailable();
      if (this.bufferPosition >= 16384) return this.huffmanIsFull(t);
    }
    return true;
  };
  s.prototype.discardMatch = function () {
    var e = this.insertString();
    if (
      e !== 0 &&
      this.stringStart - e <= this.maxDist &&
      this.findLongestMatch(e) &&
      this.matchLength <= 5 &&
      this.matchLength === 3 &&
      this.stringStart - this.matchStart > 4096
    ) {
      this.matchLength = 2;
    }
  };
  s.prototype.matchPreviousAvailable = function () {
    if (this.matchPrevAvail) {
      this.huffmanTallyLit(this.dataWindow[this.stringStart - 1] & 255);
    }
    this.matchPrevAvail = true;
    this.stringStart++;
    this.lookAhead--;
  };
  s.prototype.matchPreviousBest = function (e, t) {
    this.huffmanTallyDist(this.stringStart - 1 - e, t);
    t -= 2;
    do {
      this.stringStart++;
      this.lookAhead--;
      if (this.lookAhead >= 3) {
        this.insertString();
      }
    } while (--t > 0);
    this.stringStart++;
    this.lookAhead--;
    this.matchPrevAvail = false;
    this.matchLength = 2;
    return t;
  };
  s.prototype.lookAheadCompleted = function (e) {
    if (this.matchPrevAvail) {
      this.huffmanTallyLit(this.dataWindow[this.stringStart - 1] & 255);
    }
    this.matchPrevAvail = false;
    this.huffmanFlushBlock(this.dataWindow, this.blockStart, this.stringStart - this.blockStart, e);
    this.blockStart = this.stringStart;
    return false;
  };
  s.prototype.huffmanIsFull = function (e) {
    var t = this.stringStart - this.blockStart;
    if (this.matchPrevAvail) {
      t--;
    }
    var i = e && this.lookAhead === 0 && !this.matchPrevAvail;
    this.huffmanFlushBlock(this.dataWindow, this.blockStart, t, i);
    this.blockStart += t;
    return !i;
  };
  s.prototype.fillWindow = function () {
    for (
      this.stringStart >= this.windowSize + this.maxDist && this.slideWindow();
      this.lookAhead < 262 && this.inputOffset < this.inputEnd;

    ) {
      var e = 2 * this.windowSize - this.lookAhead - this.stringStart;
      if (e > this.inputEnd - this.inputOffset) {
        e = this.inputEnd - this.inputOffset;
      }
      this.dataWindow.set(
        this.inputBuffer.subarray(this.inputOffset, this.inputOffset + e),
        this.stringStart + this.lookAhead,
      );
      this.inputOffset += e;
      this.totalBytesIn += e;
      this.lookAhead += e;
    }
    if (this.lookAhead >= 3) {
      this.updateHash();
    }
  };
  s.prototype.slideWindow = function () {
    this.dataWindow.set(this.dataWindow.subarray(this.windowSize, this.windowSize + this.windowSize), 0);
    this.matchStart -= this.windowSize;
    this.stringStart -= this.windowSize;
    this.blockStart -= this.windowSize;
    for (var e = 0; e < this.hashSize; ++e) {
      var t = this.hashHead[e] & 65535;
      this.hashHead[e] = t >= this.windowSize ? t - this.windowSize : 0;
    }
    for (var e = 0; e < this.windowSize; e++) {
      var t = this.hashPrevious[e] & 65535;
      this.hashPrevious[e] = t >= this.windowSize ? t - this.windowSize : 0;
    }
  };
  s.prototype.insertString = function () {
    var e;
    var t = ((this.currentHash << this.hashShift) ^ this.dataWindow[this.stringStart + 2]) & this.hashMask;
    this.hashPrevious[this.stringStart & this.windowMask] = e = this.hashHead[t];
    this.hashHead[t] = this.stringStart;
    this.currentHash = t;
    return e & 65535;
  };
  s.prototype.findLongestMatch = function (e) {
    var t = 4096;
    var i = 258;
    var r = this.stringStart;
    var n;
    var a = this.stringStart + this.matchLength;
    var o = Math.max(this.matchLength, 2);
    var l = Math.max(this.stringStart - this.maxDist, 0);
    var h = this.stringStart + 258 - 1;
    var d = this.dataWindow[a - 1];
    var p = this.dataWindow[a];
    var c = this.dataWindow;
    if (o >= 32) {
      t >>= 2;
    }
    if (i > this.lookAhead) {
      i = this.lookAhead;
    }
    do
      if (
        !(
          this.dataWindow[e + o] !== p ||
          this.dataWindow[e + o - 1] !== d ||
          this.dataWindow[e] !== this.dataWindow[r] ||
          this.dataWindow[e + 1] !== this.dataWindow[r + 1]
        )
      ) {
        for (
          n = e + 2, r += 2;
          this.dataWindow[++r] === this.dataWindow[++n] &&
          this.dataWindow[++r] === this.dataWindow[++n] &&
          this.dataWindow[++r] === this.dataWindow[++n] &&
          this.dataWindow[++r] === this.dataWindow[++n] &&
          this.dataWindow[++r] === this.dataWindow[++n] &&
          this.dataWindow[++r] === this.dataWindow[++n] &&
          this.dataWindow[++r] === this.dataWindow[++n] &&
          this.dataWindow[++r] === this.dataWindow[++n] &&
          r < h;

        );
        if (r > a) {
          this.matchStart = e;
          a = r;
          o = r - this.stringStart;
          if (o >= i) break;
          d = this.dataWindow[a - 1];
          p = this.dataWindow[a];
        }
        r = this.stringStart;
      }
    while ((e = this.hashPrevious[e & this.windowMask] & 65535) > l && --t !== 0);
    this.matchLength = Math.min(o, this.lookAhead);
    return this.matchLength >= 3;
  };
  s.prototype.updateHash = function () {
    this.currentHash = (this.dataWindow[this.stringStart] << this.hashShift) ^ this.dataWindow[this.stringStart + 1];
  };
  s.prototype.huffmanTallyLit = function (e) {
    this.arrDistances[this.bufferPosition] = 0;
    this.arrLiterals[this.bufferPosition++] = e;
    this.treeLiteral.codeFrequencies[e]++;
    return this.bufferPosition >= 16384;
  };
  s.prototype.huffmanTallyDist = function (e, t) {
    this.arrDistances[this.bufferPosition] = e;
    this.arrLiterals[this.bufferPosition++] = t - 3;
    var i = this.huffmanLengthCode(t - 3);
    this.treeLiteral.codeFrequencies[i]++;
    if (i >= 265 && i < 285) {
      this.extraBits += Math.floor((i - 261) / 4);
    }
    var r = this.huffmanDistanceCode(e - 1);
    this.treeDistances.codeFrequencies[r]++;
    if (r >= 4) {
      this.extraBits += Math.floor(r / 2 - 1);
    }
    return this.bufferPosition >= 16384;
  };
  s.prototype.huffmanFlushBlock = function (e, t, i, r) {
    this.treeLiteral.codeFrequencies[256]++;
    this.treeLiteral.buildTree();
    this.treeDistances.buildTree();
    this.treeLiteral.calculateBLFreq(this.treeCodeLengths);
    this.treeDistances.calculateBLFreq(this.treeCodeLengths);
    this.treeCodeLengths.buildTree();
    for (var n = 4, a = 18; a > n; a--)
      if (this.treeCodeLengths.codeLengths[Ie.huffCodeLengthOrders[a]] > 0) {
        n = a + 1;
      }
    for (
      var o =
          14 +
          n * 3 +
          this.treeCodeLengths.getEncodedLength() +
          this.treeLiteral.getEncodedLength() +
          this.treeDistances.getEncodedLength() +
          this.extraBits,
        l = this.extraBits,
        a = 0;
      a < 286;
      a++
    )
      l += this.treeLiteral.codeFrequencies[a] * Ye[a];
    for (var a = 0; a < 30; a++) l += this.treeDistances.codeFrequencies[a] * li[a];
    if (o >= l) {
      o = l;
    }
    t >= 0 && i + 4 < o >> 3
      ? this.huffmanFlushStoredBlock(e, t, i, r)
      : o == l
        ? (this.pendingBufferWriteBits(2 + (r ? 1 : 0), 3),
          this.treeLiteral.setStaticCodes(ht, Ye),
          this.treeDistances.setStaticCodes(Xr, li),
          this.huffmanCompressBlock(),
          this.huffmanReset())
        : (this.pendingBufferWriteBits(4 + (r ? 1 : 0), 3),
          this.huffmanSendAllTrees(n),
          this.huffmanCompressBlock(),
          this.huffmanReset());
  };
  s.prototype.huffmanFlushStoredBlock = function (e, t, i, r) {
    this.pendingBufferWriteBits(0 + (r ? 1 : 0), 3);
    this.pendingBufferAlignToByte();
    this.pendingBufferWriteShort(i);
    this.pendingBufferWriteShort(~i);
    this.pendingBufferWriteByteBlock(e, t, i);
    this.huffmanReset();
  };
  s.prototype.huffmanLengthCode = function (e) {
    if (e === 255) return 285;
    for (var t = 257; e >= 8; ) {
      t += 4;
      e >>= 1;
    }
    return t + e;
  };
  s.prototype.huffmanDistanceCode = function (e) {
    for (var t = 0; e >= 4; ) {
      t += 2;
      e >>= 1;
    }
    return t + e;
  };
  s.prototype.huffmanSendAllTrees = function (e) {
    this.treeCodeLengths.buildCodes();
    this.treeLiteral.buildCodes();
    this.treeDistances.buildCodes();
    this.pendingBufferWriteBits(this.treeLiteral.treeLength - 257, 5);
    this.pendingBufferWriteBits(this.treeDistances.treeLength - 1, 5);
    this.pendingBufferWriteBits(e - 4, 4);
    for (var t = 0; t < e; t++)
      this.pendingBufferWriteBits(this.treeCodeLengths.codeLengths[Ie.huffCodeLengthOrders[t]], 3);
    this.treeLiteral.writeTree(this.treeCodeLengths);
    this.treeDistances.writeTree(this.treeCodeLengths);
  };
  s.prototype.huffmanReset = function () {
    this.bufferPosition = 0;
    this.extraBits = 0;
    this.treeLiteral.reset();
    this.treeDistances.reset();
    this.treeCodeLengths.reset();
  };
  s.prototype.huffmanCompressBlock = function () {
    for (var e = 0; e < this.bufferPosition; e++) {
      var t = this.arrLiterals[e] & 255;
      var i = this.arrDistances[e];
      if (i-- !== 0) {
        var r = this.huffmanLengthCode(t);
        this.treeLiteral.writeCodeToStream(r);
        var n = Math.floor((r - 261) / 4);
        if (n > 0 && n <= 5) {
          this.pendingBufferWriteBits(t & ((1 << n) - 1), n);
        }
        var a = this.huffmanDistanceCode(i);
        this.treeDistances.writeCodeToStream(a);
        n = Math.floor(a / 2 - 1);
        if (n > 0) {
          this.pendingBufferWriteBits(i & ((1 << n) - 1), n);
        }
      } else this.treeLiteral.writeCodeToStream(t);
    }
    this.treeLiteral.writeCodeToStream(256);
  };
  s.prototype.pendingBufferWriteBits = function (e, t) {
    var i = new Uint32Array(1);
    i[0] = this.pendingBufCache | (e << this.pendingBufBitsInCache);
    this.pendingBufCache = i[0];
    this.pendingBufBitsInCache += t;
    this.pendingBufferFlushBits();
  };
  s.prototype.pendingBufferFlush = function (e) {
    this.pendingBufferFlushBits();
    if (this.pendingBufLength > 0) {
      var t = new Uint8Array(this.pendingBufLength);
      t.set(this.pendingBuffer.subarray(0, this.pendingBufLength), 0);
      this.stream.push(t);
    }
    this.pendingBufLength = 0;
  };
  s.prototype.pendingBufferFlushBits = function () {
    for (var e = 0; this.pendingBufBitsInCache >= 8 && this.pendingBufLength < 65536; ) {
      this.pendingBuffer[this.pendingBufLength++] = this.pendingBufCache;
      this.pendingBufCache >>= 8;
      this.pendingBufBitsInCache -= 8;
      e++;
    }
    return e;
  };
  s.prototype.pendingBufferWriteByteBlock = function (e, t, i) {
    var r = e.subarray(t, t + i);
    this.pendingBuffer.set(r, this.pendingBufLength);
    this.pendingBufLength += i;
  };
  s.prototype.pendingBufferWriteShort = function (e) {
    this.pendingBuffer[this.pendingBufLength++] = e;
    this.pendingBuffer[this.pendingBufLength++] = e >> 8;
  };
  s.prototype.pendingBufferAlignToByte = function () {
    if (this.pendingBufBitsInCache > 0) {
      this.pendingBuffer[this.pendingBufLength++] = this.pendingBufCache;
    }
    this.pendingBufCache = 0;
    this.pendingBufBitsInCache = 0;
  };
  s.initHuffmanTree = function () {
    for (var e = 0; e < 144; ) {
      ht[e] = Ie.bitReverse((48 + e) << 8);
      Ye[e++] = 8;
    }
    for (; e < 256; ) {
      ht[e] = Ie.bitReverse((256 + e) << 7);
      Ye[e++] = 9;
    }
    for (; e < 280; ) {
      ht[e] = Ie.bitReverse((-256 + e) << 9);
      Ye[e++] = 7;
    }
    for (; e < 286; ) {
      ht[e] = Ie.bitReverse((-88 + e) << 8);
      Ye[e++] = 8;
    }
    for (e = 0; e < 30; e++) {
      Xr[e] = Ie.bitReverse(e << 11);
      li[e] = 5;
    }
  };
  s.prototype.close = function () {
    do {
      this.pendingBufferFlush(true);
      if (!this.compressData(true)) {
        this.pendingBufferFlush(true);
        this.pendingBufferAlignToByte();
        if (!this.noWrap) {
          this.pendingBufferWriteShortBytes(this.checkSum >> 16);
          this.pendingBufferWriteShortBytes(this.checkSum & 65535);
        }
        this.pendingBufferFlush(true);
      }
    } while (this.inputEnd !== this.inputOffset || this.pendingBufLength !== 0);
  };
  s.prototype.destroy = function () {
    this.stream = [];
    this.stream = void 0;
    this.pendingBuffer = void 0;
    this.treeLiteral = void 0;
    this.treeDistances = void 0;
    this.treeCodeLengths = void 0;
    this.arrLiterals = void 0;
    this.arrDistances = void 0;
    this.hashHead = void 0;
    this.hashPrevious = void 0;
    this.dataWindow = void 0;
    this.inputBuffer = void 0;
    this.pendingBufLength = void 0;
    this.pendingBufCache = void 0;
    this.pendingBufBitsInCache = void 0;
    this.bufferPosition = void 0;
    this.extraBits = void 0;
    this.currentHash = void 0;
    this.matchStart = void 0;
    this.matchLength = void 0;
    this.matchPrevAvail = void 0;
    this.blockStart = void 0;
    this.stringStart = void 0;
    this.lookAhead = void 0;
    this.totalBytesIn = void 0;
    this.inputOffset = void 0;
    this.inputEnd = void 0;
    this.windowSize = void 0;
    this.windowMask = void 0;
    this.hashSize = void 0;
    this.hashMask = void 0;
    this.hashShift = void 0;
    this.maxDist = void 0;
    this.checkSum = void 0;
    this.noWrap = void 0;
  };
  s.isHuffmanTreeInitiated = false;
  return s;
})();
var Ie = (function () {
  function s(e, t, i, r) {
    this.writer = e;
    this.codeMinCount = i;
    this.maxLength = r;
    this.codeFrequency = new Uint16Array(t);
    this.lengthCount = new Int32Array(r);
  }
  Object.defineProperty(s.prototype, 'treeLength', {
    get: function () {
      return this.codeCount;
    },
    enumerable: true,
    configurable: true,
  });
  Object.defineProperty(s.prototype, 'codeLengths', {
    get: function () {
      return this.codeLength;
    },
    enumerable: true,
    configurable: true,
  });
  Object.defineProperty(s.prototype, 'codeFrequencies', {
    get: function () {
      return this.codeFrequency;
    },
    enumerable: true,
    configurable: true,
  });
  s.prototype.setStaticCodes = function (e, t) {
    var i = new Int16Array(e.length);
    i.set(e, 0);
    this.codes = i;
    var r = new Uint8Array(t.length);
    r.set(t, 0);
    this.codeLength = r;
  };
  s.prototype.reset = function () {
    for (var e = 0; e < this.codeFrequency.length; e++) this.codeFrequency[e] = 0;
    this.codes = void 0;
    this.codeLength = void 0;
  };
  s.prototype.writeCodeToStream = function (e) {
    this.writer.pendingBufferWriteBits(this.codes[e] & 65535, this.codeLength[e]);
  };
  s.prototype.buildCodes = function () {
    var e = new Int32Array(this.maxLength);
    this.codes = new Int16Array(this.codeCount);
    for (var t = 0, i = 0; i < this.maxLength; i++) {
      e[i] = t;
      t += this.lengthCount[i] << (15 - i);
    }
    for (var r = 0; r < this.codeCount; r++) {
      var n = this.codeLength[r];
      if (this.codeLength[r] > 0) {
        this.codes[r] = s.bitReverse(e[this.codeLength[r] - 1]);
        e[this.codeLength[r] - 1] += 1 << (16 - this.codeLength[r]);
      }
    }
  };
  s.bitReverse = function (e) {
    return (
      (s.reverseBits[e & 15] << 12) |
      (s.reverseBits[(e >> 4) & 15] << 8) |
      (s.reverseBits[(e >> 8) & 15] << 4) |
      s.reverseBits[e >> 12]
    );
  };
  s.prototype.getEncodedLength = function () {
    for (var e = 0, t = 0; t < this.codeFrequency.length; t++) e += this.codeFrequency[t] * this.codeLength[t];
    return e;
  };
  s.prototype.calculateBLFreq = function (e) {
    for (var t, i, r, n = -1, a = 0; a < this.codeCount; ) {
      r = 1;
      var o = this.codeLength[a];
      for (
        this.codeLength[a] === 0
          ? ((t = 138), (i = 3))
          : ((t = 6), (i = 3), n !== this.codeLength[a] && (e.codeFrequency[this.codeLength[a]]++, (r = 0))),
          n = this.codeLength[a],
          a++;
        a < this.codeCount && n === this.codeLength[a] && (a++, !(++r >= t));

      );
      r < i
        ? (e.codeFrequency[n] += r)
        : n !== 0
          ? e.codeFrequency[16]++
          : r <= 10
            ? e.codeFrequency[17]++
            : e.codeFrequency[18]++;
    }
  };
  s.prototype.writeTree = function (e) {
    for (var t, i, r, n = -1, a = 0; a < this.codeCount; ) {
      r = 1;
      var o = this.codeLength[a];
      for (
        this.codeLength[a] === 0
          ? ((t = 138), (i = 3))
          : ((t = 6), (i = 3), n !== this.codeLength[a] && (e.writeCodeToStream(this.codeLength[a]), (r = 0))),
          n = this.codeLength[a],
          a++;
        a < this.codeCount && n === this.codeLength[a] && (a++, !(++r >= t));

      );
      if (r < i) for (; r-- > 0; ) e.writeCodeToStream(n);
      else
        n !== 0
          ? (e.writeCodeToStream(16), this.writer.pendingBufferWriteBits(r - 3, 2))
          : r <= 10
            ? (e.writeCodeToStream(17), this.writer.pendingBufferWriteBits(r - 3, 3))
            : (e.writeCodeToStream(18), this.writer.pendingBufferWriteBits(r - 11, 7));
    }
  };
  s.prototype.buildTree = function () {
    for (var e = this.codeFrequency.length, t = new Int32Array(e), i = 0, r = 0, n = 0; n < e; n++) {
      var a = this.codeFrequency[n];
      if (this.codeFrequency[n] !== 0) {
        for (
          var o = i++, l = 0;
          o > 0 && this.codeFrequency[t[(l = Math.floor((o - 1) / 2))]] > this.codeFrequency[n];

        ) {
          t[o] = t[l];
          o = l;
        }
        t[o] = n;
        r = n;
      }
    }
    for (; i < 2; ) t[i++] = r < 2 ? ++r : 0;
    this.codeCount = Math.max(r + 1, this.codeMinCount);
    for (var h = i, d = h, p = new Int32Array(4 * i - 2), c = new Int32Array(2 * i - 1), f = 0; f < i; f++) {
      var g = t[f];
      var m = 2 * f;
      p[m] = t[f];
      p[m + 1] = -1;
      c[f] = this.codeFrequency[t[f]] << 8;
      t[f] = f;
    }
    this.constructHuffmanTree(t, i, c, d, p);
    this.buildLength(p);
  };
  s.prototype.constructHuffmanTree = function (e, t, i, r, n) {
    do {
      for (var a = e[0], o = e[--t], l = i[o], h = 0, d = 1; d < t; ) {
        if (d + 1 < t && i[e[d]] > i[e[d + 1]]) {
          d++;
        }
        e[h] = e[d];
        h = d;
        d = h * 2 + 1;
      }
      for (; (d = h) > 0 && i[e[(h = Math.floor((d - 1) / 2))]] > l; ) e[d] = e[h];
      e[d] = o;
      var p = e[0];
      o = r++;
      n[2 * o] = a;
      n[2 * o + 1] = e[0];
      var c = Math.min(i[a] & 255, i[e[0]] & 255);
      for (i[o] = l = i[a] + i[e[0]] - c + 1, h = 0, d = 1; d < t; ) {
        if (d + 1 < t && i[e[d]] > i[e[d + 1]]) {
          d++;
        }
        e[h] = e[d];
        h = d;
        d = h * 2 + 1;
      }
      for (; (d = h) > 0 && i[e[(h = Math.floor((d - 1) / 2))]] > l; ) e[d] = e[h];
      e[d] = o;
    } while (t > 1);
  };
  s.prototype.buildLength = function (e) {
    this.codeLength = new Uint8Array(this.codeFrequency.length);
    for (var t = Math.floor(e.length / 2), i = Math.floor((t + 1) / 2), r = 0, n = 0; n < this.maxLength; n++)
      this.lengthCount[n] = 0;
    r = this.calculateOptimalCodeLength(e, r, t);
    if (r !== 0) {
      var a = this.maxLength - 1;
      do {
        for (; this.lengthCount[--a] === 0; );
        do {
          this.lengthCount[a]--;
          this.lengthCount[++a]++;
          r -= 1 << (this.maxLength - 1 - a);
        } while (r > 0 && a < this.maxLength - 1);
      } while (r > 0);
      this.recreateTree(e, r, i);
    }
  };
  s.prototype.recreateTree = function (e, t, i) {
    this.lengthCount[this.maxLength - 1] += t;
    this.lengthCount[this.maxLength - 2] -= t;
    for (var r = 2 * i, n = this.maxLength; n !== 0; n--)
      for (var a = this.lengthCount[n - 1]; a > 0; ) {
        var o = 2 * e[r++];
        if (e[o + 1] === -1) {
          this.codeLength[e[o]] = n;
          a--;
        }
      }
  };
  s.prototype.calculateOptimalCodeLength = function (e, t, i) {
    var r = new Int32Array(i);
    r[i - 1] = 0;
    for (var n = i - 1; n >= 0; n--) {
      var a = 2 * n + 1;
      if (e[a] !== -1) {
        var o = r[n] + 1;
        if (o > this.maxLength) {
          o = this.maxLength;
          t++;
        }
        r[e[a - 1]] = r[e[a]] = o;
      } else {
        var o = r[n];
        this.lengthCount[r[n] - 1]++;
        this.codeLength[e[a - 1]] = r[n];
      }
    }
    return t;
  };
  s.reverseBits = [0, 8, 4, 12, 2, 10, 6, 14, 1, 9, 5, 13, 3, 11, 7, 15];
  s.huffCodeLengthOrders = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];
  return s;
})();
var Tl = (function () {
  function s() {}
  s.checksumUpdate = function (e, t, i, r) {
    var n = new Uint32Array(1);
    n[0] = e;
    for (var a = n[0], o = (n[0] = a & 65535), l = (n[0] = a >> s.checkSumBitOffset); r > 0; ) {
      var h = Math.min(r, s.checksumIterationCount);
      for (r -= h; --h >= 0; ) {
        o = o + (n[0] = t[i++] & 255);
        l = l + o;
      }
      o %= s.checksumBase;
      l %= s.checksumBase;
    }
    a = (l << s.checkSumBitOffset) | o;
    return a;
  };
  s.checkSumBitOffset = 16;
  s.checksumBase = 65521;
  s.checksumIterationCount = 3800;
  return s;
})();
var Qe = (function () {
  function s(e) {
    this.buildTree(e);
  }
  s.init = function () {
    var e;
    var t;
    for (e = new Uint8Array(288), t = 0; t < 144; ) e[t++] = 8;
    for (; t < 256; ) e[t++] = 9;
    for (; t < 280; ) e[t++] = 7;
    for (; t < 288; ) e[t++] = 8;
    for (s.m_LengthTree = new s(e), e = new Uint8Array(32), t = 0; t < 32; ) e[t++] = 5;
    s.m_DistanceTree = new s(e);
  };
  s.prototype.prepareData = function (e, t, i) {
    for (var r = 0, n = 512, a = 0; a < i.length; a++) {
      var o = i[a];
      if (i[a] > 0) {
        e[i[a]]++;
      }
    }
    for (var l = 1; l <= s.MAX_BITLEN; l++) {
      t[l] = r;
      r += e[l] << (16 - l);
      if (l >= 10) {
        var h = t[l] & 130944;
        var d = r & 130944;
        n += (d - h) >> (16 - l);
      }
    }
    return {
      code: r,
      treeSize: n,
    };
  };
  s.prototype.treeFromData = function (e, t, i, r, n) {
    for (var a = new Int16Array(n), o = 512, l = 128, h = s.MAX_BITLEN; h >= 10; h--) {
      var d = r & 130944;
      r -= e[h] << (16 - h);
      for (var p = r & 130944, c = p; c < d; c += l) {
        a[Z.bitReverse(c)] = Z.bitConverterInt32ToInt16((-o << 4) | h);
        o += 1 << (h - 9);
      }
    }
    for (var c = 0; c < i.length; c++) {
      var h = i[c];
      if (h != 0) {
        r = t[h];
        var f = Z.bitReverse(r);
        if (h <= 9)
          do {
            a[f] = Z.bitConverterInt32ToInt16((c << 4) | h);
            f += 1 << h;
          } while (f < 512);
        else {
          var g = a[f & 511];
          var m = 1 << (g & 15);
          g = -(g >> 4);
          do {
            a[g | (f >> 9)] = Z.bitConverterInt32ToInt16((c << 4) | h);
            f += 1 << h;
          } while (f < m);
        }
        t[h] = r + (1 << (16 - h));
      }
    }
    return a;
  };
  s.prototype.buildTree = function (e) {
    var t = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
    var i = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
    var r = this.prepareData(t, i, e);
    this.m_Tree = this.treeFromData(t, i, e, r.code, r.treeSize);
  };
  s.prototype.unpackSymbol = function (e) {
    var t;
    var i;
    if ((t = e.peekBits(9)) >= 0) {
      if ((i = this.m_Tree[t]) >= 0) {
        e.skipBits(i & 15);
        return i >> 4;
      }
      var r = -(i >> 4);
      var n = i & 15;
      if ((t = e.peekBits(n)) >= 0) {
        i = this.m_Tree[r | (t >> 9)];
        e.skipBits(i & 15);
        return i >> 4;
      }
      var a = e.availableBits;
      t = e.peekBits(e.availableBits);
      i = this.m_Tree[r | (t >> 9)];
      return (i & 15) <= e.availableBits ? (e.skipBits(i & 15), i >> 4) : -1;
    } else {
      var a = e.availableBits;
      t = e.peekBits(e.availableBits);
      i = this.m_Tree[t];
      return i >= 0 && (i & 15) <= e.availableBits ? (e.skipBits(i & 15), i >> 4) : -1;
    }
  };
  Object.defineProperty(s, 'lengthTree', {
    get: function () {
      return this.m_LengthTree;
    },
    enumerable: true,
    configurable: true,
  });
  Object.defineProperty(s, 'distanceTree', {
    get: function () {
      return this.m_DistanceTree;
    },
    enumerable: true,
    configurable: true,
  });
  s.MAX_BITLEN = 15;
  return s;
})();
var Ol = (function () {
  function s() {}
  s.ChecksumUpdate = function (e, t, i, r) {
    for (var n = e, a = n & 65535, o = n >> this.DEF_CHECKSUM_BIT_OFFSET; r > 0; ) {
      var l = Math.min(r, this.DEF_CHECKSUM_ITERATIONSCOUNT);
      for (r -= l; --l >= 0; ) {
        a = a + (t[i++] & 255);
        o = o + a;
      }
      a %= this.DEF_CHECKSUM_BASE;
      o %= this.DEF_CHECKSUM_BASE;
    }
    n = (o << this.DEF_CHECKSUM_BIT_OFFSET) | a;
    e = n;
  };
  s.ChecksumGenerate = function (e, t, i) {
    var r = 1;
    s.ChecksumUpdate(1, e, t, i);
    return 1;
  };
  s.DEF_CHECKSUM_BIT_OFFSET = 16;
  s.DEF_CHECKSUM_BASE = 65521;
  s.DEF_CHECKSUM_ITERATIONSCOUNT = 3800;
  return s;
})();
var Bl = (function () {
  function s(e, t) {
    this.defaultHuffmanDynamicTree = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];
    this.DEF_HEADER_METHOD_MASK = 3840;
    this.DEF_HEADER_INFO_MASK = 61440;
    this.DEF_HEADER_FLAGS_FCHECK = 31;
    this.DEF_HEADER_FLAGS_FDICT = 32;
    this.DEF_HEADER_FLAGS_FLEVEL = 192;
    this.DEF_MAX_WINDOW_SIZE = 65535;
    this.DEF_HUFFMAN_REPEATE_MAX = 258;
    this.DEF_HUFFMAN_END_BLOCK = 256;
    this.DEF_HUFFMAN_LENGTH_MINIMUMCODE = 257;
    this.DEF_HUFFMAN_LENGTH_MAXIMUMCODE = 285;
    this.DEF_HUFFMAN_DISTANCE_MAXIMUMCODE = 29;
    this.mCheckSum = 1;
    this.tBuffer = 0;
    this.mBufferedBits = 0;
    this.mTempBuffer = new Uint8Array(4);
    this.mBlockBuffer = new Uint8Array(this.DEF_MAX_WINDOW_SIZE);
    this.mbNoWrap = false;
    this.mWindowSize = 0;
    this.mCurrentPosition = 0;
    this.mDataLength = 0;
    this.mbCanReadNextBlock = true;
    this.mbCanReadMoreData = true;
    this.mbCheckSumRead = false;
    if (e == null) throw new DOMException('stream');
    if (e.length === 0) throw new DOMException('stream - string can not be empty');
    Qe.init();
    this.mInputStream = new Gt(e);
    this.mbNoWrap = t;
    if (!this.mbNoWrap) {
      this.readZLibHeader();
    }
    this.decodeBlockHeader();
  }
  Object.defineProperty(s.prototype, 'mBuffer', {
    get: function () {
      return this.tBuffer;
    },
    set: function (e) {
      this.tBuffer = e;
    },
    enumerable: true,
    configurable: true,
  });
  s.prototype.peekBits = function (e) {
    if (e < 0) throw new DOMException('count', 'Bits count can not be less than zero.');
    if (e > 32) throw new DOMException('count', 'Count of bits is too large.');
    if (this.mBufferedBits < e) {
      this.fillBuffer();
    }
    if (this.mBufferedBits < e) return -1;
    var t = ~(4294967295 << e);
    var i = Z.bitConverterUintToInt32(this.mBuffer & t);
    return i;
  };
  s.prototype.fillBuffer = function () {
    var e = 4 - (this.mBufferedBits >> 3) - ((this.mBufferedBits & 7) !== 0 ? 1 : 0);
    if (e !== 0)
      for (var t = this.mInputStream.read(this.mTempBuffer, 0, e), i = 0; i < t; i++) {
        this.mBuffer = Z.bitConverterInt32ToUint(
          this.mBuffer | Z.bitConverterInt32ToUint(this.mTempBuffer[i] << this.mBufferedBits),
        );
        this.mBufferedBits += 8;
      }
  };
  s.prototype.skipBits = function (e) {
    if (e < 0) throw new DOMException('count', 'Bits count can not be less than zero.');
    if (e !== 0) {
      e >= this.mBufferedBits
        ? ((e -= this.mBufferedBits),
          (this.mBufferedBits = 0),
          (this.mBuffer = 0),
          e > 0 &&
            ((this.mInputStream.position += e >> 3),
            (e &= 7),
            e > 0 &&
              (this.fillBuffer(),
              (this.mBufferedBits -= e),
              (this.mBuffer = Z.bitConverterInt32ToUint(this.mBuffer >>> e)))))
        : ((this.mBufferedBits -= e), (this.mBuffer = Z.bitConverterInt32ToUint(this.mBuffer >>> e)));
    }
  };
  Object.defineProperty(s.prototype, 'availableBits', {
    get: function () {
      return this.mBufferedBits;
    },
    enumerable: true,
    configurable: true,
  });
  s.prototype.readZLibHeader = function () {
    var e = this.readInt16();
    if (e === -1) throw new DOMException('Header of the stream can not be read.');
    if (e % 31 !== 0) throw new DOMException('Header checksum illegal');
    if ((e & this.DEF_HEADER_METHOD_MASK) !== 2048) throw new DOMException('Unsupported compression method.');
    this.mWindowSize = Math.pow(2, ((e & this.DEF_HEADER_INFO_MASK) >> 12) + 8);
    if (this.mWindowSize > 65535) throw new DOMException('Unsupported window size for deflate compression method.');
    if ((e & this.DEF_HEADER_FLAGS_FDICT) >> 5 === 1)
      throw new DOMException('Custom dictionary is not supported at the moment.');
  };
  s.prototype.readInt16 = function () {
    var e = this.readBits(8) << 8;
    e |= this.readBits(8);
    return e;
  };
  s.prototype.readBits = function (e) {
    var t = this.peekBits(e);
    return t === -1
      ? -1
      : ((this.mBufferedBits -= e), (this.mBuffer = Z.bitConverterInt32ToUint(this.mBuffer >>> e)), t);
  };
  s.prototype.decodeBlockHeader = function () {
    if (!this.mbCanReadNextBlock) return false;
    var e = this.readBits(1);
    if (e === -1) return false;
    var t = this.readBits(2);
    if (t === -1) return false;
    switch (((this.mbCanReadNextBlock = e === 0), t)) {
      case 0:
        {
          this.mbReadingUncompressed = true;
          this.skipToBoundary();
        }
        {
          var i = this.readInt16Inverted();
          var r = this.readInt16Inverted();
        }
        if (i !== (r ^ 65535)) throw new DOMException('Wrong block length.');
        if (i > 65535) throw new DOMException('Uncompressed block length can not be more than 65535.');
        {
          this.mUncompressedDataLength = i;
          this.mCurrentLengthTree = null;
          this.mCurrentDistanceTree = null;
        }
        break;
      case 1:
        {
          this.mbReadingUncompressed = false;
          this.mUncompressedDataLength = -1;
          this.mCurrentLengthTree = Qe.lengthTree;
          this.mCurrentDistanceTree = Qe.distanceTree;
        }
        break;
      case 2:
        {
          this.mbReadingUncompressed = false;
          this.mUncompressedDataLength = -1;
        }
        var n = this.decodeDynamicHeader(this.mCurrentLengthTree, this.mCurrentDistanceTree);
        {
          this.mCurrentLengthTree = n.lengthTree;
          this.mCurrentDistanceTree = n.distanceTree;
        }
        break;
      default:
        throw new DOMException('Wrong block type.');
    }
    return true;
  };
  s.prototype.skipToBoundary = function () {
    this.mBuffer = Z.bitConverterInt32ToUint(this.mBuffer >>> (this.mBufferedBits & 7));
    this.mBufferedBits &= -8;
  };
  s.prototype.readInt16Inverted = function () {
    var e = this.readBits(8);
    e |= this.readBits(8) << 8;
    return e;
  };
  s.prototype.decodeDynamicHeader = function (e, t) {
    var i = 0;
    var r = this.readBits(5);
    var n = this.readBits(5);
    var a = this.readBits(4);
    if (r < 0 || n < 0 || a < 0) throw new DOMException('Wrong dynamic huffman codes.');
    r += 257;
    n += 1;
    var o = r + n;
    var l = new Uint8Array(o);
    var h = new Uint8Array(19);
    a += 4;
    for (var d = 0; d < a; ) {
      var p = this.readBits(3);
      if (p < 0) throw new DOMException('Wrong dynamic huffman codes.');
      h[this.defaultHuffmanDynamicTree[d++]] = p;
    }
    var c = new Qe(h);
    for (d = 0; ; ) {
      var f = void 0;
      var g = false;
      for (f = c.unpackSymbol(this); (f & -16) === 0; ) {
        l[d++] = i = f;
        if (d === o) {
          g = true;
          break;
        }
        f = c.unpackSymbol(this);
      }
      if (g) break;
      if (f < 0) throw new DOMException('Wrong dynamic huffman codes.');
      if (f >= 17) i = 0;
      else if (d === 0) throw new DOMException('Wrong dynamic huffman codes.');
      var m = f - 16;
      var y = s.DEF_HUFFMAN_DYNTREE_REPEAT_BITS[m];
      var v = this.readBits(s.DEF_HUFFMAN_DYNTREE_REPEAT_BITS[m]);
      if (v < 0) throw new DOMException('Wrong dynamic huffman codes.');
      v += s.DEF_HUFFMAN_DYNTREE_REPEAT_MINIMUMS[m];
      if (d + v > o) throw new DOMException('Wrong dynamic huffman codes.');
      for (; v-- > 0; ) l[d++] = i;
      if (d === o) break;
    }
    var b = new Uint8Array(r);
    b.set(l.subarray(0, r), 0);
    e = new Qe(b);
    b = l.slice(r, r + n);
    t = new Qe(b);
    return {
      lengthTree: e,
      distanceTree: t,
    };
  };
  s.prototype.readHuffman = function () {
    for (
      var e = this.DEF_MAX_WINDOW_SIZE - (this.mDataLength - this.mCurrentPosition), t = false, i = {};
      e >= this.DEF_HUFFMAN_REPEATE_MAX;

    ) {
      var r = void 0;
      for (r = this.mCurrentLengthTree.unpackSymbol(this); (r & -256) === 0; ) {
        i[(this.mDataLength + 1) % this.DEF_MAX_WINDOW_SIZE] = r;
        this.mBlockBuffer[this.mDataLength++ % this.DEF_MAX_WINDOW_SIZE] = r;
        t = true;
        if (--e < this.DEF_HUFFMAN_REPEATE_MAX) return true;
        r = this.mCurrentLengthTree.unpackSymbol(this);
      }
      if (r < this.DEF_HUFFMAN_LENGTH_MINIMUMCODE) {
        if (r < this.DEF_HUFFMAN_END_BLOCK) throw new DOMException('Illegal code.');
        var n = t ? 1 : 0;
        this.mbCanReadMoreData = this.decodeBlockHeader();
        var a = this.mbCanReadMoreData ? 1 : 0;
        return !!(n | a);
      }
      if (r > this.DEF_HUFFMAN_LENGTH_MAXIMUMCODE) throw new DOMException('Illegal repeat code length.');
      var o = s.DEF_HUFFMAN_REPEAT_LENGTH_BASE[r - this.DEF_HUFFMAN_LENGTH_MINIMUMCODE];
      var l = s.DEF_HUFFMAN_REPEAT_LENGTH_EXTENSION[r - this.DEF_HUFFMAN_LENGTH_MINIMUMCODE];
      if (l > 0) {
        var h = this.readBits(l);
        if (h < 0) throw new DOMException('Wrong data.');
        o += h;
      }
      r = this.mCurrentDistanceTree.unpackSymbol(this);
      if (r < 0 || r > s.DEF_HUFFMAN_REPEAT_DISTANCE_BASE.length) throw new DOMException('Wrong distance code.');
      var d = s.DEF_HUFFMAN_REPEAT_DISTANCE_BASE[r];
      l = s.DEF_HUFFMAN_REPEAT_DISTANCE_EXTENSION[r];
      if (l > 0) {
        var h = this.readBits(l);
        if (h < 0) throw new DOMException('Wrong data.');
        d += h;
      }
      for (var p = 0; p < o; p++) {
        this.mBlockBuffer[this.mDataLength % this.DEF_MAX_WINDOW_SIZE] =
          this.mBlockBuffer[(this.mDataLength - d) % this.DEF_MAX_WINDOW_SIZE];
        this.mDataLength++;
        e--;
      }
      t = true;
    }
    return t;
  };
  s.prototype.read = function (e, t, i) {
    if (e == null) throw new DOMException('buffer');
    if (t < 0 || t > e.length - 1) throw new DOMException('offset', 'Offset does not belong to specified buffer.');
    if (i < 0 || i > e.length - t) throw new DOMException('length', 'Length is illegal.');
    for (var r = i; i > 0; )
      if (this.mCurrentPosition < this.mDataLength) {
        var n = this.mCurrentPosition % this.DEF_MAX_WINDOW_SIZE;
        var a = Math.min(this.DEF_MAX_WINDOW_SIZE - n, this.mDataLength - this.mCurrentPosition);
        a = Math.min(a, i);
        Z.arrayCopy(this.mBlockBuffer, n, e, t, a);
        this.mCurrentPosition += a;
        t += a;
        i -= a;
      } else {
        if (!this.mbCanReadMoreData) break;
        var o = this.mDataLength;
        if (this.mbReadingUncompressed)
          if (this.mUncompressedDataLength === 0) {
            this.mbCanReadMoreData = this.decodeBlockHeader();
            if (!this.mbCanReadMoreData) break;
          } else {
            var n = this.mDataLength % this.DEF_MAX_WINDOW_SIZE;
            var l = Math.min(this.mUncompressedDataLength, this.DEF_MAX_WINDOW_SIZE - n);
            var h = this.readPackedBytes(this.mBlockBuffer, n, l);
            if (l !== h) throw new DOMException('Not enough data in stream.');
            this.mUncompressedDataLength -= h;
            this.mDataLength += h;
          }
        else if (!this.readHuffman()) break;
        if (this.mDataLength < this.mDataLength) {
          var d = this.mDataLength % this.DEF_MAX_WINDOW_SIZE;
          var p = this.mDataLength % this.DEF_MAX_WINDOW_SIZE;
          d < p
            ? this.checksumUpdate(this.mBlockBuffer, d, p - d)
            : (this.checksumUpdate(this.mBlockBuffer, d, this.DEF_MAX_WINDOW_SIZE - d),
              p > 0 && this.checksumUpdate(this.mBlockBuffer, 0, p));
        }
      }
    if (!this.mbCanReadMoreData && !this.mbCheckSumRead && !this.mbNoWrap) {
      this.skipToBoundary();
      var c = this.readInt32();
      if (c !== this.mCheckSum) throw new DOMException('Checksum check failed.');
      this.mbCheckSumRead = true;
    }
    return r - i;
  };
  s.prototype.readPackedBytes = function (e, t, i) {
    if (e == null) throw new DOMException('buffer');
    if (t < 0 || t > e.length - 1)
      throw new DOMException('offset", "Offset can not be less than zero or greater than buffer length - 1.');
    if (i < 0) throw new DOMException('length", "Length can not be less than zero.');
    if (i > e.length - t) throw new DOMException('length", "Length is too large.');
    if ((this.mBufferedBits & 7) !== 0) throw new DOMException('Reading of unalligned data is not supported.');
    if (i === 0) return 0;
    for (var r = 0; this.mBufferedBits > 0 && i > 0; ) {
      e[t++] = this.mBuffer;
      this.mBufferedBits -= 8;
      this.mBuffer = Z.bitConverterInt32ToUint(this.mBuffer >>> 8);
      i--;
      r++;
    }
    if (i > 0) {
      r += this.mInputStream.read(e, t, i);
    }
    return r;
  };
  s.prototype.readInt32 = function () {
    var e = this.readBits(8) << 24;
    e |= this.readBits(8) << 16;
    e |= this.readBits(8) << 8;
    e |= this.readBits(8);
    return e;
  };
  s.prototype.checksumUpdate = function (e, t, i) {
    Ol.ChecksumUpdate(this.mCheckSum, e, t, i);
  };
  s.DEF_REVERSE_BITS = new Uint8Array([0, 8, 4, 12, 2, 10, 6, 14, 1, 9, 5, 13, 3, 11, 7, 15]);
  s.DEF_HUFFMAN_DYNTREE_REPEAT_MINIMUMS = [3, 3, 11];
  s.DEF_HUFFMAN_DYNTREE_REPEAT_BITS = [2, 3, 7];
  s.DEF_HUFFMAN_REPEAT_LENGTH_BASE = [
    3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258,
  ];
  s.DEF_HUFFMAN_REPEAT_LENGTH_EXTENSION = [
    0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0,
  ];
  s.DEF_HUFFMAN_REPEAT_DISTANCE_BASE = [
    1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145,
    8193, 12289, 16385, 24577,
  ];
  s.DEF_HUFFMAN_REPEAT_DISTANCE_EXTENSION = [
    0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13,
  ];
  return s;
})();
var Gt = (function () {
  function s(e) {
    this.position = 0;
    this.inputStream = new Uint8Array(e.buffer);
  }
  Object.defineProperty(s.prototype, 'length', {
    get: function () {
      return this.inputStream.buffer.byteLength;
    },
    enumerable: true,
    configurable: true,
  });
  s.prototype.read = function (e, t, i) {
    var r = new Uint8Array(this.inputStream.buffer, this.position + t);
    var n = r.subarray(0, i);
    e.set(n, 0);
    this.position += n.byteLength;
    return n.byteLength;
  };
  s.prototype.readByte = function () {
    return this.inputStream[this.position++];
  };
  s.prototype.write = function (e, t, i) {
    Z.arrayCopy(e, 0, this.inputStream, this.position + t, i);
    this.position += i;
  };
  s.prototype.toByteArray = function () {
    return new Uint8Array(this.inputStream.buffer);
  };
  return s;
})();
var Al = (function () {
  function s(e) {
    this.intl = new Jt();
  }
  s.prototype.getFormatFunction = function (e, t) {
    return e.type ? (t && (e.isServerRendered = true), this.intl.getDateFormat(e)) : this.intl.getNumberFormat(e);
  };
  s.prototype.toView = function (e, t) {
    var i = e;
    if (!u(t) && !u(e)) {
      i = t(e);
    }
    return i;
  };
  s.prototype.displayText = function (e, t, i) {
    return this.toView(e, this.getFormatFunction(t, i));
  };
  return s;
})();
var kl = (function () {
  function s(e, t) {
    this.csvStr = '';
    t == null ? (this.separator = ',') : (this.separator = t);
    this.formatter = new Al();
    this.isMicrosoftBrowser = !!navigator.msSaveBlob;
    if (e.isServerRendered !== null && e.isServerRendered !== void 0) {
      this.isServerRendered = e.isServerRendered;
    }
    if (e.styles !== null && e.styles !== void 0) {
      this.globalStyles = new Map();
      for (var i = 0; i < e.styles.length; i++)
        if (e.styles[i].name !== void 0 && e.styles[i].numberFormat !== void 0) {
          this.globalStyles.set(e.styles[i].name, e.styles[i].numberFormat);
        }
    }
    if (e.worksheets !== null && e.worksheets !== void 0) {
      this.parseWorksheet(e.worksheets[0]);
    }
  }
  s.prototype.parseWorksheet = function (e) {
    if (e.rows !== null && e.rows !== void 0) {
      this.parseRows(e.rows);
    }
  };
  s.prototype.parseRows = function (e) {
    for (var t = 1, i = 0, r = e; i < r.length; i++) {
      var n = r[i];
      if (r[i].index !== null && r[i].index !== void 0) {
        for (; t < r[i].index; ) {
          this.csvStr += `\r
`;
          t++;
        }
        this.parseRow(r[i]);
      } else throw Error('Row index is missing.');
    }
    this.csvStr += `\r
`;
  };
  s.prototype.parseRow = function (e) {
    if (e.cells !== null && e.cells !== void 0)
      for (var t = 1, i = 0, r = e.cells; i < r.length; i++) {
        var n = r[i];
        if (r[i].index !== null && r[i].index !== void 0) {
          for (; t < r[i].index; ) {
            this.csvStr += this.separator;
            t++;
          }
          this.parseCell(r[i]);
        } else throw Error('Cell index is missing.');
      }
  };
  s.prototype.parseCell = function (e) {
    var t = this.csvStr;
    if (e.value !== void 0)
      if (e.value instanceof Date)
        if (e.style !== void 0 && e.style.numberFormat !== void 0)
          try {
            t += this.parseCellValue(
              this.formatter.displayText(
                e.value,
                {
                  type: 'dateTime',
                  skeleton: e.style.numberFormat,
                },
                this.isServerRendered,
              ),
            );
          } catch {
            t += this.parseCellValue(
              this.formatter.displayText(
                e.value,
                {
                  type: 'dateTime',
                  format: e.style.numberFormat,
                },
                this.isServerRendered,
              ),
            );
          }
        else if (e.style !== void 0 && e.style.name !== void 0 && this.globalStyles.has(e.style.name))
          try {
            t += this.parseCellValue(
              this.formatter.displayText(
                e.value,
                {
                  type: 'dateTime',
                  skeleton: this.globalStyles.get(e.style.name),
                },
                this.isServerRendered,
              ),
            );
          } catch {
            t += this.parseCellValue(
              this.formatter.displayText(
                e.value,
                {
                  type: 'dateTime',
                  format: this.globalStyles.get(e.style.name),
                },
                this.isServerRendered,
              ),
            );
          }
        else t += e.value;
      else
        typeof e.value == 'boolean'
          ? (t += e.value ? 'TRUE' : 'FALSE')
          : typeof e.value == 'number'
            ? e.style !== void 0 && e.style.numberFormat !== void 0
              ? (t += this.parseCellValue(
                  this.formatter.displayText(
                    e.value,
                    {
                      format: e.style.numberFormat,
                      ignoreCurrency: true,
                    },
                    this.isServerRendered,
                  ),
                ))
              : e.style !== void 0 && e.style.name !== void 0 && this.globalStyles.has(e.style.name)
                ? (t += this.parseCellValue(
                    this.formatter.displayText(
                      e.value,
                      {
                        format: this.globalStyles.get(e.style.name),
                        ignoreCurrency: true,
                      },
                      this.isServerRendered,
                    ),
                  ))
                : (t += e.value)
            : (t += this.parseCellValue(e.value));
    this.csvStr = t;
  };
  s.prototype.parseCellValue = function (e) {
    for (var t = '', i = e.length, r = 0; r < i; r++) e[r] === '"' ? (t += e[r].replace('"', '""')) : (t += e[r]);
    e = t;
    return e.indexOf(this.separator) !== -1 ||
      e.indexOf(`
`) !== -1 ||
      e.indexOf('"') !== -1
      ? (e = '"' + e + '"')
      : e;
  };
  s.prototype.save = function (e) {
    this.buffer = new Blob(['\uFEFF' + this.csvStr], { type: 'text/csv;charset=UTF-8' });
    if (this.isMicrosoftBrowser) navigator.msSaveBlob(this.buffer, e);
    else {
      var t = window.URL.createObjectURL(this.buffer);
      var i = document.createElementNS('http://www.w3.org/1999/xhtml', 'a');
      i.download = e;
      i.href = t;
      var r = document.createEvent('MouseEvent');
      r.initEvent('click', true, true);
      i.dispatchEvent(r);
      setTimeout(function () {
        window.URL.revokeObjectURL(t);
      });
    }
  };
  s.prototype.saveAsBlob = function (e) {
    if (e != null) {
      var t = new Un();
      var i = 'UTF-8';
      e.toUpperCase() == 'ANSI'
        ? ((t.type = 'Ansi'), (i = 'ANSI'))
        : e.toUpperCase() == 'UNICODE'
          ? ((t.type = 'Unicode'), (i = 'UNICODE'))
          : ((t.type = 'Utf8'), (i = 'UTF-8'));
      var r = t.getBytes(this.csvStr, 0, this.csvStr.length);
      return new Blob([r], { type: 'text/csv;charset=' + i });
    } else return new Blob(['\uFEFF' + this.csvStr], { type: 'text/csv;charset=UTF-8' });
  };
  return s;
})();
var Jr = (function () {
  function s() {
    this.parts = [];
  }
  s.prototype.append = function (e) {
    this.parts.push(e);
    this.blob = void 0;
  };
  s.prototype.getBlob = function () {
    return new Blob(this.parts, { type: 'text/plain' });
  };
  return s;
})();
var Ll = (function () {
  function s() {}
  return s;
})();
var Zr = (function () {
  function s(e, t, i, r, n) {
    this.sharedStringCount = 0;
    this.unitsProportions = [
      1.28, 0.32, 96, 3.7795275590551185, 37.79527559055118, 1, 1.3333333333333333, 0.00010498687664041994,
    ];
    this.hyperlinkStyle = {
      fontColor: '#0000FF',
      underline: true,
    };
    i !== void 0 ? (this.culture = i) : (this.culture = 'en-US');
    r !== void 0 ? (this.currency = r) : (this.currency = 'USD');
    this.intl = new Jt(this.culture);
    this.mSaveType = t;
    if (t === 'xlsx') {
      this.mArchive = new ne();
      this.sharedString = [];
      this.mFonts = [];
      this.mBorders = [];
      this.mStyles = [];
      this.printTitles = new Map();
      this.cellStyles = new Map();
      this.mNumFmt = new Map();
      this.mFills = new Map();
      this.mStyles.push(new ke());
      this.mFonts.push(new Vr());
      this.cellStyles.set('Normal', new _r());
      this.mCellXfs = [];
      this.mCellStyleXfs = [];
      this.drawingCount = 0;
      this.imageCount = 0;
      if (e.styles !== null && e.styles !== void 0) {
        this.globalStyles = new Map();
        for (var a = 0; a < e.styles.length; a++)
          if (e.styles[a].name !== void 0) {
            if (this.cellStyles.has(e.styles[a].name))
              throw Error('Style name ' + e.styles[a].name + ' is already existed');
            var o = new ke();
            o.isGlobalStyle = true;
            this.parserCellStyle(e.styles[a], o, 'none');
            var l = new _r();
            l.name = o.name;
            l.xfId = o.index - 1;
            this.cellStyles.set(l.name, l);
            var h = {};
            if (e.styles[a].numberFormat !== void 0) {
              h.format = e.styles[a].numberFormat;
            }
            e.styles[a].type !== void 0 ? (h.type = e.styles[a].type) : (h.type = 'datetime');
            if (h.format !== void 0) {
              this.globalStyles.set(e.styles[a].name, h);
            }
          }
      }
      if (e.worksheets !== null && e.worksheets !== void 0) this.parserWorksheets(e.worksheets);
      else throw Error('Worksheet is expected.');
      if (e.builtInProperties !== null && e.builtInProperties !== void 0) {
        this.builtInProperties = new Ml();
        this.parserBuiltInProperties(e.builtInProperties, this.builtInProperties);
      }
    } else this.csvHelper = new kl(e, n);
  }
  s.prototype.parserBuiltInProperties = function (e, t) {
    if (e.author !== null && e.author !== void 0) {
      t.author = e.author;
    }
    if (e.comments !== null && e.comments !== void 0) {
      t.comments = e.comments;
    }
    if (e.category !== null && e.category !== void 0) {
      t.category = e.category;
    }
    if (e.company !== null && e.company !== void 0) {
      t.company = e.company;
    }
    if (e.manager !== null && e.manager !== void 0) {
      t.manager = e.manager;
    }
    if (e.subject !== null && e.subject !== void 0) {
      t.subject = e.subject;
    }
    if (e.title !== null && e.title !== void 0) {
      t.title = e.title;
    }
    if (e.createdDate !== null && e.createdDate !== void 0) {
      t.createdDate = e.createdDate;
    }
    if (e.modifiedDate !== null && e.modifiedDate !== void 0) {
      t.modifiedDate = e.modifiedDate;
    }
    if (e.tags !== null && e.tags !== void 0) {
      t.tags = e.tags;
    }
    if (e.status !== null && e.status !== void 0) {
      t.status = e.status;
    }
  };
  s.prototype.parserWorksheets = function (e) {
    this.worksheets = new vl();
    for (var t = e.length, i = 0; i < t; i++) {
      var r = e[i];
      var n = new Sl();
      this.mergeCells = new Cl();
      this.mergedCellsStyle = new Map();
      this.mHyperLinks = [];
      e[i].name !== null && e[i].name !== void 0 ? (n.name = e[i].name) : (n.name = 'Sheet' + (i + 1).toString());
      if (e[i].enableRtl !== null && e[i].enableRtl !== void 0) {
        n.enableRtl = e[i].enableRtl;
      }
      n.index = i + 1;
      if (e[i].columns !== null && e[i].columns !== void 0) {
        this.parserColumns(e[i].columns, n);
      }
      if (e[i].rows !== null && e[i].rows !== void 0) {
        this.parserRows(e[i].rows, n);
      }
      if (e[i].showGridLines !== null && e[i].showGridLines !== void 0) {
        n.showGridLines = e[i].showGridLines;
      }
      if (e[i].freeze !== null && e[i].freeze !== void 0) {
        this.parserFreezePanes(e[i].freeze, n);
      }
      if (e[i].printTitle !== null && e[i].printTitle !== void 0) {
        this.parserPrintTitle(e[i].printTitle, n);
      }
      if (e[i].pageSetup !== void 0 && e[i].pageSetup.isSummaryRowBelow !== void 0) {
        n.isSummaryRowBelow = e[i].pageSetup.isSummaryRowBelow;
      }
      if (e[i].images !== void 0) {
        this.parserImages(e[i].images, n);
      }
      if (e[i].autoFilters !== null && e[i].autoFilters !== void 0) {
        this.parseFilters(e[i].autoFilters, n);
      }
      n.index = i + 1;
      n.mergeCells = this.mergeCells;
      n.hyperLinks = this.mHyperLinks;
      this.worksheets.push(n);
    }
  };
  s.prototype.mergeOptions = function (e, t) {
    var i = {};
    this.applyProperties(e, i);
    this.applyProperties(t, i);
    return i;
  };
  s.prototype.applyProperties = function (e, t) {
    for (var i = Object.keys(e), r = 0; r < i.length; r++)
      if (i[r] !== 'name') {
        t[i[r]] = e[i[r]];
      }
  };
  s.prototype.getCellName = function (e, t) {
    return this.getColumnName(t) + e.toString();
  };
  s.prototype.getColumnName = function (e) {
    e--;
    var t = '';
    do {
      var i = e % 26;
      e = e / 26 - 1;
      t = String.fromCharCode(65 + i) + t;
    } while (e >= 0);
    return t;
  };
  s.prototype.parserPrintTitle = function (e, t) {
    var i = '';
    var r;
    if (e.fromRow !== null && e.fromRow !== void 0) {
      var n = e.fromRow;
      var a = void 0;
      e.toRow !== null && e.toRow !== void 0 ? (a = e.toRow) : (a = e.fromRow);
      r = '$' + e.fromRow + ':$' + a;
    }
    var o;
    if (e.fromColumn !== null && e.fromColumn !== void 0) {
      var l = e.fromColumn;
      var h = void 0;
      e.toColumn !== null && e.toColumn !== void 0 ? (h = e.toColumn) : (h = e.fromColumn);
      o = '$' + this.getColumnName(e.fromColumn) + ':$' + this.getColumnName(h);
    }
    if (r !== void 0) {
      i += t.name + '!' + r;
    }
    o !== void 0 && r !== void 0 ? (i += ',' + (t.name + '!' + o)) : o !== void 0 && (i += t.name + '!' + o);
    if (i !== '') {
      this.printTitles.set(t.index - 1, i);
    }
  };
  s.prototype.parserFreezePanes = function (e, t) {
    t.freezePanes = new bl();
    e.row !== null && e.row !== void 0 ? (t.freezePanes.row = e.row) : (t.freezePanes.row = 0);
    e.column !== null && e.column !== void 0 ? (t.freezePanes.column = e.column) : (t.freezePanes.column = 0);
    t.freezePanes.leftCell = this.getCellName(t.freezePanes.row + 1, t.freezePanes.column + 1);
  };
  s.prototype.parserColumns = function (e, t) {
    var i = e.length;
    t.columns = [];
    for (var r = 0; r < e.length; r++) {
      var n = new cl();
      if (e[r].index !== null && e[r].index !== void 0) n.index = e[r].index;
      else throw Error('Column index is missing.');
      if (e[r].width !== null && e[r].width !== void 0) {
        n.width = e[r].width;
      }
      t.columns.push(n);
    }
  };
  s.prototype.parserRows = function (e, t) {
    var i = e.length;
    t.rows = new gl();
    for (var r = 0, n = 0; n < e.length; n++) {
      var a = this.parserRow(e[n], r);
      r = a.index;
      t.rows.add(a);
    }
    this.insertMergedCellsStyle(t);
  };
  s.prototype.insertMergedCellsStyle = function (e) {
    var t = this;
    if (this.mergeCells.length > 0) {
      this.mergedCellsStyle.forEach(function (i, r) {
        var n = e.rows.filter(function (p) {
          return p.index === i.y;
        })[0];
        if (
          u(
            e.rows.filter(function (p) {
              return p.index === i.y;
            })[0],
          )
        ) {
          var h = e.rows.filter(function (c) {
            return c.index <= i.y;
          });
          var d = new Wr();
          d.index = i.y;
          d.cells = new Gr();
          d.cells.add(t.createCell(i, r));
          var l = 0;
          if (h.length > 0) {
            l = e.rows.indexOf(h[h.length - 1]) + 1;
          }
          e.rows.splice(l, 0, d);
        } else {
          var a = e.rows
            .filter(function (p) {
              return p.index === i.y;
            })[0]
            .cells.filter(function (p) {
              return p.index === i.x;
            })[0];
          if (!u(a)) a.styleIndex = i.styleIndex;
          else {
            var o = e.rows
              .filter(function (p) {
                return p.index === i.y;
              })[0]
              .cells.filter(function (p) {
                return p.index <= i.x;
              });
            var l = 0;
            if (o.length > 0) {
              l =
                e.rows
                  .filter(function (p) {
                    return p.index === i.y;
                  })[0]
                  .cells.indexOf(o[o.length - 1]) + 1;
            }
            e.rows
              .filter(function (p) {
                return p.index === i.y;
              })[0]
              .cells.splice(l, 0, t.createCell(i, r));
          }
        }
      });
    }
  };
  s.prototype.createCell = function (e, t) {
    var i = new Ur();
    i.refName = t;
    i.index = e.x;
    i.cellStyle = new ke();
    i.styleIndex = e.styleIndex;
    return i;
  };
  s.prototype.parserRow = function (e, t) {
    var i = new Wr();
    if (e.height !== null && e.height !== void 0) {
      i.height = e.height;
    }
    if (e.index !== null && e.index !== void 0) i.index = e.index;
    else throw Error('Row index is missing.');
    if (e.grouping !== null && e.grouping !== void 0) {
      this.parseGrouping(e.grouping, i);
    }
    this.parseCells(e.cells, i);
    return i;
  };
  s.prototype.parseGrouping = function (e, t) {
    t.grouping = new wl();
    if (e.outlineLevel !== void 0) {
      t.grouping.outlineLevel = e.outlineLevel;
    }
    if (e.isCollapsed !== void 0) {
      t.grouping.isCollapsed = e.isCollapsed;
    }
    if (e.isHidden !== void 0) {
      t.grouping.isHidden = e.isHidden;
    }
  };
  s.prototype.parseCells = function (e, t) {
    t.cells = new Gr();
    for (var i = e !== void 0 ? e.length : 0, r = 1, n = 1, a = 0; a < i; a++) {
      var o = e[a];
      var l = new Ur();
      if (e[a].index !== null && e[a].index !== void 0) l.index = e[a].index;
      else throw Error('Cell index is missing.');
      l.index < r ? (r = l.index) : l.index > n && (n = l.index);
      l.refName = this.getCellName(t.index, l.index);
      e[a].rowSpan !== null && e[a].rowSpan !== void 0 ? (l.rowSpan = e[a].rowSpan - 1) : (l.rowSpan = 0);
      e[a].colSpan !== null && e[a].colSpan !== void 0 ? (l.colSpan = e[a].colSpan - 1) : (l.colSpan = 0);
      if (e[a].hyperlink !== null && e[a].hyperlink !== void 0) {
        var h = new Kr();
        if (e[a].hyperlink.target !== void 0) {
          h.target = e[a].hyperlink.target;
          e[a].hyperlink.displayText !== void 0
            ? (l.value = e[a].hyperlink.displayText)
            : (l.value = e[a].hyperlink.target);
          l.type = this.getCellValueType(l.value);
          h.ref = l.refName;
          h.rId = this.mHyperLinks.length + 1;
          this.mHyperLinks.push(h);
          l.cellStyle = new ke();
          this.parserCellStyle(
            e[a].style !== void 0 ? this.mergeOptions(e[a].style, this.hyperlinkStyle) : this.hyperlinkStyle,
            l.cellStyle,
            'string',
          );
          l.styleIndex = l.cellStyle.index;
        }
      }
      if (e[a].formula !== null && e[a].formula !== void 0) {
        l.formula = e[a].formula;
        l.type = 'formula';
      }
      if (e[a].value !== null && e[a].value !== void 0) {
        l.formula !== void 0 ? (l.value = 0) : ((l.value = e[a].value), (l.type = this.getCellValueType(l.value)));
      }
      e[a].style !== null && e[a].style !== void 0 && l.styleIndex === void 0
        ? ((l.cellStyle = new ke()),
          l.value instanceof Date
            ? this.parserCellStyle(e[a].style, l.cellStyle, l.type, 14)
            : this.parserCellStyle(e[a].style, l.cellStyle, l.type),
          (l.styleIndex = l.cellStyle.index))
        : l.value instanceof Date &&
          ((l.cellStyle = new ke()),
          this.parserCellStyle({}, l.cellStyle, l.type, 14),
          (l.styleIndex = l.cellStyle.index));
      this.parseCellType(l);
      this.mergeCells = this.processMergeCells(l, t.index, this.mergeCells);
      t.cells.add(l);
      l.index + 1;
    }
    t.spans = r + ':' + n;
  };
  s.prototype.GetColors = function () {
    var e;
    e = new Map();
    e.set('WHITE', 'FFFFFFFF');
    e.set('SILVER', 'FFC0C0C0');
    e.set('GRAY', 'FF808080');
    e.set('BLACK', 'FF000000');
    e.set('RED', 'FFFF0000');
    e.set('MAROON', 'FF800000');
    e.set('YELLOW', 'FFFFFF00');
    e.set('OLIVE', 'FF808000');
    e.set('LIME', 'FF00FF00');
    e.set('GREEN', 'FF008000');
    e.set('AQUA', 'FF00FFFF');
    e.set('TEAL', 'FF008080');
    e.set('BLUE', 'FF0000FF');
    e.set('NAVY', 'FF000080');
    e.set('FUCHSIA', 'FFFF00FF');
    e.set('PURPLE', 'FF800080');
    return e;
  };
  s.prototype.processColor = function (e) {
    return e.indexOf('#') === 0
      ? e.replace('#', 'FF')
      : ((e = e.toUpperCase()),
        (this.rgbColors = this.GetColors()),
        this.rgbColors.has(e) ? (e = this.rgbColors.get(e)) : (e = 'FF000000'),
        e);
  };
  s.prototype.processCellValue = function (e, t) {
    var i = e;
    if (
      e.indexOf('<font') !== -1 ||
      e.indexOf('<a') !== -1 ||
      e.indexOf('<b>') !== -1 ||
      e.indexOf('<i>') !== -1 ||
      e.indexOf('<u>') !== -1
    ) {
      var r = '';
      var n = e.indexOf('<', 0);
      var a = e.indexOf('>', n + 1);
      if (n >= 0 && a >= 0) {
        for (
          n !== 0 && (r += '<r><t xml:space="preserve">' + this.processString(e.substring(0, n)) + '</t></r>');
          n >= 0 && a >= 0;

        ) {
          a = e.indexOf('>', n + 1);
          if (a >= 0) {
            var o = e.substring(n + 1, a);
            n = e.indexOf('<', a + 1);
            if (n < 0) {
              n = e.length;
            }
            var l = e.substring(a + 1, n);
            if (l.length !== 0) {
              var h = o.split(' ');
              if (h.length > 0) {
                r += '<r><rPr>';
              }
              if (h.length > 1)
                for (var d = 0, p = h; d < p.length; d++) {
                  var c = p[d];
                  var f = p[d].trim().substring(0, 5);
                  switch (f) {
                    case 'size=':
                      r += '<sz val="' + p[d].substring(6, p[d].length - 1) + '"/>';
                      break;
                    case 'face=':
                      r += '<rFont val="' + p[d].substring(6, p[d].length - 1) + '"/>';
                      break;
                    case 'color':
                      r += '<color rgb="' + this.processColor(p[d].substring(7, p[d].length - 1)) + '"/>';
                      break;
                    case 'href=':
                      var g = new Kr();
                      {
                        g.target = p[d].substring(6, p[d].length - 1).trim();
                        g.ref = t.refName;
                        g.rId = this.mHyperLinks.length + 1;
                        this.mHyperLinks.push(g);
                        r += '<color rgb="FF0000FF"/><u/><b/>';
                      }
                      break;
                  }
                }
              else if (h.length === 1) {
                var m = h[0].trim();
                switch (m) {
                  case 'b':
                    r += '<b/>';
                    break;
                  case 'i':
                    r += '<i/>';
                    break;
                  case 'u':
                    r += '<u/>';
                    break;
                }
              }
              r += '</rPr><t xml:space="preserve">' + this.processString(l) + '</t></r>';
            }
          }
        }
        return r === '' ? e : r;
      } else return e;
    } else return e;
  };
  s.prototype.applyGlobalStyle = function (e, t) {
    if (this.cellStyles.has(e.name)) {
      t.index = this.mStyles.filter(function (i) {
        return i.name === e.name;
      })[0].index;
      t.name = e.name;
    }
  };
  s.prototype.parserCellStyle = function (e, t, i, r) {
    if (e.name !== null && e.name !== void 0)
      if (t.isGlobalStyle) t.name = e.name;
      else {
        this.applyGlobalStyle(e, t);
        return;
      }
    if (e.backColor !== null && e.backColor !== void 0) {
      t.backColor = e.backColor;
    }
    t.borders = new _n();
    if (e.borders !== null && e.borders !== void 0) {
      this.parserBorder(e.borders, t.borders.all);
    }
    if (e.leftBorder !== null && e.leftBorder !== void 0) {
      this.parserBorder(e.leftBorder, t.borders.left);
    }
    if (e.rightBorder !== null && e.rightBorder !== void 0) {
      this.parserBorder(e.rightBorder, t.borders.right);
    }
    if (e.topBorder !== null && e.topBorder !== void 0) {
      this.parserBorder(e.topBorder, t.borders.top);
    }
    if (e.bottomBorder !== null && e.bottomBorder !== void 0) {
      this.parserBorder(e.bottomBorder, t.borders.bottom);
    }
    if (e.fontName !== null && e.fontName !== void 0) {
      t.fontName = e.fontName;
    }
    if (e.fontSize !== null && e.fontSize !== void 0) {
      t.fontSize = e.fontSize;
    }
    if (e.fontColor !== null && e.fontColor !== void 0) {
      t.fontColor = e.fontColor;
    }
    if (e.italic !== null && e.italic !== void 0) {
      t.italic = e.italic;
    }
    if (e.bold !== null && e.bold !== void 0) {
      t.bold = e.bold;
    }
    if (e.hAlign !== null && e.hAlign !== void 0) {
      t.hAlign = e.hAlign.toLowerCase();
    }
    if (e.indent !== null && e.indent !== void 0) {
      t.indent = e.indent;
      if (!(t.hAlign === 'left' || t.hAlign === 'right')) {
        t.hAlign = 'left';
      }
    }
    if (e.rotation !== null && e.rotation !== void 0) {
      t.rotation = e.rotation;
    }
    if (e.vAlign !== null && e.vAlign !== void 0) {
      t.vAlign = e.vAlign.toLowerCase();
    }
    if (e.underline !== null && e.underline !== void 0) {
      t.underline = e.underline;
    }
    if (e.strikeThrough !== null && e.strikeThrough !== void 0) {
      t.strikeThrough = e.strikeThrough;
    }
    if (e.wrapText !== null && e.wrapText !== void 0) {
      t.wrapText = e.wrapText;
    }
    e.numberFormat !== null && e.numberFormat !== void 0
      ? e.type !== null && e.type !== void 0
        ? (t.numberFormat = this.getNumberFormat(e.numberFormat, e.type))
        : (t.numberFormat = this.getNumberFormat(e.numberFormat, i))
      : (r !== void 0 && (t.numFmtId = 14), (t.numberFormat = 'GENERAL'));
    t.index = this.processCellStyle(t);
  };
  s.prototype.switchNumberFormat = function (e, t) {
    var i = this.getNumberFormat(e, t);
    if (i !== e) {
      var r = this.mNumFmt.get(e);
      if (r !== void 0 && ((r.formatCode = i), this.mNumFmt.has(i))) {
        for (var n = 0, a = this.mCellStyleXfs; n < a.length; n++) {
          var o = a[n];
          if (o.numFmtId === r.numFmtId) {
            o.numFmtId = this.mNumFmt.get(i).numFmtId;
          }
        }
        for (var l = 0, h = this.mCellXfs; l < h.length; l++) {
          var d = h[l];
          if (d.numFmtId === r.numFmtId) {
            d.numFmtId = this.mNumFmt.get(i).numFmtId;
          }
        }
      }
    }
  };
  s.prototype.changeNumberFormats = function (e) {
    if (typeof e == 'string') {
      var t = new RegExp(this.currency, 'g');
      e = e.replace(t, '[$' + this.currency + ']');
    } else if (typeof e == 'object')
      for (var i = 0; i < e.length; i++) e[i] = e[i].replace(this.currency, '[$' + this.currency + ']');
    return e;
  };
  s.prototype.getNumberFormat = function (e, t) {
    var i;
    switch (t) {
      case 'number':
        try {
          i = this.intl.getNumberPattern(
            {
              format: e,
              currency: this.currency,
              useGrouping: true,
            },
            true,
          );
          if (this.currency.length > 1) {
            i = this.changeNumberFormats(i);
          }
        } catch {
          i = e;
        }
        break;
      case 'datetime':
        try {
          i = this.intl.getDatePattern(
            {
              skeleton: e,
              type: 'dateTime',
            },
            true,
          );
        } catch {
          try {
            i = this.intl.getDatePattern(
              {
                format: e,
                type: 'dateTime',
              },
              true,
            );
          } catch {
            i = e;
          }
        }
        break;
      case 'date':
        try {
          i = this.intl.getDatePattern(
            {
              skeleton: e,
              type: 'date',
            },
            true,
          );
        } catch {
          try {
            i = this.intl.getDatePattern(
              {
                format: e,
                type: 'date',
              },
              true,
            );
          } catch {
            i = e;
          }
        }
        break;
      case 'time':
        try {
          i = this.intl.getDatePattern(
            {
              skeleton: e,
              type: 'time',
            },
            true,
          );
        } catch {
          try {
            i = this.intl.getDatePattern(
              {
                format: e,
                type: 'time',
              },
              true,
            );
          } catch {
            i = e;
          }
        }
        break;
      default:
        i = e;
        break;
    }
    return i;
  };
  s.prototype.parserBorder = function (e, t) {
    e.color !== null && e.color !== void 0 ? (t.color = e.color) : (t.color = '#000000');
    e.lineStyle !== null && e.lineStyle !== void 0 ? (t.lineStyle = e.lineStyle) : (t.lineStyle = 'thin');
  };
  s.prototype.processCellStyle = function (e) {
    if (e.isGlobalStyle) {
      this.processNumFormatId(e);
      this.mStyles.push(e);
      return this.mStyles.length;
    }
    var t = this.compareStyle(e);
    return t.result ? t.index : (this.processNumFormatId(e), this.mStyles.push(e), this.mStyles.length);
  };
  s.prototype.processNumFormatId = function (e) {
    if (e.numberFormat !== 'GENERAL' && !this.mNumFmt.has(e.numberFormat)) {
      var t = this.mNumFmt.size + 164;
      this.mNumFmt.set(e.numberFormat, new jr(t, e.numberFormat));
    }
  };
  s.prototype.isNewFont = function (e) {
    for (var t = false, i = 0, r = 0, n = this.mFonts; r < n.length; r++) {
      var a = n[r];
      i++;
      var o = void 0;
      if (e.fontColor !== void 0) {
        o = 'FF' + e.fontColor.replace('#', '');
      }
      t =
        n[r].color === o &&
        n[r].b === e.bold &&
        n[r].i === e.italic &&
        n[r].u === e.underline &&
        n[r].strike === e.strikeThrough &&
        n[r].name === e.fontName &&
        n[r].sz === e.fontSize;
      if (t) break;
    }
    i = i - 1;
    return {
      index: i,
      result: t,
    };
  };
  s.prototype.isNewBorder = function (e) {
    var t = new ke();
    return this.isAllBorder(e.borders)
      ? t.borders.all.color === e.borders.all.color && t.borders.all.lineStyle === e.borders.all.lineStyle
      : t.borders.left.color === e.borders.left.color &&
          t.borders.left.lineStyle === e.borders.left.lineStyle &&
          t.borders.right.color === e.borders.right.color &&
          t.borders.right.lineStyle === e.borders.right.lineStyle &&
          t.borders.top.color === e.borders.top.color &&
          t.borders.top.lineStyle === e.borders.top.lineStyle &&
          t.borders.bottom.color === e.borders.bottom.color &&
          t.borders.bottom.lineStyle === e.borders.bottom.lineStyle;
  };
  s.prototype.isAllBorder = function (e) {
    var t = new ke();
    return t.borders.all.color !== e.all.color && t.borders.all.lineStyle !== e.all.lineStyle;
  };
  s.prototype.compareStyle = function (e) {
    for (var t = true, i = 0, r = 0, n = this.mStyles; r < n.length; r++) {
      var a = n[r];
      t = n[r].isGlobalStyle
        ? false
        : n[r].backColor === e.backColor &&
          n[r].bold === e.bold &&
          n[r].numFmtId === e.numFmtId &&
          n[r].numberFormat === e.numberFormat &&
          n[r].type === e.type &&
          n[r].fontColor === e.fontColor &&
          n[r].fontName === e.fontName &&
          n[r].fontSize === e.fontSize &&
          n[r].hAlign === e.hAlign &&
          n[r].italic === e.italic &&
          n[r].underline === e.underline &&
          n[r].strikeThrough === e.strikeThrough &&
          n[r].vAlign === e.vAlign &&
          n[r].indent === e.indent &&
          n[r].rotation === e.rotation &&
          n[r].wrapText === e.wrapText &&
          n[r].borders.all.color === e.borders.all.color &&
          n[r].borders.all.lineStyle === e.borders.all.lineStyle &&
          n[r].borders.left.color === e.borders.left.color &&
          n[r].borders.left.lineStyle === e.borders.left.lineStyle &&
          n[r].borders.right.color === e.borders.right.color &&
          n[r].borders.right.lineStyle === e.borders.right.lineStyle &&
          n[r].borders.top.color === e.borders.top.color &&
          n[r].borders.top.lineStyle === e.borders.top.lineStyle &&
          n[r].borders.bottom.color === e.borders.bottom.color &&
          n[r].borders.bottom.lineStyle === e.borders.bottom.lineStyle;
      if (t) {
        i = n[r].index;
        break;
      }
    }
    return {
      index: i,
      result: t,
    };
  };
  s.prototype.contains = function (e, t) {
    var i = e.indexOf(t);
    return i > -1 && i < e.length;
  };
  s.prototype.getCellValueType = function (e) {
    return e instanceof Date
      ? 'datetime'
      : typeof e == 'boolean'
        ? 'boolean'
        : typeof e == 'number'
          ? 'number'
          : 'string';
  };
  s.prototype.parseCellType = function (e) {
    var t = e.type;
    var i;
    var r = e.value;
    switch (e.type) {
      case 'datetime':
        {
          r = this.toOADate(r);
          if (e.cellStyle !== void 0 && e.cellStyle.name !== void 0 && this.globalStyles.has(e.cellStyle.name)) {
            var n = this.globalStyles.get(e.cellStyle.name);
            this.switchNumberFormat(n.format, n.type);
          }
        }
        i = 'n';
        break;
      case 'boolean':
        {
          r = r ? 1 : 0;
          i = 'b';
        }
        break;
      case 'number':
        {
          i = 'n';
          if (e.cellStyle !== void 0 && e.cellStyle.name !== void 0 && this.globalStyles.has(e.cellStyle.name)) {
            this.switchNumberFormat(this.globalStyles.get(e.cellStyle.name).format, 'number');
          }
        }
        break;
      case 'string':
        {
          this.sharedStringCount++;
          i = 's';
        }
        var a = this.processCellValue(r, e);
        {
          if (!this.contains(this.sharedString, a)) {
            this.sharedString.push(a);
          }
          r = this.sharedString.indexOf(a);
        }
        break;
    }
    e.saveType = i;
    e.value = r;
  };
  s.prototype.parserImages = function (e, t) {
    var i = e.length;
    t.images = [];
    for (var r = 0; r < e.length; r++) {
      var n = this.parserImage(e[r]);
      t.images.push(n);
    }
  };
  s.prototype.parseFilters = function (e, t) {
    t.autoFilters = new Ll();
    if (e.row !== null && e.row !== void 0) t.autoFilters.row = e.row;
    else throw new Error('Argument Null Exception: row null or empty');
    if (e.lastRow !== null && e.lastRow !== void 0) t.autoFilters.lastRow = e.lastRow;
    else throw new Error('Argument Null Exception: lastRow cannot be null or empty');
    if (e.column !== null && e.column !== void 0) t.autoFilters.column = e.column;
    else throw new Error('Argument Null Exception: column cannot be null or empty');
    if (e.lastColumn !== null && e.row !== void 0) t.autoFilters.lastColumn = e.lastColumn;
    else throw new Error('Argument Null Exception: lastColumn cannot be null or empty');
  };
  s.prototype.parserImage = function (e) {
    var t = new Il();
    if (e.image !== null && e.image !== void 0) {
      t.image = e.image;
    }
    if (e.row !== null && e.row !== void 0) {
      t.row = e.row;
    }
    if (e.column !== null && e.column !== void 0) {
      t.column = e.column;
    }
    if (e.lastRow !== null && e.lastRow !== void 0) {
      t.lastRow = e.lastRow;
    }
    if (e.lastColumn !== null && e.lastColumn !== void 0) {
      t.lastColumn = e.lastColumn;
    }
    if (e.width !== null && e.width !== void 0) {
      t.width = e.width;
    }
    if (e.height !== null && e.height !== void 0) {
      t.height = e.height;
    }
    if (e.horizontalFlip !== null && e.horizontalFlip !== void 0) {
      t.horizontalFlip = e.horizontalFlip;
    }
    if (e.verticalFlip !== null && e.verticalFlip !== void 0) {
      t.verticalFlip = e.verticalFlip;
    }
    if (e.rotation !== null && e.rotation !== void 0) {
      t.rotation = e.rotation;
    }
    return t;
  };
  s.prototype.saveAsBlob = function (e, t) {
    var i = this;
    switch (e) {
      case 'text/csv':
        return new Promise(function (r, n) {
          var a = {};
          a.blobData = i.csvHelper.saveAsBlob(t);
          r(a);
        });
      default:
        return new Promise(function (r, n) {
          i.saveInternal();
          i.mArchive.saveAsBlob().then(function (a) {
            var o = {};
            o.blobData = new Blob([a], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
            r(o);
          });
        });
    }
  };
  s.prototype.save = function (e, t) {
    var i = this;
    if (e == null || e === '') throw new Error('Argument Null Exception: fileName cannot be null or empty');
    var r = e.match('.xlsx$');
    var n = e.match('.csv$');
    if (r !== null && r[0] === '.' + this.mSaveType) {
      this.saveInternal();
      this.mArchive.save(e).then(function () {
        i.mArchive.destroy();
      });
    } else if (n !== null && n[0] === '.' + this.mSaveType) this.csvHelper.save(e);
    else throw Error('Save type and file extension is different.');
  };
  s.prototype.saveInternal = function () {
    this.saveWorkbook();
    this.saveWorksheets();
    this.saveSharedString();
    this.saveStyles();
    this.saveApp(this.builtInProperties);
    this.saveCore(this.builtInProperties);
    this.saveContentType();
    this.saveTopLevelRelation();
    this.saveWorkbookRelation();
  };
  s.prototype.saveWorkbook = function () {
    for (
      var e =
          '<?xml version="1.0" encoding="utf-8"?><workbook xmlns:r = "http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns= "http://schemas.openxmlformats.org/spreadsheetml/2006/main"><workbookPr codeName="ThisWorkbook" defaultThemeVersion= "153222"/><bookViews><workbookView activeTab="0"/></bookViews>',
        t = '<sheets>',
        i = this.worksheets.length,
        r = 0;
      r < i;
      r++
    ) {
      var n = this.worksheets[r].name;
      n = n.replace('&', '&amp;');
      n = n.replace('<', '&lt;');
      n = n.replace('>', '&gt;');
      n = n.replace('"', '&quot;');
      t += '<sheet name="' + n + '" sheetId="' + (r + 1).toString() + '" r:id ="rId' + (r + 1).toString() + '" />';
    }
    t += '</sheets>';
    e += t;
    if (this.printTitles.size > 0) {
      var a = '<definedNames>';
      this.printTitles.forEach(function (o, l) {
        a += '<definedName name="_xlnm.Print_Titles" localSheetId="' + l + '">' + o + '</definedName>';
      });
      a += '</definedNames>';
      e += a;
    }
    this.addToArchive(e + '</workbook>', 'xl/workbook.xml');
  };
  s.prototype.saveWorksheets = function () {
    for (var e = this.worksheets.length, t = 0; t < e; t++) this.saveWorksheet(this.worksheets[t], t);
  };
  s.prototype.saveWorksheet = function (e, t) {
    var i = new Jr();
    var r =
      '<?xml version="1.0" encoding="utf-8" standalone="yes"?><worksheet xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';
    e.isSummaryRowBelow ? (r += '<sheetPr />') : (r += '<sheetPr><outlinePr summaryBelow="0" ></outlinePr></sheetPr>');
    r += this.saveSheetView(e);
    if (e.columns !== void 0) {
      for (var n = '<cols>', a = 0, o = e.columns; a < o.length; a++) {
        var l = o[a];
        o[a].width !== void 0
          ? (n +=
              '<col min="' +
              o[a].index +
              '" max="' +
              o[a].index +
              '" width="' +
              this.pixelsToColumnWidth(o[a].width) +
              '" customWidth="1" />')
          : (n += '<col min="' + o[a].index + '" max="' + o[a].index + '" width="8.43" customWidth="1" />');
      }
      r += n + '</cols>';
    }
    r += '<sheetData>';
    i.append(r);
    r = '';
    if (e.rows !== void 0)
      for (var h = 0, d = e.rows; h < d.length; h++) {
        var p = d[h];
        var c = '<row r="' + d[h].index + '" ';
        if (!u(d[h].spans)) {
          c += 'spans="' + d[h].spans + '" ';
        }
        if (d[h].height !== void 0) {
          c += 'ht="' + this.pixelsToRowHeight(d[h].height) + '" customHeight="1" ';
        }
        if (d[h].grouping !== void 0) {
          if (d[h].grouping.isHidden) {
            c += 'hidden="1" ';
          }
          if (d[h].grouping.outlineLevel !== void 0) {
            c += 'outlineLevel="' + d[h].grouping.outlineLevel + '" ';
          }
          if (d[h].grouping.isCollapsed) {
            c += 'collapsed="1" ';
          }
        }
        c += '>';
        for (var f = 0, g = d[h].cells; f < g.length; f++) {
          var m = g[f];
          if (g[f] !== void 0 && (g[f].value !== void 0 || g[f].cellStyle !== void 0)) {
            c += '<c r="' + g[f].refName + '" ';
            if (g[f].saveType !== void 0) {
              c += 't="' + g[f].saveType + '" ';
            }
            if (g[f].styleIndex !== void 0) {
              c += 's="' + g[f].styleIndex + '" ';
            }
            c += ' >';
            if (g[f].formula !== void 0) {
              c += '<f>' + g[f].formula + '</f>';
            }
            g[f].value !== void 0 ? (c += '<v>' + g[f].value + '</v></c>') : (c += '</c>');
          }
        }
        c += '</row>';
        i.append(c);
      }
    r += '</sheetData>';
    if (e.autoFilters !== null && e.autoFilters !== void 0) {
      r +=
        '<autoFilter ref="' +
        this.getCellName(e.autoFilters.row, e.autoFilters.column) +
        ':' +
        this.getCellName(e.autoFilters.lastRow, e.autoFilters.lastColumn) +
        '"/>';
    }
    if (e.mergeCells.length > 0) {
      r += '<mergeCells count="' + e.mergeCells.length + '">';
      for (var y = 0, v = e.mergeCells; y < v.length; y++) {
        var b = v[y];
        r += '<mergeCell ref="' + v[y].ref + '" />';
      }
      r += '</mergeCells>';
    }
    if (e.hyperLinks.length > 0) {
      r += '<hyperlinks>';
      for (var w = 0, C = e.hyperLinks; w < C.length; w++) {
        var I = C[w];
        r += '<hyperlink ref="' + C[w].ref + '" r:id="rId' + C[w].rId + '" />';
      }
      r += '</hyperlinks>';
    }
    r +=
      '<pageMargins left="0.75" right="0.75" top="1" bottom="1" header="0.5" footer="0.5" /><headerFooter scaleWithDoc="1" alignWithMargins="0" differentFirst="0" differentOddEven="0" />';
    if (e.images != null && e.images.length > 0) {
      this.drawingCount++;
      this.saveDrawings(e, e.index);
      r += '<drawing r:id="rId' + (e.hyperLinks.length + 1) + '"/>';
    }
    this.addToArchive(this.saveSheetRelations(e), 'xl/worksheets/_rels/sheet' + e.index + '.xml.rels');
    i.append(r + '</worksheet>');
    this.addToArchive(i.getBlob(), 'xl/worksheets/sheet' + (t + 1) + '.xml');
  };
  s.prototype.saveDrawings = function (e, t) {
    var i = new Jr();
    var r =
      '<xdr:wsDr xmlns:xdr="http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main">';
    if (e.images !== void 0) {
      for (var n = 0, a = 0, o = e.images; a < o.length; a++) {
        var l = o[a];
        l.height !== void 0 && l.width !== void 0
          ? (this.updatelastRowOffset(e, l), this.updatelastColumnOffSet(e, l), (l.lastRow -= 1), (l.lastColumn -= 1))
          : l.lastRow !== void 0 && l.lastColumn !== void 0 && ((l.lastRowOffset = 0), (l.lastColOffset = 0));
        n++;
        r += '<xdr:twoCellAnchor editAs="oneCell">';
        r += '<xdr:from><xdr:col>';
        r += l.column - 1;
        r += '</xdr:col><xdr:colOff>';
        r += 0;
        r += '</xdr:colOff><xdr:row>';
        r += l.row - 1;
        r += '</xdr:row><xdr:rowOff>';
        r += 0;
        r += '</xdr:rowOff></xdr:from>';
        r += '<xdr:to><xdr:col>';
        r += l.lastColumn;
        r += '</xdr:col><xdr:colOff>';
        r += l.lastColOffset;
        r += '</xdr:colOff><xdr:row>';
        r += l.lastRow;
        r += '</xdr:row><xdr:rowOff>';
        r += l.lastRowOffset;
        r += '</xdr:rowOff></xdr:to>';
        r += '<xdr:pic>';
        r += '<xdr:nvPicPr>';
        r += '<xdr:cNvPr id="' + n + '" name="Picture ' + n + '"> </xdr:cNvPr>';
        r += '<xdr:cNvPicPr><a:picLocks noChangeAspect="1"/></xdr:cNvPicPr> </xdr:nvPicPr>';
        r += '<xdr:blipFill>';
        r +=
          '<a:blip xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" r:embed="rId' +
          n +
          '" cstate="print">';
        r += '</a:blip><a:stretch><a:fillRect /></a:stretch></xdr:blipFill>';
        r += '<xdr:spPr>';
        r += '<a:xfrm';
        if (l.rotation != null && l.rotation <= 3600 && l.rotation >= -3600) {
          r += ' rot="' + l.rotation * 60000 + '"';
        }
        if (l.verticalFlip != null && l.verticalFlip != false) {
          r += ' flipV="1"';
        }
        if (l.horizontalFlip != null && l.horizontalFlip != false) {
          r += ' flipH="1"';
        }
        r += '/>';
        r += '<a:prstGeom prst="rect"><a:avLst /></a:prstGeom></xdr:spPr>';
        r += '</xdr:pic><xdr:clientData /></xdr:twoCellAnchor>';
        var h = this.convertBase64toImage(l.image);
        this.imageCount += 1;
        this.addToArchive(h, 'xl/media/image' + this.imageCount + '.png');
      }
      i.append(r);
      i.append('</xdr:wsDr>');
      this.saveDrawingRelations(e);
      this.addToArchive(i.getBlob(), 'xl/drawings/drawing' + this.drawingCount + '.xml');
    }
  };
  s.prototype.updatelastRowOffset = function (e, t) {
    for (var i = t.height, r = t.row, n = 0; i >= 0; ) {
      var a = 0;
      e.rows !== void 0 && e.rows[r - 1] !== void 0
        ? (a = this.convertToPixels(e.rows[r - 1].height === void 0 ? 15 : e.rows[r - 1].height))
        : (a = this.convertToPixels(15));
      var o = a - (n * a) / 256;
      if (o > i) {
        t.lastRow = r;
        t.lastRowOffset = n + (i * 256) / a;
        var l = 0;
        e.rows !== void 0 && e.rows[r - 1] !== void 0
          ? (l = this.convertToPixels(e.rows[r - 1].height === void 0 ? 15 : e.rows[r - 1].height))
          : (l = this.convertToPixels(15));
        t.lastRowOffset = (l * t.lastRowOffset) / 256;
        t.lastRowOffset = Math.round(t.lastRowOffset / this.unitsProportions[7]);
        break;
      } else {
        i -= o;
        r++;
        n = 0;
      }
    }
  };
  s.prototype.updatelastColumnOffSet = function (e, t) {
    for (var i = t.width, r = t.column, n = 0; i >= 0; ) {
      var a = 0;
      e.columns !== void 0 && e.columns[r - 1] !== void 0
        ? (a = this.ColumnWidthToPixels(e.columns[r - 1].width === void 0 ? 8.43 : e.columns[r - 1].width))
        : (a = this.ColumnWidthToPixels(8.43));
      var o = a - (n * a) / 1024;
      if (o > i) {
        t.lastColumn = r;
        t.lastColOffset = n + (i * 1024) / a;
        var l = 0;
        e.columns !== void 0 && e.columns[r - 1] !== void 0
          ? (l = this.ColumnWidthToPixels(e.columns[r - 1].width === void 0 ? 8.43 : e.columns[r - 1].width))
          : (l = this.ColumnWidthToPixels(8.43));
        t.lastColOffset = (l * t.lastColOffset) / 1024;
        t.lastColOffset = Math.round(t.lastColOffset / this.unitsProportions[7]);
        break;
      } else {
        i -= o;
        r++;
        n = 0;
      }
    }
  };
  s.prototype.convertToPixels = function (e) {
    return e * this.unitsProportions[6];
  };
  s.prototype.convertBase64toImage = function (e) {
    for (var t = window.atob(e), i = new ArrayBuffer(t.length), r = new Uint8Array(i), n = 0; n < t.length; n++)
      r[n] = t.charCodeAt(n);
    var a = new Blob([r], { type: 'image/png' });
    return a;
  };
  s.prototype.saveDrawingRelations = function (e) {
    for (
      var t =
          '<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',
        i = e.images.length,
        r = this.imageCount - e.images.length,
        n = 1;
      n <= i;
      n++
    ) {
      r++;
      t +=
        '<Relationship Id="rId' +
        n +
        '" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="../media/image' +
        r +
        '.png" />';
    }
    this.addToArchive(t + '</Relationships>', 'xl/drawings/_rels/drawing' + this.drawingCount + '.xml.rels');
  };
  s.prototype.pixelsToColumnWidth = function (e) {
    var t = 7;
    var i = e > 12 ? this.trunc(((e - 5) / 7) * 100 + 0.5) / 100 : e / 12;
    return i > 1 ? (((i * 7 + 5) / 7) * 256) / 256 : (((i * 12) / 7) * 256) / 256;
  };
  s.prototype.ColumnWidthToPixels = function (e) {
    var t = 7;
    var i = e > 1 ? (((e * 7 + 5) / 7) * 256) / 256 : (((e * 12) / 7) * 256) / 256;
    return this.trunc(((256 * i + this.trunc(18.285714285714285)) / 256) * 7);
  };
  s.prototype.trunc = function (e) {
    var t = e - (e % 1);
    return t === 0 && (e < 0 || (e === 0 && 1 / e !== Infinity)) ? -0 : t;
  };
  s.prototype.pixelsToRowHeight = function (e) {
    return (e * this.unitsProportions[5]) / this.unitsProportions[6];
  };
  s.prototype.saveSheetRelations = function (e) {
    for (
      var t =
          '<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',
        i = 0,
        r = e.hyperLinks;
      i < r.length;
      i++
    ) {
      var n = r[i];
      t +=
        '<Relationship Id="rId' +
        r[i].rId +
        '" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink" Target="' +
        this.processString(r[i].target) +
        '" TargetMode="External" />';
    }
    if (e.images != null && e.images.length > 0) {
      t +=
        '<Relationship Id="rId' +
        (e.hyperLinks.length + 1) +
        '" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing" Target="../drawings/drawing' +
        this.drawingCount +
        '.xml" />';
    }
    t += '</Relationships>';
    return t;
  };
  s.prototype.saveSheetView = function (e) {
    var t = '<sheetViews><sheetView workbookViewId="0" ';
    if (e.enableRtl === true) {
      t += 'rightToLeft="1"';
    }
    e.showGridLines === false ? (t += 'showGridLines="0" >') : (t += '>');
    if (e.freezePanes !== void 0) {
      t += '<pane state="frozen" topLeftCell="' + e.freezePanes.leftCell + '" ';
      if (e.freezePanes.row !== 0) {
        t += 'ySplit="' + e.freezePanes.row + '" ';
      }
      if (e.freezePanes.column !== 0) {
        t += 'xSplit="' + e.freezePanes.column + '" ';
      }
      t += '/>';
    }
    t += '</sheetView></sheetViews > ';
    return t;
  };
  s.prototype.saveSharedString = function () {
    var e = this.sharedString.length;
    if (this.sharedString.length > 0) {
      for (
        var t =
            '<?xml version="1.0" encoding="utf-8"?><sst uniqueCount="' +
            this.sharedString.length +
            '" count="' +
            this.sharedStringCount +
            '" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">',
          i = '',
          r = 0;
        r < this.sharedString.length;
        r++
      )
        this.sharedString[r].indexOf('<r>') !== 0
          ? ((i += '<si><t>'), (i += this.processString(this.sharedString[r])), (i += '</t></si>'))
          : ((i += '<si>'), (i += this.sharedString[r]), (i += '</si>'));
      i += '</sst>';
      this.addToArchive(t + i, 'xl/sharedStrings.xml');
    }
  };
  s.prototype.processString = function (e) {
    if (typeof e == 'string') {
      if (e.indexOf('&') !== -1) {
        e = e.replace(/&/g, '&amp;');
      }
      if (e.indexOf('<') !== -1) {
        e = e.replace(/</g, '&lt;');
      }
      if (e.indexOf('>') !== -1) {
        e = e.replace(/>/g, '&gt;');
      }
      if (e.indexOf('\x0B') !== -1) {
        e = e.replace(/\v/g, '_x000B_');
      }
    } else if (typeof e == 'object')
      for (var t = 0; t < e.length; t++) {
        if (e[t].indexOf('&') !== -1) {
          e[t] = e[t].replace(/&/g, '&amp;');
        }
        if (e[t].indexOf('<') !== -1) {
          e[t] = e[t].replace(/</g, '&lt;');
        }
        if (e[t].indexOf('>') !== -1) {
          e[t] = e[t].replace(/>/g, '&gt;');
        }
        if (e[t].indexOf('\x0B') !== -1) {
          e[t] = e[t].replace(/\v/g, '_x000B_');
        }
      }
    return e;
  };
  s.prototype.saveStyles = function () {
    this.updateCellXfsStyleXfs();
    var e =
      '<?xml version="1.0" encoding="utf-8"?><styleSheet xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';
    e += this.saveNumberFormats();
    e += this.saveFonts();
    e += this.saveFills();
    e += this.saveBorders();
    e += this.saveCellStyleXfs();
    e += this.saveCellXfs();
    e += this.saveCellStyles();
    this.addToArchive(e + '</styleSheet>', 'xl/styles.xml');
  };
  s.prototype.updateCellXfsStyleXfs = function () {
    for (var e = 0, t = this.mStyles; e < t.length; e++) {
      var i = t[e];
      var r = void 0;
      t[e].isGlobalStyle ? ((r = new pl()), (r.xfId = t[e].index - 1)) : ((r = new hl()), (r.xfId = 0));
      var n = this.isNewFont(t[e]);
      if (n.result) r.fontId = n.index;
      else {
        var a = new Vr();
        a.b = t[e].bold;
        a.i = t[e].italic;
        a.name = t[e].fontName;
        a.sz = t[e].fontSize;
        a.u = t[e].underline;
        a.strike = t[e].strikeThrough;
        a.color = 'FF' + t[e].fontColor.replace('#', '');
        this.mFonts.push(a);
        r.fontId = this.mFonts.length - 1;
      }
      if (t[e].backColor !== 'none') {
        var o = 'FF' + t[e].backColor.replace('#', '');
        if (this.mFills.has(o)) {
          var l = this.mFills.get(o);
          r.fillId = l;
        } else {
          var l = this.mFills.size + 2;
          this.mFills.set(o, l);
          r.fillId = l;
        }
      } else r.fillId = 0;
      this.isNewBorder(t[e])
        ? (r.borderId = 0)
        : (this.mBorders.push(t[e].borders), (r.borderId = this.mBorders.length));
      if (t[e].numberFormat !== 'GENERAL')
        if (this.mNumFmt.has(t[e].numberFormat)) {
          var h = this.mNumFmt.get(t[e].numberFormat);
          r.numFmtId = h.numFmtId;
        } else {
          var d = this.mNumFmt.size + 164;
          this.mNumFmt.set(t[e].numberFormat, new jr(d, t[e].numberFormat));
          r.numFmtId = d;
        }
      else t[e].numberFormat === 'GENERAL' && t[e].numFmtId === 14 ? (r.numFmtId = 14) : (r.numFmtId = 0);
      if (!t[e].isGlobalStyle) {
        r.applyAlignment = 1;
      }
      r.alignment = new dl();
      r.alignment.indent = t[e].indent;
      r.alignment.horizontal = t[e].hAlign;
      r.alignment.vertical = t[e].vAlign;
      r.alignment.wrapText = t[e].wrapText ? 1 : 0;
      r.alignment.rotation = t[e].rotation;
      t[e].isGlobalStyle ? (this.mCellStyleXfs.push(r), this.mCellXfs.push(r)) : this.mCellXfs.push(r);
    }
  };
  s.prototype.saveNumberFormats = function () {
    if (this.mNumFmt.size >= 1) {
      var e = '<numFmts count="' + this.mNumFmt.size + '">';
      this.mNumFmt.forEach(function (t, i) {
        e += '<numFmt numFmtId="' + t.numFmtId + '" formatCode="' + t.formatCode.replace(/"/g, '&quot;') + '" />';
      });
      return (e += '</numFmts>');
    } else return '';
  };
  s.prototype.saveFonts = function () {
    var e = '<fonts count="' + this.mFonts.length + '">';
    if (this.mFonts.length >= 1)
      for (var t = 0, i = this.mFonts; t < i.length; t++) {
        var r = i[t];
        e += '<font>';
        if (i[t].b) {
          e += '<b />';
        }
        if (i[t].i) {
          e += '<i />';
        }
        if (i[t].u) {
          e += '<u />';
        }
        if (i[t].strike) {
          e += '<strike />';
        }
        e += '<sz val="' + i[t].sz + '" />';
        e += '<color rgb="' + i[t].color + '" />';
        e += '<name val="' + i[t].name + '" /></font>';
      }
    return e + '</fonts>';
  };
  s.prototype.saveFills = function () {
    var e =
      '<fills count="' +
      (this.mFills.size + 2) +
      '"><fill><patternFill patternType="none"></patternFill></fill><fill><patternFill patternType="gray125"></patternFill></fill>';
    if (this.mFills.size >= 1) {
      this.mFills.forEach(function (t, i) {
        e +=
          '<fill><patternFill patternType="solid"><fgColor rgb="' +
          i +
          '" /><bgColor rgb="FFFFFFFF" /></patternFill></fill>';
      });
    }
    return e + '</fills>';
  };
  s.prototype.saveBorders = function () {
    var e =
      '<borders count="' +
      (this.mBorders.length + 1) +
      '"><border><left /><right /><top /><bottom /><diagonal /></border>';
    if (this.mBorders.length >= 1)
      for (var t = 0, i = this.mBorders; t < i.length; t++) {
        var r = i[t];
        if (this.isAllBorder(i[t])) {
          var n = i[t].all.color.replace('#', '');
          var a = i[t].all.lineStyle;
          e +=
            '<border><left style="' +
            i[t].all.lineStyle +
            '"><color rgb="FF' +
            n +
            '" /></left><right style="' +
            i[t].all.lineStyle +
            '"><color rgb="FF' +
            n +
            '" /></right><top style="' +
            i[t].all.lineStyle +
            '"><color rgb="FF' +
            n +
            '" /></top><bottom style="' +
            i[t].all.lineStyle +
            '"><color rgb="FF' +
            n +
            '" /></bottom></border>';
        } else
          e +=
            '<border><left style="' +
            i[t].left.lineStyle +
            '"><color rgb="FF' +
            i[t].left.color.replace('#', '') +
            '" /></left><right style="' +
            i[t].right.lineStyle +
            '"><color rgb="FF' +
            i[t].right.color.replace('#', '') +
            '" /></right><top style="' +
            i[t].top.lineStyle +
            '"><color rgb="FF' +
            i[t].top.color.replace('#', '') +
            '" /></top><bottom style="' +
            i[t].bottom.lineStyle +
            '"><color rgb="FF' +
            i[t].bottom.color.replace('#', '') +
            '" /></bottom></border>';
      }
    return e + '</borders>';
  };
  s.prototype.saveCellStyles = function () {
    var e = this;
    var t = '<cellStyles  count="' + this.cellStyles.size + '">';
    this.cellStyles.forEach(function (i, r) {
      t += '<cellStyle name="' + r + '" xfId="' + e.cellStyles.get(r).xfId + '"';
      if (r === 'Normal') {
        t += ' builtinId="0"';
      }
      t += ' />';
    });
    return (t += '</cellStyles>');
  };
  s.prototype.saveCellStyleXfs = function () {
    var e =
      '<cellStyleXfs count="' +
      (this.mCellStyleXfs.length + 1) +
      '"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" />';
    if (this.mCellStyleXfs.length >= 1)
      for (var t = 0, i = this.mCellStyleXfs; t < i.length; t++) {
        var r = i[t];
        e +=
          '<xf numFmtId="' +
          i[t].numFmtId +
          '" fontId="' +
          i[t].fontId +
          '" fillId="' +
          i[t].fillId +
          '" borderId="' +
          i[t].borderId +
          '" ';
        i[t].alignment !== void 0 ? (e += '>' + this.saveAlignment(i[t]) + '</xf>') : (e += ' />');
      }
    return e + '</cellStyleXfs>';
  };
  s.prototype.saveCellXfs = function () {
    var e =
      '<cellXfs count="' +
      (this.mCellXfs.length + 1) +
      '"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0" />';
    if (this.mCellXfs.length >= 1)
      for (var t = 0, i = this.mCellXfs; t < i.length; t++) {
        var r = i[t];
        e +=
          '<xf numFmtId="' +
          i[t].numFmtId +
          '" fontId="' +
          i[t].fontId +
          '" fillId="' +
          i[t].fillId +
          '" borderId="' +
          i[t].borderId +
          '" xfId="' +
          i[t].xfId +
          '" ';
        if (i[t].applyAlignment === 1) {
          e += 'applyAlignment="1"';
        }
        e += '>' + this.saveAlignment(i[t]) + '</xf>';
      }
    return e + '</cellXfs>';
  };
  s.prototype.saveAlignment = function (e) {
    var t = '<alignment ';
    if (e.alignment.horizontal !== void 0) {
      t += 'horizontal="' + e.alignment.horizontal + '" ';
    }
    e.alignment.indent !== void 0 && e.alignment.indent !== 0
      ? (t += 'indent="' + e.alignment.indent + '" ')
      : e.alignment.rotation !== void 0 &&
        e.alignment.rotation !== 0 &&
        (t += 'textRotation="' + e.alignment.rotation + '" ');
    if (e.alignment.vertical !== void 0) {
      t += 'vertical="' + e.alignment.vertical + '" ';
    }
    t += 'wrapText="' + e.alignment.wrapText + '" />';
    return t;
  };
  s.prototype.saveApp = function (e) {
    var t =
      '<?xml version="1.0" encoding="utf-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"><Application>Essential XlsIO</Application>';
    if (e !== void 0) {
      if (e.manager !== void 0) {
        t += '<Manager>' + e.manager + '</Manager>';
      }
      if (e.company !== void 0) {
        t += '<Company>' + e.company + '</Company>';
      }
    }
    this.addToArchive(t + '</Properties>', 'docProps/app.xml');
  };
  s.prototype.saveCore = function (e) {
    var t = new Date();
    var i =
      '<?xml version="1.0" encoding="utf-8" standalone="yes"?><cp:coreProperties xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties">';
    this.builtInProperties !== void 0
      ? (e.author !== void 0 && (i += '<dc:creator>' + e.author + '</dc:creator>'),
        e.subject !== void 0 && (i += '<dc:subject>' + e.subject + '</dc:subject>'),
        e.category !== void 0 && (i += '<cp:category>' + e.category + '</cp:category>'),
        e.comments !== void 0 && (i += '<dc:description>' + e.comments + '</dc:description>'),
        e.title !== void 0 && (i += '<dc:title>' + e.title + '</dc:title>'),
        e.tags !== void 0 && (i += '<cp:keywords>' + e.tags + '</cp:keywords>'),
        e.status !== void 0 && (i += '<cp:contentStatus>' + e.status + '</cp:contentStatus>'),
        e.createdDate !== void 0
          ? (i += '<dcterms:created xsi:type="dcterms:W3CDTF">' + e.createdDate.toISOString() + '</dcterms:created>')
          : (i += '<dcterms:created xsi:type="dcterms:W3CDTF">' + t.toISOString() + '</dcterms:created>'),
        e.modifiedDate !== void 0
          ? (i += '<dcterms:modified xsi:type="dcterms:W3CDTF">' + e.modifiedDate.toISOString() + '</dcterms:modified>')
          : (i += '<dcterms:modified xsi:type="dcterms:W3CDTF">' + t.toISOString() + '</dcterms:modified>'))
      : ((i += '<dcterms:created xsi:type="dcterms:W3CDTF">' + t.toISOString() + '</dcterms:created>'),
        (i += '<dcterms:modified xsi:type="dcterms:W3CDTF">' + t.toISOString() + '</dcterms:modified>'));
    i += '</cp:coreProperties>';
    this.addToArchive(i, 'docProps/core.xml');
  };
  s.prototype.saveTopLevelRelation = function () {
    var e =
      '<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml" /><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml" /><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml" /></Relationships>';
    this.addToArchive(
      '<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml" /><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml" /><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml" /></Relationships>',
      '_rels/.rels',
    );
  };
  s.prototype.saveWorkbookRelation = function () {
    for (
      var e =
          '<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',
        t = this.worksheets.length,
        i = 0,
        r = 0;
      r < t;
      r++, i++
    )
      e +=
        '<Relationship Id="rId' +
        (r + 1).toString() +
        '" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet' +
        (r + 1).toString() +
        '.xml" />';
    e +=
      '<Relationship Id="rId' +
      (++i).toString() +
      '" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml" />';
    if (this.sharedStringCount > 0) {
      e +=
        '<Relationship Id="rId' +
        (++i).toString() +
        '" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml" />';
    }
    this.addToArchive(e + '</Relationships>', 'xl/_rels/workbook.xml.rels');
  };
  s.prototype.saveContentType = function () {
    for (
      var e =
          '<?xml version="1.0" encoding="utf-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml" /><Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml" />',
        t = '',
        i = this.worksheets.length,
        r = 0,
        n = 0;
      n < i;
      n++
    ) {
      t +=
        '<Override PartName="/xl/worksheets/sheet' +
        (n + 1).toString() +
        '.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" />';
      if (this.worksheets[n].images != null && this.worksheets[n].images.length > 0) {
        r++;
        t +=
          '<Override PartName="/xl/drawings/drawing' +
          r.toString() +
          '.xml" ContentType="application/vnd.openxmlformats-officedocument.drawing+xml" />';
      }
    }
    if (this.imageCount > 0) {
      t += '<Default Extension="png" ContentType="image/png" />';
    }
    if (this.sharedStringCount > 0) {
      e +=
        '<Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml" />';
    }
    this.addToArchive(e + t + '</Types>', '[Content_Types].xml');
  };
  s.prototype.addToArchive = function (e, t) {
    if (typeof e == 'string') {
      var i = new Blob([e], { type: 'text/plain' });
      var r = new tt(i, t);
      this.mArchive.addItem(r);
    } else {
      var r = new tt(e, t);
      this.mArchive.addItem(r);
    }
  };
  s.prototype.processMergeCells = function (e, t, i) {
    if (e.rowSpan !== 0 || e.colSpan !== 0) {
      var r = new jn();
      r.x = e.index;
      r.width = e.colSpan;
      r.y = t;
      r.height = e.rowSpan;
      var n = this.getCellName(r.y, r.x);
      var a = this.getCellName(t + r.height, e.index + r.width);
      r.ref = n + ':' + a;
      i.add(r);
      var o = {
        x: r.x,
        y: r.y,
      };
      var l = {
        x: e.index + r.width,
        y: t + r.height,
      };
      this.updatedMergedCellStyles(o, l, e);
    }
    return i;
  };
  s.prototype.updatedMergedCellStyles = function (e, t, i) {
    for (var r = e.x; r <= t.x; r++)
      for (var n = e.y; n <= t.y; n++)
        this.mergedCellsStyle.set(this.getCellName(n, r), {
          x: r,
          y: n,
          styleIndex: i.styleIndex,
        });
  };
  s.prototype.dateToTicks = function (e, t, i) {
    var r = 864000000000;
    var n = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365];
    var a = [0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366];
    if (e >= 1 && e <= 9999 && t >= 1 && t <= 12) {
      var o = this.isLeapYear(e) ? a : n;
      var l = e - 1;
      var h = l * 365 + ((l / 4) | 0) - ((l / 100) | 0) + ((l / 400) | 0) + o[t - 1] + i - 1;
      return h * 864000000000;
    }
    throw new Error('Not a valid date');
  };
  s.prototype.timeToTicks = function (e, t, i) {
    if (e >= 0 && e < 24 && t >= 0 && t < 60 && i >= 0 && i < 60) {
      var r = e * 3600 + t * 60 + i;
      return r * 10000 * 1000;
    }
    throw new Error('Not valid time');
  };
  s.prototype.isLeapYear = function (e) {
    return e % 4 === 0 && (e % 100 !== 0 || e % 400 === 0);
  };
  s.prototype.toOADate = function (e) {
    var t = 0;
    t =
      this.dateToTicks(e.getFullYear(), e.getMonth() + 1, e.getDate()) +
      this.timeToTicks(e.getHours(), e.getMinutes(), e.getSeconds());
    if (t === 0) return 0;
    var i = 864000000000;
    var r = 693593;
    var n = 599264352000000000;
    var a = 31241376000000000;
    if (t < 31241376000000000) throw new Error('Arg_OleAutDateInvalid');
    var o = 86400000;
    return (t - 599264352000000000) / 10000 / 86400000;
  };
  return s;
})();
var Ml = (function () {
  function s() {}
  return s;
})();
var hi = (function () {
  function s(e, t) {
    this.hideColumnInclude = false;
    this.foreignKeyData = {};
    this.parent = e;
    if (!e.parentDetails && t) {
      this.foreignKeyData = t;
    }
  }
  s.getQuery = function (e, t) {
    var i = t.generateQuery(true).requiresCount();
    if (t.isRemote()) {
      e.groupSettings.enableLazyLoading && e.groupSettings.columns.length
        ? (i.lazyLoad = [])
        : i.take(e.pageSettings.totalRecordsCount);
    }
    return i;
  };
  s.prototype.getFData = function (e, t) {
    var i = Mn(t, {}, e, this.foreignKeyData[t.field])[0];
    return Mn(t, {}, e, this.foreignKeyData[t.field])[0];
  };
  s.prototype.getGridRowModel = function (e, t, i, r) {
    if (r === void 0) {
      r = 0;
    }
    var n = [];
    var a = t.length;
    if (t.length) {
      for (var o = 0; o < t.length; o++, r++) {
        var l = { isExpand: false };
        l.data = t[parseInt(o.toString(), 10)];
        l.index = r;
        if (i.childGrid || i.detailTemplate) {
          i.hierarchyPrintMode === 'All'
            ? (l.isExpand = true)
            : i.hierarchyPrintMode === 'Expanded' &&
              this.parent.expandedRows &&
              this.parent.expandedRows[parseInt(r.toString(), 10)] &&
              (l.isExpand = i.expandedRows[parseInt(r.toString(), 10)].isExpand);
        }
        var h = new yt(l);
        h.cells = this.generateCells(e, i);
        n.push(h);
      }
      this.processColumns(n);
    }
    return n;
  };
  s.prototype.generateCells = function (e, t) {
    var i = [];
    if (t.childGridLevel) for (var r = t.childGridLevel, n = 0; r > n; n++) i.push(this.generateCell({}, P.Indent));
    for (var a = 0, o = e; a < o.length; a++) {
      var l = o[a];
      i.push(this.generateCell(o[a], P.Data));
    }
    return i;
  };
  s.prototype.getColumnData = function (e) {
    var t = this;
    var i = [];
    var r;
    var n = e.getForeignKeyColumns();
    if (n.length) {
      for (var a = 0; a < n.length; a++) {
        var o =
          'result' in n[parseInt(a.toString(), 10)].dataSource
            ? new H(n[parseInt(a.toString(), 10)].dataSource.result)
            : n[parseInt(a.toString(), 10)].dataSource;
        i.push(o.executeQuery(new ue()));
      }
      r = Promise.all(i).then(function (l) {
        for (var h = 0; h < n.length; h++)
          t.foreignKeyData[n[parseInt(h.toString(), 10)].field] = l[parseInt(h.toString(), 10)].result;
      });
    }
    return r;
  };
  s.prototype.getHeaders = function (e, t) {
    t ? (this.hideColumnInclude = true) : (this.hideColumnInclude = false);
    this.colDepth = qn(e);
    for (var i = [], r = 0; r < this.colDepth; r++) {
      i[parseInt(r.toString(), 10)] = new yt({});
      i[parseInt(r.toString(), 10)].cells = [];
    }
    i = this.processColumns(i);
    i = this.processHeaderCells(i, e);
    return {
      rows: i,
      columns: this.generateActualColumns(e),
    };
  };
  s.prototype.getConvertedWidth = function (e) {
    var t = parseFloat(e);
    return e.indexOf('%') !== -1 ? (this.parent.element.getBoundingClientRect().width * t) / 100 : t;
  };
  s.prototype.generateActualColumns = function (e, t) {
    if (t === void 0) {
      t = [];
    }
    for (var i = 0, r = e; i < r.length; i++) {
      var n = r[i];
      if (!r[i].commands) {
        if (!r[i].columns)
          if (r[i].visible || this.hideColumnInclude) {
            t.push(r[i]);
          } else if (r[i].visible || this.hideColumnInclude) {
            var a = this.getCellCount(r[i], 0);
            if (a !== 0) {
              this.generateActualColumns(r[i].columns, t);
            }
          }
      }
    }
    return t;
  };
  s.prototype.processHeaderCells = function (e, t) {
    for (var i = t, r = 0; r < i.length; r++)
      if (!i[parseInt(r.toString(), 10)].commands) {
        e = this.appendGridCells(i[parseInt(r.toString(), 10)], e, 0);
      }
    return e;
  };
  s.prototype.appendGridCells = function (e, t, i) {
    if (!e.columns && (e.visible !== false || this.hideColumnInclude) && !e.commands)
      t[parseInt(i.toString(), 10)].cells.push(this.generateCell(e, P.Header, this.colDepth - i, i));
    else if (e.columns) {
      var r = this.getCellCount(e, 0);
      if (r) {
        t[parseInt(i.toString(), 10)].cells.push(
          new ze({
            cellType: P.StackedHeader,
            column: e,
            colSpan: r,
          }),
        );
      }
      for (var n = void 0, a = 0, o = e.columns.length; a < o; a++) {
        if (e.columns[parseInt(a.toString(), 10)].visible && !n) {
          n = true;
        }
        t = this.appendGridCells(e.columns[parseInt(a.toString(), 10)], t, i + 1);
      }
    }
    return t;
  };
  s.prototype.generateCell = function (e, t, i, r) {
    var n = {
      visible: e.visible,
      isDataCell: t === P.Data,
      column: e,
      cellType: t,
      rowSpan: i,
      index: r,
    };
    if (!n.rowSpan || n.rowSpan < 2) {
      delete n.rowSpan;
    }
    return new ze(n);
  };
  s.prototype.processColumns = function (e) {
    var t = this.parent;
    var i = [];
    if (this.parent.enableColumnVirtualization) {
      i = this.parent.getColumnIndexesInView();
    }
    for (var r = 0, n = e.length; r < n; r++)
      if (this.parent.allowGrouping)
        for (var a = 0, o = this.parent.groupSettings.columns.length - 1; a < o; a++)
          if (!(this.parent.enableColumnVirtualization && i.indexOf(a) === -1)) {
            e[parseInt(r.toString(), 10)].cells.splice(0, 0, this.generateCell({}, P.HeaderIndent));
          }
    return e;
  };
  s.prototype.getCellCount = function (e, t) {
    if (e.columns)
      for (var i = 0; i < e.columns.length; i++) t = this.getCellCount(e.columns[parseInt(i.toString(), 10)], t);
    else if (e.visible || this.hideColumnInclude) {
      t++;
    }
    return t;
  };
  s.prototype.checkAndExport = function (e, t) {
    var i = Object.keys(e).some(function (r) {
      return !e['' + r];
    });
    if (!i) {
      t();
    }
  };
  s.prototype.failureHandler = function (e, t, i) {
    var r = this;
    return function () {
      e[t.id] = true;
      r.checkAndExport(e, i);
    };
  };
  s.prototype.createChildGrid = function (e, t, i, r) {
    var n = new pn(this.parent.detailRowModule.getGridModel(e, t, i));
    e.isPrinting = false;
    var a = 'parentDetails';
    n.parentDetails = {
      parentID: e.element.id,
      parentPrimaryKeys: e.getPrimaryKeyFieldNames(),
      parentKeyField: e.childGrid.queryString,
      parentKeyFieldValue: re(n.queryString, t.data),
      parentRowData: t.data,
    };
    var o = Nt('child-grid');
    var l = ve('div', { id: o });
    l.style.display = 'none';
    document.body.appendChild(l);
    n.id = o;
    r['' + o] = false;
    n.isExportGrid = true;
    return {
      childGrid: n,
      element: l,
    };
  };
  s.prototype.getGridExportColumns = function (e) {
    for (var t = [], i = 0, r = e; i < r.length; i++)
      if (r[parseInt(i.toString(), 10)].type !== 'checkbox') {
        t.push(r[parseInt(i.toString(), 10)]);
      }
    return t;
  };
  s.prototype.getForeignKeyData = function () {
    return this.foreignKeyData;
  };
  return s;
})();
var ql = (function () {
  function s(e) {
    this.valueFormatter = new wn(e);
    this.internationalization = new Jt(e);
  }
  s.prototype.returnFormattedValue = function (e, t) {
    return !u(e.value) && e.value ? this.valueFormatter.getFormatFunction(t)(e.value) : '';
  };
  s.prototype.formatCellValue = function (e) {
    if (e.isForeignKey) {
      e.value = re(e.column.foreignKeyValue, Mn(e.column, {}, e.value)[0]);
    }
    if (e.column.type === 'number' && e.column.format !== void 0 && e.column.format !== '') {
      if (typeof e.column.format == 'string') {
        e.column.format = { format: e.column.format };
      }
      return e.value || e.value === 0 ? this.internationalization.getNumberFormat(e.column.format)(e.value) : '';
    }
    if (e.column.type === 'boolean' && e.value !== '') return e.value ? 'true' : 'false';
    if (
      (e.column.type === 'date' ||
        e.column.type === 'dateonly' ||
        e.column.type === 'datetime' ||
        e.column.type === 'time') &&
      e.column.format !== void 0
    ) {
      if (typeof e.value == 'string') {
        e.value = new Date(e.value);
      }
      if (typeof e.column.format == 'string') {
        var t = void 0;
        var i = e.column.format;
        e.column.type === 'date' || e.column.type === 'dateonly'
          ? (t = {
              type: 'date',
              skeleton: e.column.format,
            })
          : e.column.type === 'time'
            ? (t = {
                type: 'time',
                skeleton: e.column.format,
              })
            : (t = {
                type: 'dateTime',
                skeleton: e.column.format,
              });
        return this.returnFormattedValue(e, t);
      } else {
        if (e.column.format instanceof Object && e.column.format.type === void 0) return e.value.toString();
        var r = void 0;
        e.column.type === 'date' || e.column.type === 'dateonly'
          ? (r = {
              type: e.column.format.type,
              format: e.column.format.format,
              skeleton: e.column.format.skeleton,
            })
          : e.column.type === 'time'
            ? (r = {
                type: 'time',
                format: e.column.format.format,
                skeleton: e.column.format.skeleton,
              })
            : (r = {
                type: 'dateTime',
                format: e.column.format.format,
                skeleton: e.column.format.skeleton,
              });
        return this.returnFormattedValue(e, r);
      }
    } else return (!u(e.column.type) && !u(e.value)) || !u(e.value) ? e.value.toString() : '';
  };
  return s;
})();
var zl = (function () {
  function s(e, t) {
    this.book = {};
    this.workSheet = [];
    this.rows = [];
    this.columns = [];
    this.styles = [];
    this.rowLength = 1;
    this.expType = 'AppendToSheet';
    this.includeHiddenColumn = false;
    this.isCsvExport = false;
    this.isChild = false;
    this.isElementIdChanged = false;
    this.gridPool = {};
    this.sheet = {};
    this.grpFooterTemplates = [];
    this.footerTemplates = [];
    this.aggIndex = 0;
    this.totalAggregates = 0;
    this.parent = e;
    this.helper = new hi(e);
    this.locator = t;
    this.l10n = this.locator.getService('localization');
  }
  s.prototype.getModuleName = function () {
    return 'ExcelExport';
  };
  s.prototype.init = function (e) {
    if (e.element !== null && e.element.id === '') {
      e.element.id = new Date().toISOString();
      this.isElementIdChanged = true;
    }
    this.parent = e;
    if (!this.parent.isDestroyed) {
      this.isExporting = void 0;
      this.book = {};
      this.workSheet = [];
      this.rows = [];
      this.columns = [];
      this.styles = [];
      this.rowLength = 1;
      this.footer = void 0;
      this.expType = 'AppendToSheet';
      this.includeHiddenColumn = false;
      this.exportValueFormatter = new ql(e.locale);
      e.id = Nt('main-grid');
      this.gridPool[e.id] = false;
    }
  };
  s.prototype.Map = function (e, t, i, r, n, a) {
    var o = e;
    var l = 'cancel';
    var h = 'isBlob';
    var d = 'isChild';
    var p = 'isCsv';
    var c = 'workbook';
    var f = 'isMultipleExport';
    this.gridPool = {};
    if ((e.childGrid || e.detailTemplate) && !(!u(t) && t.hierarchyExportMode === 'None')) {
      e.expandedRows = Ua(e).expandedRows;
    }
    var g = {
      requestType: 'beforeExcelExport',
      gridObject: e,
      cancel: false,
      isMultipleExport: i,
      workbook: r,
      isCsv: n,
      isBlob: a,
      isChild: this.isChild,
      grpFooterTemplates: this.grpFooterTemplates,
    };
    e.trigger(Ga, g);
    return g.cancel
      ? new Promise(function (m) {
          return m();
        })
      : (this.parent.log('exporting_begin', this.getModuleName()),
        (this.data = new Wa(e)),
        (this.isExporting = true),
        (this.isBlob = g.isBlob),
        (this.isChild = g.isChild),
        (this.grpFooterTemplates = g.grpFooterTemplates),
        g.isCsv ? (this.isCsvExport = g.isCsv) : (this.isCsvExport = false),
        Or(t) && Ka(t, e),
        this.processRecords(e, t, g.isMultipleExport, g.workbook));
  };
  s.prototype.exportingSuccess = function (e) {
    this.isExporting = false;
    this.parent.trigger($a, this.isBlob ? { promise: this.blobPromise } : { gridInstance: this.parent });
    this.parent.log('exporting_complete', this.getModuleName());
    e(this.book);
  };
  s.prototype.processRecords = function (e, t, i, r) {
    var n = this;
    if (!u(t) && !u(t.dataSource)) {
      t.dataSource = t.dataSource instanceof H ? t.dataSource : new H(t.dataSource);
      var a = t.query ? t.query : new ue();
      if (u(a.isCountRequired) || e.aggregates) {
        a.isCountRequired = true;
      }
      return new Promise(function (h) {
        var d = t.dataSource.executeQuery(a);
        d.then(function (p) {
          n.init(e);
          n.processInnerRecords(e, t, i, r, p).then(function () {
            n.exportingSuccess(h);
          });
        });
      });
    } else {
      if (
        !u(t) &&
        t.exportType === 'CurrentPage' &&
        !(
          this.parent.groupSettings.enableLazyLoading &&
          this.parent.groupSettings.columns.length &&
          !this.parent.getDataModule().isRemote()
        )
      )
        return new Promise(function (h) {
          n.init(e);
          n.processInnerRecords(e, t, i, r, n.parent.getCurrentViewRecords());
          n.exportingSuccess(h);
        });
      var o = [];
      var l = hi.getQuery(e, this.data);
      if (
        this.parent.groupSettings.enableLazyLoading &&
        this.parent.groupSettings.columns.length &&
        !this.parent.getDataModule().isRemote()
      ) {
        if (u(t)) {
          t = { hierarchyExportMode: 'All' };
        }
        t.hierarchyExportMode = t.hierarchyExportMode === 'None' ? 'None' : 'All';
        if (t.hierarchyExportMode === 'All') {
          l.lazyLoad = [];
        }
      }
      o.push(this.data.getData({}, l));
      o.push(this.helper.getColumnData(e));
      return new Promise(function (h, d) {
        Promise.all(o)
          .then(function (p) {
            n.init(e);
            n.processInnerRecords(e, t, i, r, p[0]).then(function () {
              n.exportingSuccess(h);
            });
          })
          .catch(function (p) {
            d(n.book);
            n.parent.trigger(Bn, p);
          });
      });
    }
  };
  s.prototype.processInnerRecords = function (e, t, i, r, n) {
    var a = this;
    this.groupedColLength = e.groupSettings.columns.length;
    var o = 5;
    var l;
    var h = [];
    var d = qn(e.columns);
    var p = !u(t);
    if (p && !u(t.multipleExport)) {
      this.expType = u(t.multipleExport.type) ? 'AppendToSheet' : t.multipleExport.type;
      if (!u(t.multipleExport.blankRows)) {
        o = t.multipleExport.blankRows;
      }
    }
    u(r)
      ? ((this.workSheet = []), (this.rows = []), (this.columns = []), (this.styles = []), (this.sheet.images = []))
      : this.expType === 'NewSheet'
        ? ((this.workSheet = r.worksheets),
          (this.rows = []),
          (this.columns = []),
          (this.sheet.images = []),
          (this.styles = r.styles))
        : ((this.workSheet = []),
          (this.rows = r.worksheets[0].rows),
          (this.columns = r.worksheets[0].columns),
          (this.styles = r.styles),
          (this.sheet.images = r.worksheets[0].images),
          (this.rowLength = this.rows[this.rows.length - 1].index + o),
          this.rowLength++);
    if (p) {
      u(i)
        ? (u(t.header) || this.processExcelHeader(JSON.parse(JSON.stringify(t.header))),
          u(t.footer) || (this.footer = JSON.parse(JSON.stringify(t.footer))))
        : (!u(t.header) &&
            (i || this.expType === 'NewSheet') &&
            this.processExcelHeader(JSON.parse(JSON.stringify(t.header))),
          u(t.footer) ||
            (this.expType === 'AppendToSheet'
              ? i || (this.footer = JSON.parse(JSON.stringify(t.footer)))
              : (this.footer = JSON.parse(JSON.stringify(t.footer)))));
    }
    this.includeHiddenColumn = p ? t.includeHiddenColumn : false;
    return new Promise(function (c, f) {
      e.childGridLevel = 0;
      h = a.processGridExport(e, t, n);
      a.globalResolve = c;
      a.gridPool[e.id] = true;
      a.helper.checkAndExport(a.gridPool, a.globalResolve);
    }).then(function () {
      var c = [];
      a.organiseRows(h, h[0].index, c);
      a.rows = a.rows.concat(c);
      if (!u(a.footer)) {
        if ((a.expType === 'AppendToSheet' && !i) || a.expType === 'NewSheet') {
          a.processExcelFooter(a.footer);
        }
      }
      if (a.columns.length > 0) {
        a.sheet.columns = a.columns;
      }
      a.sheet.rows = a.rows;
      a.sheet.enableRtl = a.parent.enableRtl;
      if (a.parent.allowFiltering && e.getVisibleColumns().length && p && t.enableFilter) {
        var f = t.header ? t.header.headerRows || t.header.rows.length : 0;
        var g = {
          row: d + f,
          column: a.groupedColLength ? a.groupedColLength + 1 : a.sheet.columns[0].index,
          lastRow: a.sheet.rows.length,
          lastColumn: a.sheet.columns.length,
        };
        a.sheet.autoFilters = g;
      }
      a.workSheet.push(a.sheet);
      a.book.worksheets = a.workSheet;
      a.book.styles = a.styles;
      e.notify('finalPageSetup', a.book);
      if (!i) {
        if (a.isCsvExport) {
          if (p && !u(t.separator) && t.separator !== ',') {
            l = t.separator;
          }
          var m = new Zr(a.book, 'csv', e.locale, Br, l);
          a.isBlob
            ? (a.blobPromise = m.saveAsBlob('text/csv'))
            : p && t.fileName
              ? m.save(t.fileName)
              : m.save('Export.csv');
        } else {
          var m = new Zr(a.book, 'xlsx', e.locale, Br);
          a.isBlob
            ? (a.blobPromise = m.saveAsBlob('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'))
            : p && t.fileName
              ? m.save(t.fileName)
              : m.save('Export.xlsx');
        }
        if (a.isElementIdChanged) {
          e.element.id = '';
        }
        delete e.expandedRows;
      }
      return r;
    });
  };
  s.prototype.organiseRows = function (e, t, i) {
    if (!e.length) return t;
    for (var r = 0; r < e.length; r++) {
      var n = e[parseInt(r.toString(), 10)];
      var a = n.childRows;
      n.childRows
        ? ((n.index = t++), delete n.childRows, i.push(n), (t = this.organiseRows(n.childRows, t, i)))
        : ((n.index = t++), i.push(n));
    }
    return t;
  };
  s.prototype.processGridExport = function (e, t, i) {
    var r = [];
    if (!u(t) && !u(t.theme)) {
      this.theme = t.theme;
    }
    if ((e.childGrid || e.detailTemplate) && !u(t)) {
      e.hierarchyPrintMode = t.hierarchyExportMode || 'Expanded';
    }
    var n = new hi(e, this.helper.getForeignKeyData());
    var a = Or(t) ? Xa(t.columns, e.enableColumnVirtualization) : n.getGridExportColumns(e.columns);
    var o = n.getHeaders(a, this.includeHiddenColumn);
    var l = e.groupSettings.columns.length ? e.groupSettings.columns.length - 1 : 0;
    r = this.processHeaderContent(e, o, l, r);
    !u(t) && Object.keys(t).length && u(t.dataSource)
      ? t.exportType === 'CurrentPage' && (!e.groupSettings.enableLazyLoading || e.getDataModule().isRemote())
        ? (r = this.processRecordContent(e, i, o, t, e.currentViewData, r, n))
        : (r = this.processRecordContent(e, i, o, t, void 0, r, n))
      : (r = this.processRecordContent(e, i, o, t, void 0, r, n));
    e.notify(Ja, {
      excelRows: r,
      type: 'excel',
    });
    this.capTemplate = void 0;
    this.footerTemplates = [];
    this.grpFooterTemplates = [];
    this.aggIndex = 0;
    this.totalAggregates = 0;
    return r;
  };
  s.prototype.processRecordContent = function (e, t, i, r, n, a, o) {
    var l;
    !u(n) && n.length ? (l = n) : (l = t.result);
    u(l.level) ? this.processRecordRows(e, l, i, 0, 0, r, a, o) : this.processGroupedRows(e, l, i, l.level, 0, r, a, o);
    if (!u(t.aggregates))
      if (!u(n) && !this.parent.groupSettings.enableLazyLoading) this.processAggregates(e, t.result, a, n);
      else {
        var h = t.result.GroupGuid ? t.result.records : t.result;
        this.processAggregates(e, h, a);
      }
    return a;
  };
  s.prototype.processGroupedRows = function (e, t, i, r, n, a, o, l) {
    for (var h = 0, d = t; h < d.length; h++) {
      var p = d[h];
      var c = [];
      var f = 1;
      var g = {};
      g.index = 1 + r - 1;
      var m = e.getColumnByField(d[h].field);
      var y = {
        value: d[h].key,
        column: m,
        style: void 0,
        isForeignKey: m.isForeignColumn(),
      };
      var v =
        e.getColumnByField(d[h].field).headerText +
        ': ' +
        (m.enableGroupByFormat ? d[h].key : this.exportValueFormatter.formatCellValue(y)) +
        ' - ';
      d[h].count > 1 ? (v += d[h].count + ' items') : (v += d[h].count + ' item');
      var b = {
        captionText: v,
        type: this.isCsvExport ? 'CSV' : 'Excel',
        data: d[h],
      };
      this.parent.trigger(Ar, b);
      g.value = b.captionText;
      g.style = this.getCaptionThemeStyle(this.theme);
      if (!u(b.style)) {
        g.style = this.mergeOptions(g.style, b.style);
      }
      var w = new yn(e);
      var C = w.generateRows(d[h]);
      this.fillAggregates(e, C, t.level + t.childLevels - 1, o, this.rowLength);
      c.push(g);
      if (o[o.length - 1].cells.length > 0) {
        for (
          var I = t.level + t.childLevels + C[0].cells.length, x = 0, O = 0, A = o[o.length - 1].cells;
          O < A.length;
          O++
        ) {
          var k = A[O];
          if (A[O].index < I) {
            I = A[O].index;
          }
          if (A[O].index > x) {
            x = A[O].index;
          }
          if (c[c.length - 1].index !== A[O].index) {
            c.push(A[O]);
          }
        }
        if (I - g.index > 1) {
          g.colSpan = I - g.index;
        }
        for (var F = Object.keys(C[0].data), D = F ? F.length : 0; x < i.columns.length - D + r + t.childLevels; ) {
          var L = {};
          L.index = x + 1;
          L.style = this.getCaptionThemeStyle(this.theme);
          var K = {
            type: this.isCsvExport ? 'CSV' : 'Excel',
            data: d[h],
          };
          this.parent.trigger(Ar, K);
          if (!u(K.style)) {
            L.style = this.mergeOptions(L.style, K.style);
          }
          c.push(L);
          x++;
        }
      } else {
        for (var V = 0, W = 0, J = i.columns; W < J.length; W++) {
          var we = J[W];
          if (J[W].visible) {
            V++;
          }
        }
        g.colSpan = t.childLevels + V;
      }
      o[o.length - 1].cells = c;
      this.rowLength++;
      if (this.groupedColLength < 8 && r > 1) {
        var he = {
          outlineLevel: r - 1,
          isCollapsed: true,
        };
        o[o.length - 1].grouping = he;
      }
      !u(t.childLevels) && t.childLevels > 0
        ? (this.processGroupedRows(e, d[h].items, i, d[h].items.level, n, a, o, l),
          this.processAggregates(e, d[h], o, void 0, r - 1 + t.childLevels, true))
        : ((n = this.processRecordRows(e, d[h].items, i, r - 1, n, a, o, l)),
          this.processAggregates(e, d[h], o, void 0, r - 1, true));
    }
  };
  s.prototype.processRecordRows = function (e, t, i, r, n, a, o, l) {
    for (var h = 1, d = [], p = i.columns, c = l.getGridRowModel(p, t, e, n), f = 0, g = c; f < g.length; f++) {
      var m = g[f];
      d = [];
      n++;
      h = 1;
      for (var y = void 0, v = 0, b = g[f].cells.length; v < b; v++) {
        var w = g[f].cells[parseInt(v.toString(), 10)];
        if (g[f].cells[parseInt(v.toString(), 10)].cellType === P.Data) {
          var C = g[f].cells[parseInt(v.toString(), 10)].column;
          var I = g[f].cells[parseInt(v.toString(), 10)].column.field;
          var x = u(g[f].cells[parseInt(v.toString(), 10)].column.field)
            ? ''
            : g[f].cells[parseInt(v.toString(), 10)].column.valueAccessor(
                g[f].cells[parseInt(v.toString(), 10)].column.field,
                g[f].data,
                g[f].cells[parseInt(v.toString(), 10)].column,
              );
          var O = u(x) ? '' : x;
          if (g[f].cells[parseInt(v.toString(), 10)].column.type === 'dateonly' && typeof O == 'string' && O) {
            var A = O.split(/[^0-9.]/);
            O = new Date(parseInt(A[0], 10), parseInt(A[1], 10) - 1, parseInt(A[2], 10));
          }
          var k = void 0;
          if (
            g[f].cells[parseInt(v.toString(), 10)].column.isForeignColumn &&
            g[f].cells[parseInt(v.toString(), 10)].column.isForeignColumn()
          ) {
            k = l.getFData(O, g[f].cells[parseInt(v.toString(), 10)].column);
            O = re(g[f].cells[parseInt(v.toString(), 10)].column.foreignKeyValue, k);
          }
          if (!u(O)) {
            var F = {};
            var D = h + r + e.childGridLevel;
            var L = {
              data: g[f].data,
              column: g[f].cells[parseInt(v.toString(), 10)].column,
              foreignKeyData: k,
              value: O,
              style: void 0,
              colSpan: 1,
              cell: F,
            };
            e.trigger(Za, L);
            if (!u(L.image) && !u(L.image.base64)) {
              y = this.setImage(L, D);
              if (L.image.height && L.value !== '') {
                y += 30;
              }
            }
            if (!u(L.hyperLink)) {
              L.cell.hyperlink = { target: L.hyperLink.target };
              L.value = L.hyperLink.displayText || L.value;
            }
            F = L.cell;
            F.index = D;
            F.value = L.value;
            if (L.data === '' && e.childGridLevel && h === 1) {
              var K = {};
              K.hAlign = 'left';
              L = { style: K };
              F.colSpan = e.getVisibleColumns().length;
              F.value = this.l10n.getConstant('EmptyRecord');
            }
            if (L.colSpan > 1) {
              F.colSpan = L.colSpan;
            }
            if (u(L.style)) F.style = { name: e.element.id + 'column' + (h + r) };
            else {
              var V = this.getColumnStyle(e, h + r);
              F.style = this.mergeOptions(this.styles[parseInt(V.toString(), 10)], L.style);
            }
            d.push(F);
          }
          h++;
        }
      }
      var W = {
        index: this.rowLength++,
        cells: d,
      };
      if (!u(y)) {
        W.height = y;
      }
      if (this.groupedColLength && this.groupedColLength < 8 && r + 1 > 0) {
        W.grouping = {
          outlineLevel: r + 1,
          isCollapsed: true,
        };
      }
      o.push(W);
      if ((g[f].isExpand || this.isChild) && (!u(e.childGrid) || !u(e.detailTemplate)))
        if (u(e.childGrid)) {
          var Ae = {
            parentRow: g[f],
            row: W,
            value: {},
            action: 'excelexport',
            gridInstance: e,
          };
          this.parent.trigger(Qa, Ae);
          W.childRows = this.processDetailTemplate(Ae);
        } else {
          e.isPrinting = true;
          var J = !u(a) && a.exportType ? a.exportType : 'AllPages';
          var we = this.helper.createChildGrid(e, g[f], J, this.gridPool);
          var he = we.childGrid;
          var Be = we.element;
          he.actionFailure = l.failureHandler(this.gridPool, he, this.globalResolve);
          he.childGridLevel = e.childGridLevel + 1;
          var $e = E(a, {
            columns: null,
            dataSource: null,
            query: null,
          });
          var Ae = {
            childGrid: he,
            row: g[f],
            exportProperties: $e,
          };
          this.parent.trigger(Ya, Ae);
          he.beforeDataBound = this.childGridCell(W, he, $e, g[f]);
          he.appendTo(we.element);
        }
      e.notify(eo, {
        rowObj: g[f],
        type: 'excel',
        excelRows: o,
      });
    }
    return n;
  };
  s.prototype.processDetailTemplate = function (e) {
    var t = this;
    var i = [];
    var r;
    var n = 2;
    var a;
    if (e.value.columnHeader || e.value.rows) {
      var o = function (p, c) {
        var f = {};
        if (u(p.index)) {
          p.index = a;
          a++;
        }
        f.index = p.index + 2;
        if (!u(p.value)) {
          f.value = p.value;
        }
        if (!u(p.colSpan)) {
          f.colSpan = p.colSpan;
        }
        if (!u(p.rowSpan)) {
          f.rowSpan = p.rowSpan;
        }
        c ? (f.style = t.getHeaderThemeStyle(t.theme)) : (f.style = t.getRecordThemeStyle(t.theme));
        if (!u(p.style)) {
          var g = {
            fontColor: p.style.fontColor,
            fontName: p.style.fontName,
            fontSize: p.style.fontSize,
            hAlign: p.style.excelHAlign,
            vAlign: p.style.excelVAlign,
            rotation: p.style.excelRotation,
            bold: p.style.bold,
            indent: p.style.indent,
            italic: p.style.italic,
            underline: p.style.underline,
            backColor: p.style.backColor,
            wrapText: p.style.wrapText,
            borders: p.style.excelBorders,
            numberFormat: p.style.excelNumberFormat,
            type: p.style.excelType,
            strikeThrough: p.style.strikeThrough,
          };
          f.style = t.mergeOptions(g, f.style);
        }
        if (!u(p.image) && !u(p.image.base64)) {
          p.rowSpan > 1
            ? t.setImage(p, f.index)
            : ((r = t.setImage(p, f.index)), p.image.height && p.value !== '' && (r += 30));
        }
        if (!u(p.hyperLink)) {
          f.hyperlink = { target: p.hyperLink.target };
          f.value = p.hyperLink.displayText;
        }
        return f;
      };
      var l = function (p, c) {
        var f = [];
        a = 0;
        for (var g = 0; g < p.cells.length; g++) {
          var m = p.cells[parseInt(g.toString(), 10)];
          var y = o(p.cells[parseInt(g.toString(), 10)], c);
          f.push(y);
        }
        var v = {
          index: t.rowLength++,
          cells: f,
        };
        if (!u(r)) {
          v.height = r;
          r = null;
        }
        i.push(v);
      };
      if (e.value.columnHeader)
        for (var h = 0; h < e.value.columnHeader.length; h++) l(e.value.columnHeader[parseInt(h.toString(), 10)], true);
      if (e.value.rows) for (var h = 0; h < e.value.rows.length; h++) l(e.value.rows[parseInt(h.toString(), 10)]);
    } else if (e.value.image) {
      r = this.setImage(e.value, 2);
      var d = {
        index: this.rowLength++,
        cells: [
          {
            index: 2,
            style: this.getRecordThemeStyle(this.theme),
          },
        ],
      };
      if (!u(r)) {
        d.height = r;
        r = null;
      }
      i.push(d);
    } else if (e.value.text) {
      var d = {
        index: this.rowLength++,
        cells: [
          {
            index: 2,
            value: e.value.text,
            style: this.getRecordThemeStyle(this.theme),
          },
        ],
      };
      i.push(d);
    } else if (e.value.hyperLink) {
      var d = {
        index: this.rowLength++,
        cells: [
          {
            index: 2,
            hyperlink: { target: e.value.hyperLink.target },
            value: e.value.hyperLink.displayText,
            style: this.getRecordThemeStyle(this.theme),
          },
        ],
      };
      i.push(d);
    }
    for (var h = 0; h < i.length; h++)
      i[parseInt(h.toString(), 10)].grouping = {
        outlineLevel: 1,
        isCollapsed: !e.parentRow.isExpand,
        isHidden: !e.parentRow.isExpand,
      };
    return i;
  };
  s.prototype.setImage = function (e, t) {
    if (u(this.sheet.images)) {
      this.sheet.images = [];
    }
    var i = {
      image: e.image.base64,
      row: this.rowLength,
      column: t,
      lastRow: this.rowLength,
      lastColumn: t,
    };
    if (e.image.width && e.image.height) {
      i.width = e.image.width;
      i.height = e.image.height;
    }
    this.sheet.images.push(i);
    this.columns[t - 1].width = e.image.width || this.columns[t - 1].width;
    return e.image.height || 50;
  };
  s.prototype.childGridCell = function (e, t, i, r) {
    var n = this;
    return function (a) {
      t.beforeDataBound = null;
      a.cancel = true;
      if (a.result.length === 0) {
        a.result = [''];
      }
      e.childRows = n.processGridExport(t, i, a);
      for (var o = n.parent.groupSettings.columns.length, l = e.childRows, h = 0; h < l.length; h++)
        l[parseInt(h.toString(), 10)].grouping = {
          outlineLevel: o + t.childGridLevel,
          isCollapsed: !r.isExpand,
          isHidden: !r.isExpand,
        };
      t.destroy();
      Tt(t.element);
      n.gridPool[t.id] = true;
      n.helper.checkAndExport(n.gridPool, n.globalResolve);
      return e;
    };
  };
  s.prototype.processAggregates = function (e, t, i, r, n, a) {
    var o = new gn(e);
    var l = o.getColumns();
    l = l.filter(function (f) {
      return u(f.commands) && f.type !== 'checkbox';
    });
    if (e.aggregates.length && this.parent !== e) {
      e.aggregateModule.prepareSummaryInfo();
    }
    var h = void 0;
    u(r) ? (h = t) : (h = r);
    if (n === void 0) {
      n = 0;
    }
    if (e.groupSettings.columns.length > 0 && a) {
      var d = new Sn(e);
      var p = d.generateRows(h, { level: h.level });
      if (p.length > 0) {
        i = this.fillAggregates(e, p, n, i);
      }
    } else {
      n = e.groupSettings.columns.length > 0 && !a ? e.groupSettings.columns.length : n;
      var c = o.generateRows(h, t.aggregates, null, null, l);
      if (c.length > 0 && !a) {
        n = e.groupSettings.columns.length ? n - 1 : n;
        i = this.fillAggregates(e, c, n, i);
      }
    }
    return i;
  };
  s.prototype.fillAggregates = function (e, t, i, r, n) {
    for (var a = 0, o = t; a < o.length; a++) {
      for (var l = o[a], h = [], d = true, p = 0, c = 0, f = l.cells; c < f.length; c++) {
        var g = f[c];
        var m = {};
        var y = {};
        if (!u(f[c].attributes['data-index'])) {
          y = this.parent.getColumnByIndex(f[c].attributes['data-index']);
        }
        if (
          !(f[c].cellType === P.DetailFooterIntent || y.type === 'checkbox' || y.commands) &&
          (f[c].visible || this.includeHiddenColumn)
        ) {
          p++;
          if (f[c].isDataCell) {
            d = false;
            var v = !u(f[c].column.footerTemplate);
            var b = !u(f[c].column.groupFooterTemplate);
            var w = !u(f[c].column.groupCaptionTemplate);
            m.index = p + i + e.childGridLevel;
            if (v) m.value = this.getAggreateValue(e, P.Summary, f[c].column.footerTemplate, f[c], l);
            else if (b) m.value = this.getAggreateValue(e, P.GroupSummary, f[c].column.groupFooterTemplate, f[c], l);
            else if (w) m.value = this.getAggreateValue(e, P.CaptionSummary, f[c].column.groupCaptionTemplate, f[c], l);
            else
              for (var C = 0, I = Object.keys(l.data[f[c].column.field]); C < I.length; C++) {
                var x = I[C];
                if (I[C] === f[c].column.type) {
                  u(l.data[f[c].column.field].Sum)
                    ? u(l.data[f[c].column.field].Average)
                      ? u(l.data[f[c].column.field].Max)
                        ? u(l.data[f[c].column.field].Min)
                          ? u(l.data[f[c].column.field].Count)
                            ? u(l.data[f[c].column.field].TrueCount)
                              ? u(l.data[f[c].column.field].FalseCount)
                                ? u(l.data[f[c].column.field].Custom) || (m.value = l.data[f[c].column.field].Custom)
                                : (m.value = l.data[f[c].column.field][f[c].column.field + ' - falsecount'])
                              : (m.value = l.data[f[c].column.field][f[c].column.field + ' - truecount'])
                            : (m.value = l.data[f[c].column.field][f[c].column.field + ' - count'])
                          : (m.value = l.data[f[c].column.field][f[c].column.field + ' - min'])
                        : (m.value = l.data[f[c].column.field][f[c].column.field + ' - max'])
                      : (m.value = l.data[f[c].column.field][f[c].column.field + ' - average'])
                    : (m.value = l.data[f[c].column.field][f[c].column.field + ' - sum']);
                }
              }
            m.style = this.getCaptionThemeStyle(this.theme);
            this.aggregateStyle(f[c].column, m.style, f[c].column.field);
            var O = f[c].attributes.class != null ? f[c].attributes.class.toString() : '';
            if (O) {
              m.style.hAlign =
                O.indexOf('e-rightalign') > -1 ? 'right' : O.indexOf('e-centeralign') > -1 ? 'center' : 'left';
            }
            var A = {
              row: l,
              type: v ? 'Footer' : b ? 'GroupFooter' : 'GroupCaption',
              style: m,
              cell: f[c],
            };
            this.parent.trigger(kr, A);
            h.push(m);
          } else if (n === void 0) {
            m.index = p + i + e.childGridLevel;
            m.style = this.getCaptionThemeStyle(this.theme);
            var A = {
              row: l,
              type: u(f[c].column.footerTemplate)
                ? u(f[c].column.groupFooterTemplate)
                  ? 'GroupCaption'
                  : 'GroupFooter'
                : 'Footer',
              style: m,
              cell: f[c],
            };
            this.parent.trigger(kr, A);
            h.push(m);
          }
        }
      }
      if (!u(n))
        r.push({
          index: n,
          cells: h,
        });
      else {
        var k = {};
        var F = 'outlineLevel';
        var D = 'grouping';
        if (
          this.groupedColLength < 8 &&
          this.groupedColLength > 0 &&
          !(e.groupSettings.enableLazyLoading && u(r[r.length - 1].grouping))
        ) {
          var L = r[r.length - 1].grouping.outlineLevel;
          var K = {
            outlineLevel: r[r.length - 1].grouping.outlineLevel,
            isCollapsed: true,
          };
          k = {
            index: this.rowLength++,
            cells: h,
            grouping: K,
          };
        } else
          k = {
            index: this.rowLength++,
            cells: h,
          };
        if (!d) {
          r.push(k);
        }
      }
    }
    return r;
  };
  s.prototype.aggregateStyle = function (e, t, i) {
    var r = this.parent.getColumnByField(i);
    if (typeof e.format == 'object') {
      var n = e.format;
      t.numberFormat = u(e.format.format) ? e.format.skeleton : e.format.format;
      if (!u(e.format.type)) {
        t.type = e.format.type.toLowerCase();
      }
    } else t.numberFormat = e.format;
    if (!u(r) && u(t.type)) {
      t.type = r.type.toLowerCase();
    }
  };
  s.prototype.getAggreateValue = function (e, t, i, r, n) {
    var a = {};
    a[Lr(P, r.cellType)] = to(i);
    var o;
    var l = n.data[r.column.field ? r.column.field : r.column.columnName];
    return (this.parent.isReact || this.parent.isVue || this.parent.isVue3 || this.parent.isAngular) &&
      !(
        typeof r.column.footerTemplate == 'string' ||
        typeof r.column.groupFooterTemplate == 'string' ||
        typeof r.column.groupCaptionTemplate == 'string'
      )
      ? ((o = n.data[r.column.field ? r.column.field : r.column.columnName][r.column.type]), u(o) ? '' : o)
      : ((o = a[Lr(P, r.cellType)](n.data[r.column.field ? r.column.field : r.column.columnName], this.parent)),
        this.parent.isVue3 && !u(o[1]) ? o[1].textContent : u(o[0]) ? '' : o[0].textContent);
  };
  s.prototype.mergeOptions = function (e, t) {
    for (var i = {}, r = Object.keys(e), n = 0; n < r.length; n++)
      if (r[parseInt(n.toString(), 10)] !== 'name') {
        i[r[parseInt(n.toString(), 10)]] = e[r[parseInt(n.toString(), 10)]];
      }
    r = Object.keys(t);
    for (var n = 0; n < r.length; n++)
      if (r[parseInt(n.toString(), 10)] !== 'name') {
        i[r[parseInt(n.toString(), 10)]] = t[r[parseInt(n.toString(), 10)]];
      }
    return i;
  };
  s.prototype.getColumnStyle = function (e, t) {
    for (var i = 0, r = 0, n = this.styles; r < n.length; r++) {
      var a = n[r];
      if (n[r].name === e.element.id + 'column' + t) return i;
      i++;
    }
  };
  s.prototype.headerRotation = function (e) {
    var t = e.style.rotation;
    t <= 90 && t >= 0 ? (e.style.hAlign = 'Left') : ((t > 90 && t <= 180) || (t = 180), (e.style.hAlign = 'Right'));
    e.style.rotation = t;
  };
  s.prototype.processHeaderContent = function (e, t, i, r) {
    var n = 1;
    var a = t.rows;
    var o = t.columns;
    var l = [];
    if (i > 0)
      for (var h = 0; h !== i; ) {
        this.columns.push({
          index: h + 1,
          width: 30,
        });
        h++;
      }
    for (var d = 0; d < t.columns.length; d++)
      this.parseStyles(e, t.columns[parseInt(d.toString(), 10)], this.getRecordThemeStyle(this.theme), i + d + 1);
    for (var p, c = 0; c < t.rows.length; c++) {
      for (var f = 1 + i, g = [], m = 0; m < t.rows[parseInt(c.toString(), 10)].cells.length; m++) {
        var y = {};
        var v = {};
        var b = t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)];
        if (
          !(
            t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].isSpanned ||
            t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].cellType === P.HeaderIndent ||
            t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].cellType === P.DetailHeader
          )
        ) {
          for (
            var w = {
              contains: true,
              index: 1,
            };
            true;

          ) {
            w = this.getIndex(l, 1, f);
            f = 1;
            if (!w.contains) {
              v.index = 1 + e.childGridLevel;
              break;
            }
          }
          if (
            !u(t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].rowSpan) &&
            t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].rowSpan !== 1
          ) {
            v.rowSpan = t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].rowSpan;
            for (var C = 1; C < t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].rowSpan + 1; C++) {
              var I = {
                rowIndex: 0,
                columnIndex: 0,
                colSpan: 0,
              };
              I.rowIndex = C;
              I.columnIndex = f;
              I.colSpan = t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].colSpan || 1;
              l.push(I);
            }
          }
          if (
            !u(t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].colSpan) &&
            t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].colSpan !== 1
          ) {
            v.colSpan = t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].colSpan;
            f = f + v.colSpan - 1;
          }
          v.value = t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].column.headerText;
          y = this.getHeaderThemeStyle(this.theme);
          if (!u(t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].column.textAlign)) {
            y.hAlign =
              t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].column.textAlign.toLowerCase();
          }
          if (!u(t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].column.headerTextAlign)) {
            y.hAlign =
              t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].column.headerTextAlign.toLowerCase();
          }
          var x = {
            cell: v,
            gridCell: t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)],
            style: y,
          };
          e.trigger(io, x);
          if (
            t.rows[parseInt(c.toString(), 10)].cells[parseInt(m.toString(), 10)].cellType === P.Header &&
            v.colSpan > 1
          ) {
            f = f + v.colSpan - 1;
            for (var O = 1; O < v.colSpan; O++) {
              var A = m + O;
              if (A < t.rows[parseInt(c.toString(), 10)].cells.length) {
                t.rows[parseInt(c.toString(), 10)].cells[parseInt(A.toString(), 10)].isSpanned = true;
              }
            }
            for (var C = 0; C < l.length; C++)
              if (l[parseInt(C.toString(), 10)].columnIndex === v.index) {
                l[parseInt(C.toString(), 10)].colSpan = v.colSpan;
              }
          }
          if (x.style.rotation) {
            this.headerRotation(x);
          }
          if (!u(x.image) && !u(x.image.base64)) {
            p = this.setImage(x, f);
          }
          if (!u(x.hyperLink)) {
            x.cell.hyperlink = { target: x.hyperLink.target };
            v.value = x.hyperLink.displayText || v.value;
          }
          v.style = x.style;
          g.push(v);
          f++;
        }
      }
      var k = {
        index: this.rowLength++,
        cells: g,
      };
      if (!u(p)) {
        k.height = p;
      }
      r.push(k);
    }
    return r;
  };
  s.prototype.getHeaderThemeStyle = function (e) {
    var t = {};
    t.fontSize = 12;
    t.borders = { color: '#E0E0E0' };
    t.bold = true;
    if (!u(e) && !u(e.header)) {
      t = this.updateThemeStyle(e.header, t);
    }
    return t;
  };
  s.prototype.updateThemeStyle = function (e, t) {
    return E(t, e);
  };
  s.prototype.getCaptionThemeStyle = function (e) {
    var t = {};
    t.fontSize = 13;
    t.backColor = '#F6F6F6';
    if (!u(e) && !u(e.caption)) {
      t = this.updateThemeStyle(e.caption, t);
    }
    return t;
  };
  s.prototype.getRecordThemeStyle = function (e) {
    var t = {};
    t.fontSize = 13;
    t.borders = { color: '#E0E0E0' };
    if (!u(e) && !u(e.record)) {
      t = this.updateThemeStyle(e.record, t);
    }
    return t;
  };
  s.prototype.processExcelHeader = function (e) {
    if (!u(e.rows) && (this.expType === 'NewSheet' || this.rowLength === 1)) {
      var t = void 0;
      e.headerRows === void 0 ? (this.rowLength = e.rows.length) : (this.rowLength = e.headerRows);
      this.rowLength < e.rows.length ? (t = this.rowLength) : (t = e.rows.length);
      this.rowLength++;
      for (var i = 0; i < t; i++) {
        var r = e.rows[parseInt(i.toString(), 10)];
        if (!(r.index !== null && !u(r.index))) {
          r.index = i + 1;
        }
        this.updatedCellIndex(r);
      }
    }
  };
  s.prototype.updatedCellIndex = function (e) {
    for (var t = e.cells.length, i = 0; i < t; i++) {
      var r = e.cells[parseInt(i.toString(), 10)];
      if (!(r.index !== null && !u(r.index))) {
        r.index = i + 1;
      }
    }
    this.rows.push(e);
  };
  s.prototype.processExcelFooter = function (e) {
    if (!u(e.rows)) {
      var t = void 0;
      e.footerRows === void 0
        ? (this.rowLength += e.rows.length)
        : e.footerRows > e.rows.length
          ? ((this.rowLength += e.footerRows - e.rows.length), (t = e.rows.length))
          : (t = e.footerRows);
      for (var i = 0; i < t; i++) {
        var r = e.rows[parseInt(i.toString(), 10)];
        r.index === null || r.index === void 0 ? (r.index = this.rowLength++) : (r.index += this.rowLength);
        this.updatedCellIndex(r);
      }
    }
  };
  s.prototype.getIndex = function (e, t, i) {
    for (var r = 0, n = e; r < n.length; r++) {
      var a = n[r];
      if (n[r].rowIndex === t && n[r].columnIndex === i) {
        i += n[r].colSpan || 1;
        return {
          contains: true,
          index: i,
        };
      }
    }
    return {
      contains: false,
      index: i,
    };
  };
  s.prototype.parseStyles = function (e, t, i, r) {
    if (!u(t.format))
      if (typeof t.format == 'object') {
        var n = t.format;
        i.numberFormat = u(t.format.format) ? t.format.skeleton : t.format.format;
        if (!u(t.format.type)) {
          i.type = t.format.type === 'dateonly' ? 'date' : t.format.type.toLowerCase();
        }
      } else {
        i.numberFormat = t.format;
        i.type = t.type === 'dateonly' ? 'date' : t.type;
      }
    if (!u(t.textAlign)) {
      i.hAlign = t.textAlign.toLowerCase();
    }
    if (Object.keys(i).length > 0) {
      i.name = e.element.id + 'column' + r;
      this.styles.push(i);
    }
    if (!e.childGridLevel) {
      !u(t.width) && t.width !== 'auto'
        ? this.columns.push({
            index: r + e.childGridLevel,
            width: typeof t.width == 'number' ? t.width : this.helper.getConvertedWidth(t.width),
          })
        : this.columns.push({
            index: r + e.childGridLevel,
            width: null,
          });
    }
  };
  s.prototype.destroy = function () {};
  return s;
})();
const Nl = {
  data() {
    return {
      data: {
        componentToCreate: null,
        propsToPass: null,
        passDataToProps: true,
      },
      vueNodeId: null,
    };
  },
  created() {
    this.vueNodeId = UUID.generate();
  },
  mounted() {
    let s = this.$data.data.propsToPass;
    if (this.$data.data.passDataToProps) {
      s.data = this.$data.data;
    }
    const e = no(this.$data.data.componentToCreate, s);
    e.appContext = app.__vue_app__._context;
    const t = document.getElementById(this.vueNodeId);
    so(e, t);
  },
};
const Pl = ['id'];
function Hl(s, e, t, i, r, n) {
  oo();
  return ao('div', { id: r.vueNodeId }, null, 8, Pl);
}
const Vl = ro(Nl, [['render', Hl]]);
const Wl = {
  mixins: [co],
  components: { subGridTemplate: Vl },
  data() {
    let s = null;
    if (sessionStorage.getItem('user')) {
      s = JSON.parse(sessionStorage.getItem('user')).date_format_array;
    }
    let e = null;
    s
      ? (e = {
          type: 'dateTime',
          format: s.syncfusionLight,
        })
      : (e = {
          type: 'dateTime',
          format: 'dd/MM/yyyy hh:mm a',
        });
    return {
      selectionModuleGrid: { persistSelectedData: [] },
      gridSettings: {
        ref: 'grid',
        allowExcelExport: true,
        allowFiltering: true,
        allowPaging: true,
        allowReordering: true,
        allowResizing: true,
        allowRowDragAndDrop: true,
        allowSelection: true,
        allowSorting: true,
        clipMode: 'EllipsisWithTooltip',
        dateformat: e,
        enableHover: false,
        enablePersistence: true,
        filterCheck: {
          type: 'CheckBox',
          ignoreAccent: true,
        },
        filterExcel: {
          type: 'Excel',
          ignoreAccent: true,
          enableInfiniteScrolling: true,
          itemsCount: 40,
        },
        filterNumber: {
          type: 'Menu',
          operator: 'equal',
          ignoreAccent: false,
          params: {
            autofill: false,
            popupWidth: 'auto',
          },
        },
        filterSettings: {
          type: 'Menu',
          operator: 'contains',
          ignoreAccent: false,
          params: {
            autofill: false,
            popupWidth: 'auto',
          },
          enableInfiniteScrolling: true,
          itemsCount: 40,
          operators: {
            stringOperator: [
              {
                value: 'startsWith',
                text: this.trans.get('__JSON__.main.grid.operators.startsWith'),
              },
              {
                value: 'endsWith',
                text: this.trans.get('__JSON__.main.grid.operators.endsWith'),
              },
              {
                value: 'contains',
                text: this.trans.get('__JSON__.main.grid.operators.contains'),
              },
              {
                value: 'equal',
                text: this.trans.get('__JSON__.main.grid.operators.equal'),
              },
              {
                value: 'notequal',
                text: this.trans.get('__JSON__.main.grid.operators.notequal'),
              },
              {
                value: 'doesnotstartwith',
                text: this.trans.get('__JSON__.main.grid.operators.doesnotstartwith'),
              },
              {
                value: 'doesnotendwith',
                text: this.trans.get('__JSON__.main.grid.operators.doesnotendwith'),
              },
              {
                value: 'doesnotcontain',
                text: this.trans.get('__JSON__.main.grid.operators.doesnotcontain'),
              },
              {
                value: 'isnull',
                text: this.trans.get('__JSON__.main.grid.operators.isnull'),
              },
              {
                value: 'isnotnull',
                text: this.trans.get('__JSON__.main.grid.operators.isnotnull'),
              },
            ],
            numberOperator: [
              {
                value: 'equal',
                text: this.trans.get('__JSON__.main.grid.operators.equal'),
              },
              {
                value: 'notequal',
                text: this.trans.get('__JSON__.main.grid.operators.notequal'),
              },
              {
                value: 'greaterthan',
                text: this.trans.get('__JSON__.main.grid.operators.greaterthan'),
              },
              {
                value: 'greaterthanorequal',
                text: this.trans.get('__JSON__.main.grid.operators.greaterthanorequal'),
              },
              {
                value: 'lessthan',
                text: this.trans.get('__JSON__.main.grid.operators.lessthan'),
              },
              {
                value: 'lessthanorequal',
                text: this.trans.get('__JSON__.main.grid.operators.lessthanorequal'),
              },
              {
                value: 'isnull',
                text: this.trans.get('__JSON__.main.grid.operators.isnull'),
              },
              {
                value: 'isnotnull',
                text: this.trans.get('__JSON__.main.grid.operators.isnotnull'),
              },
            ],
          },
        },
        filterWithoutCheckbox: {
          type: 'Menu',
          operator: 'contains',
          params: {
            autofill: false,
            popupWidth: 'auto',
          },
          ignoreAccent: false,
          enableInfiniteScrolling: true,
          itemsCount: 40,
        },
        height: '100%',
        pageSettings: {
          currentPage: 1,
          pageCount: 8,
          pageSize: 25,
          pageSizes: [5, 10, 25, 50, 100, 200],
        },
        pageSettingsModal: {
          currentPage: 1,
          pageCount: 8,
          pageSize: 10,
          pageSizes: [5, 10, 25, 50, 100, 200],
        },
        rowHeight: 30,
        searchSettings: {
          operator: 'contains',
          key: '',
        },
        selectionSettings: {
          checkboxOnly: false,
          persistSelection: true,
          type: 'Multiple',
          enableSimpleMultiRowSelection: true,
        },
        selectionSettingsCheckBoxOnly: {
          checkboxOnly: true,
          persistSelection: true,
          type: 'Multiple',
          enableSimpleMultiRowSelection: true,
        },
        showColumnChooser: true,
        rowDropSettings: { targetID: 'treeview' },
        toolbar: [
          'Search',
          'ColumnChooser',
          {
            id: 'excelExport',
            prefixIcon: 'sf-icon--excel-export-',
            tooltipText: translate.get('__JSON__.main.grid.toolbar.excelExport'),
          },
          {
            id: 'csvExport',
            prefixIcon: 'sf-icon-csv-export',
            tooltipText: translate.get('__JSON__.main.grid.toolbar.csvExport'),
          },
          {
            id: 'resetFilter',
            prefixIcon: 'sf-icon-filter-05-wf',
            tooltipText: translate.get('__JSON__.main.grid.toolbar.resetFilter'),
          },
          {
            id: 'autofitColumns',
            prefixIcon: 'sf-icon-arrow-expand',
            tooltipText: translate.get('__JSON__.main.grid.toolbar.autofitColumns'),
          },
          {
            id: 'selectionToolbar',
            text: translate.get('__JSON__.main.grid.toolbar.numberSelected', { number: 0 }),
            disabled: true,
          },
        ],
        toolbarChild: [
          'Search',
          'ColumnChooser',
          {
            id: 'excelExportChild',
            prefixIcon: 'sf-icon--excel-export-',
            tooltipText: translate.get('__JSON__.main.grid.toolbar.excelExport'),
          },
          {
            id: 'csvExportChild',
            prefixIcon: 'sf-icon-csv-export',
            tooltipText: translate.get('__JSON__.main.grid.toolbar.csvExport'),
          },
          {
            id: 'resetFilterChild',
            prefixIcon: 'sf-icon-filter-05-wf',
            tooltipText: translate.get('__JSON__.main.grid.toolbar.resetFilter'),
          },
          {
            id: 'autofitColumnsChild',
            prefixIcon: 'sf-icon-arrow-expand',
            tooltipText: translate.get('__JSON__.main.grid.toolbar.autofitColumns'),
          },
        ],
        extraSmallWidth: 30,
        smallWidth: 60,
        mediumWidth: 100,
        largeWidth: 150,
        extraLargeWidth: 200,
        columnsLogs: [
          {
            field: 'created_at',
            type: 'date',
            headerText: this.trans.get('__JSON__.model.value.created'),
            format: e,
            visible: true,
            filter: { type: 'Menu' },
          },
          {
            field: 'created_by_user',
            type: 'string',
            headerText: this.trans.get('__JSON__.model.value.createdBy'),
            visible: true,
            filter: { type: 'Excel' },
          },
          {
            field: 'updated_at',
            type: 'date',
            headerText: this.trans.get('__JSON__.model.value.updated'),
            format: e,
            visible: true,
            filter: { type: 'Menu' },
          },
          {
            field: 'updated_by_user',
            type: 'string',
            headerText: this.trans.get('__JSON__.model.value.updatedBy'),
            visible: true,
            filter: { type: 'Excel' },
          },
          {
            field: 'deleted_at',
            type: 'date',
            headerText: this.trans.get('__JSON__.model.value.deleted'),
            format: e,
            visible: false,
            filter: { type: 'Menu' },
          },
          {
            field: 'deleted_by_user',
            type: 'string',
            headerText: this.trans.get('__JSON__.model.value.deletedBy'),
            visible: false,
            filter: { type: 'Excel' },
          },
        ],
      },
      childGridSettings: {
        queryString: null,
        columns: [],
        load: function () {
          this.parentDetails.parentKeyFieldValue = this.parentDetails.parentRowData.id;
        },
      },
      isRowSelected: false,
      isMassSelecting: false,
      isSelecting: false,
      hasPreferences: false,
      forceImageVisibility: false,
    };
  },
  mounted() {
    if (this.$refs.grid && this.$refs.grid.ej2Instances) {
      if (this.$refs.grid.ej2Instances.enablePersistence && this.$refs.grid.$el && this.$refs.grid.$el.id) {
        let e = this.mainStore.getCurrentColumnsPreferences(this.$refs.grid.$el.id);
        e
          ? ((this.hasPreferences = true), this.manageColumnsPreferences(e))
          : axios.get('api/users/getPreference/grid' + this.$refs.grid.$el.id).then((t) => {
              if (t.data.preference && this.$refs.grid) {
                this.hasPreferences = true;
                let i = JSON.parse(t.data.preference);
                this.manageColumnsPreferences(i);
              }
            });
      }
      He.$on('gridLoaded', this.gridLoaded);
      let s = this.$refs.grid.$el.querySelector('#selectionToolbar');
      if (s && s.firstElementChild) {
        let e = s.firstElementChild;
        s.firstElementChild.style.color = 'black';
        s.firstElementChild.style['font-size'] = '12px';
        this.selectionModuleGrid = this.$refs.grid.ej2Instances.selectionModule;
      }
      $('.e-toolbar-item.e-search-wrapper > .e-input-group.e-search > .e-input').attr('autocomplete', 'off');
    }
  },
  beforeUnmount() {
    if (
      this.$refs.grid &&
      (He.$off('gridLoaded', this.gridLoaded),
      this.mainStore.removeExternalSearch(),
      this.$refs.grid.dataSource && (this.$refs.grid.dataSource.length = 0),
      this.$refs.grid.$el && this.$refs.grid.$el.id && this.$refs.grid.ej2Instances.enablePersistence)
    ) {
      let s = JSON.parse(this.$refs.grid.ej2Instances.getPersistData());
      let e = [];
      s.columns.forEach((t, i) => {
        e.push({
          index: i,
          field: t.field,
          visible: t.visible,
          width: t.width,
        });
      });
      this.mainStore.saveCurrentColumnsPreferences({
        gridId: this.$refs.grid.$el.id,
        columns: e,
      });
      axios.post('api/users/updatePreferences', {
        informations: e,
        type: 'grid' + this.$refs.grid.$el.id,
      });
    }
  },
  computed: {
    childGridDefault() {
      return {
        actionBegin: this.actionBegin,
        allowExcelExport: this.gridSettings.allowExcelExport,
        allowFiltering: this.gridSettings.allowFiltering,
        allowPaging: this.gridSettings.allowPaging,
        allowReordering: this.gridSettings.allowReordering,
        allowResizing: this.gridSettings.allowResizing,
        allowRowDragAndDrop: false,
        allowSelection: this.gridSettings.allowSelection,
        allowSorting: this.gridSettings.allowSorting,
        clipMode: this.gridSettings.clipMode,
        dataBound: this.dataBoundChild,
        filterSettings: this.gridSettings.filterSettings,
        pageSettings: this.gridSettings.pageSettings,
        searchSettings: this.gridSettings.searchSettings,
        selectionSettings: this.gridSettings.selectionSettings,
        showColumnChooser: this.gridSettings.showColumnChooser,
        recordDoubleClick: this.recordDoubleClick,
        rowDragStart: this.rowDragStart,
        rowDropSettings: this.gridSettings.rowDropSettings,
        rowHeight: this.gridSettings.rowHeight,
        toolbar: this.gridSettings.toolbarChild,
        toolbarClick: this.toolbarClickChild,
        queryString: this.childGridSettings.queryString,
        columns: this.childGridSettings.columns,
        load: this.childGridSettings.load,
      };
    },
  },
  methods: {
    getSubGridTemplate(s, e, t) {
      let i = this;
      return function () {
        return {
          template: { _context: i.$ },
          data: {
            passDataToProps: s,
            componentToCreate: po(uo(e)),
            propsToPass: t,
          },
        };
      };
    },
    manageColumnsPreferences(s) {
      if (!(s && this.$refs.grid.ej2Instances.columns && s.length !== this.$refs.grid.ej2Instances.columns.length)) {
        s.forEach((e) => {
          let t = this.$refs.grid.ej2Instances.columns.find((i) => i.field === e.field);
          if (t && e && e.field) {
            if (e.field === 'image') {
              this.forceImageVisibility = e.visible;
            }
            if (t.allowReordering) {
              this.$refs.grid.ej2Instances.reorderColumnByTargetIndex(e.field, e.index);
            }
            if (t.showInColumnChooser) {
              t.visible = e.visible;
            }
            if (t.allowResizing) {
              t.width = e.width;
            }
          }
        });
        if (s.length) {
          this.$refs.grid.ej2Instances.refresh();
        }
      }
    },
    onGridCreate(s) {
      this.$refs.grid.$el.removeAttribute('tabindex');
    },
    sortComparerNaturalOrder(s, e) {
      if (s == null || s === false) return e == null || e === false ? 0 : 1;
      if (e === null) return -1;
      let t = s.localeCompare(e, void 0, {
        numeric: true,
        sensitivity: 'base',
        ignorePunctuation: true,
      });
      return t > 0 ? 1 : t === 0 ? 0 : -1;
    },
    filterMultipleValues(s, e) {
      let t = { value: '' };
      let i = this;
      return {
        ui: {
          create: function (r) {
            r.getOptrInstance.dropOptr.element.parentElement.parentElement.style.display = 'none';
            let n = ve('input');
            r.target.appendChild(n);
            let a = [
              ...new Set(
                i[s].flatMap(function (d) {
                  return d[e] ? d[e].split(' | ') : i.trans.get('__JSON__.main.grid.content.blank');
                }),
              ),
            ];
            let o = [];
            let l = 1;
            a.forEach((d) => {
              o.push({
                text: d,
                id: l,
              });
              l++;
            });
            let h = new H(o);
            t = new Ke({
              dataSource: h,
              placeholder: i.trans.get('__JSON__.main.grid.content.selectValue'),
              popupHeight: '200px',
              sortOrder: 'Ascending',
              fields: {
                text: 'text',
                value: 'id',
              },
              allowFiltering: true,
              filtering: function (d) {
                let p = new ue();
                p = d.text !== '' ? p.where('text', 'contains', d.text, true) : p;
                d.updateData(h, p);
              },
            });
            t.appendTo(n);
          },
          write: function (r) {},
          read: function (r) {
            r.fltrObj.clearFiltering([r.column.field]);
            let n = t.text;
            n = n.split(',');
            if (n) {
              let a = false;
              if (n.indexOf(i.trans.get('__JSON__.main.grid.content.blank')) !== -1) {
                n = [
                  ...new Set(
                    i[s].map(function (h) {
                      return h[e];
                    }),
                  ),
                ].filter((h) => {
                  if (h) {
                    let d = false;
                    n.forEach((p) => {
                      if (h.includes(p)) {
                        d = true;
                      }
                    });
                    return d;
                  } else return true;
                });
                a = true;
              }
              i.$nextTick(() => {
                r.fltrObj.filterByColumn(r.column.field, a ? 'equal' : 'contains', n);
              });
            }
          },
        },
      };
    },
    actionBegin(s) {
      if (
        this.mainStore.externalSearch.type &&
        this.mainStore.externalSearch.content &&
        !this.notForGridLoaded &&
        this.mainStore.externalSearch.columnName === 'id'
      ) {
        He.$emit('showPanel', {
          panelDroite: true,
          refObjet: this.mainStore.externalSearch.content,
          typeObject: this.mainStore.externalSearch.panel_type,
          tabDatas: { goToTab: this.mainStore.externalSearch.tab },
        });
        this.mainStore.removeExternalSearch();
      }
    },
    actionComplete(s) {
      if (s.requestType === 'columnstate') {
        let e = this.$refs.grid;
        if (this.$refs.grid && this.$refs.grid.$el.querySelector('.e-detailrow')) {
          this.$refs.grid.refresh();
        }
      }
    },
    dataBound() {
      if (this.$refs.grid) {
        if (
          !this.$refs.grid.ej2Instances.enablePersistence ||
          !this.$refs.grid.$el ||
          !this.$refs.grid.$el.id ||
          !this.hasPreferences
        ) {
          this.hasPreferences = true;
        }
        let s = this.$refs.grid.ej2Instances.columns;
        let e = ['actions', 'checkbox', 'node_icon'];
        this.$refs.grid.ej2Instances.columns.find((t) => e.includes(t.field))
          ? this.$refs.grid.autoFitColumns(e)
          : this.$refs.grid.autoFitColumns();
      }
    },
    dataBoundChild() {
      let s = this.$refs.grid;
      if (this.$refs.grid) {
        let e = this.$refs.grid.$el.querySelector('.e-detailrow');
        if (e) {
          let t = this.getSyncfusionInstanceFromElement(e.querySelector('.e-grid'), 'autoFitColumns');
          if (t && t.columns.length < 10) {
            t.autoFitColumns();
          }
        }
      }
    },
    filterSettingsWithExternalSearch(s) {
      if (
        s &&
        this.mainStore.externalSearch &&
        this.mainStore.externalSearch.content &&
        this.mainStore.externalSearch.columnName !== 'treeviewSearch'
      ) {
        let e = JSON.parse(JSON.stringify(this.gridSettings.filterSettings));
        if (this.mainStore.externalSearch.columnName) {
          s = this.mainStore.externalSearch.columnName;
        }
        if (s !== 'pce_uuid') {
          e.columns = [
            {
              field: s,
              matchCase: false,
              operator: this.mainStore.externalSearch.filter,
              predicate: 'and',
              value: this.mainStore.externalSearch.content,
            },
          ];
        }
        return e;
      } else return this.gridSettings.filterSettings;
    },
    gridLoaded() {
      let s = this.$refs.grid;
      this.$nextTick(() => {
        if (
          this.mainStore.externalSearch.type &&
          this.mainStore.externalSearch.type !== 'pce' &&
          this.mainStore.externalSearch.content &&
          !this.notForGridLoaded &&
          this.mainStore.externalSearch.columnName !== 'treeviewSearch'
        ) {
          let e = this.$refs.grid.getFilteredRecords();
          if (e && e.length === 1) {
            this.recordDoubleClick({
              rowData: e[0],
              tabDatas: this.mainStore.externalSearch ? { goToTab: this.mainStore.externalSearch.tab } : null,
            });
          }
          this.mainStore.removeExternalSearch();
        }
      });
    },
    recordDoubleClick(s) {
      if (s.rowData && (s.rowData.api_prefix || this.typeObject) && s.rowData.id && !s.rowData.deleted_at) {
        He.$emit('showPanel', {
          panelDroite: true,
          refObjet: s.rowData.id,
          typeObject: s.rowData.api_prefix ? s.rowData.api_prefix : this.typeObject,
          tabDatas: s.tabDatas ?? null,
        });
      }
    },
    rowDataBound(s) {
      if (this.objectType == 'value_lists' || this.objectType == 'values') {
        let e = '';
        let t = '';
        this.objectType == 'value_list'
          ? ((e = s.data.editable), (t = s.data.data.deleted_at))
          : ((e = s.data.deletable), (t = s.data.data.deleted_at));
        e != 0 && data.useCaseCount == 0 && t != null
          ? (s.row.classList.add('soft-deleted'), s.row.classList.remove('rowActive'))
          : (s.row.classList.add('rowActive'), s.row.classList.remove('soft-deleted'));
      } else
        s.data.has_use_cases == false && s.data.deleted_at != null
          ? (s.row.classList.add('soft-deleted'), s.row.classList.remove('rowActive'))
          : (s.row.classList.add('rowActive'), s.row.classList.remove('soft-deleted'));
    },
    rowDragStart(s) {
      s.cancel = true;
    },
    rowDrop(s) {
      $('body').css('cursor', '');
      let e = s.target.closest('li');
      if (!e) {
        s.cancel = true;
        return;
      }
      if (e.id === 'cartButton') {
        let t = null;
        let i = s.data.map(
          (r) => (
            (t = r.api_prefix),
            {
              object_id: r.id,
              object_type: r.api_prefix,
            }
          ),
        );
        if (!t || t !== 'items') return;
        He.$emit('showCartSelector', i);
      } else {
        let t = $(e).attr('data-uid');
        if (!t) {
          s.cancel = true;
          return;
        }
        let i = {
          idNode: t,
          selection: s.data,
        };
        He.$emit('dropGridFromTree', i);
      }
      this.$refs.grid.ej2Instances.selectionModule.clearSelection();
    },
    rowSelecting(s) {
      if (s.target) {
        if (s.target.tagName === 'INPUT') {
          s.cancel = true;
          return;
        }
        if (s.target.closest('.gridActions')) {
          s.cancel = true;
          return;
        }
      }
    },
    rowSelected(s) {
      if (this.$refs.grid) {
        let e = this.$refs.grid.getSelectedRecords();
        let t = document.getElementById('selectionToolbar');
        if (t && t.firstElementChild) {
          let i = t?.firstElementChild;
          i.textContent = translate.get('__JSON__.main.grid.toolbar.numberSelected', { number: e.length });
        }
        He.$emit('getRowChecked', this.$refs.grid.getSelectedRecords());
      }
    },
    rowDeselected(s) {
      if (this.$refs.grid) {
        let e = this.$refs.grid.getSelectedRecords();
        let t = document.getElementById('selectionToolbar');
        if (t && t.firstElementChild) {
          let i = t?.firstElementChild;
          i.textContent = translate.get('__JSON__.main.grid.toolbar.numberSelected', { number: e.length });
        }
      }
    },
    setChildDataSource(s, e) {
      let t = this.getSyncfusionInstanceFromElement(s.detailElement.querySelector('.e-grid'), 'autoFitColumns');
      t.dataSource = e;
      t.autoFitColumns();
    },
    toolbarClick(s) {
      let e = this.$refs.grid;
      let t = {
        fileName: this.getNameForExport(),
        enableFilter: true,
        hierarchyExportMode: 'None',
        includeHiddenColumn: false,
      };
      var i = [];
      var r = false;
      if (this.typeObject) {
        this.$refs.grid.getFilteredRecords().length > 0
          ? (i = this.$refs.grid.getFilteredRecords())
          : (i = this.$refs.grid.dataSource);
        r = true;
        var n = this.$refs.grid
          .getColumns()
          .filter((l) => l.visible)
          .map((l) => l.field);
        var a = this.$refs.grid
          .getColumns()
          .filter((l) => l.visible)
          .map((l) => l.headerText);
        var o = i.map((l) => l.id);
      }
      switch (s.item.id) {
        case 'excelExport':
          r
            ? ((t.fileName += '.xlsx'),
              axios
                .post('api/' + this.typeObject + '/export_xlsx', {
                  ids: o,
                  columnsFieldName: n,
                  tradFieldName: a,
                  nameFile: t.fileName,
                  subExportType: this.subExportType ?? null,
                })
                .catch((l) => {
                  console.error(l);
                }))
            : (this.$refs.grid.showSpinner(),
              (t.fileName += '.xlsx'),
              this.$refs.grid
                .excelExport(t)
                .then((l) => {
                  this.$refs.grid.hideSpinner();
                })
                .catch((l) => {
                  this.$refs.grid.hideSpinner();
                }));
          break;
        case 'csvExport':
          r
            ? ((t.fileName += '.csv'),
              axios
                .post('api/' + this.typeObject + '/export_csv', {
                  ids: o,
                  columnsFieldName: n,
                  tradFieldName: a,
                  nameFile: t.fileName,
                  subExportType: this.subExportType ?? null,
                })
                .catch((l) => {
                  console.error(l);
                }))
            : (this.$refs.grid.showSpinner(),
              (t.fileName += '.csv'),
              this.$refs.grid
                .csvExport(t)
                .then((l) => {
                  this.$refs.grid.hideSpinner();
                })
                .catch((l) => {
                  this.$refs.grid.hideSpinner();
                }));
          break;
        case 'resetFilter':
          {
            this.$refs.grid.clearFiltering();
            this.$refs.grid.clearSorting();
            if (this.$refs.grid.ej2Instances && this.$refs.grid.ej2Instances.searchSettings) {
              this.$refs.grid.ej2Instances.searchSettings.key = '';
            }
            this.$refs.grid.refresh();
            this.$refs.grid.refreshHeader();
          }
          break;
        case 'autofitColumns':
          this.$refs.grid.autoFitColumns();
          break;
      }
    },
    getNameForExport() {
      let s = new Date().toLocaleString();
      s = s.replace('/', '-');
      s = s.replace(':', '-');
      s = s.replace('.', '-');
      s += ' ' + this.trans.get('__JSON__.main.grid.export.name');
      if (this.gridNameForExport) {
        s = s + ' ' + this.gridNameForExport;
      }
      s = s.replace(/[:/*?"<>\\]/g, '_');
      return s;
    },
    toolbarClickChild(s) {
      let e = this.getSyncfusionInstanceFromElement(s.originalEvent.target.closest('.e-grid'), 'autoFitColumns');
      let t = {
        fileName: this.getNameForExport(),
        enableFilter: true,
        hierarchyExportMode: 'None',
        includeHiddenColumn: false,
      };
      switch (s.item.id) {
        case 'excelExportChild':
          {
            this.$refs.grid.showSpinner();
            t.fileName += '.xlsx';
            e.excelExport(t)
              .then((i) => {
                this.$refs.grid.hideSpinner();
              })
              .catch((i) => {
                this.$refs.grid.hideSpinner();
              });
          }
          break;
        case 'csvExportChild':
          {
            this.$refs.grid.showSpinner();
            t.fileName += '.csv';
            e.csvExport(t)
              .then((i) => {
                this.$refs.grid.hideSpinner();
              })
              .catch((i) => {
                this.$refs.grid.hideSpinner();
              });
          }
          break;
        case 'resetFilterChild':
          {
            e.clearFiltering();
            e.clearSorting();
            if (e.ej2Instances && e.ej2Instances.searchSettings) {
              e.ej2Instances.searchSettings.key = '';
            }
            e.refresh();
            e.refreshHeader();
          }
          break;
        case 'autofitColumnsChild':
          e.autoFitColumns();
          break;
      }
    },
    addRecordChildGrid(s, e) {
      let t = this.$refs.grid.getRowIndexByPrimaryKey(e);
      if (t >= 0) {
        let r = this.$refs.grid.getRowByIndex(t).nextElementSibling;
        if (
          this.$refs.grid.getRowByIndex(t).nextElementSibling &&
          this.$refs.grid.getRowByIndex(t).nextElementSibling.classList.contains('e-detailrow')
        ) {
          let n = this.getSyncfusionInstanceFromElement(
            this.$refs.grid.getRowByIndex(t).nextElementSibling.querySelector('.e-grid'),
            'addRecord',
          );
          n.addRecord(s);
          n.refresh();
        }
      }
    },
    deleteRecordChildGrid(s, e) {
      let t = this.$refs.grid.getRowIndexByPrimaryKey(e);
      if (t >= 0) {
        let r = this.$refs.grid.getRowByIndex(t).nextElementSibling;
        if (
          this.$refs.grid.getRowByIndex(t).nextElementSibling &&
          this.$refs.grid.getRowByIndex(t).nextElementSibling.classList.contains('e-detailrow')
        ) {
          let n = this.getSyncfusionInstanceFromElement(
            this.$refs.grid.getRowByIndex(t).nextElementSibling.querySelector('.e-grid'),
            'selectRow',
          );
          let a = n.getRowIndexByPrimaryKey(s);
          if (a >= 0) {
            n.selectRow(a);
            n.deleteRecord();
            n.refresh();
          }
        }
      }
    },
    updateRecordChildGrid(s, e, t) {
      let i = this.$refs.grid.getRowIndexByPrimaryKey(t);
      if (i >= 0) {
        let n = this.$refs.grid.getRowByIndex(i).nextElementSibling;
        if (
          this.$refs.grid.getRowByIndex(i).nextElementSibling &&
          this.$refs.grid.getRowByIndex(i).nextElementSibling.classList.contains('e-detailrow')
        ) {
          let a = this.getSyncfusionInstanceFromElement(
            this.$refs.grid.getRowByIndex(i).nextElementSibling.querySelector('.e-grid'),
            'selectRow',
          );
          let o = a.getRowIndexByPrimaryKey(e);
          if (o >= 0) {
            a.selectRow(o);
            a.deleteRecord();
            a.addRecord(s, o);
            a.refresh();
          }
        }
      }
    },
    getSubGridPageByPage(s, e, t, i = null) {
      if (i) {
        ho(document.getElementById(i));
      }
      let r = 1;
      let n = [];
      this.getSubGridPage(s, n, e, 1, t, i);
    },
    getSubGridPage(s, e, t, i, r, n) {
      let a = t + i;
      axios
        .get(a)
        .then((o) => {
          if (this.$refs.grid) {
            let l = [];
            if (o.data.hasOwnProperty(r)) {
              l = o.data[r];
            }
            e = e.concat(l);
            i < o.data.count
              ? (i++, this.getSubGridPage(s, e, t, i, r, n))
              : (n && Mr(document.getElementById(n)), this.setChildDataSource(s, e));
          }
        })
        .catch((o) => {
          console.error(o);
          if (n) {
            Mr(document.getElementById(n));
          }
          this.showCenterToast(this.trans.get('__JSON__.main.grid.toast.error.get'), 'e-toast-danger');
        });
    },
  },
  watch: {
    'selectionModuleGrid.persistSelectedData': {
      deep: true,
      handler(s) {
        let e = this.$refs.grid.$el.querySelector('#selectionToolbar');
        if (e && e.firstElementChild) {
          let t = e.firstElementChild;
          s
            ? (t.textContent = translate.get('__JSON__.main.grid.toolbar.numberSelected', { number: s.length }))
            : (t.textContent = translate.get('__JSON__.main.grid.toolbar.numberSelected', { number: 0 }));
        }
      },
    },
  },
  provide: {
    grid: [jo, No, ll, Ao, ol, zl, Fo, yo, Oo, To, Bo, lo, go, ko],
  },
};
export {
  No as A,
  ll as C,
  Ao as D,
  hi as E,
  Fo as F,
  Ho as I,
  yo as P,
  To as R,
  $r as S,
  ko as T,
  Nn as V,
  zl as a,
  Un as b,
  Fl as c,
  ql as d,
  go as e,
  Bo as f,
  Wl as g,
  ol as h,
  Oo as i,
  Vo as j,
  _o as k,
  jo as l,
  Vl as s,
  Ve as v,
};
